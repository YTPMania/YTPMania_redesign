define("discourse/plugins/chat/discourse/adapters/chat-message",["exports","discourse/adapters/rest"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{pathFor(e,t,i){if(i.targetMessageId)return`/chat/lookup/${i.targetMessageId}.json?chat_channel_id=${i.channelId}`
let n=`/chat/${i.channelId}/messages.json?page_size=${i.pageSize}`
return i.messageId&&(n+=`&message_id=${i.messageId}`),i.direction&&(n+=`&direction=${i.direction}`),n}apiNameFor(){return"chat-message"}}e.default=i})),define("discourse/plugins/chat/discourse/admin-chat-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var t={resource:"admin.adminPlugins",path:"/plugins",map(){this.route("chat")}}
e.default=t})),define("discourse/plugins/chat/discourse/chat-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){this.route("chat",{path:"/chat"},(function(){this.route("channel-legacy",{path:"/channel/:channelId/:channelTitle"}),this.route("channel",{path:"/c/:channelTitle/:channelId"},(function(){this.route("near-message",{path:"/:messageId"}),this.route("threads",{path:"/t"}),this.route("thread",{path:"/t/:threadId"},(function(){this.route("near-message",{path:"/:messageId"})}))})),this.route("channel.info",{path:"/c/:channelTitle/:channelId/info"},(function(){this.route("about",{path:"/about"}),this.route("members",{path:"/members"}),this.route("settings",{path:"/settings"})})),this.route("browse",{path:"/browse"},(function(){this.route("all",{path:"/all"}),this.route("closed",{path:"/closed"}),this.route("open",{path:"/open"}),this.route("archived",{path:"/archived"})})),this.route("message",{path:"/message/:messageId"})}))}})),define("discourse/plugins/chat/discourse/components/channels-list",["exports","@ember/component","@ember/template-factory","discourse-common/utils/decorators","@glimmer/component","@ember/object","@ember/runloop","@ember/service","@glimmer/tracking","discourse/plugins/chat/discourse/components/chat/modal/new-message"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p,m,b,g,f,v,y,_
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const M=(0,i.createTemplateFactory)({id:"S360bfJ+",block:'[[[41,[30,0,["showMobileDirectMessageButton"]],[[[1,"  "],[8,[39,1],[[24,0,"no-text btn-flat open-new-message-btn keep-mobile-sidebar-open btn-floating"],[16,"title",[28,[37,2],[[30,0,["createDirectMessageChannelLabel"]]],null]]],[["@icon","@action"],["plus",[30,0,["openNewMessageModal"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[11,0],[24,"role","region"],[16,"aria-label",[28,[37,2],["chat.aria_roles.channels_list"],null]],[16,0,[28,[37,3],["channels-list",[52,[30,0,["hasScrollbar"]],"has-scrollbar"]],null]],[4,[38,4],["scroll",[52,[30,0,["chatStateManager","isFullPageActive"]],[30,0,["storeScrollPosition"]],[28,[37,5],null,null]]],null],[4,[38,6],[[30,0,["computeHasScrollbar"]]],null],[4,[38,7],[[30,0,["computeResizedEntries"]]],null],[12],[1,"\\n"],[41,[30,0,["displayPublicChannels"]],[[[1,"    "],[10,0],[14,0,"chat-channel-divider public-channels-section"],[12],[1,"\\n"],[41,[30,0,["inSidebar"]],[[[1,"        "],[11,1],[24,0,"title-caret"],[24,1,"public-channels-caret"],[24,"role","button"],[24,"title","toggle nav list"],[24,"data-toggleable","public-channels"],[4,[38,4],["click",[28,[37,8],[[30,0],"toggleChannelSection","public-channels"],null]],null],[12],[1,"\\n          "],[1,[28,[35,9],["angle-up"],null]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"      "],[10,1],[14,0,"channel-title"],[12],[1,[28,[35,2],["chat.chat_channels"],null]],[13],[1,"\\n\\n      "],[8,[39,10],[[24,0,"btn no-text btn-flat open-browse-page-btn title-action"],[16,"title",[28,[37,2],["chat.channels_list_popup.browse"],null]]],[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n        "],[1,[28,[35,9],["pencil-alt"],null]],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,1,"public-channels"],[15,0,[30,0,["publicChannelClasses"]]],[12],[1,"\\n"],[41,[30,0,["publicChannelsEmpty"]],[[[1,"        "],[10,0],[14,0,"public-channel-empty-message"],[12],[1,"\\n          "],[10,1],[14,0,"channel-title"],[12],[1,[28,[35,2],["chat.no_public_channels"],null]],[13],[1,"\\n          "],[8,[39,10],null,[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n            "],[1,[28,[35,2],["chat.click_to_join"],null]],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[42,[28,[37,12],[[28,[37,12],[[30,0,["chatChannelsManager","publicMessageChannels"]]],null]],null],null,[[[1,"          "],[8,[39,13],null,[["@channel","@options"],[[30,1],[28,[37,14],null,[["settingsButton"],[true]]]]],null],[1,"\\n"]],[1]],null]],[]]],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[8,[39,15],null,[["@name","@tagName","@outletArgs"],["below-public-chat-channels","",[28,[37,14],null,[["inSidebar"],[[30,0,["inSidebar"]]]]]]],null],[1,"\\n\\n"],[41,[30,0,["showDirectMessageChannels"]],[[[1,"    "],[10,0],[14,0,"chat-channel-divider direct-message-channels-section"],[12],[1,"\\n"],[41,[30,0,["inSidebar"]],[[[1,"        "],[11,1],[24,0,"title-caret"],[24,1,"direct-message-channels-caret"],[24,"role","button"],[24,"title","toggle nav list"],[24,"data-toggleable","direct-message-channels"],[4,[38,4],["click",[28,[37,8],[[30,0],"toggleChannelSection","direct-message-channels"],null]],null],[12],[1,"\\n          "],[1,[28,[35,9],["angle-up"],null]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"      "],[10,1],[14,0,"channel-title"],[12],[1,[28,[35,2],["chat.direct_messages.title"],null]],[13],[1,"\\n\\n"],[41,[28,[37,16],[[30,0,["canCreateDirectMessageChannel"]],[28,[37,17],[[30,0,["showMobileDirectMessageButton"]]],null]],null],[[[1,"        "],[8,[39,1],[[24,0,"no-text btn-flat open-new-message-btn"],[16,"title",[28,[37,2],[[30,0,["createDirectMessageChannelLabel"]]],null]]],[["@icon","@action"],["plus",[30,0,["openNewMessageModal"]]]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[10,0],[14,1,"direct-message-channels"],[15,0,[30,0,["directMessageChannelClasses"]]],[12],[1,"\\n"],[42,[28,[37,12],[[28,[37,12],[[30,0,["chatChannelsManager","truncatedDirectMessageChannels"]]],null]],null],null,[[[1,"      "],[8,[39,13],null,[["@channel","@options"],[[30,2],[28,[37,14],null,[["leaveButton"],[true]]]]],null],[1,"\\n"]],[2]],null],[1,"  "],[13],[1,"\\n"],[13]],["channel","channel"],false,["if","d-button","i18n","concat-class","on","noop","did-insert","chat/on-resize","action","d-icon","link-to","each","-track-array","chat-channel-row","hash","plugin-outlet","and","not"]]',moduleName:"discourse/plugins/chat/discourse/components/channels-list.hbs",isStrictMode:!1})
let z=(u=class extends r.default{constructor(){super(...arguments),w(this,"chat",d,this),w(this,"router",h,this),w(this,"chatStateManager",p,this),w(this,"chatChannelsManager",m,this),w(this,"site",b,this),w(this,"siteSettings",g,this),w(this,"session",f,this),w(this,"currentUser",v,this),w(this,"modal",y,this),w(this,"hasScrollbar",_,this)}computeHasScrollbar(e){this.hasScrollbar=e.scrollHeight>e.clientHeight}computeResizedEntries(e){this.computeHasScrollbar(e[0].target)}openNewMessageModal(){this.modal.show(c.default)}get showMobileDirectMessageButton(){return this.site.mobileView&&this.canCreateDirectMessageChannel}get inSidebar(){return this.args.inSidebar??!1}get publicMessageChannelsEmpty(){return 0===this.chatChannelsManager.publicMessageChannels?.length}get createDirectMessageChannelLabel(){return this.canCreateDirectMessageChannel?"chat.direct_messages.new":"chat.direct_messages.cannot_create"}get showDirectMessageChannels(){return this.canCreateDirectMessageChannel||this.chatChannelsManager.directMessageChannels?.length>0}get canCreateDirectMessageChannel(){return this.chat.userCanDirectMessage}get publicChannelClasses(){return"channels-list-container public-channels "+(this.inSidebar?"collapsible-sidebar-section":"")}get displayPublicChannels(){return!!this.siteSettings.enable_public_channels&&(!this.publicMessageChannelsEmpty||(this.currentUser?.staff||this.currentUser?.has_joinable_public_channels))}get directMessageChannelClasses(){return"channels-list-container direct-message-channels "+(this.inSidebar?"collapsible-sidebar-section":"")}toggleChannelSection(e){this.args.toggleSection(e)}didRender(){this._super(...arguments),(0,s.schedule)("afterRender",this._applyScrollPosition)}storeScrollPosition(){if(this.chatStateManager.isDrawerActive)return
const e=document.querySelector(".channels-list")?.scrollTop||0
this.session.channelsListPosition=e}_applyScrollPosition(){if(this.chatStateManager.isDrawerActive)return
const e=this.chatStateManager.isFullPageActive&&this.session.channelsListPosition||0
document.querySelector(".channels-list").scrollTo(0,e)}},d=j(u.prototype,"chat",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=j(u.prototype,"router",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=j(u.prototype,"chatStateManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=j(u.prototype,"chatChannelsManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=j(u.prototype,"site",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=j(u.prototype,"siteSettings",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=j(u.prototype,"session",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=j(u.prototype,"currentUser",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=j(u.prototype,"modal",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=j(u.prototype,"hasScrollbar",[l.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j(u.prototype,"computeHasScrollbar",[a.action],Object.getOwnPropertyDescriptor(u.prototype,"computeHasScrollbar"),u.prototype),j(u.prototype,"computeResizedEntries",[a.action],Object.getOwnPropertyDescriptor(u.prototype,"computeResizedEntries"),u.prototype),j(u.prototype,"openNewMessageModal",[a.action],Object.getOwnPropertyDescriptor(u.prototype,"openNewMessageModal"),u.prototype),j(u.prototype,"toggleChannelSection",[a.action],Object.getOwnPropertyDescriptor(u.prototype,"toggleChannelSection"),u.prototype),j(u.prototype,"storeScrollPosition",[a.action],Object.getOwnPropertyDescriptor(u.prototype,"storeScrollPosition"),u.prototype),j(u.prototype,"_applyScrollPosition",[n.bind],Object.getOwnPropertyDescriptor(u.prototype,"_applyScrollPosition"),u.prototype),u)
e.default=z,(0,t.setComponentTemplate)(M,z)})),define("discourse/plugins/chat/discourse/components/chat-browse-view",["exports","@ember/component","@ember/template-factory","discourse-common/config/environment","@ember/object","@ember/runloop","@ember/service","discourse-common/lib/debounce","discourse/plugins/chat/discourse/components/chat/modal/new-message","discourse/plugins/chat/discourse/components/chat/modal/create-channel"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const f=(0,i.createTemplateFactory)({id:"q4+dyCay",block:'[[[10,0],[14,0,"chat-browse-view__header chat-full-page-header"],[12],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"    "],[8,[39,1],[[24,0,"chat-full-page-header__back-btn no-text btn-flat btn"],[16,"title",[28,[37,2],["chat.browse.back"],null]]],[["@route"],["chat.index"]],[["default"],[[[[1,"\\n      "],[1,[28,[35,3],["chevron-left"],null]],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n  "],[10,1],[14,0,"chat-browse-view__title"],[12],[1,[28,[35,2],["chat.browse.title"],null]],[13],[1,"\\n\\n"],[41,[30,0,["currentUser","staff"]],[[[1,"    "],[8,[39,4],null,[["@action","@icon","@class","@label"],[[28,[37,5],[[30,0],"createChannel"],null],"plus",[28,[37,6],["new-channel-btn",[52,[30,0,["site","mobileView"]],"btn-flat"]],null],[52,[30,0,["site","desktopView"]],"chat.create_channel.title"]]],null],[1,"\\n"]],[]],null],[13],[1,"\\n\\n"],[10,0],[14,0,"chat-browse-view"],[12],[1,"\\n  "],[10,0],[14,0,"chat-browse-view__actions"],[12],[1,"\\n    "],[10,"nav"],[12],[1,"\\n      "],[10,"ul"],[14,0,"nav-pills chat-browse-view__filters"],[12],[1,"\\n"],[42,[28,[37,8],[[28,[37,8],[[30,0,["tabs"]]],null]],null],null,[[[1,"          "],[10,"li"],[15,0,[28,[37,9],["chat-browse-view__filter -",[30,1]],null]],[12],[1,"\\n            "],[8,[39,1],[[16,0,[28,[37,9],["chat-browse-view__filter-link -",[30,1]],null]]],[["@route"],[[28,[37,9],["chat.browse.",[30,1]],null]]],[["default"],[[[[1,"\\n              "],[1,[28,[35,2],[[28,[37,9],["chat.browse.filter_",[30,1]],null]],null]],[1,"\\n            "]],[]]]]],[1,"\\n          "],[13],[1,"\\n"]],[1]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[39,10],[[16,"placeholder",[28,[37,2],["chat.browse.filter_input_placeholder"],null]],[4,[38,12],[[28,[37,5],[[30,0],[30,0,["focusFilterInput"]]],null]],null]],[["@class","@filterAction","@icons"],["filter-input",[28,[37,5],[[30,0],"debouncedFiltering"],null],[28,[37,11],null,[["right"],["search"]]]]],null],[1,"\\n  "],[13],[1,"\\n\\n"],[41,[28,[37,13],[[30,0,["channelsCollection","fetchedOnce"]],[28,[37,14],[[30,0,["channelsCollection","length"]]],null]],null],[[[1,"    "],[10,0],[14,0,"empty-state"],[12],[1,"\\n      "],[10,1],[14,0,"empty-state-title"],[12],[1,[28,[35,2],["chat.empty_state.title"],null]],[13],[1,"\\n      "],[10,0],[14,0,"empty-state-body"],[12],[1,"\\n        "],[10,2],[12],[1,[28,[35,2],["chat.empty_state.direct_message"],null]],[13],[1,"\\n        "],[8,[39,4],null,[["@action","@label"],[[30,0,["showChatNewMessageModal"]],"chat.empty_state.direct_message_cta"]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[41,[30,0,["channelsCollection","length"]],[[[1,"    "],[8,[39,15],null,[["@selector","@action"],[".chat-channel-card",[30,0,["channelsCollection","load"]]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-browse-view__content_wrapper"],[12],[1,"\\n        "],[10,0],[14,0,"chat-browse-view__content"],[12],[1,"\\n          "],[10,0],[14,0,"chat-browse-view__cards"],[12],[1,"\\n"],[42,[28,[37,8],[[28,[37,8],[[30,0,["channelsCollection"]]],null]],null],null,[[[1,"              "],[8,[39,16],null,[["@channel"],[[30,2]]],null],[1,"\\n"]],[2]],null],[1,"          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[39,17],null,[["@condition"],[[30,0,["channelsCollection","loading"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]],null]],[]]],[13]],["tab","channel"],false,["if","link-to","i18n","d-icon","d-button","action","concat-class","each","-track-array","concat","dc-filter-input","hash","did-insert","and","not","load-more","chat-channel-card","conditional-loading-spinner"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-browse-view.hbs",isStrictMode:!1}),v=["all","open","closed","archived"]
let y=(u=(0,r.computed)("siteSettings.chat_allow_archiving_channels"),d=class extends t.default{constructor(){super(...arguments),m(this,"chatApi",h,this),m(this,"modal",p,this),b(this,"tagName","")}didReceiveAttrs(){this._super(...arguments),this.channelsCollection||this.set("channelsCollection",this.chatApi.channels()),this.channelsCollection.load({filter:this.filter,status:this.status})}get tabs(){return this.siteSettings.chat_allow_archiving_channels?v:[...v].removeObject("archived")}showChatNewMessageModal(){this.modal.show(l.default)}onScroll(){(0,o.default)(this,this.channelsCollection.load,{filter:this.filter,status:this.status},n.INPUT_DELAY)}debouncedFiltering(e){this.set("channelsCollection",this.chatApi.channels()),(0,o.default)(this,this.channelsCollection.load,{filter:e.target.value,status:this.status},n.INPUT_DELAY)}createChannel(){this.modal.show(c.default)}focusFilterInput(e){(0,a.schedule)("afterRender",(()=>e?.focus()))}},h=g(d.prototype,"chatApi",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=g(d.prototype,"modal",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g(d.prototype,"tabs",[u],Object.getOwnPropertyDescriptor(d.prototype,"tabs"),d.prototype),g(d.prototype,"showChatNewMessageModal",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"showChatNewMessageModal"),d.prototype),g(d.prototype,"onScroll",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"onScroll"),d.prototype),g(d.prototype,"debouncedFiltering",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"debouncedFiltering"),d.prototype),g(d.prototype,"createChannel",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"createChannel"),d.prototype),g(d.prototype,"focusFilterInput",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"focusFilterInput"),d.prototype),d)
e.default=y,(0,t.setComponentTemplate)(f,y)})),define("discourse/plugins/chat/discourse/components/chat-channel-about-view",["exports","@ember/component","@ember/template-factory","@ember/service"],(function(e,t,i,n){"use strict"
var r,a
function s(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"1PeK/a2B",block:'[[[41,[30,0,["channel","isCategoryChannel"]],[[[1,"  "],[10,0],[14,0,"chat-form__section"],[12],[1,"\\n    "],[10,0],[14,0,"chat-form__field"],[12],[1,"\\n      "],[10,"label"],[14,0,"chat-form__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.about_view.associated_category"],null]],[1,"\\n      "],[13],[1,"\\n      "],[10,0],[14,0,"chat-form__control"],[12],[1,"\\n        "],[1,[28,[35,2],[[30,0,["channel","chatable"]]],[["link","allowUncategorized"],[true,true]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[10,0],[14,0,"chat-form__section"],[12],[1,"\\n  "],[10,0],[14,0,"chat-form__field"],[12],[1,"\\n    "],[10,"label"],[14,0,"chat-form__label"],[12],[1,"\\n      "],[10,1],[12],[1,[28,[35,1],["chat.about_view.name"],null]],[13],[1,"\\n"],[41,[28,[37,3],["can-edit-chat-channel"],null],[[[1,"        "],[10,0],[14,0,"chat-form__label-actions"],[12],[1,"\\n          "],[8,[39,4],null,[["@class","@label","@action"],["edit-name-slug-btn btn-flat","chat.channel_settings.edit",[52,[30,0,["onEditChatChannelName"]],[30,0,["onEditChatChannelName"]]]]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n    "],[10,0],[14,0,"chat-form__control"],[12],[1,"\\n      "],[10,0],[14,0,"channel-info-about-view__name"],[12],[1,"\\n        "],[1,[28,[35,5],[[30,0,["channel","title"]]],null]],[1,"\\n      "],[13],[1,"\\n      "],[10,0],[14,0,"channel-info-about-view__slug"],[12],[1,"\\n        "],[1,[30,0,["channel","slug"]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[41,[28,[37,6],[[28,[37,3],["can-edit-chat-channel"],null],[30,0,["channel","description","length"]]],null],[[[1,"  "],[10,0],[14,0,"chat-form__section"],[12],[1,"\\n    "],[10,0],[14,0,"chat-form__field"],[12],[1,"\\n      "],[10,"label"],[14,0,"chat-form__label"],[12],[1,"\\n        "],[10,1],[12],[1,[28,[35,1],["chat.about_view.description"],null]],[13],[1,"\\n"],[41,[28,[37,3],["can-edit-chat-channel"],null],[[[1,"          "],[10,0],[14,0,"chat-form__label-actions"],[12],[1,"\\n            "],[8,[39,4],null,[["@class","@label","@action"],["edit-description-btn btn-flat",[52,[30,0,["channel","description","length"]],"chat.channel_settings.edit","chat.channel_settings.add"],[52,[30,0,["onEditChatChannelDescription"]],[30,0,["onEditChatChannelDescription"]]]]],null],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"chat-form__control"],[12],[1,"\\n        "],[10,0],[14,0,"channel-info-about-view__description"],[12],[1,"\\n"],[41,[30,0,["channel","description","length"]],[[[1,"            "],[1,[30,0,["channel","description"]]],[1,"\\n"]],[]],[[[1,"            "],[10,0],[14,0,"channel-info-about-view__description__helper-text"],[12],[1,"\\n              "],[1,[28,[35,1],["chat.channel_edit_description_modal.description"],null]],[1,"\\n            "],[13],[1,"\\n"]],[]]],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[10,0],[14,0,"chat-form__section"],[12],[1,"\\n  "],[8,[39,7],null,[["@channel","@options"],[[30,0,["channel"]],[28,[37,8],null,[["joinClass","leaveClass","joinIcon","leaveIcon"],["btn-primary","btn-flat","sign-in-alt","sign-out-alt"]]]]],null],[1,"\\n"],[13]],[],false,["if","i18n","category-badge","chat-guardian","d-button","replace-emoji","or","toggle-channel-membership-button","hash"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-about-view.hbs",isStrictMode:!1})
let l=(r=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=a)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),s(this,"tagName",""),s(this,"channel",null),s(this,"onEditChatChannelName",null),s(this,"onEditChatChannelDescription",null),s(this,"isLoading",!1)}},c=r.prototype,u="chat",d=[n.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),a=m,r)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-channel-archive-status",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/template","I18n","discourse/lib/ajax-error","discourse-common/lib/get-url","@ember/object","@ember/service","@ember/utils"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const g=(0,i.createTemplateFactory)({id:"OSF9OQ/P",block:'[[[41,[30,0,["shouldRender"]],[[[41,[30,1,["archive","failed"]],[[[1,"    "],[10,0],[15,0,[28,[37,1],["alert alert-warn chat-channel-retry-archive",[30,1,["status"]]],null]],[12],[1,"\\n      "],[10,0],[14,0,"chat-channel-archive-failed-message"],[12],[1,"\\n        "],[1,[30,0,["channelArchiveFailedMessage"]]],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"chat-channel-archive-failed-retry"],[12],[1,"\\n        "],[8,[39,2],null,[["@action","@label"],[[30,0,["retryArchive"]],"chat.channel_archive.retry"]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[41,[30,1,["archive","completed"]],[[[1,"    "],[10,0],[15,0,[28,[37,1],["chat-channel-archive-status",[30,1,["status"]]],null]],[12],[1,"\\n      "],[1,[30,0,["channelArchiveCompletedMessage"]]],[1,"\\n    "],[13],[1,"\\n  "]],[]],null]],[]]]],[]],null]],["@channel"],false,["if","concat-class","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-archive-status.hbs",isStrictMode:!1})
let f=(d=class extends n.default{constructor(){super(...arguments),m(this,"chatApi",h,this),m(this,"currentUser",p,this)}get shouldRender(){return this.currentUser.admin&&(0,u.isPresent)(this.args.channel.archive)}get channelArchiveFailedMessage(){const e=this.args.channel.archive,t=e.topicId?"chat.channel_status.archive_failed":"chat.channel_status.archive_failed_no_topic"
return(0,r.htmlSafe)(a.default.t(t,{completed:e.messages,total:e.totalMessages,topic_url:this.topicUrl}))}get channelArchiveCompletedMessage(){return(0,r.htmlSafe)(a.default.t("chat.channel_status.archive_completed",{topic_url:this.topicUrl}))}retryArchive(){return this.chatApi.createChannelArchive(this.args.channel.id).catch(s.popupAjaxError)}get topicUrl(){return this.args.channel.archive.topicId?(0,o.default)(`/t/-/${this.args.channel.archive.topicId}`):""}},h=b(d.prototype,"chatApi",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=b(d.prototype,"currentUser",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b(d.prototype,"retryArchive",[l.action],Object.getOwnPropertyDescriptor(d.prototype,"retryArchive"),d.prototype),d)
e.default=f,(0,t.setComponentTemplate)(g,f)})),define("discourse/plugins/chat/discourse/components/chat-channel-card",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"iGJxwFqF",block:'[[[41,[30,1],[[[1,"  "],[10,0],[15,0,[28,[37,1],["chat-channel-card",[52,[30,1,["isClosed"]],"-closed"],[52,[30,1,["isArchived"]],"-archived"]],null]],[15,5,[28,[37,2],[[30,1,["chatable","color"]]],null]],[15,"data-channel-id",[30,1,["id"]]],[12],[1,"\\n    "],[10,0],[14,0,"chat-channel-card__header"],[12],[1,"\\n      "],[8,[39,3],[[24,0,"chat-channel-card__name-container"]],[["@route","@models"],["chat.channel",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n        "],[10,1],[14,0,"chat-channel-card__name"],[12],[1,"\\n          "],[1,[28,[35,4],[[30,1,["title"]]],null]],[1,"\\n        "],[13],[1,"\\n"],[41,[30,1,["chatable","read_restricted"]],[[[1,"          "],[1,[28,[35,5],["lock"],[["class"],["chat-channel-card__read-restricted"]]]],[1,"\\n"]],[]],null],[1,"      "]],[]]]]],[1,"\\n\\n      "],[10,0],[14,0,"chat-channel-card__header-actions"],[12],[1,"\\n"],[41,[30,1,["currentUserMembership","muted"]],[[[1,"          "],[8,[39,3],[[24,0,"chat-channel-card__tag -muted"],[24,"tabindex","-1"]],[["@route","@models"],["chat.channel.info.settings",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n            "],[1,[28,[35,6],["chat.muted"],null]],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[39,3],[[24,0,"chat-channel-card__setting"],[24,"tabindex","-1"]],[["@route","@models"],["chat.channel.info.settings",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n          "],[1,[28,[35,5],["cog"],null]],[1,"\\n        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,1,["description"]],[[[1,"      "],[10,0],[14,0,"chat-channel-card__description"],[12],[1,"\\n        "],[1,[28,[35,4],[[30,1,["description"]]],null]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,0,"chat-channel-card__cta"],[12],[1,"\\n"],[41,[30,1,["isFollowing"]],[[[1,"        "],[10,0],[14,0,"chat-channel-card__tags"],[12],[1,"\\n          "],[10,1],[14,0,"chat-channel-card__tag -joined"],[12],[1,"\\n            "],[1,[28,[35,6],["chat.joined"],null]],[1,"\\n          "],[13],[1,"\\n\\n          "],[8,[39,7],null,[["@channel","@options"],[[30,1],[28,[37,8],null,[["leaveClass","labelType"],["btn-link btn-small chat-channel-card__leave-btn","short"]]]]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[41,[30,1,["isJoinable"]],[[[1,"        "],[8,[39,7],null,[["@channel","@options"],[[30,1],[28,[37,8],null,[["joinClass","labelType"],["btn-primary btn-small chat-channel-card__join-btn","short"]]]]],null],[1,"\\n      "]],[]],null]],[]]],[1,"\\n"],[41,[28,[37,9],[[30,1,["membershipsCount"]],0],null],[[[1,"        "],[8,[39,3],[[24,0,"chat-channel-card__members"],[24,"tabindex","-1"]],[["@route","@models"],["chat.channel.info.members",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n          "],[1,[28,[35,6],["chat.channel.memberships_count"],[["count"],[[30,1,["membershipsCount"]]]]]],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@channel"],false,["if","concat-class","border-color","link-to","replace-emoji","d-icon","i18n","toggle-channel-membership-button","hash","gt"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-card.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chat",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-channel-chooser-header",["exports","@ember/component","@ember/template-factory","select-kit/components/combo-box/combo-box-header"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"27aMe1xD",block:'[[[10,0],[14,0,"select-kit-header-wrapper"],[12],[1,"\\n"],[41,[30,0,["selectedContent"]],[[[1,"    "],[8,[39,1],null,[["@channel"],[[30,0,["selectedContent"]]]],null],[1,"\\n"]],[]],[[[1,"    "],[1,[28,[35,2],["chat.incoming_webhooks.channel_placeholder"],null]],[1,"\\n"]],[]]],[1,"\\n  "],[1,[28,[35,3],[[30,0,["caretIcon"]]],[["class"],["caret-icon"]]]],[1,"\\n"],[13]],[],false,["if","chat-channel-title","i18n","d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-chooser-header.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,n.default.extend({}))
e.default=a})),define("discourse/plugins/chat/discourse/components/chat-channel-chooser-row",["exports","@ember/component","@ember/template-factory","select-kit/components/select-kit/select-kit-row"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"ZkPkPrfc",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["item"]]]],null]],[],false,["chat-channel-title"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-chooser-row.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,n.default.extend({classNames:["chat-channel-chooser-row"]}))
e.default=a})),define("discourse/plugins/chat/discourse/components/chat-channel-chooser",["exports","select-kit/components/combo-box"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=t.default.extend({pluginApiIdentifiers:["chat-channel-chooser"],classNames:["chat-channel-chooser"],selectKitOptions:{headerComponent:"chat-channel-chooser-header"},modifyComponentForRow:()=>"chat-channel-chooser-row"})
e.default=i})),define("discourse/plugins/chat/discourse/components/chat-channel-leave-btn",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service","@ember/utils"],(function(e,t,i,n,r,a){"use strict"
var s,o,l
function c(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,i.createTemplateFactory)({id:"FbjC/zGO",block:'[[[41,[30,0,["shouldRender"]],[[[1,"  "],[8,[39,1],null,[["@icon","@action","@class","@title"],["times",[30,1],"btn-flat chat-channel-leave-btn",[30,0,["leaveChatTitleKey"]]]],null],[1,"\\n"]],[]],null]],["@onLeaveChannel"],false,["if","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-leave-btn.hbs",isStrictMode:!1})
let h=(s=class extends n.default{constructor(){super(...arguments),c(this,"chat",o,this),c(this,"site",l,this)}get shouldRender(){return!this.site.mobileView&&(0,a.isPresent)(this.args.channel)}get leaveChatTitleKey(){return this.args.channel.isDirectMessageChannel?"chat.direct_messages.leave":"chat.leave"}},o=u(s.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=u(s.prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s)
e.default=h,(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/chat-channel-members-view",["exports","@ember/component","@ember/template-factory","discourse-common/config/environment","@ember/object","@ember/runloop","discourse-common/lib/debounce","@ember/service"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,i.createTemplateFactory)({id:"6Bm2zfV0",block:'[[[41,[28,[37,1],[[30,0,["channel","membershipsCount"]],0],null],[[[1,"  "],[8,[39,2],null,[["@selector","@action"],[".channel-members-view__list-item",[30,0,["load"]]]],[["default"],[[[[1,"\\n    "],[10,0],[14,0,"channel-members-view-wrapper"],[12],[1,"\\n      "],[10,0],[15,0,[28,[37,3],["channel-members-view__search-input-container",[52,[30,0,["isSearchFocused"]]," is-focused"]],null]],[12],[1,"\\n        "],[8,[39,4],[[16,0,[30,0,["inputSelector"]]],[16,"placeholder",[28,[37,5],["chat.members_view.filter_placeholder"],null]],[4,[38,6],["input",[28,[37,7],[[30,0],"onFilterMembers"],[["value"],["target.value"]]]],null],[4,[38,6],["focusin",[28,[37,7],[[30,0],[28,[37,8],[[30,0,["isSearchFocused"]]],null],true],null]],null],[4,[38,6],["focusout",[28,[37,7],[[30,0],[28,[37,8],[[30,0,["isSearchFocused"]]],null],false],null]],null]],null,null],[1,"\\n        "],[1,[28,[35,9],["search"],null]],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"channel-members-view__list-container"],[12],[1,"\\n        "],[10,0],[14,"role","list"],[14,0,"channel-members-view__list"],[12],[1,"\\n"],[42,[28,[37,11],[[28,[37,11],[[30,0,["members"]]],null]],null],null,[[[1,"            "],[10,0],[14,0,"channel-members-view__list-item"],[12],[1,"\\n              "],[8,[39,12],null,[["@user"],[[30,1,["user"]]]],null],[1,"\\n            "],[13],[1,"\\n"]],[1]],[[[41,[30,0,["members","fetchedOnce"]],[[[1,"              "],[10,0],[14,0,"chat-thread-list__no-threads"],[12],[1,"\\n                "],[1,[28,[35,5],["chat.channel.no_memberships_found"],null]],[1,"\\n              "],[13],[1,"\\n"]],[]],null]],[]]],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n    "],[8,[39,13],null,[["@condition"],[[30,0,["members","loading"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]],[[[1,"  "],[10,0],[14,0,"channel-members-view-wrapper"],[12],[1,"\\n    "],[1,[28,[35,5],["chat.channel.no_memberships"],null]],[1,"\\n  "],[13],[1,"\\n"]],[]]]],["membership"],false,["if","gt","load-more","concat","input","i18n","on","action","mut","d-icon","each","-track-array","chat-user-info","conditional-loading-spinner"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-members-view.hbs",isStrictMode:!1})
let p=(l=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatApi",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),u(this,"tagName",""),u(this,"channel",null),u(this,"isSearchFocused",!1),u(this,"onlineUsers",null),u(this,"filter",null),u(this,"inputSelector","channel-members-view__search-input"),u(this,"members",null)}didInsertElement(){this._super(...arguments),this.channel&&(this._focusSearch(),this.set("members",this.chatApi.listChannelMemberships(this.channel.id)),this.members.load(),this.appEvents.on("chat:refresh-channel-members",this,"onFilterMembers"))}willDestroyElement(){this._super(...arguments),this.appEvents.off("chat:refresh-channel-members",this,"onFilterMembers")}onFilterMembers(e){this.set("filter",e),this.set("members",this.chatApi.listChannelMemberships(this.channel.id)),(0,s.default)(this,this.members.load,{username:this.filter},n.INPUT_DELAY)}load(){(0,s.default)(this,this.members.load,n.INPUT_DELAY)}_focusSearch(){this.capabilities.isIpadOS||this.site.mobileView||(0,a.schedule)("afterRender",(()=>{document.getElementsByClassName(this.inputSelector)[0]?.focus()}))}},c=d(l.prototype,"chatApi",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"onFilterMembers",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"onFilterMembers"),l.prototype),d(l.prototype,"load",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"load"),l.prototype),l)
e.default=p,(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/chat-channel-message-emoji-picker",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object","@ember/service","discourse/lib/offset-calculator","@popperjs/core"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,i.createTemplateFactory)({id:"dGIWD4WF",block:'[[[8,[39,0],null,[["@context","@didInsert","@willDestroy","@didSelectEmoji","@class"],["chat-channel-message",[30,0,["didInsert"]],[30,0,["willDestroy"]],[30,0,["didSelectEmoji"]],"hidden"]],null]],[],false,["chat-emoji-picker"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-message-emoji-picker.hbs",isStrictMode:!1})
let b=(l=class extends n.default{constructor(){super(...arguments),d(this,"site",c,this),d(this,"chatEmojiPickerManager",u,this),h(this,"context","chat-channel-message")}didSelectEmoji(e){this.chatEmojiPickerManager.picker?.didSelectEmoji(e),this.chatEmojiPickerManager.close()}didInsert(e){this.site.mobileView||(this._popper=(0,o.createPopper)(this.chatEmojiPickerManager.picker?.trigger,e,{placement:"top",modifiers:[{name:"eventListeners",options:{scroll:!1,resize:!1}},{name:"flip",options:{padding:{top:(0,s.headerOffset)()}}}]})),e.classList.remove("hidden")}willDestroy(){this._popper?.destroy()}},c=p(l.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(l.prototype,"chatEmojiPickerManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(l.prototype,"didSelectEmoji",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"didSelectEmoji"),l.prototype),p(l.prototype,"didInsert",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"didInsert"),l.prototype),p(l.prototype,"willDestroy",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"willDestroy"),l.prototype),l)
e.default=b,(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/chat-channel-metadata",["exports","@ember/component","@ember/template-factory","@glimmer/component"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"dcIpnToE",block:'[[[10,0],[14,0,"chat-channel-metadata"],[12],[1,"\\n"],[41,[30,1,["lastMessage"]],[[[1,"    "],[10,0],[14,0,"chat-channel-metadata__date"],[12],[1,"\\n      "],[1,[30,0,["lastMessageFormattedDate"]]],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["unreadIndicator"]],[[[1,"    "],[8,[39,1],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]],null],[13]],["@channel"],false,["if","chat-channel-unread-indicator"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-metadata.hbs",isStrictMode:!1})
class a extends n.default{get unreadIndicator(){return this.args.unreadIndicator??!1}get lastMessageFormattedDate(){return moment(this.args.channel.lastMessage.createdAt).calendar(null,{sameDay:"LT",nextDay:"[Tomorrow]",nextWeek:"dddd",lastDay:"[Yesterday]",lastWeek:"dddd",sameElse:"l"})}}e.default=a,(0,t.setComponentTemplate)(r,a)})),define("discourse/plugins/chat/discourse/components/chat-channel-preview-card",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/utils","@ember/service"],(function(e,t,i,n,r,a){"use strict"
var s,o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,i.createTemplateFactory)({id:"BCZbso3D",block:'[[[10,0],[15,0,[28,[37,0],["chat-channel-preview-card",[52,[51,[30,0,["hasDescription"]]],"-no-description"],[52,[51,[30,0,["showJoinButton"]]],"-no-button"]],null]],[12],[1,"\\n  "],[8,[39,2],null,[["@channel"],[[30,1]]],null],[1,"\\n"],[41,[30,0,["hasDescription"]],[[[1,"    "],[10,2],[14,0,"chat-channel-preview-card__description"],[12],[1,"\\n      "],[1,[30,1,["description"]]],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[41,[30,0,["showJoinButton"]],[[[1,"    "],[8,[39,4],null,[["@channel","@options"],[[30,1],[28,[37,5],null,[["joinClass"],["btn-primary"]]]]],null],[1,"\\n"]],[]],null],[1,"  "],[8,[39,6],[[24,0,"chat-channel-preview-card__browse-all"]],[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n    "],[1,[28,[35,7],["chat.browse_all_channels"],null]],[1,"\\n  "]],[]]]]],[1,"\\n"],[13]],["@channel"],false,["concat-class","unless","chat-channel-title","if","toggle-channel-membership-button","hash","link-to","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-preview-card.hbs",isStrictMode:!1})
let c=(s=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get showJoinButton(){return this.args.channel?.isOpen&&this.args.channel?.canJoin}get hasDescription(){return!(0,r.isEmpty)(this.args.channel?.description)}},u=s.prototype,d="chat",h=[a.inject],p={configurable:!0,enumerable:!0,writable:!0,initializer:null},b={},Object.keys(p).forEach((function(e){b[e]=p[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=h.slice().reverse().reduce((function(e,t){return t(u,d,e)||e}),b),m&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(m):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(u,d,b),b=null),o=b,s)
var u,d,h,p,m,b
e.default=c,(0,t.setComponentTemplate)(l,c)})),define("discourse/plugins/chat/discourse/components/chat-channel-row",["exports","@ember/component","@ember/template-factory","@ember/service","@glimmer/component","@ember/object"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function m(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const g=(0,i.createTemplateFactory)({id:"ZrLkfLZS",block:'[[[8,[39,0],[[16,0,[28,[37,1],["chat-channel-row",[52,[30,1,["focused"]],"focused"],[52,[30,1,["currentUserMembership","muted"]],"muted"],[52,[30,2,["leaveButton"]],"can-leave"],[52,[28,[37,3],[[30,0,["chat","activeChannel","id"]],[30,1,["id"]]],null],"active"],[52,[30,0,["channelHasUnread"]],"has-unread"]],null]],[24,"tabindex","0"],[16,"data-chat-channel-id",[30,1,["id"]]],[4,[38,4],[[30,0,["startTrackingStatus"]]],null],[4,[38,5],[[30,0,["stopTrackingStatus"]]],null]],[["@route","@models"],["chat.channel",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n  "],[8,[39,6],null,[["@channel"],[[30,1]]],null],[1,"\\n  "],[8,[39,7],null,[["@channel","@unreadIndicator"],[[30,1],true]],null],[1,"\\n\\n"],[41,[28,[37,8],[[30,2,["leaveButton"]],[30,1,["isFollowing"]],[30,0,["site","desktopView"]]],null],[[[1,"    "],[8,[39,9],null,[["@channel","@options"],[[30,1],[28,[37,10],null,[["leaveClass","labelType","leaveIcon","leaveTitle"],["btn-flat chat-channel-leave-btn","none","times",[52,[30,1,["isDirectMessageChannel"]],[28,[37,11],["chat.direct_messages.leave"],null],[28,[37,11],["chat.channel_settings.leave_channel"],null]]]]]]],null],[1,"\\n"]],[]],null]],[]]]]]],["@channel","@options"],false,["link-to","concat-class","if","eq","did-insert","will-destroy","chat-channel-title","chat-channel-metadata","and","toggle-channel-membership-button","hash","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-row.hbs",isStrictMode:!1})
let f=(d=new WeakMap,s=class extends r.default{constructor(){super(...arguments),p(this,d,{get:v,set:void 0}),h(this,"router",o,this),h(this,"chat",l,this),h(this,"currentUser",c,this),h(this,"site",u,this)}startTrackingStatus(){m(this,d)?.trackStatus()}stopTrackingStatus(){m(this,d)?.stopTrackingStatus()}get channelHasUnread(){return this.args.channel.tracking.unreadCount>0}},o=b(s.prototype,"router",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=b(s.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=b(s.prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=b(s.prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b(s.prototype,"startTrackingStatus",[a.action],Object.getOwnPropertyDescriptor(s.prototype,"startTrackingStatus"),s.prototype),b(s.prototype,"stopTrackingStatus",[a.action],Object.getOwnPropertyDescriptor(s.prototype,"stopTrackingStatus"),s.prototype),s)
function v(){return this.args.channel?.chatable?.users?.firstObject}e.default=f,(0,t.setComponentTemplate)(g,f)})),define("discourse/plugins/chat/discourse/components/chat-channel-settings-saved-indicator",["exports","@ember/component","@ember/template-factory","discourse-common/lib/later","@glimmer/component","@ember/object","@glimmer/tracking","@ember/runloop"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,i.createTemplateFactory)({id:"G8pX+BQW",block:'[[[11,1],[16,0,[28,[37,0],["chat-channel-settings-saved-indicator",[52,[30,0,["isActive"]],"is-active"]],null]],[24,"role","status"],[4,[38,2],[[30,0,["activate"]],[30,1]],null],[4,[38,3],[[30,0,["teardown"]]],null],[12],[1,"\\n"],[41,[30,0,["isActive"]],[[[1,"    "],[1,[28,[35,4],["check"],null]],[1,"\\n    "],[10,1],[12],[1,[28,[35,5],["saved"],null]],[13],[1,"\\n"]],[]],null],[13]],["@property"],false,["concat-class","if","did-update","will-destroy","d-icon","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-settings-saved-indicator.hbs",isStrictMode:!1})
let p=(l=class extends r.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="isActive",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),u(this,"property",null)}activate(){(0,o.cancel)(this._deactivateHandler),this.isActive=!0,this._deactivateHandler=(0,n.default)((()=>{this.isActive=!1}),2e3)}teardown(){(0,o.cancel)(this._deactivateHandler)}},c=d(l.prototype,"isActive",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d(l.prototype,"activate",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"activate"),l.prototype),d(l.prototype,"teardown",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"teardown"),l.prototype),l)
e.default=p,(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/chat-channel-settings-view",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object","@ember/service","I18n","discourse/plugins/chat/discourse/components/chat/modal/archive-channel","discourse/plugins/chat/discourse/components/chat/modal/delete-channel","discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p,m,b,g,f,v
function y(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function w(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const j=(0,i.createTemplateFactory)({id:"4ICv/fOe",block:'[[[10,0],[14,0,"chat-form__section"],[12],[1,"\\n  "],[10,0],[14,0,"chat-form__field -mute"],[12],[1,"\\n    "],[10,"label"],[14,0,"chat-form__label"],[12],[1,"\\n      "],[10,1],[12],[1,[28,[35,0],["chat.settings.mute"],null]],[13],[1,"\\n      "],[8,[39,1],null,[["@property"],[[30,1,["currentUserMembership","muted"]]]],null],[1,"\\n    "],[13],[1,"\\n    "],[10,0],[14,0,"chat-form__control"],[12],[1,"\\n      "],[8,[39,2],null,[["@content","@value","@valueProperty","@class","@onChange"],[[30,0,["mutedOptions"]],[30,1,["currentUserMembership","muted"]],"value","channel-settings-view__selector",[28,[37,3],[[30,0,["saveNotificationSettings"]],"muted","muted"],null]]],null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n\\n"],[41,[51,[30,1,["currentUserMembership","muted"]]],[[[1,"    "],[10,0],[14,0,"chat-form__field -desktop-notification-level"],[12],[1,"\\n      "],[10,"label"],[14,0,"chat-form__label"],[12],[1,"\\n        "],[10,1],[12],[1,[28,[35,0],["chat.settings.desktop_notification_level"],null]],[13],[1,"\\n        "],[8,[39,1],null,[["@property"],[[30,1,["currentUserMembership","desktopNotificationLevel"]]]],null],[1,"\\n      "],[13],[1,"\\n      "],[10,0],[14,0,"chat-form__control"],[12],[1,"\\n        "],[8,[39,2],null,[["@content","@value","@valueProperty","@class","@onChange"],[[30,0,["notificationLevels"]],[30,1,["currentUserMembership","desktopNotificationLevel"]],"value","channel-settings-view__selector",[28,[37,3],[[30,0,["saveNotificationSettings"]],"desktopNotificationLevel","desktop_notification_level"],null]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-form__field -mobile-notification-level"],[12],[1,"\\n      "],[10,"label"],[14,0,"chat-form__label"],[12],[1,"\\n        "],[10,1],[12],[1,[28,[35,0],["chat.settings.mobile_notification_level"],null]],[13],[1,"\\n        "],[8,[39,1],null,[["@property"],[[30,1,["currentUserMembership","mobileNotificationLevel"]]]],null],[1,"\\n      "],[13],[1,"\\n      "],[10,0],[14,0,"chat-form__control"],[12],[1,"\\n        "],[8,[39,2],null,[["@content","@value","@valueProperty","@class","@onChange"],[[30,0,["notificationLevels"]],[30,1,["currentUserMembership","mobileNotificationLevel"]],"value","channel-settings-view__selector",[28,[37,3],[[30,0,["saveNotificationSettings"]],"mobileNotificationLevel","mobile_notification_level"],null]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"  "],[10,0],[14,0,"chat-retention-info"],[12],[1,"\\n    "],[1,[28,[35,5],["info-circle"],null]],[1,"\\n    "],[8,[39,6],null,[["@channel"],[[30,1]]],null],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[41,[30,0,["adminSectionAvailable"]],[[[1,"  "],[10,"h3"],[14,0,"chat-form__section-admin-title"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.settings.admin_title"],null]],[1,"\\n  "],[13],[1,"\\n\\n"],[41,[30,0,["autoJoinAvailable"]],[[[1,"    "],[10,0],[14,0,"chat-form__section -autojoin"],[12],[1,"\\n      "],[10,0],[14,0,"chat-form__field"],[12],[1,"\\n        "],[10,"label"],[14,0,"chat-form__label"],[12],[1,"\\n          "],[10,1],[12],[1,[28,[35,0],["chat.settings.auto_join_users_label"],null]],[13],[1,"\\n          "],[8,[39,1],null,[["@property"],[[30,1,["autoJoinUsers"]]]],null],[1,"\\n        "],[13],[1,"\\n        "],[8,[39,2],null,[["@content","@value","@valueProperty","@class","@onChange"],[[30,0,["autoAddUsersOptions"]],[30,1,["autoJoinUsers"]],"value","channel-settings-view__selector",[28,[37,8],[[30,0],[28,[37,3],[[30,0,["onToggleAutoJoinUsers"]],[30,1,["autoJoinUsers"]]],null]],null]]],null],[1,"\\n        "],[10,2],[14,0,"chat-form__description"],[12],[1,"\\n          "],[1,[28,[35,0],["chat.settings.auto_join_users_info"],[["category"],[[30,1,["chatable","name"]]]]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["togglingChannelWideMentionsAvailable"]],[[[1,"    "],[10,0],[14,0,"chat-form__section -channel-wide-mentions"],[12],[1,"\\n      "],[10,0],[14,0,"chat-form__field"],[12],[1,"\\n        "],[10,"label"],[14,0,"chat-form__label"],[12],[1,"\\n          "],[10,1],[12],[1,[28,[35,0],["chat.settings.channel_wide_mentions_label"],null]],[13],[1,"\\n          "],[8,[39,1],null,[["@property"],[[30,1,["allowChannelWideMentions"]]]],null],[1,"\\n        "],[13],[1,"\\n        "],[8,[39,2],null,[["@content","@value","@valueProperty","@class","@onChange"],[[30,0,["channelWideMentionsOptions"]],[30,1,["allowChannelWideMentions"]],"value","channel-settings-view__selector",[30,0,["onToggleChannelWideMentions"]]]],null],[1,"\\n        "],[10,2],[14,0,"chat-form__description"],[12],[1,"\\n          "],[1,[28,[35,0],["chat.settings.channel_wide_mentions_description"],[["channel"],[[30,1,["title"]]]]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[10,0],[14,0,"chat-form__section -threading"],[12],[1,"\\n    "],[10,0],[14,0,"chat-form__field"],[12],[1,"\\n      "],[10,"label"],[14,0,"chat-form__label"],[12],[1,"\\n        "],[10,1],[12],[1,[28,[35,0],["chat.settings.channel_threading_label"],null]],[13],[1,"\\n        "],[10,1],[14,0,"channel-settings-view__channel-threading-tooltip"],[12],[1,"\\n          "],[1,[28,[35,5],["info-circle"],null]],[1,"\\n          "],[8,[39,9],null,null,[["default"],[[[[1,"\\n            "],[1,[28,[35,0],["chat.settings.channel_threading_description"],null]],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n        "],[8,[39,1],null,[["@property"],[[30,1,["threadingEnabled"]]]],null],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,2],null,[["@content","@value","@valueProperty","@class","@onChange"],[[30,0,["threadingEnabledOptions"]],[30,1,["threadingEnabled"]],"value","channel-settings-view__selector",[30,0,["onToggleThreadingEnabled"]]]],null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[51,[30,1,["isDirectMessageChannel"]]],[[[1,"  "],[10,0],[14,0,"chat-form__section"],[12],[1,"\\n"],[41,[28,[37,10],["can-edit-chat-channel"],null],[[[41,[28,[37,10],["can-archive-channel",[30,1]],null],[[[1,"        "],[10,0],[14,0,"chat-form__field"],[12],[1,"\\n          "],[8,[39,11],null,[["@action","@label","@class","@icon"],[[28,[37,8],[[30,0],"onArchiveChannel"],null],"chat.channel_settings.archive_channel","archive-btn chat-form__btn btn-flat","archive"]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,1,["isClosed"]],[[[1,"        "],[10,0],[14,0,"chat-form__field"],[12],[1,"\\n          "],[8,[39,11],null,[["@action","@label","@class","@icon"],[[28,[37,8],[[30,0],"onToggleChannelState"],null],"chat.channel_settings.open_channel","open-btn chat-form__btn btn-flat","unlock"]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[1,"        "],[10,0],[14,0,"chat-form__field"],[12],[1,"\\n          "],[8,[39,11],null,[["@action","@label","@class","@icon"],[[28,[37,8],[[30,0],"onToggleChannelState"],null],"chat.channel_settings.close_channel","close-btn chat-form__btn btn-flat","lock"]],null],[1,"\\n        "],[13],[1,"\\n"]],[]]],[1,"\\n      "],[10,0],[14,0,"chat-form__field"],[12],[1,"\\n        "],[8,[39,11],null,[["@action","@label","@class","@icon"],[[28,[37,8],[[30,0],"onDeleteChannel"],null],"chat.channel_settings.delete_channel","delete-btn chat-form__btn btn-flat","trash-alt"]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@channel"],false,["i18n","chat-channel-settings-saved-indicator","combo-box","fn","unless","d-icon","chat-retention-reminder-text","if","action","d-tooltip","chat-guardian","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-settings-view.hbs",isStrictMode:!1}),M=[{name:s.default.t("chat.notification_levels.never"),value:"never"},{name:s.default.t("chat.notification_levels.mention"),value:"mention"},{name:s.default.t("chat.notification_levels.always"),value:"always"}],z=[{name:s.default.t("chat.settings.muted_on"),value:!0},{name:s.default.t("chat.settings.muted_off"),value:!1}],k=[{name:s.default.t("yes_value"),value:!0},{name:s.default.t("no_value"),value:!1}],O=[{name:s.default.t("chat.settings.threading_enabled"),value:!0},{name:s.default.t("chat.settings.threading_disabled"),value:!1}],C=[{name:s.default.t("yes_value"),value:!0},{name:s.default.t("no_value"),value:!1}]
let S=(u=class extends n.default{constructor(){super(...arguments),y(this,"chat",d,this),y(this,"chatApi",h,this),y(this,"chatGuardian",p,this),y(this,"currentUser",m,this),y(this,"siteSettings",b,this),y(this,"router",g,this),y(this,"dialog",f,this),y(this,"modal",v,this),_(this,"notificationLevels",M),_(this,"mutedOptions",z),_(this,"threadingEnabledOptions",O),_(this,"autoAddUsersOptions",k),_(this,"channelWideMentionsOptions",C),_(this,"isSavingNotificationSetting",!1),_(this,"savedDesktopNotificationLevel",!1),_(this,"savedMobileNotificationLevel",!1),_(this,"savedMuted",!1)}get togglingChannelWideMentionsAvailable(){return this.args.channel.isCategoryChannel}get autoJoinAvailable(){return this.siteSettings.max_chat_auto_joined_users>0&&this.args.channel.isCategoryChannel}get adminSectionAvailable(){return this.chatGuardian.canEditChatChannel()&&(this.autoJoinAvailable||this.togglingChannelWideMentionsAvailable)}get canArchiveChannel(){return this.siteSettings.chat_allow_archiving_channels&&!this.args.channel.isArchived&&!this.args.channel.isReadOnly}saveNotificationSettings(e,t,i){if(this.args.channel.currentUserMembership[e]===i)return
const n={}
return n[t]=i,this.chatApi.updateCurrentUserChannelNotificationsSettings(this.args.channel.id,n).then((i=>{this.args.channel.currentUserMembership[e]=i.membership[t]}))}onArchiveChannel(){return this.modal.show(o.default,{model:{channel:this.args.channel}})}onDeleteChannel(){return this.modal.show(l.default,{model:{channel:this.args.channel}})}onToggleChannelState(){this.modal.show(c.default,{model:this.args.channel})}onToggleAutoJoinUsers(){this.args.channel.autoJoinUsers?this.onDisableAutoJoinUsers():this.onEnableAutoJoinUsers()}onToggleThreadingEnabled(e){return this._updateChannelProperty(this.args.channel,"threading_enabled",e).then((e=>{this.args.channel.threadingEnabled=e.channel.threading_enabled}))}onToggleChannelWideMentions(){const e=!this.args.channel.allowChannelWideMentions
if(this.args.channel.allowChannelWideMentions!==e)return this._updateChannelProperty(this.args.channel,"allow_channel_wide_mentions",e).then((e=>{this.args.channel.allowChannelWideMentions=e.channel.allow_channel_wide_mentions}))}onDisableAutoJoinUsers(){if(!1!==this.args.channel.autoJoinUsers)return this._updateChannelProperty(this.args.channel,"auto_join_users",!1).then((e=>{this.args.channel.autoJoinUsers=e.channel.auto_join_users}))}onEnableAutoJoinUsers(){!0!==this.args.channel.autoJoinUsers&&this.dialog.confirm({message:s.default.t("chat.settings.auto_join_users_warning",{category:this.args.channel.chatable.name}),didConfirm:()=>this._updateChannelProperty(this.args.channel,"auto_join_users",!0).then((e=>{this.args.channel.autoJoinUsers=e.channel.auto_join_users}))})}_updateChannelProperty(e,t,i){const n={}
return n[t]=i,this.chatApi.updateChannel(e.id,n).catch((e=>{e.jqXHR?.responseJSON?.errors&&this.flash(e.jqXHR.responseJSON.errors.join("\n"),"error")}))}},d=w(u.prototype,"chat",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=w(u.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=w(u.prototype,"chatGuardian",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=w(u.prototype,"currentUser",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=w(u.prototype,"siteSettings",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=w(u.prototype,"router",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=w(u.prototype,"dialog",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=w(u.prototype,"modal",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w(u.prototype,"saveNotificationSettings",[r.action],Object.getOwnPropertyDescriptor(u.prototype,"saveNotificationSettings"),u.prototype),w(u.prototype,"onArchiveChannel",[r.action],Object.getOwnPropertyDescriptor(u.prototype,"onArchiveChannel"),u.prototype),w(u.prototype,"onDeleteChannel",[r.action],Object.getOwnPropertyDescriptor(u.prototype,"onDeleteChannel"),u.prototype),w(u.prototype,"onToggleChannelState",[r.action],Object.getOwnPropertyDescriptor(u.prototype,"onToggleChannelState"),u.prototype),w(u.prototype,"onToggleAutoJoinUsers",[r.action],Object.getOwnPropertyDescriptor(u.prototype,"onToggleAutoJoinUsers"),u.prototype),w(u.prototype,"onToggleThreadingEnabled",[r.action],Object.getOwnPropertyDescriptor(u.prototype,"onToggleThreadingEnabled"),u.prototype),w(u.prototype,"onToggleChannelWideMentions",[r.action],Object.getOwnPropertyDescriptor(u.prototype,"onToggleChannelWideMentions"),u.prototype),u)
e.default=S,(0,t.setComponentTemplate)(j,S)})),define("discourse/plugins/chat/discourse/components/chat-channel-status",["exports","@ember/component","@ember/template-factory","I18n","@glimmer/component","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n,r,a){"use strict"
function s(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function o(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,i.createTemplateFactory)({id:"i9qs4lOv",block:'[[[41,[30,0,["shouldRender"]],[[[1,"  "],[10,0],[14,0,"chat-channel-status"],[12],[1,"\\n    "],[1,[28,[35,1],[[30,0,["channelStatusIcon"]]],null]],[1,"\\n    "],[10,1],[12],[1,[30,0,["channelStatusMessage"]]],[13],[1,"\\n    "],[8,[39,2],null,[["@channel"],[[30,1]]],null],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@channel"],false,["if","d-icon","chat-channel-archive-status"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-status.hbs",isStrictMode:!1})
var u=new WeakSet,d=new WeakSet
class h extends r.default{constructor(){super(...arguments),s(this,d),s(this,u),o(this,"LONG_FORMAT","long"),o(this,"SHORT_FORMAT","short"),o(this,"VALID_FORMATS",[this.SHORT_FORMAT,this.LONG_FORMAT])}get format(){return this.VALID_FORMATS.includes(this.args.format)?this.args.format:this.LONG_FORMAT}get shouldRender(){return this.channelStatusIcon&&this.args.channel.status!==a.CHANNEL_STATUSES.open}get channelStatusMessage(){return this.format===this.LONG_FORMAT?l(this,d,m).call(this,this.args.channel.status):l(this,u,p).call(this,this.args.channel.status)}get channelStatusIcon(){return(0,a.channelStatusIcon)(this.args.channel.status)}}function p(e){switch(e){case a.CHANNEL_STATUSES.archived:return n.default.t("chat.channel_status.archived")
case a.CHANNEL_STATUSES.closed:return n.default.t("chat.channel_status.closed")
case a.CHANNEL_STATUSES.open:return n.default.t("chat.channel_status.open")
case a.CHANNEL_STATUSES.readOnly:return n.default.t("chat.channel_status.read_only")}}function m(e){switch(e){case a.CHANNEL_STATUSES.archived:return n.default.t("chat.channel_status.archived_header")
case a.CHANNEL_STATUSES.closed:return n.default.t("chat.channel_status.closed_header")
case a.CHANNEL_STATUSES.open:return n.default.t("chat.channel_status.open_header")
case a.CHANNEL_STATUSES.readOnly:return n.default.t("chat.channel_status.read_only_header")}}e.default=h,(0,t.setComponentTemplate)(c,h)})),define("discourse/plugins/chat/discourse/components/chat-channel-title",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/template"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,i.createTemplateFactory)({id:"1vSiAUnx",block:'[[[41,[30,1,["isDirectMessageChannel"]],[[[1,"  "],[10,0],[14,0,"chat-channel-title is-dm"],[12],[1,"\\n"],[41,[30,1,["chatable","users","length"]],[[[1,"      "],[10,0],[14,0,"chat-channel-title__avatar"],[12],[1,"\\n"],[41,[30,0,["multiDm"]],[[[1,"          "],[10,1],[14,0,"chat-channel-title__users-count"],[12],[1,"\\n            "],[1,[30,1,["chatable","users","length"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[8,[39,1],null,[["@user"],[[28,[37,2],[[30,1,["chatable","users"]],"0"],null]]],null],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,0,"chat-channel-title__user-info"],[12],[1,"\\n      "],[10,0],[14,0,"chat-channel-title__usernames"],[12],[1,"\\n"],[41,[30,1,["chatable","users","length"]],[[[41,[30,0,["multiDm"]],[[[1,"            "],[10,1],[14,0,"chat-channel-title__name"],[12],[1,[30,0,["usernames"]]],[13],[1,"\\n"]],[]],[[[44,[[28,[37,2],[[30,1,["chatable","users"]],"0"],null]],[[[1,"              "],[10,1],[14,0,"chat-channel-title__name"],[12],[1,[30,2,["username"]]],[13],[1,"\\n"],[41,[30,0,["showUserStatus"]],[[[1,"                "],[8,[39,4],null,[["@class","@status","@showDescription"],["chat-channel-title__user-status-message",[28,[37,2],[[30,1,["chatable","users"]],"0.status"],null],[52,[30,0,["site","mobileView"]],"true"]]],null],[1,"\\n"]],[]],null],[1,"              "],[8,[39,5],null,[["@name","@outletArgs","@tagName","@connectorTagName"],["after-chat-channel-username",[28,[37,6],null,[["user"],[[30,2]]]],"",""]],null],[1,"\\n"]],[2]]]],[]]]],[]],[[[1,"          "],[10,1],[14,0,"chat-channel-title__name"],[12],[1,"Add users"],[13],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[48,[30,3]],[[[1,"      "],[18,3,null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],[[[41,[30,1,["isCategoryChannel"]],[[[1,"  "],[10,0],[14,0,"chat-channel-title is-category"],[12],[1,"\\n    "],[10,1],[14,0,"chat-channel-title__category-badge"],[15,5,[30,0,["channelColorStyle"]]],[12],[1,"\\n      "],[1,[28,[35,9],["d-chat"],null]],[1,"\\n"],[41,[30,1,["chatable","read_restricted"]],[[[1,"        "],[1,[28,[35,9],["lock"],[["class"],["chat-channel-title__restricted-category-icon"]]]],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n    "],[10,1],[14,0,"chat-channel-title__name"],[12],[1,"\\n      "],[1,[28,[35,10],[[30,1,["title"]]],null]],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[48,[30,3]],[[[1,"      "],[18,3,null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],[]]]],["@channel","user","&default"],false,["if","chat/user-avatar","get","let","user-status-message","plugin-outlet","hash","has-block","yield","d-icon","replace-emoji"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-title.hbs",isStrictMode:!1})
class s extends n.default{get users(){return this.args.channel.chatable.users}get multiDm(){return this.users.length>1}get usernames(){return this.users.mapBy("username").join(", ")}get channelColorStyle(){return(0,r.htmlSafe)(`color: #${this.args.channel.chatable.color}`)}get showUserStatus(){return!(1!==this.users.length||!this.users[0].status)}}e.default=s,(0,t.setComponentTemplate)(a,s)})),define("discourse/plugins/chat/discourse/components/chat-channel-unread-indicator",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const u=(0,i.createTemplateFactory)({id:"YuxjflSR",block:'[[[41,[30,0,["showUnreadIndicator"]],[[[1,"  "],[10,0],[15,0,[28,[37,1],["chat-channel-unread-indicator",[52,[30,0,["isUrgent"]],"-urgent"]],null]],[12],[1,"\\n    "],[10,0],[14,0,"chat-channel-unread-indicator__number"],[12],[41,[30,0,["showUnreadCount"]],[[[1,[30,0,["unreadCount"]]]],[]],[[[1,""]],[]]],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if","concat-class"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-unread-indicator.hbs",isStrictMode:!1})
let d=(a=class extends n.default{constructor(){super(...arguments),l(this,"chat",s,this),l(this,"site",o,this)}get showUnreadIndicator(){return this.args.channel.tracking.unreadCount>0||this.chat.activeChannel?.id!==this.args.channel.id&&this.args.channel.unreadThreadsCountSinceLastViewed>0}get unreadCount(){return this.args.channel.tracking.unreadCount}get isUrgent(){return this.args.channel.isDirectMessageChannel||this.args.channel.tracking.mentionCount>0}get showUnreadCount(){return this.args.channel.isDirectMessageChannel||this.isUrgent}},s=c(a.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(a.prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a)
e.default=d,(0,t.setComponentTemplate)(u,d)})),define("discourse/plugins/chat/discourse/components/chat-channel",["exports","@ember/component","@ember/template-factory","discourse/plugins/chat/discourse/models/chat-message","@glimmer/component","discourse-common/utils/decorators","@ember/object","discourse/plugins/chat/discourse/services/chat-pane-base-subscriptions-manager","discourse/lib/ajax-error","@ember/runloop","@ember/service","discourse/lib/desktop-notifications","discourse/lib/user-presence","discourse/plugins/chat/discourse/lib/chat-ios-hacks","discourse/plugins/chat/discourse/lib/scroll-helpers","discourse/plugins/chat/discourse/lib/check-message-visibility","discourse/plugins/chat/discourse/lib/chat-messages-loader","@glimmer/tracking","discourse-common/lib/debounce","discourse/lib/url","discourse-common/lib/get-owner","discourse/plugins/chat/discourse/lib/chat-constants"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,_,w){"use strict"
var j,M,z,k,O,C,S,P,T,E,x,D,I,A,U,L,N,R,F,W,B,H,$,V,q,G,K,J,Y,Z,X
function Q(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ee(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function te(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ie(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function ne(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const re=(0,i.createTemplateFactory)({id:"ySjGEHYK",block:'[[[11,0],[16,0,[28,[37,0],["chat-channel",[52,[30,0,["messagesLoader","loading"]],"loading"],[52,[30,0,["pane","sending"]],"chat-channel--sending"],[52,[51,[30,0,["messagesLoader","fetchedOnce"]]],"chat-channel--not-loaded-once"]],null]],[16,"data-id",[30,1,["id"]]],[4,[38,3],[[30,0,["setUploadDropZone"]]],null],[4,[38,3],[[30,0,["setupListeners"]]],null],[4,[38,4],[[30,0,["teardownListeners"]]],null],[4,[38,5],[[30,0,["loadMessages"]],[30,2]],null],[4,[38,3],[[30,0,["didUpdateChannel"]]],null],[4,[38,5],[[30,0,["didUpdateChannel"]],[30,1,["id"]]],null],[4,[38,3],[[30,0,["addAutoFocusEventListener"]]],null],[4,[38,4],[[30,0,["removeAutoFocusEventListener"]]],null],[12],[1,"\\n  "],[8,[39,6],null,[["@channel","@onCloseFullScreen","@displayed"],[[30,1],[30,0,["onCloseFullScreen"]],[30,0,["includeHeader"]]]],null],[1,"\\n\\n  "],[8,[39,7],null,[["@channel"],[[30,1]]],null],[1,"\\n\\n  "],[8,[39,8],null,null,null],[1,"\\n\\n  "],[11,0],[24,0,"chat-messages-scroll chat-messages-container popper-viewport"],[4,[38,3],[[30,0,["setScrollable"]]],null],[4,[38,9],[[28,[37,10],null,[["onScroll","onScrollEnd","reverse"],[[30,0,["onScroll"]],[30,0,["onScrollEnd"]],true]]]],null],[12],[1,"\\n    "],[11,0],[24,0,"chat-messages-container"],[4,[38,11],[[30,0,["didResizePane"]],[28,[37,10],null,[["delay","immediate"],[100,true]]]],null],[12],[1,"\\n"],[42,[28,[37,13],[[28,[37,13],[[30,0,["messagesManager","messages"]]],null]],null],"id",[[[1,"        "],[8,[39,14],null,[["@message","@disableMouseEvents","@resendStagedMessage","@fetchMessagesByDate","@context"],[[30,3],[30,0,["isScrolling"]],[30,0,["resendStagedMessage"]],[30,0,["fetchMessagesByDate"]],"channel"]],null],[1,"\\n"]],[3]],[[[41,[51,[30,0,["messagesLoader","fetchedOnce"]]],[[[1,"          "],[8,[39,15],null,null,null],[1,"\\n"]],[]],null]],[]]],[1,"    "],[13],[1,"\\n\\n"],[41,[30,0,["messagesLoader","loadedPast"]],[[[1,"      "],[10,0],[14,0,"all-loaded-message"],[12],[1,"\\n        "],[1,[28,[35,16],["chat.all_loaded"],null]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n\\n  "],[8,[39,17],null,[["@onScrollToBottom","@isVisible"],[[30,0,["scrollToLatestMessage"]],[30,0,["needsArrow"]]]],null],[1,"\\n\\n"],[41,[30,0,["pane","selectingMessages"]],[[[1,"    "],[8,[39,18],null,[["@enableMove","@pane"],[[28,[37,19],[[28,[37,20],[[30,1,["isDirectMessageChannel"]]],null],[30,1,["canModerate"]]],null],[30,0,["pane"]]]],null],[1,"\\n"]],[]],[[[41,[28,[37,19],[[28,[37,20],[[30,1,["isFollowing"]]],null],[30,1,["isCategoryChannel"]]],null],[[[1,"      "],[8,[39,21],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]],[[[1,"      "],[8,[39,22],null,[["@channel","@uploadDropZone","@onSendMessage"],[[30,1],[30,0,["uploadDropZone"]],[30,0,["onSendMessage"]]]],null],[1,"\\n"]],[]]]],[]]],[1,"\\n  "],[8,[39,23],null,[["@model"],[[30,1]]],null],[1,"\\n"],[13]],["@channel","@targetMessageId","message"],false,["concat-class","if","unless","did-insert","will-destroy","did-update","chat-full-page-header","chat/notices","chat-mention-warnings","chat/scrollable-list","hash","chat/on-resize","each","-track-array","chat-message","chat-skeleton","i18n","chat/scroll-to-bottom-arrow","chat/selection-manager","and","not","chat-channel-preview-card","chat/composer/channel","chat-upload-drop-zone"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel.hbs",isStrictMode:!1})
let ae=(j=(0,u.inject)("chat-channel-composer"),M=(0,u.inject)("chat-channel-pane"),K=new WeakSet,J=new WeakSet,Y=new WeakSet,Z=new WeakSet,X=new WeakSet,z=class extends r.default{constructor(){super(...arguments),ee(this,X),ee(this,Z),ee(this,Y),ee(this,J),ee(this,K),Q(this,"appEvents",k,this),Q(this,"capabilities",O,this),Q(this,"chat",C,this),Q(this,"chatApi",S,this),Q(this,"chatChannelsManager",P,this),Q(this,"chatChannelPaneSubscriptionsManager",T,this),Q(this,"chatComposerPresenceManager",E,this),Q(this,"chatDraftsManager",x,this),Q(this,"chatEmojiPickerManager",D,this),Q(this,"chatStateManager",I,this),Q(this,"composer",A,this),Q(this,"pane",U,this),Q(this,"currentUser",L,this),Q(this,"messageBus",N,this),Q(this,"router",R,this),Q(this,"site",F,this),Q(this,"sending",W,this),Q(this,"showChatQuoteSuccess",B,this),Q(this,"includeHeader",H,this),Q(this,"needsArrow",$,this),Q(this,"atBottom",V,this),Q(this,"uploadDropZone",q,this),Q(this,"isScrolling",G,this),te(this,"scrollable",null)
te(this,"_loadedChannelId",null),te(this,"_mentionWarningsSeen",{}),te(this,"_unreachableGroupMentions",[]),te(this,"_overMembersLimitGroupMentions",[])}get messagesLoader(){return new g.default((0,_.getOwner)(this),this.args.channel)}get messagesManager(){return this.args.channel.messagesManager}get currentUserMembership(){return this.args.channel.currentUserMembership}setUploadDropZone(e){this.uploadDropZone=e}setScrollable(e){this.scrollable=e}setupListeners(){(0,h.onPresenceChange)({callback:this.onPresenceChangeCallback})}teardownListeners(){ie(this,Y,le).call(this),(0,h.removeOnPresenceChange)(this.onPresenceChangeCallback),this.unsubscribeToUpdates(this._loadedChannelId)}didResizePane(){this.debounceFillPaneAttempt(),this.computeDatesSeparators()}didUpdateChannel(){if(ie(this,Y,le).call(this),!this.args.channel)return
this.messagesManager.clear(),this.args.channel.isDirectMessageChannel&&!this.args.channel.isFollowing&&this.chatChannelsManager.follow(this.args.channel),this._loadedChannelId!==this.args.channel.id&&(this.unsubscribeToUpdates(this._loadedChannelId),this.pane.selectingMessages=!1,this._loadedChannelId=this.args.channel.id)
const e=this.chatDraftsManager.get({channelId:this.args.channel.id})
e?this.composer.message=e:this.resetComposerMessage(),this.composer.focus(),this.loadMessages(),this.args.channel.updateLastViewedAt()}loadMessages(){this.args.channel?.id&&(this.subscribeToUpdates(this.args.channel),this.args.targetMessageId?this.debounceHighlightOrFetchMessage(this.args.targetMessageId):this.fetchMessages({fetch_from_last_read:!0}))}onPresenceChangeCallback(e){e&&this.debouncedUpdateLastReadMessage()}async fetchMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(this.messagesLoader.loading)return
this.messagesManager.clear()
const t=await this.messagesLoader.load(e)
if(this.messagesManager.messages=this.processMessages(this.args.channel,t),e.target_message_id)this.scrollToMessageId(e.target_message_id,{highlight:!0})
else if(e.fetch_from_last_read){const e=this.currentUserMembership?.lastReadMessageId
this.scrollToMessageId(e)}else e.target_date?this.scrollToMessageId(t.meta.target_message_id,{highlight:!0,position:"center"}):(this._ignoreNextScroll=!0,this.scrollToBottom())
this.debounceFillPaneAttempt(),this.debouncedUpdateLastReadMessage()}async fetchMoreMessages(e){let{direction:t}=e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
if(this.messagesLoader.loading)return
const n=await this.messagesLoader.loadMore({direction:t})
if(!n)return
const r=this.processMessages(this.args.channel,n)
if(!r.length)return
const a=this.messagesManager.messages.lastObject.id;(0,p.stackingContextFix)(this.scrollable,(()=>{this.messagesManager.addMessages(r)})),t!==w.FUTURE||i.noScroll||this.scrollToMessageId(a,{position:"end",forceAuto:!0}),this.debounceFillPaneAttempt()}scrollToBottom(){this._ignoreNextScroll=!0,(0,m.scrollListToBottom)(this.scrollable)}scrollToMessageId(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
this._ignoreNextScroll=!0
const i=this.messagesManager.findMessage(e);(0,m.scrollListToMessage)(this.scrollable,i,t)}debounceFillPaneAttempt(){this._debouncedFillPaneAttemptHandler=(0,v.default)(this,this.fillPaneAttempt,500)}fetchMessagesByDate(e){if(this.messagesLoader.loading)return
const t=this.messagesManager.findFirstMessageOfDay(new Date(e))
t.firstOfResults&&this.messagesLoader.canLoadMorePast?this.fetchMessages({target_date:e,direction:w.FUTURE}):this.highlightOrFetchMessage(t.id,{position:"center"})}async fillPaneAttempt(){this.messagesLoader.fetchedOnce&&(this.messagesManager.messages.length>200||this.messagesLoader.canLoadMorePast&&(0,c.schedule)("afterRender",(()=>{const e=this.messagesManager.messages.firstObject?.id,t=this.scrollable.querySelector(`.chat-message-container[data-id="${e}"]`)
t&&(0,b.checkMessageTopVisibility)(this.scrollable,t)&&this.fetchMoreMessages({direction:w.PAST})})))}processMessages(e,t){const i=[]
let r=!1
const a=this.messagesManager.messages.some((e=>e.newest))
return t.messages.forEach(((s,o)=>{s.firstOfResults=0===o,this.currentUser.ignored_users&&(s.hidden=this.currentUser.ignored_users.includes(s.user.username)),this.requestedTargetMessageId===s.id?s.expanded=!s.hidden:s.expanded=!(s.hidden||s.deleted_at),!a&&!r&&s.id>this.currentUserMembership?.lastReadMessageId&&(r=!0,s.newest=!0)
const l=n.default.create(e,s)
l.manager=e.messagesManager,l.thread&&ie(this,Z,ce).call(this,l.thread,t.tracking.thread_tracking),i.push(l)})),i}debounceHighlightOrFetchMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
this._debouncedHighlightOrFetchMessageHandler=(0,v.default)(this,this.highlightOrFetchMessage,e,t,100)}highlightOrFetchMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
const i=this.messagesManager.findMessage(e)
i?this.scrollToMessageId(i.id,Object.assign({highlight:!0,position:"start",autoExpand:!0,behavior:this.capabilities.isIOS?"smooth":null},t)):this.fetchMessages({target_message_id:e})}debouncedUpdateLastReadMessage(){this._debouncedUpdateLastReadMessageHandler=(0,v.default)(this,this.updateLastReadMessage,w.READ_INTERVAL_MS)}updateLastReadMessage(){this.args.channel.isFollowing&&(0,c.schedule)("afterRender",(()=>{let e=null
if(this.scrollable.querySelectorAll(".chat-message-container").forEach((t=>{(0,b.checkMessageBottomVisibility)(this.scrollable,t)&&(e=t)})),!e)return
let t=this.messagesManager.findMessage(e.dataset.id)
if(!t)return
const i=this.args.channel.currentUserMembership?.lastReadMessageId
return i>t.id?void 0:this.chatApi.markChannelAsRead(this.args.channel.id,t.id)}))}scrollToLatestMessage(){this.messagesLoader.canLoadMoreFuture?this.fetchMessages():this.messagesManager.messages.length>0&&this.scrollToBottom(this.scrollable)}onScroll(e){(0,p.bodyScrollFix)(),(0,c.next)((()=>{ie(this,X,ue).call(this)||(this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!0,this.debouncedUpdateLastReadMessage(),e.atTop||!this.capabilities.isIOS&&e.up&&e.distanceToTop.percentage<40?this.fetchMoreMessages({direction:w.PAST}):e.atBottom&&this.fetchMoreMessages({direction:w.FUTURE}))}))}onScrollEnd(e){(0,d.resetIdle)(),this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!1,this.atBottom=e.atBottom,e.atBottom&&this.fetchMoreMessages({direction:w.FUTURE})}onMessage(e){if("sent"===e.type)this.handleSentMessage(e)}handleSentMessage(e){if(e.chat_message.user.id===this.currentUser.id&&e.staged_id){if((0,o.handleStagedMessage)(this.args.channel,this.messagesManager,e))return}const t=n.default.create(this.args.channel,e.chat_message)
t.manager=this.args.channel.messagesManager,(0,p.stackingContextFix)(this.scrollable,(()=>{this.messagesManager.addMessages([t])})),this.debouncedUpdateLastReadMessage(),this.args.channel.lastMessage=t}async onSendMessage(e){await e.cook(),e.editing?await ie(this,K,se).call(this,e):await ie(this,J,oe).call(this,e)}resetComposerMessage(){this.composer.reset(this.args.channel)}_onSendError(e,t){const i=this.args.channel.messagesManager.findStagedMessage(e)
i&&(t.jqXHR?.responseJSON?.errors?.length?(i.message="",i.cooked="",i.error=t.jqXHR.responseJSON.errors[0]):(this.chat.markNetworkAsUnreliable(),i.error="network_error")),this.resetComposerMessage()}resendStagedMessage(e){this.pane.sending=!0,e.error=null
const t={cooked:e.cooked,message:e.message,upload_ids:e.uploads.map((e=>e.id)),staged_id:e.id}
this.chatApi.sendMessage(this.args.channel.id,t).catch((e=>{this._onSendError(t.staged_id,e)})).then((()=>{this.chat.markNetworkAsReliable()})).finally((()=>{this.pane.sending=!1}))}onCloseFullScreen(){this.chatStateManager.prefersDrawer(),y.default.routeTo(this.chatStateManager.lastKnownAppURL).then((()=>{y.default.routeTo(this.chatStateManager.lastKnownChatURL)}))}unsubscribeToUpdates(e){e&&(this.chatChannelPaneSubscriptionsManager.unsubscribe(),this.messageBus.unsubscribe(`/chat/${e}`,this.onMessage))}subscribeToUpdates(e){e&&(this.unsubscribeToUpdates(e.id),this.messageBus.subscribe(`/chat/${e.id}`,this.onMessage,e.channelMessageBusLastId),this.chatChannelPaneSubscriptionsManager.subscribe(e))}addAutoFocusEventListener(){document.addEventListener("keydown",this._autoFocus)}removeAutoFocusEventListener(){document.removeEventListener("keydown",this._autoFocus)}_autoFocus(e){if(this.chatStateManager.isDrawerActive)return
const{key:t,metaKey:i,ctrlKey:n,code:r,target:a}=e
!t||t.length>1||i||n||"Space"===r||"?"===t||a&&!/^(INPUT|TEXTAREA|SELECT)$/.test(a.tagName)&&(e.preventDefault(),this.composer.focus({addText:e.key}))}computeDatesSeparators(){(0,c.schedule)("afterRender",(()=>{const e=[...this.scrollable.querySelectorAll(".chat-message-separator-date")].reverse(),t=this.scrollable.querySelector(".chat-messages-container").clientHeight
e.map(((i,n)=>{const r={bottom:0,date:i},a=i.nextElementSibling
if(n>0){const i=e[n-1].nextElementSibling
r.bottom=t-i.offsetTop}if(1===e.length)r.height=t
else if(0===n)r.height=t-a.offsetTop
else{const i=e[n-1].nextElementSibling
r.height=t-a.offsetTop-(t-i.offsetTop)}return r})).forEach((e=>{e.date.style.bottom=e.bottom+"px",e.date.style.height=e.height+"px"}))}))}},k=ne(z.prototype,"appEvents",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=ne(z.prototype,"capabilities",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=ne(z.prototype,"chat",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=ne(z.prototype,"chatApi",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=ne(z.prototype,"chatChannelsManager",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=ne(z.prototype,"chatChannelPaneSubscriptionsManager",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=ne(z.prototype,"chatComposerPresenceManager",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=ne(z.prototype,"chatDraftsManager",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=ne(z.prototype,"chatEmojiPickerManager",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=ne(z.prototype,"chatStateManager",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=ne(z.prototype,"composer",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=ne(z.prototype,"pane",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=ne(z.prototype,"currentUser",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=ne(z.prototype,"messageBus",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=ne(z.prototype,"router",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=ne(z.prototype,"site",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=ne(z.prototype,"sending",[f.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),B=ne(z.prototype,"showChatQuoteSuccess",[f.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),H=ne(z.prototype,"includeHeader",[f.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),$=ne(z.prototype,"needsArrow",[f.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),V=ne(z.prototype,"atBottom",[f.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),q=ne(z.prototype,"uploadDropZone",[f.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=ne(z.prototype,"isScrolling",[f.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ne(z.prototype,"messagesLoader",[f.cached],Object.getOwnPropertyDescriptor(z.prototype,"messagesLoader"),z.prototype),ne(z.prototype,"setUploadDropZone",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"setUploadDropZone"),z.prototype),ne(z.prototype,"setScrollable",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"setScrollable"),z.prototype),ne(z.prototype,"setupListeners",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"setupListeners"),z.prototype),ne(z.prototype,"teardownListeners",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"teardownListeners"),z.prototype),ne(z.prototype,"didResizePane",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"didResizePane"),z.prototype),ne(z.prototype,"didUpdateChannel",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"didUpdateChannel"),z.prototype),ne(z.prototype,"loadMessages",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"loadMessages"),z.prototype),ne(z.prototype,"onPresenceChangeCallback",[a.bind],Object.getOwnPropertyDescriptor(z.prototype,"onPresenceChangeCallback"),z.prototype),ne(z.prototype,"scrollToBottom",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"scrollToBottom"),z.prototype),ne(z.prototype,"fetchMessagesByDate",[a.bind],Object.getOwnPropertyDescriptor(z.prototype,"fetchMessagesByDate"),z.prototype),ne(z.prototype,"processMessages",[a.bind],Object.getOwnPropertyDescriptor(z.prototype,"processMessages"),z.prototype),ne(z.prototype,"scrollToLatestMessage",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"scrollToLatestMessage"),z.prototype),ne(z.prototype,"onScroll",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"onScroll"),z.prototype),ne(z.prototype,"onScrollEnd",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"onScrollEnd"),z.prototype),ne(z.prototype,"onMessage",[a.bind],Object.getOwnPropertyDescriptor(z.prototype,"onMessage"),z.prototype),ne(z.prototype,"onSendMessage",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"onSendMessage"),z.prototype),ne(z.prototype,"resetComposerMessage",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"resetComposerMessage"),z.prototype),ne(z.prototype,"resendStagedMessage",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"resendStagedMessage"),z.prototype),ne(z.prototype,"onCloseFullScreen",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"onCloseFullScreen"),z.prototype),ne(z.prototype,"addAutoFocusEventListener",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"addAutoFocusEventListener"),z.prototype),ne(z.prototype,"removeAutoFocusEventListener",[s.action],Object.getOwnPropertyDescriptor(z.prototype,"removeAutoFocusEventListener"),z.prototype),ne(z.prototype,"_autoFocus",[a.bind],Object.getOwnPropertyDescriptor(z.prototype,"_autoFocus"),z.prototype),ne(z.prototype,"computeDatesSeparators",[a.bind],Object.getOwnPropertyDescriptor(z.prototype,"computeDatesSeparators"),z.prototype),z)
async function se(e){this.pane.sending=!0
const t={new_message:e.message,upload_ids:e.uploads.map((e=>e.id))}
this.resetComposerMessage()
try{(0,p.stackingContextFix)(this.scrollable,(async()=>{await this.chatApi.editMessage(this.args.channel.id,e.id,t)}))}catch(i){(0,l.popupAjaxError)(i)}finally{this.chatDraftsManager.remove({channelId:this.args.channel.id}),this.pane.sending=!1}}async function oe(e){this.pane.sending=!0,(0,d.resetIdle)(),(0,p.stackingContextFix)(this.scrollable,(async()=>{await this.args.channel.stageMessage(e)})),e.manager=this.args.channel.messagesManager,this.resetComposerMessage(),this.capabilities.isIOS||this.messagesLoader.canLoadMoreFuture||this.scrollToLatestMessage()
try{await this.chatApi.sendMessage(this.args.channel.id,{message:e.message,in_reply_to_id:e.inReplyTo?.id,staged_id:e.id,upload_ids:e.uploads.map((e=>e.id))}),this.capabilities.isIOS||this.scrollToLatestMessage()}catch(t){this._onSendError(e.id,t)}finally{this.chatDraftsManager.remove({channelId:this.args.channel.id}),this.pane.sending=!1}}function le(){(0,c.cancel)(this._debouncedHighlightOrFetchMessageHandler),(0,c.cancel)(this._debouncedUpdateLastReadMessageHandler),(0,c.cancel)(this._debouncedFillPaneAttemptHandler)}function ce(e,t){t[e.id]&&(e.tracking.unreadCount=t[e.id].unread_count,e.tracking.mentionCount=t[e.id].mention_count)}function ue(){const e=this._ignoreNextScroll
return this._ignoreNextScroll=!1,e}e.default=ae,(0,t.setComponentTemplate)(re,ae)})),define("discourse/plugins/chat/discourse/components/chat-composer-dropdown",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse-common/lib/icon-library","tippy.js","@ember/object","discourse/lib/d-popover","@glimmer/tracking"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,i.createTemplateFactory)({id:"xb86xExg",block:'[[[41,[30,1,["length"]],[[[1,"  "],[8,[39,1],[[16,"title",[28,[37,2],["chat.composer.toggle_toolbar"],null]],[16,"disabled",[30,2]],[16,0,[28,[37,3],["chat-composer-dropdown__trigger-btn",[52,[30,3],"has-active-panel"]],null]],[16,"aria-expanded",[52,[30,0,["isExpanded"]],"true","false"]],[16,"aria-controls",[30,0,["ariaControls"]]],[17,4],[4,[38,4],["click",[30,0,["toggleExpand"]]],null],[4,[38,5],[[30,0,["setupTrigger"]]],null]],[["@icon"],["plus"]],null],[1,"\\n"],[41,[30,0,["isExpanded"]],[[[1,"    "],[11,"ul"],[24,1,"chat-composer-dropdown__list"],[24,0,"chat-composer-dropdown__list"],[4,[38,5],[[30,0,["setupPanel"]]],null],[4,[38,6],[[30,0,["teardownPanel"]]],null],[12],[1,"\\n"],[42,[28,[37,8],[[28,[37,8],[[30,1]],null]],null],null,[[[1,"        "],[10,"li"],[15,0,[28,[37,3],["chat-composer-dropdown__item",[30,5,["id"]]],null]],[12],[1,"\\n          "],[8,[39,9],null,[["@class","@icon","@action","@label"],[[28,[37,3],["chat-composer-dropdown__action-btn",[30,5,["id"]]],null],[30,5,["icon"]],[28,[37,10],[[30,0,["onButtonClick"]],[30,5]],null],[30,5,["label"]]]],null],[1,"\\n        "],[13],[1,"\\n"]],[5]],null],[1,"    "],[13],[1,"\\n"]],[]],null]],[]],null]],["@buttons","@isDisabled","@hasActivePanel","&attrs","button"],false,["if","chat/composer/button","i18n","concat-class","on","did-insert","will-destroy","each","-track-array","d-button","fn"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer-dropdown.hbs",isStrictMode:!1})
let g=(c=class extends n.default{constructor(){super(...arguments),h(this,"isExpanded",u,this),h(this,"tippyInstance",d,this),p(this,"trigger",null)}setupTrigger(e){this.trigger=e}get ariaControls(){return this.tippyInstance?.popper?.id}toggleExpand(){this.args.hasActivePanel?this.args.onCloseActivePanel?.():this.isExpanded=!this.isExpanded}onButtonClick(e){this.tippyInstance.hide(),e.action()}setupPanel(e){this.tippyInstance=(0,a.default)(this.trigger,{theme:"chat-composer-dropdown",trigger:"click",zIndex:1400,arrow:(0,r.iconHTML)("tippy-rounded-arrow"),interactive:!0,allowHTML:!1,appendTo:"parent",hideOnClick:!0,plugins:[o.hideOnEscapePlugin],content:e,onShow:()=>(this.isExpanded=!0,!0),onHide:()=>(this.isExpanded=!1,!0)}),this.tippyInstance.show()}teardownPanel(){this.tippyInstance?.destroy()}},u=m(c.prototype,"isExpanded",[l.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=m(c.prototype,"tippyInstance",[l.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m(c.prototype,"setupTrigger",[s.action],Object.getOwnPropertyDescriptor(c.prototype,"setupTrigger"),c.prototype),m(c.prototype,"toggleExpand",[s.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleExpand"),c.prototype),m(c.prototype,"onButtonClick",[s.action],Object.getOwnPropertyDescriptor(c.prototype,"onButtonClick"),c.prototype),m(c.prototype,"setupPanel",[s.action],Object.getOwnPropertyDescriptor(c.prototype,"setupPanel"),c.prototype),m(c.prototype,"teardownPanel",[s.action],Object.getOwnPropertyDescriptor(c.prototype,"teardownPanel"),c.prototype),c)
e.default=g,(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/chat-composer-message-details",["exports","@ember/component","@ember/template-factory","@glimmer/component"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"tNgK8JLk",block:'[[[10,0],[14,0,"chat-composer-message-details"],[15,"data-id",[30,1,["id"]]],[15,"data-action",[52,[30,1,["editing"]],"edit","reply"]],[12],[1,"\\n  "],[10,0],[14,0,"chat-reply"],[12],[1,"\\n    "],[1,[28,[35,1],[[52,[30,1,["editing"]],"pencil-alt","reply"]],null]],[1,"\\n    "],[8,[39,2],null,[["@user"],[[30,1,["user"]]]],null],[1,"\\n    "],[10,1],[14,0,"chat-reply__username"],[12],[1,[30,1,["user","username"]]],[13],[1,"\\n    "],[10,1],[14,0,"chat-reply__excerpt"],[12],[1,"\\n      "],[1,[28,[35,3],[[28,[37,4],[[30,1,["excerpt"]]],null]],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,5],null,[["@action","@class","@icon","@title"],[[30,2],"btn-flat cancel-message-action","times-circle","cancel"]],null],[1,"\\n"],[13]],["@message","@cancelAction"],false,["if","d-icon","chat/user-avatar","replace-emoji","html-safe","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer-message-details.hbs",isStrictMode:!1})
class a extends n.default{}e.default=a,(0,t.setComponentTemplate)(r,a)})),define("discourse/plugins/chat/discourse/components/chat-composer-upload",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/lib/uploads"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,i.createTemplateFactory)({id:"TiygyZvT",block:'[[[41,[30,1],[[[1,"  "],[10,0],[15,0,[28,[37,1],["chat-composer-upload",[52,[30,0,["isImage"]],"chat-composer-upload--image"],[52,[51,[30,2]],"chat-composer-upload--in-progress"]],null]],[12],[1,"\\n    "],[10,0],[14,0,"preview"],[12],[1,"\\n"],[41,[30,0,["isImage"]],[[[41,[30,2],[[[1,"          "],[10,"img"],[14,0,"preview-img"],[15,"src",[30,1,["short_path"]]],[12],[13],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[35,3],["far-image"],null]],[1,"\\n"]],[]]]],[]],[[[1,"        "],[1,[28,[35,3],["file-alt"],null]],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n\\n    "],[10,1],[14,0,"data"],[12],[1,"\\n"],[41,[51,[30,0,["isImage"]]],[[[1,"        "],[10,0],[14,0,"top-data"],[12],[1,"\\n          "],[10,1],[14,0,"file-name"],[12],[1,[30,0,["fileName"]]],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[10,0],[14,0,"bottom-data"],[12],[1,"\\n"],[41,[30,2],[[[41,[51,[30,0,["isImage"]]],[[[1,"            "],[10,1],[14,0,"extension-pill"],[12],[1,[30,1,["extension"]]],[13],[1,"\\n"]],[]],null]],[]],[[[41,[30,1,["processing"]],[[[1,"            "],[10,1],[14,0,"processing"],[12],[1,[28,[35,4],["processing"],null]],[13],[1,"\\n"]],[]],[[[1,"            "],[10,1],[14,0,"uploading"],[12],[1,[28,[35,4],["uploading"],null]],[13],[1,"\\n"]],[]]],[1,"\\n          "],[10,"progress"],[14,0,"upload-progress"],[14,1,"file"],[14,"max","100"],[15,2,[30,1,["progress"]]],[12],[13],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[39,5],null,[["@class","@action","@icon","@title"],["btn-flat chat-composer-upload__remove-btn",[30,3],"times","chat.remove_upload"]],null],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@upload","@isDone","@onCancel"],false,["if","concat-class","unless","d-icon","i18n","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer-upload.hbs",isStrictMode:!1})
class s extends n.default{get isImage(){return(0,r.isImage)(this.args.upload.original_filename||this.args.upload.fileName)}get fileName(){return this.args.isDone?this.args.upload.original_filename:this.args.upload.fileName}}e.default=s,(0,t.setComponentTemplate)(a,s)})),define("discourse/plugins/chat/discourse/components/chat-composer-uploads",["exports","@ember/component","@ember/template-factory","discourse/lib/utilities","@ember/object","@ember/service","discourse/lib/uppy-media-optimization-plugin","discourse-common/utils/decorators","discourse/mixins/uppy-upload","discourse-common/lib/object"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d
function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,i.createTemplateFactory)({id:"FoGAB5VV",block:'[[[41,[30,0,["showUploadsContainer"]],[[[1,"  "],[10,0],[14,0,"chat-composer-uploads-container"],[12],[1,"\\n"],[42,[28,[37,2],[[28,[37,2],[[30,0,["uploads"]]],null]],null],null,[[[1,"      "],[8,[39,3],null,[["@upload","@isDone","@onCancel"],[[30,1],true,[28,[37,4],[[30,0],"removeUpload",[30,1]],null]]],null],[1,"\\n"]],[1]],null],[1,"\\n"],[42,[28,[37,2],[[28,[37,2],[[30,0,["inProgressUploads"]]],null]],null],null,[[[1,"      "],[8,[39,3],null,[["@upload","@onCancel"],[[30,2],[28,[37,4],[[30,0],"cancelUploading",[30,2]],null]]],null],[1,"\\n"]],[2]],null],[1,"  "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[8,[39,5],null,[["@allowMultiple","@fileInputId","@fileInputClass"],[true,[30,0,["fileUploadElementId"]],"hidden-upload-field"]],null]],["upload","upload"],false,["if","each","-track-array","chat-composer-upload","action","pick-files-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer-uploads.hbs",isStrictMode:!1})
var m=(0,t.setComponentTemplate)(p,t.default.extend(l.default,(u=(0,o.default)("uploads.length","inProgressUploads.length"),d={classNames:["chat-composer-uploads"],mediaOptimizationWorker:(0,a.inject)(),chatStateManager:(0,a.inject)(),id:"chat-composer-uploader",type:"chat-composer",existingUploads:null,uploads:null,useMultipartUploadsIfAvailable:!0,uploadDropZone:null,init(){this._super(...arguments),this.setProperties({fileInputSelector:`#${this.fileUploadElementId}`})},didReceiveAttrs(){this._super(...arguments),this.inProgressUploads?.length>0&&this._uppyInstance?.cancelAll(),this.set("uploads",this.existingUploads?(0,c.cloneJSON)(this.existingUploads):[])},didInsertElement(){this._super(...arguments),this.composerInputEl?.addEventListener("paste",this._pasteEventListener)},willDestroyElement(){this._super(...arguments),this.composerInputEl?.removeEventListener("paste",this._pasteEventListener)},uploadDone(e){this.uploads.pushObject(e),this._triggerUploadsChanged()},showUploadsContainer:(e,t)=>e>0||t>0,cancelUploading(e){this.appEvents.trigger(`upload-mixin:${this.id}:cancel-upload`,{fileId:e.id}),this.removeUpload(e)},removeUpload(e){this.uploads.removeObject(e),this._triggerUploadsChanged()},_uploadDropTargetOptions(){return{target:this.uploadDropZone||document.body}},_uppyReady(){this.siteSettings.composer_media_optimization_image_enabled&&this._useUploadPlugin(s.default,{optimizeFn:(e,t)=>this.mediaOptimizationWorker.optimizeImage(e,t),runParallel:!this.site.isMobileDevice}),this._onPreProcessProgress((e=>{const t=this.inProgressUploads.findBy("id",e.id)
t?.processing||t?.set("processing",!0)})),this._onPreProcessComplete((e=>{const t=this.inProgressUploads.findBy("id",e.id)
t?.set("processing",!1)}))},_pasteEventListener(e){if(document.activeElement!==this.composerInputEl)return
const{canUpload:t,canPasteHtml:i,types:r}=(0,n.clipboardHelpers)(e,{siteSettings:this.siteSettings,canUpload:!0})
!t||i||r.includes("text/plain")||e&&e.clipboardData&&e.clipboardData.files&&this._addFiles([...e.clipboardData.files],{pasted:!0})},onProgressUploadsChanged(){this._triggerUploadsChanged(this.uploads,{inProgressUploadsCount:this.inProgressUploads?.length})},_triggerUploadsChanged(){this.onUploadChanged?.(this.uploads,{inProgressUploadsCount:this.inProgressUploads?.length})}},h(d,"showUploadsContainer",[u],Object.getOwnPropertyDescriptor(d,"showUploadsContainer"),d),h(d,"cancelUploading",[r.action],Object.getOwnPropertyDescriptor(d,"cancelUploading"),d),h(d,"removeUpload",[r.action],Object.getOwnPropertyDescriptor(d,"removeUpload"),d),h(d,"_pasteEventListener",[o.bind],Object.getOwnPropertyDescriptor(d,"_pasteEventListener"),d),d)))
e.default=m})),define("discourse/plugins/chat/discourse/components/chat-composer",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object","@ember/service","@glimmer/tracking","@ember/runloop","discourse-common/lib/object","discourse/plugins/chat/discourse/lib/chat-composer-buttons","discourse/lib/show-modal","discourse/plugins/chat/discourse/lib/textarea-interactor","discourse-common/lib/get-owner","discourse/lib/user-search","discourse-common/lib/raw-templates","pretty-text/emoji","discourse/lib/text","discourse/lib/autocomplete","I18n","pretty-text/emoji/data","discourse/lib/hashtag-autocomplete","@ember/utils","rsvp","discourse/models/user","discourse/plugins/chat/discourse/lib/chat-message-interactor","discourse/lib/user-status-on-autocomplete","discourse/plugins/chat/discourse/components/chat/modal/channel-summary"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,_,w,j,M,z,k,O){"use strict"
var C,S,P,T,E,x,D,I,A,U,L,N,R,F,W,B,H,V,q,G,K,J
function Y(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function Z(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function X(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function Q(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const ee=(0,i.createTemplateFactory)({id:"gA2iO17w",block:'[[[1,"\\n"],[10,0],[14,0,"chat-composer__wrapper"],[12],[1,"\\n"],[41,[30,0,["shouldRenderMessageDetails"]],[[[1,"    "],[8,[39,1],null,[["@message","@cancelAction"],[[52,[30,0,["currentMessage","editing"]],[30,0,["currentMessage"]],[30,0,["currentMessage","inReplyTo"]]],[30,0,["composer","cancel"]]]],null],[1,"\\n"]],[]],null],[1,"\\n  "],[11,0],[24,"role","region"],[16,"aria-label",[28,[37,2],["chat.aria_roles.composer"],null]],[16,0,[28,[37,3],["chat-composer",[52,[30,0,["isFocused"]],"is-focused"],[52,[30,0,["pane","sending"]],"is-sending"],[52,[30,0,["sendEnabled"]],"is-send-enabled","is-send-disabled"],[52,[30,0,["disabled"]],"is-disabled","is-enabled"],[52,[30,0,["currentMessage","draftSaved"]],"is-draft-saved","is-draft-unsaved"]],null]],[4,[38,4],[[30,0,["didUpdateMessage"]],[30,0,["currentMessage"]]],null],[4,[38,4],[[30,0,["didUpdateInReplyTo"]],[30,0,["currentMessage","inReplyTo"]]],null],[4,[38,5],[[30,0,["setup"]]],null],[4,[38,6],[[30,0,["teardown"]]],null],[4,[38,6],[[30,0,["cancelPersistDraft"]]],null],[12],[1,"\\n    "],[10,0],[14,0,"chat-composer__outer-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-composer__inner-container"],[12],[1,"\\n        "],[8,[39,7],[[4,[38,9],["focus",[28,[37,10],[[30,0,["computeIsFocused"]],true],null]],null],[4,[38,9],["blur",[28,[37,10],[[30,0,["computeIsFocused"]],false],null]],null]],[["@buttons","@isDisabled","@hasActivePanel","@onCloseActivePanel"],[[30,0,["dropdownButtons"]],[30,0,["disabled"]],[28,[37,8],[[30,0,["chatEmojiPickerManager","picker","context"]],[30,0,["context"]]],null],[30,0,["chatEmojiPickerManager","close"]]]],null],[1,"\\n\\n        "],[11,0],[24,0,"chat-composer__input-container"],[4,[38,9],["click",[30,0,["composer","focus"]]],null],[12],[1,"\\n          "],[8,[39,11],[[16,1,[30,0,["composerId"]]],[16,2,[28,[37,12],[[30,0,["currentMessage","message"]]],null]],[24,0,"chat-composer__input"],[16,"disabled",[30,0,["disabled"]]],[24,"autocorrect","on"],[24,"autocapitalize","sentences"],[16,"placeholder",[30,0,["placeholder"]]],[16,"rows",1],[16,"data-chat-composer-context",[30,0,["context"]]],[24,4,"text"],[4,[38,5],[[30,0,["setupTextareaInteractor"]]],null],[4,[38,9],["input",[30,0,["onInput"]]],null],[4,[38,9],["keydown",[30,0,["onKeyDown"]]],null],[4,[38,9],["focusin",[30,0,["onTextareaFocusIn"]]],null],[4,[38,9],["focusin",[28,[37,10],[[30,0,["computeIsFocused"]],true],null]],null],[4,[38,9],["focusout",[28,[37,10],[[30,0,["computeIsFocused"]],false],null]],null],[4,[38,5],[[30,0,["setupAutocomplete"]]],null]],null,null],[1,"\\n        "],[13],[1,"\\n\\n"],[41,[30,0,["inlineButtons","length"]],[[[42,[28,[37,14],[[28,[37,14],[[30,0,["inlineButtons"]]],null]],null],null,[[[1,"            "],[8,[39,15],[[16,0,[29,["-",[30,1,["id"]]]]],[16,"disabled",[28,[37,16],[[30,0,["disabled"]],[30,1,["disabled"]]],null]],[16,"tabindex",[52,[30,1,["disabled"]],-1,0]],[4,[38,9],["click",[28,[37,10],[[30,0,["handleInlineButonAction"]],[30,1,["action"]]],null]],[["bubbles"],[false]]],[4,[38,9],["focus",[28,[37,10],[[30,0,["computeIsFocused"]],true],null]],null],[4,[38,9],["blur",[28,[37,10],[[30,0,["computeIsFocused"]],false],null]],null]],[["@icon"],[[30,1,["icon"]]]],null],[1,"\\n"]],[1]],null],[1,"\\n          "],[8,[39,17],null,null,null],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[39,15],[[24,0,"-send"],[16,"title",[28,[37,2],["chat.composer.send"],null]],[16,"disabled",[28,[37,16],[[30,0,["disabled"]],[28,[37,18],[[30,0,["sendEnabled"]]],null]],null]],[16,"tabindex",[52,[30,0,["sendEnabled"]],0,-1]],[4,[38,9],["click",[30,0,["onSend"]]],null],[4,[38,9],["mousedown",[30,0,["trapMouseDown"]]],null],[4,[38,9],["focus",[28,[37,10],[[30,0,["computeIsFocused"]],true],null]],null],[4,[38,9],["blur",[28,[37,10],[[30,0,["computeIsFocused"]],false],null]],null]],[["@icon"],["paper-plane"]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n\\n"],[41,[30,0,["canAttachUploads"]],[[[1,"    "],[8,[39,19],null,[["@fileUploadElementId","@onUploadChanged","@existingUploads","@uploadDropZone","@composerInputEl"],[[30,0,["fileUploadElementId"]],[30,0,["onUploadChanged"]],[30,0,["currentMessage","uploads"]],[30,2],[30,0,["composer","textarea","element"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["shouldRenderReplyingIndicator"]],[[[1,"    "],[10,0],[14,0,"chat-replying-indicator-container"],[12],[1,"\\n      "],[8,[39,20],null,[["@presenceChannelName"],[[30,0,["presenceChannelName"]]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[8,[39,21],null,[["@context","@didSelectEmoji"],[[30,0,["context"]],[30,0,["onSelectEmoji"]]]],null],[1,"\\n"],[13]],["button","@uploadDropZone"],false,["if","chat-composer-message-details","i18n","concat-class","did-update","did-insert","will-destroy","chat-composer-dropdown","eq","on","fn","d-textarea","readonly","each","-track-array","chat/composer/button","or","chat/composer/separator","not","chat-composer-uploads","chat-replying-indicator","chat-emoji-picker"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer.hbs",isStrictMode:!1})
let te=(V=new WeakSet,q=new WeakSet,G=new WeakSet,K=new WeakSet,J=new WeakSet,C=class extends n.default{constructor(){super(...arguments),Z(this,J),Z(this,K),Z(this,G),Z(this,q),Z(this,V),Y(this,"capabilities",S,this),Y(this,"site",P,this),Y(this,"siteSettings",T,this),Y(this,"chat",E,this),Y(this,"chatComposerPresenceManager",x,this),Y(this,"chatComposerWarningsTracker",D,this),Y(this,"appEvents",I,this),Y(this,"chatEmojiReactionStore",A,this),Y(this,"chatEmojiPickerManager",U,this),Y(this,"currentUser",L,this),Y(this,"chatApi",N,this),Y(this,"chatDraftsManager",R,this),Y(this,"modal",F,this),Y(this,"isFocused",W,this),Y(this,"inProgressUploadsCount",B,this),Y(this,"presenceChannelName",H,this)}get shouldRenderMessageDetails(){return this.currentMessage?.editing||"channel"===this.context&&this.currentMessage?.inReplyTo}get inlineButtons(){return(0,c.chatComposerButtons)(this,"inline",this.context)}get dropdownButtons(){return(0,c.chatComposerButtons)(this,"dropdown",this.context)}get fileUploadElementId(){return this.context+"-file-uploader"}get canAttachUploads(){return this.siteSettings.chat_allow_uploads&&(0,w.isPresent)(this.args.uploadDropZone)}persistDraft(){}setupAutocomplete(e){const t=$(e)
X(this,q,ne).call(this,t),X(this,K,ae).call(this,t),X(this,G,re).call(this,t)}setupTextareaInteractor(e){this.composer.textarea=new d.default((0,h.getOwner)(this),e),this.site.desktopView&&this.args.autofocus&&this.composer.focus({ensureAtEnd:!0,refreshHeight:!0})}didUpdateMessage(){this.cancelPersistDraft(),this.composer.textarea.value=this.currentMessage.message,this.persistDraft()}didUpdateInReplyTo(){this.cancelPersistDraft(),this.persistDraft()}cancelPersistDraft(){(0,o.cancel)(this._persistHandler)}handleInlineButonAction(e,t){t.stopPropagation(),e()}get currentMessage(){return this.composer.message}get hasContent(){const e=this.siteSettings.chat_minimum_message_length||1
return this.currentMessage?.message?.length>=e||this.canAttachUploads&&this.currentMessage?.uploads?.length>0}get sendEnabled(){return(this.hasContent||this.currentMessage?.editing)&&!this.pane.sending&&!this.inProgressUploadsCount>0}setup(){this.appEvents.on("chat:modify-selection",this,"modifySelection"),this.appEvents.on("chat:open-insert-link-modal",this,"openInsertLinkModal")}teardown(){this.appEvents.off("chat:modify-selection",this,"modifySelection"),this.appEvents.off("chat:open-insert-link-modal",this,"openInsertLinkModal"),this.pane.sending=!1}insertDiscourseLocalDate(){(0,u.default)("discourse-local-dates-create-modal").setProperties({insertDate:e=>{this.composer.textarea.addText(this.composer.textarea.getSelected(),e),this.composer.focus()}})}uploadClicked(){document.querySelector(`#${this.fileUploadElementId}`).click()}computeIsFocused(e){(0,o.next)((()=>{this.isFocused=e}))}onInput(e){this.currentMessage.draftSaved=!1,this.currentMessage.message=e.target.value,this.composer.textarea.refreshHeight(),this.reportReplyingPresence(),this.persistDraft(),this.captureMentions()}onUploadChanged(e,t){let{inProgressUploadsCount:i}=t
this.currentMessage.draftSaved=!1,this.inProgressUploadsCount=i||0,void 0!==e&&"undefined"!==i&&0===i&&this.currentMessage&&(this.currentMessage.uploads=(0,l.cloneJSON)(e)),this.composer.textarea?.focus(),this.reportReplyingPresence(),this.persistDraft()}trapMouseDown(e){e?.preventDefault()}async onSend(e){if(this.sendEnabled){if(e?.preventDefault(),this.currentMessage.editing&&0===this.currentMessage.message.length)return new z.default((0,h.getOwner)(this),this.currentMessage,this.context).delete(),void this.reset(this.args.channel,this.args.thread)
await this.args.onSendMessage(this.currentMessage),this.composer.textarea.refreshHeight()}}reportReplyingPresence(){this.args.channel&&this.currentMessage&&this.chatComposerPresenceManager.notifyState(this.presenceChannelName,!this.currentMessage.editing&&this.hasContent)}modifySelection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{type:null,context:null}
if(t.context!==this.context)return
const i=this.composer.textarea.getSelected("",{lineVal:!0})
"bold"===t.type?this.composer.textarea.applySurround(i,"**","**","bold_text"):"italic"===t.type?this.composer.textarea.applySurround(i,"_","_","italic_text"):"code"===t.type&&this.composer.textarea.applySurround(i,"`","`","code_text")}onTextareaFocusIn(e){this.capabilities.isIOS&&((e=this.composer.textarea.textarea).style.transform="translateY(-99999px)",e.focus(),window.requestAnimationFrame((()=>{window.requestAnimationFrame((()=>{e.style.transform=""}))})))}onKeyDown(e){if(!(this.site.mobileView||e.altKey||e.metaKey||X(this,J,se).call(this))){if("Escape"===e.key&&!e.shiftKey)return this.handleEscape(e)
if("Enter"===e.key){if(e.shiftKey)return
if(!e.ctrlKey){const{pre:e}=this.composer.textarea.getSelected({lineVal:!0})
if(this.composer.textarea.isInside(e,/(^|\n)```/g))return}return this.onSend(),e.preventDefault(),!1}if("ArrowUp"===e.key&&!this.hasContent&&!this.currentMessage.editing)if(e.shiftKey&&this.lastMessage?.replyable)this.composer.replyTo(this.lastMessage)
else{const e=this.lastUserMessage(this.currentUser)
e?.editable&&this.composer.edit(e)}}}openInsertLinkModal(e){if((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{context:null}).context!==this.context)return
const t=this.composer.textarea.getSelected("",{lineVal:!0}),i=t?.value;(0,u.default)("insert-hyperlink").setProperties({linkText:i,toolbarEvent:{addText:e=>this.composer.textarea.addText(t,e)}})}onSelectEmoji(e){const t=`:${e}:`
this.chatEmojiReactionStore.track(t),this.composer.textarea.addText(this.composer.textarea.getSelected(),t),this.site.desktopView?this.composer.focus():this.chatEmojiPickerManager.close()}captureMentions(){this.hasContent&&this.chatComposerWarningsTracker.trackMentions(this.currentMessage.message)}showChannelSummaryModal(){this.modal.show(O.default,{model:{channelId:this.args.channel.id}})}},S=Q(C.prototype,"capabilities",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=Q(C.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=Q(C.prototype,"siteSettings",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=Q(C.prototype,"chat",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=Q(C.prototype,"chatComposerPresenceManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=Q(C.prototype,"chatComposerWarningsTracker",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=Q(C.prototype,"appEvents",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Q(C.prototype,"chatEmojiReactionStore",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=Q(C.prototype,"chatEmojiPickerManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=Q(C.prototype,"currentUser",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=Q(C.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Q(C.prototype,"chatDraftsManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=Q(C.prototype,"modal",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=Q(C.prototype,"isFocused",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),B=Q(C.prototype,"inProgressUploadsCount",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),H=Q(C.prototype,"presenceChannelName",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q(C.prototype,"persistDraft",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"persistDraft"),C.prototype),Q(C.prototype,"setupAutocomplete",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"setupAutocomplete"),C.prototype),Q(C.prototype,"setupTextareaInteractor",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"setupTextareaInteractor"),C.prototype),Q(C.prototype,"didUpdateMessage",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"didUpdateMessage"),C.prototype),Q(C.prototype,"didUpdateInReplyTo",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"didUpdateInReplyTo"),C.prototype),Q(C.prototype,"cancelPersistDraft",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"cancelPersistDraft"),C.prototype),Q(C.prototype,"handleInlineButonAction",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"handleInlineButonAction"),C.prototype),Q(C.prototype,"setup",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"setup"),C.prototype),Q(C.prototype,"teardown",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"teardown"),C.prototype),Q(C.prototype,"insertDiscourseLocalDate",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"insertDiscourseLocalDate"),C.prototype),Q(C.prototype,"uploadClicked",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"uploadClicked"),C.prototype),Q(C.prototype,"computeIsFocused",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"computeIsFocused"),C.prototype),Q(C.prototype,"onInput",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onInput"),C.prototype),Q(C.prototype,"onUploadChanged",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onUploadChanged"),C.prototype),Q(C.prototype,"trapMouseDown",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"trapMouseDown"),C.prototype),Q(C.prototype,"onSend",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onSend"),C.prototype),Q(C.prototype,"modifySelection",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"modifySelection"),C.prototype),Q(C.prototype,"onTextareaFocusIn",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onTextareaFocusIn"),C.prototype),Q(C.prototype,"onKeyDown",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onKeyDown"),C.prototype),Q(C.prototype,"openInsertLinkModal",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"openInsertLinkModal"),C.prototype),Q(C.prototype,"onSelectEmoji",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onSelectEmoji"),C.prototype),Q(C.prototype,"captureMentions",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"captureMentions"),C.prototype),Q(C.prototype,"showChannelSummaryModal",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"showChannelSummaryModal"),C.prototype),C)
function ie(e){const t=M.default.create(e)
this.currentMessage.mentionedUsers.set(t.id,t)}function ne(e){this.siteSettings.enable_mentions&&e.autocomplete({template:(0,m.findRawTemplate)("user-selector-autocomplete"),key:"@",width:"100%",treatAsTextarea:!0,autoSelectFirstSuggestion:!0,transformComplete:e=>(e.isUser&&X(this,V,ie).call(this,e),e.username||e.name),dataSource:e=>((0,k.destroyTippyInstances)(),(0,p.default)({term:e,includeGroups:!0}).then((e=>{if(e?.users?.length>0){const t=this.chat.presenceChannel.users?.mapBy("username")
e.users.forEach((e=>{t.includes(e.username)&&(e.cssClasses="is-online")})),(0,k.initUserStatusHtml)(e.users)}return e}))),onRender:e=>{(0,k.renderUserStatusHtml)(e)},afterComplete:(e,t)=>{t.preventDefault(),this.composer.textarea.value=e,this.composer.focus(),this.captureMentions()},onClose:k.destroyTippyInstances})}function re(e){(0,_.setupHashtagAutocomplete)(this.site.hashtag_configurations["chat-composer"],e,this.siteSettings,{treatAsTextarea:!0,afterComplete:(e,t)=>{t.preventDefault(),this.composer.textarea.value=e,this.composer.focus()}})}function ae(e){this.siteSettings.enable_emoji&&e.autocomplete({template:(0,m.findRawTemplate)("emoji-selector-autocomplete"),key:":",afterComplete:(e,t)=>{t.preventDefault(),this.composer.textarea.value=e,this.composer.focus()},treatAsTextarea:!0,onKeyUp:(e,t)=>{const i=/(?:^|[\s.\?,@\/#!%&*;:\[\]{}=\-_()])(:(?!:).?[\w-]*:?(?!:)(?:t\d?)?:?) ?$/gi.exec(e.substring(0,t))
if(i&&i[1])return[i[1]]},transformComplete:t=>t.code?(this.chatEmojiReactionStore.track(t.code),`${t.code}:`):(e.autocomplete({cancel:!0}),this.chatEmojiPickerManager.open({context:this.context,initialFilter:t.term}),""),dataSource:e=>new j.Promise((t=>{const i=`:${e}`
e=e.toLowerCase()
let n=Math.max(this.siteSettings.emoji_autocomplete_min_chars,2)
if(e.length<n)return t(f.SKIP)
if(!e.match(/[^-\{\}\[\]\(\)\*_\<\>\\\/].*[^-\{\}\[\]\(\)\*_\<\>\\\/]/))return t(f.SKIP)
if(""===e)return this.chatEmojiReactionStore.favorites.length?t(this.chatEmojiReactionStore.favorites.slice(0,5)):t(["slight_smile","smile","wink","sunny","blush"])
const r=this.site.custom_emoji_translation||{},a=Object.assign({},y.translations,r)
if(a[i])return t([a[i]])
const s=this.site.denied_emojis||[],o=e.match(/^:?(.*?):t([2-6])?$/)
if(o){const e=o[1],i=o[2]
if((0,b.isSkinTonableEmoji)(e)&&!s.includes(e))return t(i?[`${e}:t${i}`]:[2,3,4,5,6].map((t=>`${e}:t${t}`)))}return t((0,b.emojiSearch)(e,{maxResults:5,diversity:this.chatEmojiReactionStore.diversity,exclude:s}))})).then((e=>{if(e!==f.SKIP)return e.map((e=>({code:e,src:(0,g.emojiUrlFor)(e)})))})).then((t=>(t?.length&&t.push({label:v.default.t("composer.more_emoji"),term:e}),t)))})}function se(){return document.querySelector(".autocomplete")}e.default=te,(0,t.setComponentTemplate)(ee,te)})),define("discourse/plugins/chat/discourse/components/chat-drawer",["exports","@ember/component","@ember/template-factory","discourse-common/utils/decorators","@ember/object","@ember/runloop","@ember/service","@ember/template","discourse/lib/utilities","discourse/lib/url"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d
function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,i.createTemplateFactory)({id:"Km2Q7jFJ",block:'[[[41,[30,0,["chatStateManager","isDrawerActive"]],[[[1,"  "],[11,0],[16,"data-chat-channel-id",[30,0,["chat","activeChannel","id"]]],[16,"data-chat-thread-id",[30,0,["chat","activeChannel","activeThread","id"]]],[16,0,[28,[37,1],["chat-drawer",[52,[30,0,["chatStateManager","isDrawerExpanded"]],"is-expanded"]],null]],[16,5,[30,0,["drawerStyle"]]],[4,[38,2],[".chat-drawer-resizer",[30,0,["didResize"]]],null],[12],[1,"\\n    "],[10,0],[14,0,"chat-drawer-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-drawer-resizer"],[12],[13],[1,"\\n      "],[8,[30,0,["chatDrawerRouter","component"]],null,[["@params","@openURL","@openInFullPage","@toggleExpand","@close","@drawerActions"],[[30,0,["chatDrawerRouter","params"]],[30,0,["openURL"]],[30,0,["openInFullPage"]],[30,0,["toggleExpand"]],[30,0,["close"]],[30,0,["drawerActions"]]]],null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if","concat-class","chat/resizable-node"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer.hbs",isStrictMode:!1})
var m=(0,t.setComponentTemplate)(p,t.default.extend((u=(0,n.observes)("chatStateManager.isDrawerActive"),d={tagName:"",chat:(0,s.inject)(),router:(0,s.inject)(),chatDrawerSize:(0,s.inject)(),chatChannelsManager:(0,s.inject)(),chatStateManager:(0,s.inject)(),chatDrawerRouter:(0,s.inject)(),loading:!1,sizeTimer:null,rafTimer:null,hasUnreadMessages:!1,drawerStyle:null,didInsertElement(){this._super(...arguments),this.chat.userCanChat&&(this._checkSize(),this.appEvents.on("chat:open-url",this,"openURL"),this.appEvents.on("chat:toggle-close",this,"close"),this.appEvents.on("composer:closed",this,"_checkSize"),this.appEvents.on("composer:opened",this,"_checkSize"),this.appEvents.on("composer:resized",this,"_checkSize"),this.appEvents.on("composer:div-resizing",this,"_dynamicCheckSize"),window.addEventListener("resize",this._checkSize),this.appEvents.on("composer:resize-started",this,"_startDynamicCheckSize"),this.appEvents.on("composer:resize-ended",this,"_clearDynamicCheckSize"),this.computeDrawerStyle())},willDestroyElement(){this._super(...arguments),this.chat.userCanChat&&(window.removeEventListener("resize",this._checkSize),this.appEvents&&(this.appEvents.off("chat:open-url",this,"openURL"),this.appEvents.off("chat:toggle-close",this,"close"),this.appEvents.off("composer:closed",this,"_checkSize"),this.appEvents.off("composer:opened",this,"_checkSize"),this.appEvents.off("composer:resized",this,"_checkSize"),this.appEvents.off("composer:div-resizing",this,"_dynamicCheckSize"),this.appEvents.off("composer:resize-started",this,"_startDynamicCheckSize"),this.appEvents.off("composer:resize-ended",this,"_clearDynamicCheckSize")),this.sizeTimer&&((0,a.cancel)(this.sizeTimer),this.sizeTimer=null),this.rafTimer&&window.cancelAnimationFrame(this.rafTimer))},_fireHiddenAppEvents(){this.appEvents.trigger("chat:rerender-header")},computeDrawerStyle(){const{width:e,height:t}=this.chatDrawerSize.size
let i=`width: ${(0,l.escapeExpression)((e||"0").toString())}px;`
i+=`height: ${(0,l.escapeExpression)((t||"0").toString())}px;`,this.set("drawerStyle",(0,o.htmlSafe)(i))},get drawerActions(){return{openInFullPage:this.openInFullPage,close:this.close,toggleExpand:this.toggleExpand}},_dynamicCheckSize(){this.chatStateManager.isDrawerActive&&(this.rafTimer||(this.rafTimer=window.requestAnimationFrame((()=>{this.rafTimer=null,this._performCheckSize()}))))},_startDynamicCheckSize(){this.chatStateManager.isDrawerActive&&document.querySelector(".chat-drawer-outlet-container").classList.add("clear-transitions")},_clearDynamicCheckSize(){this.chatStateManager.isDrawerActive&&(document.querySelector(".chat-drawer-outlet-container").classList.remove("clear-transitions"),this._checkSize())},_checkSize(){this.sizeTimer=(0,a.throttle)(this,this._performCheckSize,150)},_performCheckSize(){if(this.isDestroying||this.isDestroyed)return
const e=document.querySelector(".chat-drawer-outlet-container")
if(!e)return
const t=document.getElementById("reply-control"),i=t.classList.contains("closed")
e.style.setProperty("--composer-right",(i?15:Math.max(15,t.offsetLeft))+"px")},openURL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null
this.chat.activeChannel=null,this.chatStateManager.didOpenDrawer(e),this.chatDrawerRouter.stateFor(this._routeFromURL(e))},_routeFromURL(e){let t=this.router.recognize(e||"/")
return"index"===t.localName&&(t=t.parent),t},openInFullPage(){return this.chatStateManager.storeAppURL(),this.chatStateManager.prefersFullPage(),this.chat.activeChannel=null,c.default.routeTo(this.chatStateManager.lastKnownChatURL)},toggleExpand(){this.computeDrawerStyle(),this.chatStateManager.didToggleDrawer(),this.appEvents.trigger("chat:toggle-expand",this.chatStateManager.isDrawerExpanded)},close(){this.computeDrawerStyle(),this.chatStateManager.didCloseDrawer(),this.chat.activeChannel=null},didResize(e,t){let{width:i,height:n}=t
this.chatDrawerSize.size={width:i,height:n}}},h(d,"_fireHiddenAppEvents",[u],Object.getOwnPropertyDescriptor(d,"_fireHiddenAppEvents"),d),h(d,"_dynamicCheckSize",[n.bind],Object.getOwnPropertyDescriptor(d,"_dynamicCheckSize"),d),h(d,"_checkSize",[n.bind],Object.getOwnPropertyDescriptor(d,"_checkSize"),d),h(d,"openURL",[r.action],Object.getOwnPropertyDescriptor(d,"openURL"),d),h(d,"openInFullPage",[r.action],Object.getOwnPropertyDescriptor(d,"openInFullPage"),d),h(d,"toggleExpand",[r.action],Object.getOwnPropertyDescriptor(d,"toggleExpand"),d),h(d,"close",[r.action],Object.getOwnPropertyDescriptor(d,"close"),d),h(d,"didResize",[r.action],Object.getOwnPropertyDescriptor(d,"didResize"),d),d)))
e.default=m})),define("discourse/plugins/chat/discourse/components/chat-drawer/channel",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service","@ember/object"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,i.createTemplateFactory)({id:"mFVMT7MB",block:'[[[8,[39,0],null,[["@toggleExpand"],[[30,1,["toggleExpand"]]]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,null],[1,"\\n\\n  "],[8,[39,2],null,[["@channel","@drawerActions"],[[30,0,["chat","activeChannel"]],[30,1]]],null],[1,"\\n\\n  "],[8,[39,3],null,[["@drawerActions"],[[30,1]]],null],[1,"\\n"]],[]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"  "],[11,0],[24,0,"chat-drawer-content"],[4,[38,5],[[30,0,["fetchChannel"]]],null],[4,[38,6],[[30,0,["fetchChannel"]],[30,2,["channelId"]]],null],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel"]],[[[1,"      "],[8,[39,7],null,[["@targetMessageId","@channel"],[[28,[37,8],[[30,2,["messageId"]]],null],[30,0,["chat","activeChannel"]]]],null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@drawerActions","@params"],false,["chat-drawer/header","chat-drawer/header/left-actions","chat-drawer/header/channel-title","chat-drawer/header/right-actions","if","did-insert","did-update","chat-channel","readonly"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/channel.hbs",isStrictMode:!1})
let m=(s=class extends n.default{constructor(){super(...arguments),d(this,"appEvents",o,this),d(this,"chat",l,this),d(this,"chatStateManager",c,this),d(this,"chatChannelsManager",u,this)}fetchChannel(){if(this.args.params?.channelId)return this.chatChannelsManager.find(this.args.params.channelId).then((e=>{this.chat.activeChannel=e}))}},o=h(s.prototype,"appEvents",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=h(s.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(s.prototype,"chatStateManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(s.prototype,"chatChannelsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(s.prototype,"fetchChannel",[a.action],Object.getOwnPropertyDescriptor(s.prototype,"fetchChannel"),s.prototype),s)
e.default=m,(0,t.setComponentTemplate)(p,m)}))
define("discourse/plugins/chat/discourse/components/chat-drawer/header",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"YEFR7d/9",block:'[[[11,0],[24,"role","region"],[16,"aria-label",[28,[37,0],["chat.aria_roles.header"],null]],[24,0,"chat-drawer-header"],[16,"title",[52,[30,0,["chatStateManager","isDrawerExpanded"]],[28,[37,0],["chat.collapse"],null],[28,[37,0],["chat.expand"],null]]],[4,[38,2],["click",[30,1]],null],[12],[1,"\\n  "],[18,2,null],[1,"\\n"],[13]],["@toggleExpand","&default"],false,["i18n","if","on","yield"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/back-link",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"kj3DzeN+",block:'[[[8,[39,0],[[16,"title",[30,1]],[24,0,"chat-drawer-header__back-btn"]],[["@route","@models"],[[30,2],[28,[37,1],[[30,3],[28,[37,2],null,null]],null]]],[["default"],[[[[1,"\\n  "],[1,[28,[35,3],["chevron-left"],null]],[1,"\\n"]],[]]]]]],["@title","@route","@routeModels"],false,["link-to","or","array","d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/back-link.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/channel-title",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"Kaybpdy4",block:'[[[41,[30,1],[[[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"    "],[8,[39,1],[[24,0,"chat-drawer-header__title"]],[["@route","@models"],[[52,[30,1,["isDirectMessageChannel"]],"chat.channel.info.settings","chat.channel.info.members"],[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n        "],[8,[39,2],null,[["@channel"],[[30,1]]],null],[1,"\\n      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],[[[1,"    "],[11,0],[24,"role","button"],[24,0,"chat-drawer-header__title"],[4,[38,3],["click",[30,2,["toggleExpand"]]],null],[12],[1,"\\n      "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n        "],[8,[39,2],null,[["@channel"],[[30,1]]],[["default"],[[[[1,"\\n"],[41,[30,1,["tracking","unreadCount"]],[[[1,"            "],[10,1],[14,0,"chat-unread-count"],[12],[1,"\\n              "],[1,[30,1,["tracking","unreadCount"]]],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]]]],[]],null]],["@channel","@drawerActions"],false,["if","link-to","chat-channel-title","on"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/channel-title.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/close-button",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"SAvnlGds",block:'[[[8,[39,0],null,[["@icon","@action","@title","@class"],["times",[30,1],"chat.close","btn-flat btn-link chat-drawer-header__close-btn"]],null]],["@close"],false,["d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/close-button.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,(0,n.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/full-page-button",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"Q3UEeeW9",block:'[[[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"  "],[8,[39,1],[[24,0,"btn-flat btn-link chat-drawer-header__full-screen-btn"]],[["@icon","@title","@action"],["discourse-expand","chat.open_full_page",[30,1]]],null],[1,"\\n"]],[]],null]],["@openInFullPage"],false,["if","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/full-page-button.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/left-actions",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"y0iVBJEN",block:'[[[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"  "],[10,0],[14,0,"chat-drawer-header__left-actions"],[12],[1,"\\n    "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n      "],[8,[39,1],null,[["@route","@title"],["chat",[28,[37,2],["chat.return_to_list"],null]]],null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if","chat-drawer/header/back-link","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/left-actions.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/right-actions",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"n0mIgt/b",block:'[[[10,0],[14,0,"chat-drawer-header__right-actions"],[12],[1,"\\n  "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n"],[41,[30,0,["showThreadsListButton"]],[[[1,"      "],[8,[39,1],null,[["@channel"],[[30,0,["chat","activeChannel"]]]],null],[1,"\\n"]],[]],null],[1,"\\n    "],[8,[39,2],null,[["@toggleExpand"],[[30,1,["toggleExpand"]]]],null],[1,"\\n\\n    "],[8,[39,3],null,[["@openInFullPage"],[[30,1,["openInFullPage"]]]],null],[1,"\\n\\n    "],[8,[39,4],null,[["@close"],[[30,1,["close"]]]],null],[1,"\\n  "],[13],[1,"\\n"],[13]],["@drawerActions"],false,["if","chat/thread/threads-list-button","chat-drawer/header/toggle-expand-button","chat-drawer/header/full-page-button","chat-drawer/header/close-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/right-actions.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get showThreadsListButton(){return this.chat.activeChannel?.threadingEnabled}},c=a.prototype,u="chat",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/title",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"h7tnAKNT",block:'[[[10,1],[14,0,"chat-drawer-header__title"],[12],[1,"\\n  "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n    "],[1,[28,[35,0],[[30,1]],null]],[1,"\\n  "],[13],[1,"\\n"],[13]],["@title"],false,["i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/title.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,(0,n.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat-drawer/header/toggle-expand-button",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"nIVGLv82",block:'[[[8,[39,0],null,[["@icon","@class","@action","@title"],[[52,[30,0,["chatStateManager","isDrawerExpanded"]],"angle-double-down","angle-double-up"],"btn-flat btn-link chat-drawer-header__expand-btn",[30,1],[52,[30,0,["chatStateManager","isDrawerExpanded"]],"chat.collapse","chat.expand"]]],null]],["@toggleExpand"],false,["d-button","if"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/header/toggle-expand-button.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/index",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"EGaKY0Ld",block:'[[[8,[39,0],null,[["@toggleExpand"],[[30,1,["toggleExpand"]]]],[["default"],[[[[1,"\\n  "],[10,0],[14,0,"chat-drawer-header__title"],[12],[1,"\\n    "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n      "],[1,[28,[35,1],["chat.heading"],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,2],null,[["@drawerActions"],[[30,1]]],null],[1,"\\n"]],[]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"  "],[10,0],[14,0,"chat-drawer-content"],[12],[1,"\\n    "],[8,[39,4],null,null,null],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@drawerActions"],false,["chat-drawer/header","i18n","chat-drawer/header/right-actions","if","channels-list"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/index.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatStateManager",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chatStateManager",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-drawer/thread",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service","@ember/object"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,i.createTemplateFactory)({id:"qengP9cp",block:'[[[8,[39,0],null,[["@toggleExpand"],[[30,1,["toggleExpand"]]]],[["default"],[[[[1,"\\n"],[41,[28,[37,2],[[30,0,["chatStateManager","isDrawerExpanded"]],[30,0,["chat","activeChannel"]]],null],[[[1,"    "],[10,0],[14,0,"chat-drawer-header__left-actions"],[12],[1,"\\n      "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n        "],[8,[39,3],null,[["@route","@title","@routeModels"],[[30,0,["backLink","route"]],[28,[37,4],[[30,0,["backLink","title"]]],null],[30,0,["backLink","models"]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[8,[39,5],null,[["@title"],["chat.thread.label"]],null],[1,"\\n\\n  "],[8,[39,6],null,[["@drawerActions"],[[30,1]]],null],[1,"\\n"]],[]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"  "],[11,0],[24,0,"chat-drawer-content"],[4,[38,7],[[30,0,["fetchChannelAndThread"]]],null],[4,[38,8],[[30,0,["fetchChannelAndThread"]],[30,2,["channelId"]]],null],[4,[38,8],[[30,0,["fetchChannelAndThread"]],[30,2,["threadId"]]],null],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel","activeThread"]],[[[1,"      "],[8,[39,9],null,[["@thread","@targetMessageId"],[[30,0,["chat","activeChannel","activeThread"]],[30,2,["messageId"]]]],null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@drawerActions","@params"],false,["chat-drawer/header","if","and","chat-drawer/header/back-link","i18n","chat-drawer/header/title","chat-drawer/header/right-actions","did-insert","did-update","chat-thread"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/thread.hbs",isStrictMode:!1})
let b=(s=class extends n.default{constructor(){super(...arguments),h(this,"appEvents",o,this),h(this,"chat",l,this),h(this,"chatStateManager",c,this),h(this,"chatChannelsManager",u,this),h(this,"chatHistory",d,this)}get backLink(){const e={models:this.chat.activeChannel.routeModels}
return"chat.channel.threads"===this.chatHistory.previousRoute?.name?(e.title="chat.return_to_threads_list",e.route="chat.channel.threads"):(e.title="chat.return_to_list",e.route="chat.channel"),e}fetchChannelAndThread(){if(this.args.params?.channelId&&this.args.params?.threadId)return this.chatChannelsManager.find(this.args.params.channelId).then((e=>{this.chat.activeChannel=e,e.threadsManager.find(e.id,this.args.params.threadId).then((e=>{this.chat.activeChannel.activeThread=e}))}))}},o=p(s.prototype,"appEvents",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=p(s.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=p(s.prototype,"chatStateManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(s.prototype,"chatChannelsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=p(s.prototype,"chatHistory",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(s.prototype,"fetchChannelAndThread",[a.action],Object.getOwnPropertyDescriptor(s.prototype,"fetchChannelAndThread"),s.prototype),s)
e.default=b,(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/chat-drawer/threads",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service","@ember/object"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,i.createTemplateFactory)({id:"vYLqBvE6",block:'[[[8,[39,0],null,[["@toggleExpand"],[[30,1,["toggleExpand"]]]],[["default"],[[[[1,"\\n"],[41,[28,[37,2],[[30,0,["chatStateManager","isDrawerExpanded"]],[30,0,["chat","activeChannel"]]],null],[[[1,"    "],[10,0],[14,0,"chat-drawer-header__left-actions"],[12],[1,"\\n      "],[10,0],[14,0,"chat-drawer-header__top-line"],[12],[1,"\\n        "],[8,[39,3],null,[["@route","@title","@routeModels"],["chat.channel",[28,[37,4],["chat.return_to_list"],null],[30,0,["chat","activeChannel","routeModels"]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[8,[39,5],null,[["@title"],["chat.threads.list"]],null],[1,"\\n\\n  "],[8,[39,6],null,[["@drawerActions"],[[30,1]]],null],[1,"\\n"]],[]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"  "],[11,0],[24,0,"chat-drawer-content"],[4,[38,7],[[30,0,["fetchChannel"]]],null],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel"]],[[[1,"      "],[8,[39,8],null,[["@channel","@includeHeader"],[[30,0,["chat","activeChannel"]],false]],null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@drawerActions"],false,["chat-drawer/header","if","and","chat-drawer/header/back-link","i18n","chat-drawer/header/title","chat-drawer/header/right-actions","did-insert","chat/thread-list"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer/threads.hbs",isStrictMode:!1})
let m=(s=class extends n.default{constructor(){super(...arguments),d(this,"appEvents",o,this),d(this,"chat",l,this),d(this,"chatStateManager",c,this),d(this,"chatChannelsManager",u,this)}fetchChannel(){if(this.args.params?.channelId)return this.chatChannelsManager.find(this.args.params.channelId).then((e=>{this.chat.activeChannel=e}))}},o=h(s.prototype,"appEvents",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=h(s.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(s.prototype,"chatStateManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(s.prototype,"chatChannelsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(s.prototype,"fetchChannel",[a.action],Object.getOwnPropertyDescriptor(s.prototype,"fetchChannel"),s.prototype),s)
e.default=m,(0,t.setComponentTemplate)(p,m)})),define("discourse/plugins/chat/discourse/components/chat-emoji-avatar",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"dtSGV+5d",block:'[[[10,0],[14,0,"chat-emoji-avatar"],[12],[1,"\\n  "],[10,0],[14,0,"chat-emoji-avatar-container"],[12],[1,"\\n    "],[1,[28,[35,0],[[30,1]],null]],[1,"\\n  "],[13],[1,"\\n"],[13]],["@emoji"],false,["replace-emoji"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-emoji-avatar.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,(0,n.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat-emoji-picker",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/template","@ember/object","@ember/service","@glimmer/tracking","discourse/lib/text","discourse-common/lib/debounce","discourse-common/config/environment","discourse-common/utils/decorators","@ember/runloop"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g,f,v,y,_
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function M(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.FITZPATRICK_MODIFIERS=void 0
const z=(0,i.createTemplateFactory)({id:"OMQgv14i",block:'[[[1,"\\n"],[41,[28,[37,1],[[30,0,["chatEmojiPickerManager","picker","context"]],[30,1]],null],[[[1,"  "],[11,0],[16,0,[28,[37,2],["chat-emoji-picker",[30,2],[52,[30,0,["chatEmojiPickerManager","closing"]],"closing"]],null]],[4,[38,3],[[30,0,["addClickOutsideEventListener"]]],null],[4,[38,3],[[30,0,["chatEmojiPickerManager","loadEmojis"]]],null],[4,[38,3],[[52,[30,3],[30,3],[28,[37,4],null,null]]],null],[4,[38,5],[[52,[30,4],[30,4],[28,[37,4],null,null]]],null],[4,[38,5],[[30,0,["removeClickOutsideEventListener"]]],null],[4,[38,6],["keydown",[30,0,["trapKeyDownEvents"]]],null],[12],[1,"\\n    "],[10,0],[14,0,"chat-emoji-picker__filter-container"],[12],[1,"\\n      "],[8,[39,7],[[16,"placeholder",[28,[37,8],["chat.emoji_picker.search_placeholder"],null]],[16,"autofocus",true],[4,[38,3],[[52,[30,0,["site","desktopView"]],[30,0,["focusFilter"]],[28,[37,4],null,null]]],null],[4,[38,3],[[28,[37,11],[[30,0,["didInputFilter"]],[30,0,["chatEmojiPickerManager","picker","initialFilter"]]],null]],null]],[["@class","@value","@filterAction","@icons"],["chat-emoji-picker__filter",[30,0,["chatEmojiPickerManager","picker","initialFilter"]],[28,[37,9],[[30,0],[30,0,["didInputFilter"]]],[["value"],["target.value"]]],[28,[37,10],null,[["left"],["search"]]]]],[["default"],[[[[1,"\\n        "],[11,0],[24,0,"chat-emoji-picker__fitzpatrick-scale"],[24,"role","toolbar"],[4,[38,6],["keyup",[30,0,["didNavigateFitzpatrickScale"]]],null],[12],[1,"\\n"],[41,[30,0,["isExpandedFitzpatrickScale"]],[[[42,[28,[37,13],[[28,[37,13],[[30,0,["fitzpatrickModifiers"]]],null]],null],null,[[[1,"\\n"],[41,[28,[37,14],[[30,5,["scale"]],[30,0,["chatEmojiReactionStore","diversity"]]],null],[[[1,"                "],[11,"button"],[16,"title",[28,[37,15],["t",[30,5,["scale"]]],null]],[24,"tabindex","-1"],[16,0,[28,[37,2],["chat-emoji-picker__fitzpatrick-modifier-btn",[28,[37,15],["t",[30,5,["scale"]]],null]],null]],[24,4,"button"],[4,[38,6],["keyup",[28,[37,11],[[30,0,["didRequestFitzpatrickScale"]],[30,5,["scale"]]],null]],null],[4,[38,6],["click",[28,[37,11],[[30,0,["didRequestFitzpatrickScale"]],[30,5,["scale"]]],null]],null],[12],[1,"\\n                  "],[1,[28,[35,16],["check"],null]],[1,"\\n                "],[13],[1,"\\n"]],[]],null]],[5]],null]],[]],null],[1,"\\n          "],[11,"button"],[16,"title",[28,[37,15],["t",[30,0,["fitzpatrick","scale"]]],null]],[16,0,[28,[37,2],["chat-emoji-picker__fitzpatrick-modifier-btn current",[28,[37,15],["t",[30,0,["chatEmojiReactionStore","diversity"]]],null]],null]],[24,4,"button"],[4,[38,6],["keyup",[30,0,["didToggleFitzpatrickScale"]]],null],[4,[38,6],["click",[30,0,["didToggleFitzpatrickScale"]]],null],[12],[13],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,0,["chatEmojiPickerManager","sections","length"]],[[[41,[28,[37,1],[[30,0,["filteredEmojis"]],null],null],[[[1,"        "],[10,0],[14,0,"chat-emoji-picker__sections-nav"],[12],[1,"\\n          "],[10,0],[14,0,"chat-emoji-picker__sections-nav__indicator"],[15,5,[30,0,["navIndicatorStyle"]]],[12],[13],[1,"\\n\\n"],[42,[28,[37,17],[[30,0,["groups"]]],null],null,[[[1,"            "],[8,[39,18],[[16,0,[28,[37,2],["btn-flat","chat-emoji-picker__section-btn",[52,[28,[37,1],[[30,0,["chatEmojiPickerManager","lastVisibleSection"]],[30,7]],null],"active"]],null]],[24,"tabindex","-1"],[16,5,[30,0,["navBtnStyle"]]],[16,"data-section",[30,7]]],[["@action"],[[28,[37,11],[[30,0,["didRequestSection"]],[30,7]],null]]],[["default"],[[[[1,"\\n"],[41,[28,[37,1],[[30,7],"favorites"],null],[[[1,"                "],[1,[28,[35,19],[":star:"],null]],[1,"\\n"]],[]],[[[1,"                "],[10,"img"],[14,"width","18"],[14,"height","18"],[14,0,"emoji"],[15,"src",[28,[37,20],[[30,6],"0.url"],null]],[12],[13],[1,"\\n"]],[]]],[1,"            "]],[]]]]],[1,"\\n"]],[6,7]],null],[1,"        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[11,0],[24,0,"chat-emoji-picker__scrollable-content"],[4,[38,21],null,null],[12],[1,"\\n        "],[11,0],[24,0,"chat-emoji-picker__sections"],[24,"role","button"],[4,[38,6],["click",[30,0,["didSelectEmoji"]]],null],[4,[38,6],["keydown",[30,0,["onSectionsKeyDown"]]],null],[12],[1,"\\n"],[41,[28,[37,14],[[30,0,["filteredEmojis"]],null],null],[[[1,"            "],[10,0],[14,0,"chat-emoji-picker__section filtered"],[12],[1,"\\n"],[42,[28,[37,13],[[28,[37,13],[[30,0,["filteredEmojis"]]],null]],null],null,[[[1,"                "],[10,"img"],[14,"width","32"],[14,"height","32"],[14,0,"emoji"],[15,"src",[28,[37,22],[[30,8],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"tabindex","0"],[15,"data-emoji",[30,8,["name"]]],[15,"data-tonable",[52,[30,8,["tonable"]],"true"]],[15,"alt",[30,8,["name"]]],[15,"title",[28,[37,23],[[30,8],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"loading","lazy"],[12],[13],[1,"\\n"]],[8]],[[[1,"                "],[10,2],[14,0,"chat-emoji-picker__no-results"],[12],[1,"\\n                  "],[1,[28,[35,8],["chat.emoji_picker.no_results"],null]],[1,"\\n                "],[13],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[42,[28,[37,17],[[30,0,["groups"]]],null],null,[[[1,"            "],[10,0],[15,0,[28,[37,2],["chat-emoji-picker__section",[52,[28,[37,14],[[30,0,["filteredEmojis"]],null],null],"hidden"]],null]],[15,"data-section",[30,10]],[14,"role","region"],[15,"aria-label",[28,[37,8],[[28,[37,15],["chat.emoji_picker.",[30,10]],null]],[["translatedFallback"],[[30,10]]]]],[12],[1,"\\n              "],[10,"h2"],[14,0,"chat-emoji-picker__section-title"],[12],[1,"\\n                "],[1,[28,[35,8],[[28,[37,15],["chat.emoji_picker.",[30,10]],null]],[["translatedFallback"],[[30,10]]]]],[1,"\\n              "],[13],[1,"\\n              "],[10,0],[14,0,"chat-emoji-picker__section-emojis"],[12],[1,"\\n"],[44,[[28,[37,20],[[30,9],"0"],null]],[[[1,"                  "],[10,"img"],[14,"width","32"],[14,"height","32"],[14,0,"emoji"],[15,"src",[28,[37,22],[[30,11],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"tabindex","0"],[15,"data-emoji",[30,11,["name"]]],[15,"data-tonable",[52,[30,11,["tonable"]],"true"]],[15,"alt",[30,11,["name"]]],[15,"title",[28,[37,23],[[30,11],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"loading","lazy"],[12],[13],[1,"\\n"]],[11]]],[1,"\\n"],[41,[28,[37,25],[[30,0,["chatEmojiPickerManager","visibleSections"]],[30,10]],null],[[[42,[28,[37,13],[[28,[37,13],[[30,9]],null]],null],null,[[[41,[28,[37,26],[[30,13],0],null],[[[1,"                      "],[10,"img"],[14,"width","32"],[14,"height","32"],[14,0,"emoji"],[15,"src",[28,[37,22],[[30,12],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"tabindex","-1"],[15,"data-emoji",[30,12,["name"]]],[15,"data-tonable",[52,[30,12,["tonable"]],"true"]],[15,"alt",[30,12,["name"]]],[15,"title",[28,[37,23],[[30,12],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"loading","lazy"],[12],[13],[1,"\\n"]],[]],null]],[12,13]],null]],[]],null],[1,"              "],[13],[1,"\\n            "],[13],[1,"\\n"]],[9,10]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[10,0],[14,0,"spinner medium"],[12],[13],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n\\n"],[41,[28,[37,27],[[30,0,["site","mobileView"]],[28,[37,1],[[30,0,["chatEmojiPickerManager","picker","context"]],"chat-channel-message"],null]],null],[[[1,"    "],[10,0],[14,0,"chat-emoji-picker__backdrop"],[12],[13],[1,"\\n"]],[]],null]],[]],null]],["@context","@class","@didInsert","@willDestroy","fitzpatrick","emojis","section","emoji","emojis","section","emoji","emoji","index"],false,["if","eq","concat-class","did-insert","noop","will-destroy","on","dc-filter-input","i18n","action","hash","fn","each","-track-array","not-eq","concat","d-icon","-each-in","d-button","replace-emoji","get","chat/emoji-picker-scroll-listener","tonable-emoji-url","tonable-emoji-title","let","includes","gt","and"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-emoji-picker.hbs",isStrictMode:!1}),k=[{scale:1,modifier:null},{scale:2,modifier:":t2"},{scale:3,modifier:":t3"},{scale:4,modifier:":t4"},{scale:5,modifier:":t5"},{scale:6,modifier:":t6"}]
e.FITZPATRICK_MODIFIERS=k
let O=(p=class extends n.default{constructor(){super(...arguments),w(this,"chatEmojiPickerManager",m,this),w(this,"emojiPickerScrollObserver",b,this),w(this,"chatEmojiReactionStore",g,this),w(this,"capabilities",f,this),w(this,"site",v,this),w(this,"filteredEmojis",y,this),w(this,"isExpandedFitzpatrickScale",_,this),j(this,"fitzpatrickModifiers",k)}get groups(){const e=this.chatEmojiPickerManager.emojis
return{...{favorites:this.chatEmojiReactionStore.favorites.filter((e=>!this.site.denied_emojis?.includes(e))).map((e=>({name:e,group:"favorites",url:(0,l.emojiUrlFor)(e)})))},...e}}get flatEmojis(){if(!this.chatEmojiPickerManager.emojis)return[]
let{favorites:e,...t}=this.chatEmojiPickerManager.emojis
return Object.values(t).flat()}get navIndicatorStyle(){const e=this.chatEmojiPickerManager.lastVisibleSection,t=Object.keys(this.groups).indexOf(e)
return(0,r.htmlSafe)(`width: ${100/Object.keys(this.groups).length}%; transform: translateX(${100*t}%);`)}get navBtnStyle(){return(0,r.htmlSafe)(`width: ${100/Object.keys(this.groups).length}%;`)}trapKeyDownEvents(e){"Escape"===e.key&&this.chatEmojiPickerManager.close(),"ArrowUp"===e.key&&e.stopPropagation(),"ArrowDown"===e.key&&e.target.classList.contains("dc-filter-input")&&(e.stopPropagation(),e.preventDefault(),document.querySelector('.chat-emoji-picker__scrollable-content .emoji[tabindex="0"]')?.focus())}didNavigateFitzpatrickScale(e){if("keyup"!==e.type)return
const t=[...e.target.closest(".chat-emoji-picker__fitzpatrick-scale")?.querySelectorAll(".chat-emoji-picker__fitzpatrick-modifier-btn")||[]]
"ArrowRight"===e.key&&(e.preventDefault(),e.target===t[t.length-1]?t[0].focus():e.target.nextElementSibling?.focus()),"ArrowLeft"===e.key&&(e.preventDefault(),e.target===t[0]?t[t.length-1].focus():e.target.previousElementSibling?.focus())}didToggleFitzpatrickScale(e){if("keyup"===e.type){if("Escape"===e.key)return e.preventDefault(),void(this.isExpandedFitzpatrickScale=!1)
if("Enter"!==e.key)return}this.isExpandedFitzpatrickScale=!this.isExpandedFitzpatrickScale}didRequestFitzpatrickScale(e,t){if("keyup"===t.type){if("Escape"===t.key)return t.preventDefault(),t.stopPropagation(),this.isExpandedFitzpatrickScale=!1,void this._focusCurrentFitzpatrickScale()
if("Enter"!==t.key)return}t.preventDefault(),t.stopPropagation(),this.isExpandedFitzpatrickScale=!1,this.chatEmojiReactionStore.diversity=e,this._focusCurrentFitzpatrickScale()}_focusCurrentFitzpatrickScale(){(0,h.schedule)("afterRender",(()=>{document.querySelector(".chat-emoji-picker__fitzpatrick-modifier-btn.current")?.focus()}))}didInputFilter(e){e?.length?(0,c.default)(this,this.debouncedDidInputFilter,e,u.INPUT_DELAY):this.filteredEmojis=null}focusFilter(e){(0,h.schedule)("afterRender",(()=>{e?.focus()}))}debouncedDidInputFilter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:""
e=e.toLowerCase(),this.filteredEmojis=this.flatEmojis.filter((t=>t.name.toLowerCase().includes(e)||t.search_aliases?.any((t=>t.toLowerCase().includes(e))))),(0,h.schedule)("afterRender",(()=>{const e=document.querySelector(".chat-emoji-picker__scrollable-content")
e&&(e.scrollTop=0)}))}onSectionsKeyDown(e){"Enter"===e.key?this.didSelectEmoji(e):this.didNavigateSection(e)}didNavigateSection(e){const t=e=>[...e.querySelectorAll(".emoji")],i=e=>{t(e)[0].focus()},n=e.target.closest(".chat-emoji-picker__section"),r=()=>{document.querySelector(".dc-filter-input")?.focus()},a=()=>[...document.querySelectorAll(".chat-emoji-picker__section:not(.hidden) .emoji")]
if("ArrowRight"===e.key){e.preventDefault()
const t=e.target.nextElementSibling
if(t)t.focus()
else{const e=n.nextElementSibling
e&&i(e)}}if("ArrowLeft"===e.key){e.preventDefault()
const i=e.target.previousElementSibling
if(i)i.focus()
else{const e=n.previousElementSibling
e?(e=>{const i=t(e)
i[i.length-1].focus()})(e):r()}}if("ArrowDown"===e.key){e.preventDefault(),e.stopPropagation()
const t=a().filter((t=>t.offsetTop>e.target.offsetTop)).findBy("offsetLeft",e.target.offsetLeft)
if(t)t.focus()
else{const e=n.nextElementSibling
e&&i(e)}}if("ArrowUp"===e.key){e.preventDefault(),e.stopPropagation()
const t=a().reverse().filter((t=>t.offsetTop<e.target.offsetTop)).findBy("offsetLeft",e.target.offsetLeft)
t?t.focus():r()}}didSelectEmoji(e){if(e.target.classList.contains("emoji")&&("click"===e.type||"Enter"===e.key)){e.preventDefault(),e.stopPropagation()
let t=e.target.dataset.emoji
const i=e.target.dataset.tonable,n=this.chatEmojiReactionStore.diversity
i&&n>1&&(t=`${t}:t${n}`),this.args.didSelectEmoji?.(t)}}didRequestSection(e){const t=document.querySelector(".chat-emoji-picker__scrollable-content")
this.filteredEmojis=null,this.emojiPickerScrollObserver.enabled=!1,this.chatEmojiPickerManager.addVisibleSections([e]),this.chatEmojiPickerManager.lastVisibleSection=e,t&&this.capabilities.isIOS&&(document.querySelector(".chat-emoji-picker__scrollable-content").style.overflow="hidden"),(0,h.schedule)("afterRender",(()=>{const i=document.querySelector(`.chat-emoji-picker__section[data-section="${e}"] .emoji:nth-child(1)`);([...document.querySelectorAll(`.chat-emoji-picker__section[data-section="${e}"] .emoji`)].find((e=>e.offsetTop>i.offsetTop))||i).focus(),(0,h.later)((()=>{t&&this.capabilities.isIOS&&(document.querySelector(".chat-emoji-picker__scrollable-content").style.overflow="scroll"),this.emojiPickerScrollObserver.enabled=!0}),200)}))}addClickOutsideEventListener(){document.addEventListener("click",this.didClickOutside)}removeClickOutsideEventListener(){document.removeEventListener("click",this.didClickOutside)}didClickOutside(e){e.target.closest(".chat-emoji-picker")||this.chatEmojiPickerManager.close()}},m=M(p.prototype,"chatEmojiPickerManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=M(p.prototype,"emojiPickerScrollObserver",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=M(p.prototype,"chatEmojiReactionStore",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=M(p.prototype,"capabilities",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=M(p.prototype,"site",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=M(p.prototype,"filteredEmojis",[o.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=M(p.prototype,"isExpandedFitzpatrickScale",[o.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M(p.prototype,"trapKeyDownEvents",[a.action],Object.getOwnPropertyDescriptor(p.prototype,"trapKeyDownEvents"),p.prototype),M(p.prototype,"didNavigateFitzpatrickScale",[a.action],Object.getOwnPropertyDescriptor(p.prototype,"didNavigateFitzpatrickScale"),p.prototype),M(p.prototype,"didToggleFitzpatrickScale",[a.action],Object.getOwnPropertyDescriptor(p.prototype,"didToggleFitzpatrickScale"),p.prototype),M(p.prototype,"didRequestFitzpatrickScale",[a.action],Object.getOwnPropertyDescriptor(p.prototype,"didRequestFitzpatrickScale"),p.prototype),M(p.prototype,"didInputFilter",[a.action],Object.getOwnPropertyDescriptor(p.prototype,"didInputFilter"),p.prototype),M(p.prototype,"focusFilter",[a.action],Object.getOwnPropertyDescriptor(p.prototype,"focusFilter"),p.prototype),M(p.prototype,"onSectionsKeyDown",[a.action],Object.getOwnPropertyDescriptor(p.prototype,"onSectionsKeyDown"),p.prototype),M(p.prototype,"didNavigateSection",[a.action],Object.getOwnPropertyDescriptor(p.prototype,"didNavigateSection"),p.prototype),M(p.prototype,"didSelectEmoji",[a.action],Object.getOwnPropertyDescriptor(p.prototype,"didSelectEmoji"),p.prototype),M(p.prototype,"didRequestSection",[a.action],Object.getOwnPropertyDescriptor(p.prototype,"didRequestSection"),p.prototype),M(p.prototype,"addClickOutsideEventListener",[a.action],Object.getOwnPropertyDescriptor(p.prototype,"addClickOutsideEventListener"),p.prototype),M(p.prototype,"removeClickOutsideEventListener",[a.action],Object.getOwnPropertyDescriptor(p.prototype,"removeClickOutsideEventListener"),p.prototype),M(p.prototype,"didClickOutside",[d.bind],Object.getOwnPropertyDescriptor(p.prototype,"didClickOutside"),p.prototype),p)
e.default=O,(0,t.setComponentTemplate)(z,O)})),define("discourse/plugins/chat/discourse/components/chat-full-page-header",["exports","@ember/component","@ember/template-factory","@ember/service","@glimmer/component"],(function(e,t,i,n,r){"use strict"
var a,s,o,l
function c(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,i.createTemplateFactory)({id:"yVLEOr2Q",block:'[[[41,[28,[37,1],[[30,0,["chatStateManager","isFullPageActive"]],[30,0,["displayed"]]],null],[[[1,"  "],[10,0],[15,0,[28,[37,2],["chat-full-page-header",[52,[51,[30,1,["isFollowing"]]],"-not-following"]],null]],[12],[1,"\\n    "],[10,0],[14,0,"chat-channel-header-details"],[12],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"        "],[10,0],[14,0,"chat-full-page-header__left-actions"],[12],[1,"\\n          "],[8,[39,4],[[24,0,"chat-full-page-header__back-btn no-text btn-flat"]],[["@route"],["chat"]],[["default"],[[[[1,"\\n            "],[1,[28,[35,5],["chevron-left"],null]],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[8,[39,4],[[24,0,"chat-channel-title-wrapper"]],[["@route","@models"],["chat.channel.info",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n        "],[8,[39,6],null,[["@channel"],[[30,1]]],null],[1,"\\n      "]],[]]]]],[1,"\\n\\n"],[41,[28,[37,7],[[30,1,["threadingEnabled"]],[30,0,["site","desktopView"]]],null],[[[1,"        "],[10,0],[14,0,"chat-full-page-header__right-actions"],[12],[1,"\\n"],[41,[30,0,["site","desktopView"]],[[[1,"            "],[8,[39,8],[[24,0,"open-drawer-btn btn-flat"]],[["@icon","@title","@action"],["discourse-compress","chat.close_full_page",[30,2]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["showThreadsListButton"]],[[[1,"            "],[8,[39,9],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,10],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]],null]],["@channel","@onCloseFullScreen"],false,["if","and","concat-class","unless","link-to","d-icon","chat-channel-title","or","d-button","chat/thread/threads-list-button","chat-channel-status"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-full-page-header.hbs",isStrictMode:!1})
let h=(a=class extends r.default{constructor(){super(...arguments),c(this,"site",s,this),c(this,"chatStateManager",o,this),c(this,"router",l,this)}get displayed(){return this.args.displayed??!0}get showThreadsListButton(){return this.args.channel.threadingEnabled&&"chat.channel.threads"!==this.router.currentRoute.name&&"chat.channel.thread"!==this.router.currentRoute.name}},s=u(a.prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=u(a.prototype,"chatStateManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=u(a.prototype,"router",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a)
e.default=h,(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/chat-mention-warnings",["exports","@ember/component","@ember/template-factory","@glimmer/component","I18n","@ember/template","@ember/service","discourse-common/lib/get-url"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,i.createTemplateFactory)({id:"erC4zNkm",block:'[[[41,[30,0,["show"]],[[[1,"  "],[10,0],[14,0,"chat-mention-warnings"],[12],[1,"\\n    "],[10,0],[14,0,"chat-mention-warning__icon"],[12],[1,"\\n      "],[1,[28,[35,1],["exclamation-triangle"],null]],[1,"\\n    "],[13],[1,"\\n    "],[10,0],[14,0,"chat-mention-warning__text"],[12],[1,"\\n      "],[10,0],[14,0,"chat-mention-warning__header"],[12],[1,"\\n        "],[1,[30,0,["warningHeaderText"]]],[1,"\\n      "],[13],[1,"\\n      "],[10,"ul"],[15,0,[30,0,["listStyleClass"]]],[12],[1,"\\n"],[41,[30,0,["hasTooManyMentions"]],[[[1,"          "],[10,"li"],[12],[1,[30,0,["tooManyMentionsBody"]]],[13],[1,"\\n"]],[]],[[[41,[30,0,["hasUnreachableGroupMentions"]],[[[1,"            "],[10,"li"],[12],[1,[30,0,["unreachableBody"]]],[13],[1,"\\n"]],[]],null],[41,[30,0,["hasOverMembersLimitGroupMentions"]],[[[1,"            "],[10,"li"],[12],[1,[30,0,["overMembersLimitBody"]]],[13],[1,"\\n"]],[]],null]],[]]],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if","d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-mention-warnings.hbs",isStrictMode:!1})
let b=(l=class extends n.default{constructor(){super(...arguments),h(this,"siteSettings",c,this),h(this,"currentUser",u,this),h(this,"chatComposerWarningsTracker",d,this)}get unreachableGroupMentions(){return this.chatComposerWarningsTracker.unreachableGroupMentions}get overMembersLimitGroupMentions(){return this.chatComposerWarningsTracker.overMembersLimitGroupMentions}get hasTooManyMentions(){return this.chatComposerWarningsTracker.tooManyMentions}get mentionsCount(){return this.chatComposerWarningsTracker.mentionsCount}get unreachableGroupMentionsCount(){return this.unreachableGroupMentions.length}get overMembersLimitMentionsCount(){return this.overMembersLimitGroupMentions.length}get hasUnreachableGroupMentions(){return this.unreachableGroupMentionsCount>0}get hasOverMembersLimitGroupMentions(){return this.overMembersLimitMentionsCount>0}get warningsCount(){return this.unreachableGroupMentionsCount+this.overMembersLimitMentionsCount}get show(){return this.hasTooManyMentions||this.hasUnreachableGroupMentions||this.hasOverMembersLimitGroupMentions}get listStyleClass(){return this.hasTooManyMentions?"chat-mention-warnings-list__simple":this.warningsCount>1?"chat-mention-warnings-list__multiple":"chat-mention-warnings-list__simple"}get warningHeaderText(){return this.mentionsCount<=this.warningsCount||this.hasTooManyMentions?r.default.t("chat.mention_warning.groups.header.all"):r.default.t("chat.mention_warning.groups.header.some")}get tooManyMentionsBody(){if(this.hasTooManyMentions)return this.currentUser.admin?(0,a.htmlSafe)(r.default.t("chat.mention_warning.too_many_mentions_admin",{count:this.siteSettings.max_mentions_per_chat_message,siteSettingUrl:(0,o.default)("/admin/site_settings/category/plugins?filter=max_mentions_per_chat_message")})):(0,a.htmlSafe)(r.default.t("chat.mention_warning.too_many_mentions",{count:this.siteSettings.max_mentions_per_chat_message}))}get unreachableBody(){if(this.hasUnreachableGroupMentions)switch(this.unreachableGroupMentionsCount){case 1:return r.default.t("chat.mention_warning.groups.unreachable_1",{group:this.unreachableGroupMentions[0]})
case 2:return r.default.t("chat.mention_warning.groups.unreachable_2",{group1:this.unreachableGroupMentions[0],group2:this.unreachableGroupMentions[1]})
default:return r.default.t("chat.mention_warning.groups.unreachable_multiple",{group:this.unreachableGroupMentions[0],count:this.unreachableGroupMentionsCount-1})}}get overMembersLimitBody(){if(this.hasOverMembersLimitGroupMentions)return(0,a.htmlSafe)(r.default.messageFormat("chat.mention_warning.groups.too_many_members_MF",{groupCount:this.overMembersLimitMentionsCount,isAdmin:this.currentUser.admin,siteSettingUrl:(0,o.default)("/admin/site_settings/category/plugins?filter=max_users_notified_per_group_mention"),notificationLimit:this.siteSettings.max_users_notified_per_group_mention,group1:this.overMembersLimitGroupMentions[0],group2:this.overMembersLimitGroupMentions[1]}))}},c=p(l.prototype,"siteSettings",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(l.prototype,"currentUser",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=p(l.prototype,"chatComposerWarningsTracker",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l)
e.default=b,(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/chat-message-actions-desktop",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service","discourse/plugins/chat/discourse/lib/chat-message-interactor","@ember/application","@ember/runloop","@popperjs/core","discourse/plugins/chat/discourse/lib/chat-message-container","@ember/object","@glimmer/tracking"],(function(e,t,i,n,r,a,s,o,l,c,u,d){"use strict"
var h,p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const _=(0,i.createTemplateFactory)({id:"4pnWHhEE",block:'[[[41,[28,[37,1],[[30,0,["site","desktopView"]],[30,0,["chat","activeMessage","model","id"]]],null],[[[1,"  "],[11,0],[16,0,[28,[37,2],["chat-message-actions-container",[28,[37,3],["is-size-",[30,0,["size"]]],null]],null]],[16,"data-id",[30,0,["message","id"]]],[4,[38,4],[[30,0,["setup"]]],null],[4,[38,5],[[30,0,["setup"]],[30,0,["chat","activeMessage","model","id"]]],null],[4,[38,6],["mouseleave",[30,0,["onMouseleave"]]],null],[4,[38,6],["wheel",[30,0,["onWheel"]]],[["passive"],[true]]],[4,[38,7],[[30,0,["teardown"]]],null],[12],[1,"\\n    "],[10,0],[15,0,[28,[37,2],["chat-message-actions",[52,[51,[30,0,["messageInteractor","secondaryActions","length"]]],"has-no-secondary-actions"]],null]],[12],[1,"\\n"],[41,[30,0,["shouldRenderFavoriteReactions"]],[[[42,[28,[37,10],[[28,[37,10],[[30,0,["messageInteractor","emojiReactions"]]],null]],null],"emoji",[[[1,"          "],[8,[39,11],null,[["@reaction","@onReaction","@message","@showCount"],[[30,1],[30,0,["messageInteractor","react"]],[30,0,["message"]],false]],null],[1,"\\n"]],[1]],null]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canInteractWithMessage"]],[[[1,"        "],[8,[39,12],null,[["@class","@action","@icon","@title","@forwardEvent"],["btn-flat react-btn",[30,0,["messageInteractor","openEmojiPicker"]],"discourse-emojis","chat.react",true]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canBookmark"]],[[[1,"        "],[8,[39,12],null,[["@class","@action"],["btn-flat bookmark-btn",[30,0,["messageInteractor","toggleBookmark"]]]],[["default"],[[[[1,"\\n          "],[8,[39,13],null,[["@bookmark"],[[30,0,["message","bookmark"]]]],null],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canReply"]],[[[1,"        "],[8,[39,12],null,[["@class","@action","@icon","@title"],["btn-flat reply-btn",[30,0,["messageInteractor","reply"]],"reply","chat.reply"]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[28,[37,1],[[30,0,["messageInteractor","message"]],[30,0,["messageInteractor","secondaryActions","length"]]],null],[[[1,"        "],[8,[39,14],null,[["@class","@options","@content","@onChange"],["more-buttons secondary-actions",[28,[37,15],null,[["icon","placement"],["ellipsis-v","left"]]],[30,0,["messageInteractor","secondaryActions"]],[28,[37,16],[[30,0],[30,0,["messageInteractor","handleSecondaryActions"]]],null]]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["reaction"],false,["if","and","concat-class","concat","did-insert","did-update","on","will-destroy","unless","each","-track-array","chat-message-reaction","d-button","bookmark-icon","dropdown-select-box","hash","action"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-actions-desktop.hbs",isStrictMode:!1}),w="full"
let j=(h=class extends n.default{constructor(){super(...arguments),f(this,"chat",p,this),f(this,"chatEmojiPickerManager",m,this),f(this,"site",b,this),f(this,"size",g,this),v(this,"popper",null)}get message(){return this.chat.activeMessage.model}get context(){return this.chat.activeMessage.context}get messageInteractor(){return new a.default((0,s.getOwner)(this),this.message,this.context)}get shouldRenderFavoriteReactions(){return this.size===w}onWheel(){this.chat.activeMessage=null}onMouseleave(e){(e.toElement||e.relatedTarget)?.closest(".chat-message-container")||(this.chat.activeMessage=null)}setup(e){this.popper?.destroy(),(0,o.schedule)("afterRender",(()=>{const t=(0,c.default)(this.message.id,this.context)
if(!t)return
const i=t.closest(".popper-viewport")
this.size=i.clientWidth<500?"reduced":w,t&&(this.popper=(0,l.createPopper)(t,e,{placement:"top-end",strategy:"fixed",modifiers:[{name:"flip",enabled:!0,options:{boundary:i,fallbackPlacements:["bottom-end"]}},{name:"hide",enabled:!0},{name:"eventListeners",options:{scroll:!1}},{name:"offset",options:{offset:[-2,-10]}}]}))}))}teardown(){this.popper?.destroy(),this.popper=null}},p=y(h.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=y(h.prototype,"chatEmojiPickerManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=y(h.prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=y(h.prototype,"size",[d.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return w}}),y(h.prototype,"onWheel",[u.action],Object.getOwnPropertyDescriptor(h.prototype,"onWheel"),h.prototype),y(h.prototype,"onMouseleave",[u.action],Object.getOwnPropertyDescriptor(h.prototype,"onMouseleave"),h.prototype),y(h.prototype,"setup",[u.action],Object.getOwnPropertyDescriptor(h.prototype,"setup"),h.prototype),y(h.prototype,"teardown",[u.action],Object.getOwnPropertyDescriptor(h.prototype,"teardown"),h.prototype),h)
e.default=j,(0,t.setComponentTemplate)(_,j)})),define("discourse/plugins/chat/discourse/components/chat-message-actions-mobile",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/plugins/chat/discourse/lib/chat-message-interactor","discourse-common/lib/get-owner","@glimmer/tracking","discourse-common/lib/later","@ember/object","discourse-common/config/environment","@ember/service"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g,f,v,y
function _(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function w(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function j(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function M(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const z=(0,i.createTemplateFactory)({id:"iJT8q6yM",block:'[[[41,[28,[37,1],[[30,0,["site","mobileView"]],[30,0,["chat","activeMessage"]]],null],[[[1,"  "],[11,0],[16,0,[28,[37,2],["chat-message-actions-backdrop",[52,[30,0,["showFadeIn"]],"fade-in"]],null]],[4,[38,3],[[30,0,["fadeAndVibrate"]]],null],[12],[1,"\\n    "],[11,0],[24,"role","button"],[24,0,"collapse-area"],[4,[38,4],["touchstart",[30,0,["collapseMenu"]]],[["passive","bubbles"],[false,false]]],[12],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-message-actions"],[12],[1,"\\n      "],[10,0],[14,0,"selected-message-container"],[12],[1,"\\n        "],[10,0],[14,0,"selected-message"],[12],[1,"\\n          "],[8,[39,5],null,[["@user"],[[30,0,["message","user"]]]],null],[1,"\\n          "],[11,1],[24,"role","button"],[16,0,[28,[37,2],["selected-message-reply",[52,[30,0,["hasExpandedReply"]],"is-expanded"]],null]],[4,[38,4],["touchstart",[30,0,["expandReply"]]],[["passive"],[true]]],[12],[1,"\\n            "],[1,[30,0,["message","message"]]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,"ul"],[14,0,"secondary-actions"],[12],[1,"\\n"],[42,[28,[37,7],[[28,[37,7],[[30,0,["messageInteractor","secondaryActions"]]],null]],null],null,[[[1,"          "],[10,"li"],[14,0,"chat-message-action-item"],[15,"data-id",[30,1,["id"]]],[12],[1,"\\n            "],[8,[39,8],null,[["@class","@translatedLabel","@icon","@actionParam","@action"],["chat-message-action",[30,1,["name"]],[30,1,["icon"]],[30,1,["id"]],[28,[37,9],[[30,0],[30,0,["actAndCloseMenu"]],[30,1,["id"]]],null]]],null],[1,"\\n          "],[13],[1,"\\n"]],[1]],null],[1,"      "],[13],[1,"\\n\\n"],[41,[28,[37,10],[[30,0,["messageInteractor","canReact"]],[30,0,["messageInteractor","canReply"]]],null],[[[1,"        "],[10,0],[14,0,"main-actions"],[12],[1,"\\n"],[41,[30,0,["messageInteractor","canReact"]],[[[42,[28,[37,7],[[28,[37,7],[[30,0,["messageInteractor","emojiReactions"]]],null]],null],null,[[[1,"              "],[8,[39,11],null,[["@reaction","@onReaction","@message","@showCount"],[[30,2],[30,0,["messageInteractor","react"]],[30,0,["message"]],false]],null],[1,"\\n"]],[2]],null],[1,"\\n            "],[8,[39,8],[[24,"data-id","react"]],[["@class","@action","@icon","@title","@forwardEvent"],["btn-flat react-btn",[30,0,["openEmojiPicker"]],"discourse-emojis","chat.react",true]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canBookmark"]],[[[1,"            "],[8,[39,8],[[24,"data-id","bookmark"]],[["@class","@action"],["btn-flat bookmark-btn",[28,[37,9],[[30,0],[30,0,["actAndCloseMenu"]],"toggleBookmark"],null]]],[["default"],[[[[1,"\\n              "],[8,[39,12],null,[["@bookmark"],[[30,0,["message","bookmark"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canReply"]],[[[1,"            "],[8,[39,8],[[24,"data-id","reply"]],[["@class","@action","@icon","@title"],["chat-message-action reply-btn btn-flat",[28,[37,9],[[30,0],[30,0,["actAndCloseMenu"]],"reply"],null],"reply","chat.reply"]],null],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["button","reaction"],false,["if","and","concat-class","did-insert","on","chat/user-avatar","each","-track-array","d-button","action","or","chat-message-reaction","bookmark-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-actions-mobile.hbs",isStrictMode:!1})
let k=(f=new WeakSet,v=new WeakSet,y=new WeakSet,d=class extends n.default{constructor(){super(...arguments),w(this,y),w(this,v),w(this,f),_(this,"chat",h,this),_(this,"site",p,this),_(this,"capabilities",m,this),_(this,"hasExpandedReply",b,this),_(this,"showFadeIn",g,this)}get message(){return this.chat.activeMessage.model}get context(){return this.chat.activeMessage.context}get messageInteractor(){return new r.default((0,a.getOwner)(this),this.message,this.context)}fadeAndVibrate(){(0,o.default)(j(this,v,C).bind(this)),this.capabilities.canVibrate&&!(0,c.isTesting)()&&navigator.vibrate(5)}expandReply(e){e.stopPropagation(),this.hasExpandedReply=!0}collapseMenu(e){e.preventDefault(),j(this,f,O).call(this)}actAndCloseMenu(e){this.messageInteractor[e](),j(this,f,O).call(this)}openEmojiPicker(e,t){this.messageInteractor.openEmojiPicker(e,t),j(this,f,O).call(this)}},h=M(d.prototype,"chat",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=M(d.prototype,"site",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=M(d.prototype,"capabilities",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=M(d.prototype,"hasExpandedReply",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=M(d.prototype,"showFadeIn",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M(d.prototype,"fadeAndVibrate",[l.action],Object.getOwnPropertyDescriptor(d.prototype,"fadeAndVibrate"),d.prototype),M(d.prototype,"expandReply",[l.action],Object.getOwnPropertyDescriptor(d.prototype,"expandReply"),d.prototype),M(d.prototype,"collapseMenu",[l.action],Object.getOwnPropertyDescriptor(d.prototype,"collapseMenu"),d.prototype),M(d.prototype,"actAndCloseMenu",[l.action],Object.getOwnPropertyDescriptor(d.prototype,"actAndCloseMenu"),d.prototype),M(d.prototype,"openEmojiPicker",[l.action],Object.getOwnPropertyDescriptor(d.prototype,"openEmojiPicker"),d.prototype),d)
function O(){j(this,y,S).call(this),(0,o.default)((()=>{this.isDestroying||this.isDestroyed||(this.chat.activeMessage=null)}),200)}function C(){this.showFadeIn=!0}function S(){this.showFadeIn=!1}e.default=k,(0,t.setComponentTemplate)(z,k)})),define("discourse/plugins/chat/discourse/components/chat-message-collapser",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/template","@ember/service","discourse/lib/utilities","discourse-common/lib/dom-from-string","I18n"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.isCollapsible=function(e,t){const i=Array.prototype.slice.call((0,o.default)(e))
return _(i)||M(i)||z(t)||O(i)||S(i)}
const d=(0,i.createTemplateFactory)({id:"0kb4UYGW",block:'[[[10,0],[14,0,"chat-message-collapser"],[12],[1,"\\n"],[41,[30,0,["hasUploads"]],[[[1,"    "],[1,[28,[35,1],[[30,1]],null]],[1,"\\n\\n    "],[8,[39,2],null,[["@header","@onToggle"],[[30,0,["uploadsHeader"]],[30,2]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-uploads"],[12],[1,"\\n"],[42,[28,[37,4],[[28,[37,4],[[30,3]],null]],null],null,[[[1,"          "],[8,[39,5],null,[["@upload"],[[30,4]]],null],[1,"\\n"]],[4]],null],[1,"      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],[[[42,[28,[37,4],[[28,[37,4],[[30,0,["cookedBodies"]]],null]],null],null,[[[41,[30,5,["needsCollapser"]],[[[1,"        "],[8,[39,2],null,[["@header","@onToggle"],[[30,5,["header"]],[30,2]]],[["default"],[[[[1,"\\n"],[41,[30,5,["videoAttributes"]],[[[1,"            "],[10,0],[14,0,"chat-message-collapser-lazy-video"],[12],[1,"\\n              "],[8,[39,6],null,[["@videoAttributes"],[[30,5,["videoAttributes"]]]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[1,"            "],[1,[30,5,["body"]]],[1,"\\n"]],[]]],[1,"        "]],[]]]]],[1,"\\n"]],[]],[[[1,"        "],[1,[30,5,["body"]]],[1,"\\n"]],[]]]],[5]],null]],[]]],[13]],["@cooked","@onToggleCollapse","@uploads","upload","cooked"],false,["if","html-safe","collapser","each","-track-array","chat-upload","lazy-video"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-collapser.hbs",isStrictMode:!1})
let h=(c=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="siteSettings",n=this,(i=u)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get hasUploads(){return z(this.args.uploads)}get uploadsHeader(){let e=""
return e=1===this.args.uploads.length?this.args.uploads[0].original_filename:l.default.t("chat.uploaded_files",{count:this.args.uploads.length}),(0,r.htmlSafe)(`<span class="chat-message-collapser-link-small">${(0,s.escapeExpression)(e)}</span>`)}get cookedBodies(){const e=Array.prototype.slice.call((0,o.default)(this.args.cooked))
return _(e)?this.lazyVideoCooked(e):M(e)?this.imageOneboxCooked(e):O(e)?this.imageCooked(e):S(e)?this.galleryCooked(e):[]}lazyVideoCooked(e){return e.reduce(((e,t)=>{if(this.siteSettings.lazy_videos_enabled&&y(t)){const i=(0,requirejs("discourse/plugins/discourse-lazy-videos/lib/lazy-video-attributes").default)(t)
if(this.siteSettings[`lazy_${i.providerName}_enabled`]){const n=(0,s.escapeExpression)(i.url),a=i.title,o=(0,r.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link" rel="noopener noreferrer" href="${n}">${a}</a>`)
e.push({header:o,body:t,videoAttributes:i,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})}else e.push({body:t,needsCollapser:!1})
return e}),[])}imageOneboxCooked(e){return e.reduce(((e,t)=>{if(j(t)){let i=w(t)?t.firstChild.src:t.firstElementChild.href
i=(0,s.escapeExpression)(i)
const n=(0,r.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link-small" rel="noopener noreferrer" href="${i}">${i}</a>`)
e.push({header:n,body:t,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})
return e}),[])}imageCooked(e){return e.reduce(((e,t)=>{if(k(t)){const i=(0,s.escapeExpression)(t.firstElementChild.src),n=(0,s.escapeExpression)(t.firstElementChild.alt),a=(0,r.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link-small" rel="noopener noreferrer" href="${i}">${n||i}</a>`)
e.push({header:a,body:t,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})
return e}),[])}galleryCooked(e){return e.reduce(((e,t)=>{if(C(t)){const i=(0,s.escapeExpression)(t.firstElementChild.href),n=(0,s.escapeExpression)(t.firstElementChild.firstElementChild.textContent)
t.firstElementChild.removeChild(t.firstElementChild.firstElementChild)
const a=(0,r.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link-small" rel="noopener noreferrer" href="${i}">${n}</a>`)
e.push({header:a,body:t,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})
return e}),[])}},p=c.prototype,m="siteSettings",b=[a.inject],g={configurable:!0,enumerable:!0,writable:!0,initializer:null},v={},Object.keys(g).forEach((function(e){v[e]=g[e]})),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=b.slice().reverse().reduce((function(e,t){return t(p,m,e)||e}),v),f&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(f):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(p,m,v),v=null),u=v,c)
var p,m,b,g,f,v
function y(e){return e.classList.contains("lazy-video-container")}function _(e){return e.some((e=>y(e)))}function w(e){return e.firstChild&&"IMG"===e.firstChild.nodeName&&e.firstChild.classList.contains("animated")&&e.firstChild.classList.contains("onebox")}function j(e){return w(e)||function(e){return e.firstElementChild&&"A"===e.firstElementChild.nodeName&&e.firstElementChild.classList.contains("onebox")&&e.firstElementChild.firstElementChild&&"IMG"===e.firstElementChild.firstElementChild.nodeName}(e)}function M(e){return e.some((e=>j(e)))}function z(e){return e?.length>0}function k(e){return"P"===e.nodeName&&e.firstElementChild&&"IMG"===e.firstElementChild.nodeName&&!e.firstElementChild.classList.contains("emoji")}function O(e){return e.some((e=>k(e)))}function C(e){return e.firstElementChild&&"A"===e.firstElementChild.nodeName&&e.firstElementChild.firstElementChild&&e.firstElementChild.firstElementChild.classList.contains("outer-box")}function S(e){return e.some((e=>C(e)))}e.default=h,(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/chat-message-in-reply-to-indicator",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"sXzGraAJ",block:'[[[41,[30,1,["inReplyTo"]],[[[1,"  "],[8,[39,1],[[24,0,"chat-reply is-direct-reply"]],[["@route","@models"],[[30,0,["route"]],[30,0,["model"]]]],[["default"],[[[[1,"\\n    "],[1,[28,[35,2],["share"],[["title"],["chat.in_reply_to"]]]],[1,"\\n\\n"],[41,[30,1,["inReplyTo","chatWebhookEvent","emoji"]],[[[1,"      "],[8,[39,3],null,[["@emoji"],[[30,1,["inReplyTo","chatWebhookEvent","emoji"]]]],null],[1,"\\n"]],[]],[[[1,"      "],[8,[39,4],null,[["@user"],[[30,1,["inReplyTo","user"]]]],null],[1,"\\n"]],[]]],[1,"\\n    "],[10,1],[14,0,"chat-reply__excerpt"],[12],[1,"\\n      "],[1,[28,[35,5],[[28,[37,6],[[30,1,["inReplyTo","excerpt"]]],null]],null]],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]],null]],["@message"],false,["if","link-to","d-icon","chat-emoji-avatar","chat/user-avatar","replace-emoji","html-safe"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-in-reply-to-indicator.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get route(){return this.hasThread?"chat.channel.thread":"chat.channel.near-message"}get model(){return this.hasThread?[...this.args.message.channel.routeModels,this.args.message.thread.id]:[...this.args.message.channel.routeModels,this.args.message.inReplyTo.id]}get hasThread(){return this.args.message?.channel?.threadingEnabled&&this.args.message?.thread?.id}},c=a.prototype,u="router",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat-message-reaction",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object","discourse/lib/text","I18n","@ember/runloop","@ember/service","discourse/lib/d-popover","discourse-common/lib/later","@glimmer/tracking"],(function(e,t,i,n,r,a,s,o,l,c,u,d){"use strict"
var h,p,m,b,g,f,v
function y(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t,i){w(e,t),t.set(e,i)}function w(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function j(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function M(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function z(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const k=(0,i.createTemplateFactory)({id:"ZQvjsw7U",block:'[[[41,[28,[37,1],[[30,1],[30,0,["emojiUrl"]]],null],[[[1,"  "],[11,"button"],[24,"tabindex","0"],[16,0,[28,[37,2],["chat-message-reaction",[52,[30,1,["reacted"]],"reacted"],[52,[30,0,["isActive"]],"-active"]],null]],[16,"data-emoji-name",[30,1,["emoji"]]],[16,"data-tippy-content",[30,0,["popoverContent"]]],[16,"title",[30,0,["emojiString"]]],[24,4,"button"],[4,[38,3],[[30,0,["setup"]]],null],[4,[38,4],[[30,0,["teardown"]]],null],[4,[38,5],[[30,0,["refreshTooltip"]],[30,0,["popoverContent"]]],null],[12],[1,"\\n    "],[10,"img"],[14,"loading","lazy"],[14,0,"emoji"],[14,"width","20"],[14,"height","20"],[15,"alt",[30,0,["emojiString"]]],[15,"src",[30,0,["emojiUrl"]]],[12],[13],[1,"\\n\\n"],[41,[28,[37,1],[[30,0,["showCount"]],[30,1,["count"]]],null],[[[1,"      "],[10,1],[14,0,"count"],[12],[1,[30,1,["count"]]],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@reaction"],false,["if","and","concat-class","did-insert","will-destroy","did-update"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-reaction.hbs",isStrictMode:!1})
let O=(g=new WeakMap,f=new WeakMap,v=new WeakSet,h=class extends n.default{constructor(){var e,t
super(...arguments),w(e=this,t=v),t.add(e),_(this,f,{get:S,set:void 0}),_(this,g,{get:C,set:void 0}),y(this,"capabilities",p,this),y(this,"currentUser",m,this),y(this,"isActive",b,this)}get showCount(){return this.args.showCount??!0}setup(e){this.setupListeners(e),this.setupTooltip(e)}teardown(){(0,o.cancel)(this.longPressHandler),this.teardownTooltip()}setupListeners(e){this.element=e,this.capabilities.touch&&(this.element.addEventListener("touchstart",this.onTouchStart,{passive:!0}),this.element.addEventListener("touchmove",this.cancelTouch,{passive:!0}),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchCancel",this.cancelTouch)),this.element.addEventListener("click",this.handleClick,{passive:!0})}teardownListeners(){this.capabilities.touch&&(this.element.removeEventListener("touchstart",this.onTouchStart,{passive:!0}),this.element.removeEventListener("touchmove",this.cancelTouch,{passive:!0}),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchCancel",this.cancelTouch)),this.element.removeEventListener("click",this.handleClick,{passive:!0})}onTouchStart(e){e.stopPropagation(),this.isActive=!0,this.longPressHandler=(0,u.default)((()=>{this.touching=!1}),400),this.touching=!0}cancelTouch(){(0,o.cancel)(this.longPressHandler),this._tippyInstance?.hide(),this.touching=!1,this.isActive=!1}onTouchEnd(e){e.preventDefault(),this.touching&&this.handleClick(e),(0,o.cancel)(this.longPressHandler),this._tippyInstance?.hide(),this.isActive=!1}setupTooltip(e){this._tippyInstance=(0,c.default)(e,{trigger:"mouseenter",interactive:!1,allowHTML:!0,offset:[0,10],onShow(e){if(""===e.props.content)return!1}})}teardownTooltip(){this._tippyInstance?.destroy()}refreshTooltip(){this._tippyInstance?.setContent(this.popoverContent||"")}get emojiString(){return`:${this.args.reaction.emoji}:`}get emojiUrl(){return(0,a.emojiUrlFor)(this.args.reaction.emoji)}handleClick(e){e.stopPropagation(),this.args.onReaction?.(this.args.reaction.emoji,this.args.reaction.reacted?"remove":"add"),this._tippyInstance?.clearDelayTimeouts()}get popoverContent(){if(this.args.reaction.count&&this.args.reaction.users?.length)return(0,a.emojiUnescape)(this.args.reaction.reacted?M(this,g):M(this,f))}},p=z(h.prototype,"capabilities",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=z(h.prototype,"currentUser",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=z(h.prototype,"isActive",[d.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),z(h.prototype,"setup",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"setup"),h.prototype),z(h.prototype,"teardown",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"teardown"),h.prototype),z(h.prototype,"setupListeners",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"setupListeners"),h.prototype),z(h.prototype,"teardownListeners",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"teardownListeners"),h.prototype),z(h.prototype,"onTouchStart",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"onTouchStart"),h.prototype),z(h.prototype,"cancelTouch",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"cancelTouch"),h.prototype),z(h.prototype,"onTouchEnd",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"onTouchEnd"),h.prototype),z(h.prototype,"setupTooltip",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"setupTooltip"),h.prototype),z(h.prototype,"teardownTooltip",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"teardownTooltip"),h.prototype),z(h.prototype,"refreshTooltip",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"refreshTooltip"),h.prototype),z(h.prototype,"handleClick",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"handleClick"),h.prototype),h)
function C(){const e=this.args.reaction.count
if(0===e)return
if(1===e)return s.default.t("chat.reactions.only_you",{emoji:this.args.reaction.emoji})
const t=this.args.reaction.users.filter((e=>e.id!==this.currentUser?.id)).slice(0,5).mapBy("username")
if(2===e)return s.default.t("chat.reactions.you_and_single_user",{emoji:this.args.reaction.emoji,username:t.pop()})
const i=e-t.length
return i>0?s.default.t("chat.reactions.you_multiple_users_and_more",{emoji:this.args.reaction.emoji,commaSeparatedUsernames:j(this,v,P).call(this,t),count:i}):s.default.t("chat.reactions.you_and_multiple_users",{emoji:this.args.reaction.emoji,username:t.pop(),commaSeparatedUsernames:j(this,v,P).call(this,t)})}function S(){const e=this.args.reaction.count
if(0===e)return
const t=this.args.reaction.users.filter((e=>e.id!==this.currentUser?.id)).slice(0,5).mapBy("username")
if(1===e)return s.default.t("chat.reactions.single_user",{emoji:this.args.reaction.emoji,username:t.pop()})
const i=e-t.length
return i>0?s.default.t("chat.reactions.multiple_users_and_more",{emoji:this.args.reaction.emoji,commaSeparatedUsernames:j(this,v,P).call(this,t),count:i}):s.default.t("chat.reactions.multiple_users",{emoji:this.args.reaction.emoji,username:t.pop(),commaSeparatedUsernames:j(this,v,P).call(this,t)})}function P(e){return e.join(s.default.t("word_connector.comma"))}e.default=O,(0,t.setComponentTemplate)(k,O)})),define("discourse/plugins/chat/discourse/components/chat-message-separator-date",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object"],(function(e,t,i,n,r){"use strict"
var a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const s=(0,i.createTemplateFactory)({id:"9p1ZIO+U",block:'[[[41,[30,1,["formattedFirstMessageDate"]],[[[1,"  "],[11,0],[16,0,[28,[37,1],["chat-message-separator-date",[52,[30,1,["newest"]],"with-last-visit"]],null]],[24,"role","button"],[4,[38,2],["click",[30,0,["onDateClick"]]],[["passive"],[true]]],[12],[1,"\\n    "],[11,0],[24,0,"chat-message-separator__text-container"],[4,[38,3],null,null],[12],[1,"\\n      "],[10,1],[14,0,"chat-message-separator__text"],[12],[1,"\\n        "],[1,[30,1,["formattedFirstMessageDate"]]],[1,"\\n\\n"],[41,[30,1,["newest"]],[[[1,"          "],[10,1],[14,0,"chat-message-separator__last-visit"],[12],[1,"\\n            "],[10,1],[14,0,"chat-message-separator__last-visit-separator"],[12],[1,"-"],[13],[1,"\\n            "],[1,[28,[35,4],["chat.last_visit"],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"chat-message-separator__line-container"],[12],[1,"\\n    "],[10,0],[14,0,"chat-message-separator__line"],[12],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@message"],false,["if","concat-class","on","chat/track-message-separator-date","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-separator-date.hbs",isStrictMode:!1})
let o=(a=class extends n.default{onDateClick(){return this.args.fetchMessagesByDate?.(this.args.message.firstMessageOfTheDayAt)}},l=a.prototype,c="onDateClick",u=[r.action],d=Object.getOwnPropertyDescriptor(a.prototype,"onDateClick"),h=a.prototype,p={},Object.keys(d).forEach((function(e){p[e]=d[e]})),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=u.slice().reverse().reduce((function(e,t){return t(l,c,e)||e}),p),h&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(h):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(l,c,p),p=null),a)
var l,c,u,d,h,p
e.default=o,(0,t.setComponentTemplate)(s,o)})),define("discourse/plugins/chat/discourse/components/chat-message-separator-new",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"0fHoqVRL",block:'[[[41,[28,[37,1],[[30,1,["newest"]],[28,[37,2],[[30,1,["formattedFirstMessageDate"]]],null]],null],[[[1,"  "],[10,0],[14,0,"chat-message-separator-new"],[12],[1,"\\n    "],[10,0],[14,0,"chat-message-separator__text-container"],[12],[1,"\\n      "],[10,1],[14,0,"chat-message-separator__text"],[12],[1,"\\n        "],[1,[28,[35,3],["chat.last_visit"],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-message-separator__line-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-separator__line"],[12],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@message"],false,["if","and","not","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-separator-new.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,(0,n.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat-message-text",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/plugins/chat/discourse/components/chat-message-collapser"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,i.createTemplateFactory)({id:"CosMY0zi",block:'[[[10,0],[14,0,"chat-message-text"],[12],[1,"\\n"],[41,[30,0,["isCollapsible"]],[[[1,"    "],[8,[39,1],null,[["@cooked","@uploads","@onToggleCollapse"],[[30,1],[30,2],[30,3]]],null],[1,"\\n"]],[]],[[[1,"    "],[1,[28,[35,2],[[30,1]],null]],[1,"\\n"]],[]]],[1,"\\n"],[41,[30,0,["isEdited"]],[[[1,"    "],[10,1],[14,0,"chat-message-edited"],[12],[1,"("],[1,[28,[35,3],["chat.edited"],null]],[1,")"],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[18,4,null],[1,"\\n"],[13]],["@cooked","@uploads","@onToggleCollapse","&default"],false,["if","chat-message-collapser","html-safe","i18n","yield"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-text.hbs",isStrictMode:!1})
class s extends n.default{get isEdited(){return this.args.edited??!1}get isCollapsible(){return(0,r.isCollapsible)(this.args.cooked,this.args.uploads)}}e.default=s,(0,t.setComponentTemplate)(a,s)})),define("discourse/plugins/chat/discourse/components/chat-message-thread-indicator",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service","@ember/object","discourse-common/utils/decorators","@glimmer/tracking"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const f=(0,i.createTemplateFactory)({id:"ouHqeHDv",block:'[[[11,0],[16,0,[28,[37,0],["chat-message-thread-indicator",[52,[30,0,["isActive"]],"-active"]],null]],[24,"role","button"],[16,"title",[28,[37,2],["chat.threads.open"],null]],[4,[38,3],[[30,0,["setup"]]],null],[4,[38,4],[[30,0,["teardown"]]],null],[12],[1,"\\n\\n  "],[10,0],[14,0,"chat-message-thread-indicator__last-reply-avatar"],[12],[1,"\\n    "],[8,[39,5],null,[["@user","@avatarSize"],[[30,1,["thread","preview","lastReplyUser"]],"small"]],null],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"chat-message-thread-indicator__last-reply-info"],[12],[1,"\\n    "],[10,1],[14,0,"chat-message-thread-indicator__last-reply-username"],[12],[1,"\\n      "],[1,[30,1,["thread","preview","lastReplyUser","username"]]],[1,"\\n    "],[13],[1,"\\n    "],[10,1],[14,0,"chat-message-thread-indicator__last-reply-timestamp"],[12],[1,"\\n      "],[1,[28,[35,6],[[30,1,["thread","preview","lastReplyCreatedAt"]]],[["leaveAgo"],["true"]]]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"chat-message-thread-indicator__replies-count"],[12],[1,"\\n    "],[1,[28,[35,2],["chat.thread.replies"],[["count"],[[30,1,["thread","preview","replyCount"]]]]]],[1,"\\n  "],[13],[1,"\\n  "],[8,[39,7],null,[["@thread"],[[30,1,["thread"]]]],null],[1,"\\n  "],[10,0],[14,0,"chat-message-thread-indicator__last-reply-excerpt"],[12],[1,"\\n    "],[1,[28,[35,8],[[28,[37,9],[[30,1,["thread","preview","lastReplyExcerpt"]]],null]],null]],[1,"\\n  "],[13],[1,"\\n"],[13]],["@message"],false,["concat-class","if","i18n","did-insert","will-destroy","chat/user-avatar","format-date","chat/thread/participants","replace-emoji","html-safe"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-thread-indicator.hbs",isStrictMode:!1})
let v=(l=class extends n.default{constructor(){super(...arguments),b(this,"capabilities",c,this),b(this,"chat",u,this),b(this,"chatStateManager",d,this),b(this,"router",h,this),b(this,"site",p,this),b(this,"isActive",m,this)}setup(e){this.element=e,this.capabilities.touch&&(this.element.addEventListener("touchstart",this.onTouchStart,{passive:!0}),this.element.addEventListener("touchmove",this.cancelTouch,{passive:!0}),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchCancel",this.cancelTouch)),this.element.addEventListener("click",this.openThread,{passive:!0})}teardown(){this.capabilities.touch&&(this.element.removeEventListener("touchstart",this.onTouchStart,{passive:!0}),this.element.removeEventListener("touchmove",this.cancelTouch,{passive:!0}),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchCancel",this.cancelTouch)),this.element.removeEventListener("click",this.openThread,{passive:!0})}onTouchStart(e){this.isActive=!0,e.stopPropagation(),this.touching=!0}onTouchEnd(){this.isActive=!1,this.touching&&this.openThread()}cancelTouch(){this.isActive=!1,this.touching=!1}openThread(){this.chat.activeMessage=null,this.router.transitionTo("chat.channel.thread",...this.args.message.thread.routeModels)}},c=g(l.prototype,"capabilities",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=g(l.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=g(l.prototype,"chatStateManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(l.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=g(l.prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=g(l.prototype,"isActive",[o.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g(l.prototype,"setup",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"setup"),l.prototype),g(l.prototype,"teardown",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"teardown"),l.prototype),g(l.prototype,"onTouchStart",[s.bind],Object.getOwnPropertyDescriptor(l.prototype,"onTouchStart"),l.prototype),g(l.prototype,"onTouchEnd",[s.bind],Object.getOwnPropertyDescriptor(l.prototype,"onTouchEnd"),l.prototype),g(l.prototype,"cancelTouch",[s.bind],Object.getOwnPropertyDescriptor(l.prototype,"cancelTouch"),l.prototype),g(l.prototype,"openThread",[s.bind],Object.getOwnPropertyDescriptor(l.prototype,"openThread"),l.prototype),l)
e.default=v,(0,t.setComponentTemplate)(f,v)})),define("discourse/plugins/chat/discourse/components/chat-message",["exports","@ember/component","@ember/template-factory","@ember/object","@glimmer/component","I18n","discourse/lib/optional-service","@ember/runloop","@ember/service","discourse-common/lib/later","discourse/plugins/chat/discourse/lib/zoom-check","discourse-common/lib/get-owner","discourse/plugins/chat/discourse/lib/chat-message-interactor","discourse-common/lib/debounce","discourse-common/utils/decorators","discourse/lib/update-user-status-on-mention","@glimmer/tracking"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g){"use strict"
var f,v,y,_,w,j,M,z,k,O,C,S,P,T,E,x,D,I
function A(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function U(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function L(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function N(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.MESSAGE_CONTEXT_THREAD=e.MENTION_KEYWORDS=void 0,e.addChatMessageDecorator=function(e){F.push(e)},e.default=void 0,e.resetChatMessageDecorators=function(){F=[]}
const R=(0,i.createTemplateFactory)({id:"J0eRARuj",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[41,[28,[37,1],[[30,1],"channel"],null],[[[1,"    "],[8,[39,2],null,[["@fetchMessagesByDate","@message"],[[30,2],[30,3]]],null],[1,"\\n    "],[8,[39,3],null,[["@message"],[[30,3]]],null],[1,"\\n"]],[]],null],[1,"\\n  "],[11,0],[16,0,[28,[37,4],["chat-message-container",[52,[30,0,["pane","selectingMessages"]],"-selectable"],[52,[30,3,["highlighted"]],"-highlighted"],[52,[28,[37,1],[[30,3,["user","id"]],[30,0,["currentUser","id"]]],null],"is-by-current-user"],[52,[30,3,["staged"]],"-staged","-persisted"],[52,[30,0,["hasActiveState"]],"-active"],[52,[30,3,["bookmark"]],"-bookmarked"],[52,[30,3,["deletedAt"]],"-deleted"],[52,[30,3,["selected"]],"-selected"],[52,[30,3,["error"]],"-errored"],[52,[30,0,["showThreadIndicator"]],"has-thread-indicator"],[52,[30,0,["hideUserInfo"]],"-user-info-hidden"],[52,[30,0,["hasReply"]],"has-reply"]],null]],[16,"data-id",[30,3,["id"]]],[16,"data-thread-id",[30,3,["thread","id"]]],[17,4],[4,[38,5],[[30,0,["didInsertMessage"]]],null],[4,[38,6],[[30,0,["didUpdateMessageId"]],[30,3,["id"]]],null],[4,[38,6],[[30,0,["didUpdateMessageVersion"]],[30,3,["version"]]],null],[4,[38,7],[[30,0,["willDestroyMessage"]]],null],[4,[38,8],["mouseenter",[30,0,["onMouseEnter"]]],[["passive"],[true]]],[4,[38,8],["mouseleave",[30,0,["onMouseLeave"]]],[["passive"],[true]]],[4,[38,8],["mousemove",[30,0,["onMouseMove"]]],[["passive"],[true]]],[4,[38,9],[[30,0,["onLongPressStart"]],[30,0,["onLongPressEnd"]],[30,0,["onLongPressCancel"]]],null],[12],[1,"\\n"],[41,[30,0,["show"]],[[[41,[30,0,["pane","selectingMessages"]],[[[1,"        "],[8,[39,10],[[24,0,"chat-message-selector"],[4,[38,8],["click",[30,0,["toggleChecked"]]],null]],[["@type","@checked"],["checkbox",[30,3,["selected"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["deletedAndCollapsed"]],[[[1,"        "],[10,0],[14,0,"chat-message-text -deleted"],[12],[1,"\\n          "],[8,[39,11],null,[["@class","@action","@translatedLabel"],["btn-flat chat-message-expand",[30,0,["expand"]],[30,0,["deletedMessageLabel"]]]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[41,[30,0,["hiddenAndCollapsed"]],[[[1,"        "],[10,0],[14,0,"chat-message-text -hidden"],[12],[1,"\\n          "],[8,[39,11],null,[["@class","@action","@label"],["btn-flat chat-message-expand",[30,0,["expand"]],"chat.hidden"]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[1,"        "],[10,0],[14,0,"chat-message"],[12],[1,"\\n"],[41,[51,[30,0,["hideReplyToInfo"]]],[[[1,"            "],[8,[39,13],null,[["@message"],[[30,3]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["hideUserInfo"]],[[[1,"            "],[8,[39,14],null,[["@message"],[[30,3]]],null],[1,"\\n"]],[]],[[[1,"            "],[8,[39,15],null,[["@message"],[[30,3]]],null],[1,"\\n"]],[]]],[1,"\\n          "],[10,0],[14,0,"chat-message-content"],[12],[1,"\\n            "],[8,[39,16],null,[["@message","@show"],[[30,3],[28,[37,17],[[30,0,["hideUserInfo"]]],null]]],null],[1,"\\n\\n            "],[8,[39,18],null,[["@cooked","@uploads","@edited"],[[30,3,["cooked"]],[30,3,["uploads"]],[30,3,["edited"]]]],[["default"],[[[[1,"\\n"],[41,[30,3,["reactions","length"]],[[[1,"                "],[10,0],[14,0,"chat-message-reaction-list"],[12],[1,"\\n"],[42,[28,[37,20],[[28,[37,20],[[30,3,["reactions"]]],null]],null],null,[[[1,"                    "],[8,[39,21],null,[["@reaction","@onReaction","@message","@showTooltip"],[[30,5],[30,0,["messageInteractor","react"]],[30,3],true]],null],[1,"\\n"]],[5]],null],[1,"\\n"],[41,[30,0,["shouldRenderOpenEmojiPickerButton"]],[[[1,"                    "],[8,[39,11],null,[["@class","@action","@icon","@title","@forwardEvent"],["chat-message-react-btn",[30,0,["messageInteractor","openEmojiPicker"]],"discourse-emojis","chat.react",true]],null],[1,"\\n"]],[]],null],[1,"                "],[13],[1,"\\n"]],[]],null],[1,"            "]],[]]]]],[1,"\\n\\n            "],[8,[39,22],null,[["@message","@onRetry"],[[30,3],[30,6]]],null],[1,"\\n            "],[8,[39,23],null,[["@message"],[[30,3]]],null],[1,"\\n          "],[13],[1,"\\n\\n"],[41,[30,0,["showThreadIndicator"]],[[[1,"            "],[8,[39,24],null,[["@message"],[[30,3]]],null],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "]],[]]]],[]]]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@context","@fetchMessagesByDate","@message","&attrs","reaction","@resendStagedMessage"],false,["if","eq","chat-message-separator-date","chat-message-separator-new","concat-class","did-insert","did-update","will-destroy","on","chat/on-long-press","input","d-button","unless","chat-message-in-reply-to-indicator","chat/message/left-gutter","chat/message/avatar","chat/message/info","not","chat-message-text","each","-track-array","chat-message-reaction","chat/message/error","chat/message/mention-warning","chat-message-thread-indicator"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message.hbs",isStrictMode:!1})
let F=[],W=[]
e.MENTION_KEYWORDS=["here","all"]
const B="thread"
e.MESSAGE_CONTEXT_THREAD=B
let H=(D=new WeakSet,I=new WeakSet,f=class extends r.default{constructor(){super(...arguments),U(this,I),U(this,D),A(this,"site",v,this),A(this,"dialog",y,this),A(this,"currentUser",_,this),A(this,"appEvents",w,this),A(this,"capabilities",j,this),A(this,"chat",M,this),A(this,"chatApi",z,this),A(this,"chatEmojiReactionStore",k,this),A(this,"chatEmojiPickerManager",O,this),A(this,"chatChannelPane",C,this),A(this,"chatThreadPane",S,this),A(this,"chatChannelsManager",P,this),A(this,"router",T,this),A(this,"isActive",E,this),A(this,"adminTools",x,this),this.initMentionedUsers()}get pane(){return this.args.context===B?this.chatThreadPane:this.chatChannelPane}get messageInteractor(){return new h.default((0,d.getOwner)(this),this.args.message,this.args.context)}get deletedAndCollapsed(){return this.args.message?.deletedAt&&this.collapsed}get hiddenAndCollapsed(){return this.args.message?.hidden&&this.collapsed}get collapsed(){return!this.args.message?.expanded}get deletedMessageLabel(){let e=1
const t=i=>{const n=i.previousMessage
n?.deletedAt&&(e++,t(n))}
return t(this.args.message),a.default.t("chat.deleted",{count:e})}get shouldRender(){return this.args.message.expanded||!this.args.message.deletedAt||this.args.message.deletedAt&&!this.args.message.nextMessage?.deletedAt}get shouldRenderOpenEmojiPickerButton(){return this.chat.userCanInteractWithChat&&this.site.desktopView}expand(){const e=t=>{const i=t.previousMessage
i?.deletedAt&&(i.expanded=!0,e(i))}
this.args.message.expanded=!0,this.refreshStatusOnMentions(),e(this.args.message)}toggleChecked(e){e.shiftKey&&this.messageInteractor.bulkSelect(e.target.checked),this.messageInteractor.select(e.target.checked)}willDestroyMessage(){(0,o.cancel)(this._invitationSentTimer),(0,o.cancel)(this._disableMessageActionsHandler),(0,o.cancel)(this._makeMessageActiveHandler),(0,o.cancel)(this._debounceDecorateCookedMessageHandler),L(this,I,V).call(this)}refreshStatusOnMentions(){(0,o.schedule)("afterRender",(()=>{this.args.message.mentionedUsers.forEach((e=>{const t=`/u/${e.username.toLowerCase()}`
this.messageContainer.querySelectorAll(`a.mention[href="${t}"]`).forEach((t=>{(0,b.updateUserStatusOnMention)(t,e.status,W)}))}))}))}didInsertMessage(e){this.messageContainer=e,this.debounceDecorateCookedMessage(),this.refreshStatusOnMentions()}didUpdateMessageId(){this.debounceDecorateCookedMessage()}didUpdateMessageVersion(){this.debounceDecorateCookedMessage(),this.refreshStatusOnMentions(),this.initMentionedUsers()}debounceDecorateCookedMessage(){this._debounceDecorateCookedMessageHandler=(0,p.default)(this,this.decorateCookedMessage,this.args.message,100)}decorateCookedMessage(e){(0,o.schedule)("afterRender",(()=>{F.forEach((t=>{t.call(this,this.messageContainer,e.channel)}))}))}initMentionedUsers(){this.args.message.mentionedUsers.forEach((e=>{e.isTrackingStatus()||(e.trackStatus(),e.on("status-changed",this,"refreshStatusOnMentions"))}))}get show(){return!this.args.message?.deletedAt||this.currentUser.id===this.args.message?.user?.id||this.currentUser.staff||this.args.message?.channel?.canModerate}onMouseEnter(){this.site.mobileView||this.chat.activeMessage?.model?.id!==this.args.message.id&&(this._onMouseEnterMessageDebouncedHandler=(0,p.default)(this,this._debouncedOnHoverMessage,250))}onMouseMove(){this.site.mobileView||this.chat.activeMessage?.model?.id!==this.args.message.id&&this._setActiveMessage()}onMouseLeave(e){(0,o.cancel)(this._onMouseEnterMessageDebouncedHandler),this.site.mobileView||(e.toElement||e.relatedTarget)?.closest(".chat-message-actions-container")||(this.chat.activeMessage=null)}_debouncedOnHoverMessage(){this._setActiveMessage()}_setActiveMessage(){this.args.disableMouseEvents||((0,o.cancel)(this._onMouseEnterMessageDebouncedHandler),this.chat.userCanInteractWithChat&&this.args.message.expanded&&(this.chat.activeMessage={model:this.args.message,context:this.args.context}))}onLongPressStart(e,t){this.args.message.expanded&&"IMG"!==t.target.tagName&&(this._makeMessageActiveHandler=(0,c.default)((()=>{this.isActive=!0}),125))}onLongPressCancel(){(0,o.cancel)(this._makeMessageActiveHandler),this.isActive=!1,this._disableMessageActionsHandler=(0,c.default)((()=>{document.documentElement.classList.remove("disable-message-actions-touch")}),200)}onLongPressEnd(e,t){"IMG"!==t.target.tagName&&((0,o.cancel)(this._makeMessageActiveHandler),this.isActive=!1,(0,u.default)()||(document.documentElement.classList.add("disable-message-actions-touch"),document.activeElement.blur(),document.querySelector(".chat-composer__input")?.blur(),this._setActiveMessage()))}get hasActiveState(){return this.isActive||this.chat.activeMessage?.model?.id===this.args.message.id}get hasReply(){return this.args.message.inReplyTo&&!this.hideReplyToInfo}get hideUserInfo(){const e=this.args.message,t=e.previousMessage
return!!t&&(!e.firstOfResults&&(!e.chatWebhookEvent&&(!t.deletedAt&&(!(Math.abs(new Date(e.createdAt)-new Date(t.createdAt))>3e5)&&(e.inReplyTo?e.inReplyTo?.id===t.id&&e.user?.id===t.user?.id:e.user?.id===t.user?.id)))))}get hideReplyToInfo(){return this.args.context===B||this.args.message?.inReplyTo?.id===this.args.message?.previousMessage?.id||this.threadingEnabled}get threadingEnabled(){return this.args.message?.channel?.threadingEnabled&&!!this.args.message?.thread}get showThreadIndicator(){return this.args.context!==B&&this.threadingEnabled&&this.args.message?.thread&&this.args.message?.thread.preview.replyCount>0}},v=N(f.prototype,"site",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=N(f.prototype,"dialog",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=N(f.prototype,"currentUser",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=N(f.prototype,"appEvents",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=N(f.prototype,"capabilities",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=N(f.prototype,"chat",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=N(f.prototype,"chatApi",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=N(f.prototype,"chatEmojiReactionStore",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=N(f.prototype,"chatEmojiPickerManager",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=N(f.prototype,"chatChannelPane",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=N(f.prototype,"chatThreadPane",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=N(f.prototype,"chatChannelsManager",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=N(f.prototype,"router",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=N(f.prototype,"isActive",[g.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),x=N(f.prototype,"adminTools",[s.default],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N(f.prototype,"expand",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"expand"),f.prototype),N(f.prototype,"toggleChecked",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"toggleChecked"),f.prototype),N(f.prototype,"willDestroyMessage",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"willDestroyMessage"),f.prototype),N(f.prototype,"refreshStatusOnMentions",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"refreshStatusOnMentions"),f.prototype),N(f.prototype,"didInsertMessage",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"didInsertMessage"),f.prototype),N(f.prototype,"didUpdateMessageId",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"didUpdateMessageId"),f.prototype),N(f.prototype,"didUpdateMessageVersion",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"didUpdateMessageVersion"),f.prototype),N(f.prototype,"decorateCookedMessage",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"decorateCookedMessage"),f.prototype),N(f.prototype,"initMentionedUsers",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"initMentionedUsers"),f.prototype),N(f.prototype,"onMouseEnter",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"onMouseEnter"),f.prototype),N(f.prototype,"onMouseMove",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"onMouseMove"),f.prototype),N(f.prototype,"onMouseLeave",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"onMouseLeave"),f.prototype),N(f.prototype,"_debouncedOnHoverMessage",[m.bind],Object.getOwnPropertyDescriptor(f.prototype,"_debouncedOnHoverMessage"),f.prototype),N(f.prototype,"onLongPressStart",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"onLongPressStart"),f.prototype),N(f.prototype,"onLongPressCancel",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"onLongPressCancel"),f.prototype),N(f.prototype,"onLongPressEnd",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"onLongPressEnd"),f.prototype),f)
function $(){W.forEach((e=>{e.destroy()})),W=[]}function V(){this.args.message.mentionedUsers.forEach((e=>{e.stopTrackingStatus(),e.off("status-changed",this,"refreshStatusOnMentions")})),L(this,D,$).call(this)}e.default=H,(0,t.setComponentTemplate)(R,H)})),define("discourse/plugins/chat/discourse/components/chat-notices",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service","@ember/object"],(function(e,t,i,n,r,a){"use strict"
var s,o,l
function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const u=(0,i.createTemplateFactory)({id:"JNc1JuX8",block:'[[[10,0],[14,0,"chat-notices"],[12],[1,"\\n  "],[8,[39,0],null,[["@channel"],[[30,1]]],null],[1,"\\n\\n"],[42,[28,[37,2],[[28,[37,2],[[30,0,["noticesForChannel"]]],null]],null],null,[[[1,"    "],[10,0],[14,0,"chat-notices__notice"],[12],[1,"\\n      "],[10,2],[14,0,"chat-notices__notice__content"],[12],[1,"\\n        "],[1,[30,2,["textContent"]]],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[39,3],null,[["@icon","@class","@action"],["times","btn-flat chat-notices__notice__clear",[28,[37,4],[[30,0,["clearNotice"]],[30,2]],null]]],null],[1,"\\n    "],[13],[1,"\\n"]],[2]],null],[13]],["@channel","notice"],false,["chat-retention-reminder","each","-track-array","d-button","fn"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-notices.hbs",isStrictMode:!1})
let d=(s=(0,r.inject)("chat-channel-pane-subscriptions-manager"),o=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="subscriptionsManager",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get noticesForChannel(){return this.subscriptionsManager.notices.filter((e=>e.channelId===this.args.channel.id))}clearNotice(e){this.subscriptionsManager.clearNotice(e)}},l=c(o.prototype,"subscriptionsManager",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(o.prototype,"clearNotice",[a.action],Object.getOwnPropertyDescriptor(o.prototype,"clearNotice"),o.prototype),o)
e.default=d,(0,t.setComponentTemplate)(u,d)})),define("discourse/plugins/chat/discourse/components/chat-replying-indicator",["exports","@ember/component","@ember/template-factory","@ember/utils","@glimmer/component","@ember/service","I18n","@ember/object","@glimmer/tracking"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,i.createTemplateFactory)({id:"7VNw+o1q",block:'[[[41,[30,1],[[[1,"  "],[11,0],[16,0,[28,[37,1],["chat-replying-indicator",[52,[30,0,["presenceChannel","subscribed"]],"is-subscribed"]],null]],[4,[38,2],[[30,0,["subscribe"]]],null],[4,[38,3],[[30,0,["updateSubscription"]],[30,1]],null],[4,[38,4],[[30,0,["unsubscribe"]]],null],[12],[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[10,1],[14,0,"chat-replying-indicator__text"],[12],[1,[30,0,["text"]]],[13],[1,"\\n      "],[10,1],[14,0,"chat-replying-indicator__wave"],[12],[1,"\\n        "],[10,1],[14,0,"chat-replying-indicator__dot"],[12],[1,"."],[13],[1,"\\n        "],[10,1],[14,0,"chat-replying-indicator__dot"],[12],[1,"."],[13],[1,"\\n        "],[10,1],[14,0,"chat-replying-indicator__dot"],[12],[1,"."],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@presenceChannelName"],false,["if","concat-class","did-insert","did-update","will-destroy"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-replying-indicator.hbs",isStrictMode:!1})
let g=(c=class extends r.default{constructor(){super(...arguments),p(this,"currentUser",u,this),p(this,"presence",d,this),p(this,"presenceChannel",h,this)}async updateSubscription(){await this.unsubscribe(),await this.subscribe()}async subscribe(){this.presenceChannel=this.presence.getChannel(this.args.presenceChannelName),await this.presenceChannel.subscribe()}async unsubscribe(){this.presenceChannel?.subscribed&&await this.presenceChannel.unsubscribe()}get users(){return this.presenceChannel?.get("users")?.filter((e=>e.id!==this.currentUser.id))||[]}get usernames(){return this.users.mapBy("username")}get text(){if(1===this.usernames.length)return s.default.t("chat.replying_indicator.single_user",{username:this.usernames[0]})
if(this.usernames.length<4){const e=this.usernames[this.usernames.length-1],t=this.usernames.slice(0,this.usernames.length-1).join(s.default.t("word_connector.comma"))
return s.default.t("chat.replying_indicator.multiple_users",{commaSeparatedUsernames:t,lastUsername:e})}const e=this.usernames.slice(0,2).join(s.default.t("word_connector.comma"))
return s.default.t("chat.replying_indicator.many_users",{commaSeparatedUsernames:e,count:this.usernames.length-2})}get shouldRender(){return(0,n.isPresent)(this.usernames)}},u=m(c.prototype,"currentUser",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(c.prototype,"presence",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=m(c.prototype,"presenceChannel",[l.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m(c.prototype,"updateSubscription",[o.action],Object.getOwnPropertyDescriptor(c.prototype,"updateSubscription"),c.prototype),m(c.prototype,"subscribe",[o.action],Object.getOwnPropertyDescriptor(c.prototype,"subscribe"),c.prototype),m(c.prototype,"unsubscribe",[o.action],Object.getOwnPropertyDescriptor(c.prototype,"unsubscribe"),c.prototype),c)
e.default=g,(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/chat-retention-reminder-text",["exports","@ember/component","@ember/template-factory","@glimmer/component","I18n","@ember/service"],(function(e,t,i,n,r,a){"use strict"
var s,o,l
function c(e,t,i){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function u(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,i.createTemplateFactory)({id:"gEmSCpXm",block:'[[[10,1],[14,0,"chat-retention-reminder-text"],[12],[1,"\\n  "],[1,[30,0,["text"]]],[1,"\\n"],[13]],[],false,[]]',moduleName:"discourse/plugins/chat/discourse/components/chat-retention-reminder-text.hbs",isStrictMode:!1})
let h=(l=new WeakMap,s=class extends n.default{constructor(){var e,t,i,n
super(...arguments),c(this,l,{get:y,set:void 0}),e=this,t="siteSettings",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get text(){return this.args.channel.isDirectMessageChannel?u(this,l)>0?r.default.t("chat.retention_reminders.dm",{count:this.siteSettings.chat_dm_retention_days}):r.default.t("chat.retention_reminders.dm_none"):u(this,l)>0?r.default.t("chat.retention_reminders.public",{count:this.siteSettings.chat_channel_retention_days}):r.default.t("chat.retention_reminders.public_none")}},p=s.prototype,m="siteSettings",b=[a.inject],g={configurable:!0,enumerable:!0,writable:!0,initializer:null},v={},Object.keys(g).forEach((function(e){v[e]=g[e]})),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=b.slice().reverse().reduce((function(e,t){return t(p,m,e)||e}),v),f&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(f):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(p,m,v),v=null),o=v,s)
var p,m,b,g,f,v
function y(){return this.args.channel.isDirectMessageChannel?this.siteSettings.chat_dm_retention_days:this.siteSettings.chat_channel_retention_days}e.default=h,(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/chat-retention-reminder",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object","discourse/lib/ajax","discourse/lib/ajax-error","@ember/service"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,i.createTemplateFactory)({id:"yyCUJTtm",block:'[[[41,[30,0,["show"]],[[[1,"  "],[10,0],[14,0,"chat-retention-reminder"],[12],[1,"\\n    "],[8,[39,1],null,[["@channel"],[[30,1]]],null],[1,"\\n    "],[8,[39,2],null,[["@class","@action","@icon"],["btn-flat dismiss-btn",[30,0,["dismiss"]],"times"]],null],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@channel"],false,["if","chat-retention-reminder-text","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-retention-reminder.hbs",isStrictMode:!1})
let h=(l=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="currentUser",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get show(){return this.args.channel?.isDirectMessageChannel&&this.currentUser?.get("needs_dm_retention_reminder")||this.args.channel?.isCategoryChannel&&this.currentUser?.get("needs_channel_retention_reminder")}dismiss(){return(0,a.ajax)("/chat/dismiss-retention-reminder",{method:"POST",data:{chatable_type:this.args.channel.chatableType}}).then((()=>{const e=this.args.channel.isDirectMessageChannel?"needs_dm_retention_reminder":"needs_channel_retention_reminder"
this.currentUser.set(e,!1)})).catch(s.popupAjaxError)}},c=u(l.prototype,"currentUser",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(l.prototype,"dismiss",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"dismiss"),l.prototype),l)
e.default=h,(0,t.setComponentTemplate)(d,h)}))
define("discourse/plugins/chat/discourse/components/chat-side-panel-resizer",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"9PfqvIVl",block:'[[[10,0],[14,0,"chat-side-panel-resizer"],[12],[13]],[],false,[]]',moduleName:"discourse/plugins/chat/discourse/components/chat-side-panel-resizer.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,(0,n.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat-side-panel",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service","@ember/object","@ember/template","@glimmer/tracking"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const f=(0,i.createTemplateFactory)({id:"Fkh/xPBL",block:'[[[41,[30,0,["chatStateManager","isSidePanelExpanded"]],[[[1,"  "],[11,0],[24,0,"chat-side-panel"],[16,5,[52,[28,[37,1],[[30,0,["site","desktopView"]],[30,0,["chatStateManager","isFullPageActive"]]],null],[30,0,["widthStyle"]]]],[4,[38,2],[[30,0,["setupSize"]]],null],[4,[38,3],[".chat-side-panel-resizer",[30,0,["didResize"]],[28,[37,4],null,[["position","vertical","mutate"],[false,false,false]]]],null],[12],[1,"\\n    "],[18,1,null],[1,"\\n\\n"],[41,[30,0,["site","desktopView"]],[[[1,"      "],[8,[39,6],null,null,null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["&default"],false,["if","and","did-insert","chat/resizable-node","hash","yield","chat-side-panel-resizer"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-side-panel.hbs",isStrictMode:!1})
let v=(p=new WeakSet,l=class extends n.default{constructor(){super(...arguments),b(this,p),m(this,"chatStateManager",c,this),m(this,"chatSidePanelSize",u,this),m(this,"site",d,this),m(this,"widthStyle",h,this)}setupSize(){this.widthStyle=(0,s.htmlSafe)(`width:${this.chatSidePanelSize.width}px`)}didResize(e,t){if(this.isDestroying||this.isDestroyed)return
e.parentElement.getBoundingClientRect().width-t.width>=250&&(this.chatSidePanelSize.width=t.width,e.style.width=t.width+"px",this.widthStyle=(0,s.htmlSafe)(`width:${t.width}px`))}},c=g(l.prototype,"chatStateManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=g(l.prototype,"chatSidePanelSize",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=g(l.prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(l.prototype,"widthStyle",[o.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g(l.prototype,"setupSize",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"setupSize"),l.prototype),g(l.prototype,"didResize",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"didResize"),l.prototype),l)
e.default=v,(0,t.setComponentTemplate)(f,v)})),define("discourse/plugins/chat/discourse/components/chat-skeleton",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/template"],(function(e,t,i,n,r){"use strict"
function a(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function s(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"2YNyZ6h6",block:'[[[10,0],[14,0,"chat-skeleton -animation"],[12],[1,"\\n"],[42,[28,[37,1],[[28,[37,1],[[30,0,["placeholders"]]],null]],null],null,[[[1,"    "],[10,0],[14,0,"chat-skeleton__body"],[12],[1,"\\n      "],[10,0],[14,0,"chat-skeleton__message"],[12],[1,"\\n        "],[10,0],[14,0,"chat-skeleton__message-avatar"],[12],[13],[1,"\\n        "],[10,0],[14,0,"chat-skeleton__message-poster"],[12],[13],[1,"\\n        "],[10,0],[14,0,"chat-skeleton__message-content"],[12],[1,"\\n"],[41,[30,1,["image"]],[[[1,"            "],[10,0],[14,0,"chat-skeleton__message-img"],[12],[13],[1,"\\n"]],[]],null],[1,"\\n          "],[10,0],[14,0,"chat-skeleton__message-text"],[12],[1,"\\n"],[42,[28,[37,1],[[28,[37,1],[[30,1,["rows"]]],null]],null],null,[[[1,"              "],[10,0],[14,0,"chat-skeleton__message-msg"],[15,5,[30,2]],[12],[13],[1,"\\n"]],[2]],null],[1,"          "],[13],[1,"\\n\\n"],[41,[30,1,["reactions"]],[[[1,"            "],[10,0],[14,0,"chat-skeleton__message-reactions"],[12],[1,"\\n"],[42,[28,[37,1],[[28,[37,1],[[30,1,["reactions"]]],null]],null],null,[[[1,"                "],[10,0],[14,0,"chat-skeleton__message-reaction"],[12],[13],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[1]],null],[13]],["placeholder","row"],false,["each","-track-array","if"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-skeleton.hbs",isStrictMode:!1})
var l=new WeakSet
class c extends n.default{constructor(){super(...arguments),a(this,l)}get placeholders(){return Array.from({length:15},(()=>({image:5===s(this,l,u).call(this,1,10),rows:Array.from({length:s(this,l,u).call(this,1,5)},(()=>(0,r.htmlSafe)(`width: ${s(this,l,u).call(this,20,95)}%`))),reactions:Array.from({length:s(this,l,u).call(this,0,3)})})))}}function u(e,t){return Math.floor(Math.random()*(t-e+1)+e)}e.default=c,(0,t.setComponentTemplate)(o,c)})),define("discourse/plugins/chat/discourse/components/chat-thread",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/lib/notification-levels","discourse/plugins/chat/discourse/models/user-chat-thread-membership","@glimmer/tracking","@ember/object","discourse/plugins/chat/discourse/models/chat-message","discourse/lib/ajax-error","discourse-common/utils/decorators","@ember/service","@ember/runloop","discourse/lib/desktop-notifications","discourse/plugins/chat/discourse/lib/chat-messages-loader","discourse-common/lib/get-owner","discourse/plugins/chat/discourse/lib/chat-constants","discourse-common/lib/debounce","discourse/plugins/chat/discourse/lib/chat-ios-hacks","discourse/plugins/chat/discourse/lib/scroll-helpers"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y){"use strict"
var _,w,j,M,z,k,O,C,S,P,T,E,x,D,I,A,U,L,N,R,F
function W(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function B(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function H(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function $(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function V(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const q=(0,i.createTemplateFactory)({id:"sLRfODHx",block:'[[[11,0],[16,0,[28,[37,0],["chat-thread",[52,[30,0,["messagesLoader","loading"]],"loading"],[52,[30,1,["staged"]],"staged"]],null]],[16,"data-id",[30,1,["id"]]],[4,[38,2],[[30,0,["setUploadDropZone"]]],null],[4,[38,2],[[30,0,["didUpdateThread"]]],null],[4,[38,3],[[30,0,["didUpdateThread"]],[30,1,["id"]]],null],[4,[38,4],[[30,0,["teardown"]]],null],[12],[1,"\\n"],[41,[30,2],[[[1,"    "],[8,[39,5],null,[["@channel","@thread"],[[30,1,["channel"]],[30,1]]],null],[1,"\\n"]],[]],null],[1,"\\n  "],[11,0],[24,0,"chat-thread__body popper-viewport chat-messages-scroll"],[4,[38,2],[[30,0,["setScrollable"]]],null],[4,[38,6],[[28,[37,7],null,[["onScroll","onScrollEnd","reverse"],[[30,0,["onScroll"]],[30,0,["onScrollEnd"]],true]]]],null],[12],[1,"\\n    "],[11,0],[24,0,"chat-messages-container"],[4,[38,8],[[30,0,["didResizePane"]],[28,[37,7],null,[["delay","immediate"],[100,true]]]],null],[12],[1,"\\n"],[42,[28,[37,10],[[28,[37,10],[[30,0,["messagesManager","messages"]]],null]],null],"id",[[[1,"        "],[8,[39,11],null,[["@message","@disableMouseEvents","@resendStagedMessage","@context"],[[30,3],[30,0,["isScrolling"]],[30,0,["resendStagedMessage"]],"thread"]],null],[1,"\\n"]],[3]],null],[1,"\\n"],[41,[51,[30,0,["messagesLoader","fetchedOnce"]]],[[[41,[30,0,["messagesLoader","loading"]],[[[1,"          "],[8,[39,13],null,null,null],[1,"\\n"]],[]],null]],[]],null],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,14],null,[["@onScrollToBottom","@isVisible"],[[30,0,["scrollToLatestMessage"]],[30,0,["needsArrow"]]]],null],[1,"\\n\\n"],[41,[30,0,["chatThreadPane","selectingMessages"]],[[[1,"    "],[8,[39,15],null,[["@pane"],[[30,0,["chatThreadPane"]]]],null],[1,"\\n"]],[]],[[[1,"    "],[8,[39,16],null,[["@channel","@thread","@onSendMessage","@uploadDropZone"],[[30,4],[30,1],[30,0,["onSendMessage"]],[30,0,["uploadDropZone"]]]],null],[1,"\\n"]],[]]],[1,"\\n  "],[8,[39,17],null,[["@model"],[[30,1]]],null],[1,"\\n"],[13]],["@thread","@includeHeader","message","@channel"],false,["concat-class","if","did-insert","did-update","will-destroy","chat/thread/header","chat/scrollable-list","hash","chat/on-resize","each","-track-array","chat-message","unless","chat-skeleton","chat/scroll-to-bottom-arrow","chat/selection-manager","chat/composer/thread","chat-upload-drop-zone"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-thread.hbs",isStrictMode:!1})
let G=(L=new WeakSet,N=new WeakSet,R=new WeakSet,F=new WeakSet,_=class extends n.default{constructor(){super(...arguments),B(this,F),B(this,R),B(this,N),B(this,L),W(this,"appEvents",w,this),W(this,"capabilities",j,this),W(this,"chat",M,this),W(this,"chatApi",z,this),W(this,"chatComposerPresenceManager",k,this),W(this,"chatHistory",O,this),W(this,"chatThreadComposer",C,this),W(this,"chatThreadPane",S,this),W(this,"chatThreadPaneSubscriptionsManager",P,this),W(this,"currentUser",T,this),W(this,"router",E,this),W(this,"siteSettings",x,this),W(this,"isAtBottom",D,this),W(this,"isScrolling",I,this),W(this,"needsArrow",A,this),W(this,"uploadDropZone",U,this),H(this,"scrollable",null)}resetIdle(){(0,p.resetIdle)()}get messagesLoader(){return new m.default((0,b.getOwner)(this),this.args.thread)}get messagesManager(){return this.args.thread.messagesManager}handleKeydown(e){if("Escape"===e.key)return this.router.transitionTo("chat.channel",...this.args.thread.channel.routeModels)}didUpdateThread(){this.messagesManager.clear(),this.chatThreadComposer.focus(),this.loadMessages(),this.resetComposerMessage()}setUploadDropZone(e){this.uploadDropZone=e}subscribeToUpdates(){this.chatThreadPaneSubscriptionsManager.subscribe(this.args.thread)}teardown(){this.chatThreadPaneSubscriptionsManager.unsubscribe(),(0,h.cancel)(this._debouncedFillPaneAttemptHandler),(0,h.cancel)(this._debounceUpdateLastReadMessageHandler)}onScroll(e){(0,h.next)((()=>{$(this,F,Z).call(this)||((0,v.bodyScrollFix)(),this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!0,this.debounceUpdateLastReadMessage(),e.atTop||!this.capabilities.isIOS&&e.up&&e.distanceToTop.percentage<40?this.fetchMoreMessages({direction:g.PAST}):e.atBottom&&this.fetchMoreMessages({direction:g.FUTURE}))}))}onScrollEnd(e){this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!1,this.resetIdle(),this.atBottom=e.atBottom,e.atBottom&&this.fetchMoreMessages({direction:g.FUTURE})}debounceUpdateLastReadMessage(){this._debounceUpdateLastReadMessageHandler=(0,f.default)(this,this.updateLastReadMessage,g.READ_INTERVAL_MS)}updateLastReadMessage(){this.markThreadAsRead()}setScrollable(e){this.scrollable=e}loadMessages(){this.fetchMessages(),this.subscribeToUpdates()}didResizePane(){this._ignoreNextScroll=!0,this.debounceFillPaneAttempt(),this.debounceUpdateLastReadMessage()}async fetchMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(this.args.thread.staged){const e=this.args.thread.originalMessage
return e.thread=this.args.thread,e.manager=this.messagesManager,void this.messagesManager.addMessages([e])}if(this.messagesLoader.loading)return
this.messagesManager.clear(),e.targetMessageId??=this.args.targetMessageId||this.args.thread.currentUserMembership?.lastReadMessageId,e.targetMessageId||(e.direction=g.FUTURE)
const t=await this.messagesLoader.load(e)
if(!t)return
const[i,n]=this.processMessages(this.args.thread,t);(0,v.stackingContextFix)(this.scrollable,(()=>{this.messagesManager.addMessages(i)})),this.args.thread.details=n,this.args.targetMessageId?this.scrollToMessageId(this.args.targetMessageId,{highlight:!0}):this.args.thread.currentUserMembership?.lastReadMessageId?this.scrollToMessageId(this.args.thread.currentUserMembership?.lastReadMessageId):this.scrollToTop(),this.debounceFillPaneAttempt()}async fetchMoreMessages(e){let{direction:t}=e
if(this.messagesLoader.loading)return
const i=await this.messagesLoader.loadMore({direction:t})
if(!i)return
const[n,r]=this.processMessages(this.args.thread,i)
n?.length&&((0,v.stackingContextFix)(this.scrollable,(()=>{this.messagesManager.addMessages(n)})),this.args.thread.details=r,t===g.FUTURE?this.scrollToMessageId(n.firstObject.id,{position:"end",behavior:"auto"}):t===g.PAST&&this.scrollToMessageId(n.lastObject.id),this.debounceFillPaneAttempt())}scrollToLatestMessage(){this.messagesLoader.canLoadMoreFuture?this.fetchMessages():this.messagesManager.messages.length>0&&this.scrollToBottom()}debounceFillPaneAttempt(){this.messagesLoader.fetchedOnce&&(this._debouncedFillPaneAttemptHandler=(0,f.default)(this,this.fillPaneAttempt,500))}async fillPaneAttempt(){if(this.messagesManager.messages.length>200)return
if(!this.messagesLoader.canLoadMorePast)return
const e=this.messagesManager.messages.firstObject
e?.visible&&await this.fetchMoreMessages({direction:g.PAST})}scrollToMessageId(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{highlight:!1,position:"start",autoExpand:!1}
this._ignoreNextScroll=!0
const i=this.messagesManager.findMessage(e);(0,y.scrollListToMessage)(this.scrollable,i,t)}processMessages(e,t){return[t.messages.map((t=>{const i=(this.currentUser.ignored_users||[]).includes(t.user.username)
return l.default.create(e.channel,{...t,hidden:i,expanded:!(i||t.deleted_at),manager:this.messagesManager,thread:e})})),t.meta]}markThreadAsRead(){if(this.args.thread&&!this.args.thread.staged)return this.chatApi.markThreadAsRead(this.args.thread.channel.id,this.args.thread.id)}async onSendMessage(e){(0,p.resetIdle)(),await e.cook(),e.editing?await $(this,N,J).call(this,e):await $(this,L,K).call(this,e)}resetComposerMessage(){this.chatThreadComposer.reset(this.args.thread)}scrollToBottom(){this._ignoreNextScroll=!0,(0,y.scrollListToBottom)(this.scrollable)}scrollToTop(){this._ignoreNextScroll=!0,(0,y.scrollListToTop)(this.scrollable)}resendStagedMessage(){}},w=V(_.prototype,"appEvents",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=V(_.prototype,"capabilities",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=V(_.prototype,"chat",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=V(_.prototype,"chatApi",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=V(_.prototype,"chatComposerPresenceManager",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=V(_.prototype,"chatHistory",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=V(_.prototype,"chatThreadComposer",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=V(_.prototype,"chatThreadPane",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=V(_.prototype,"chatThreadPaneSubscriptionsManager",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=V(_.prototype,"currentUser",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=V(_.prototype,"router",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=V(_.prototype,"siteSettings",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=V(_.prototype,"isAtBottom",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),I=V(_.prototype,"isScrolling",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),A=V(_.prototype,"needsArrow",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),U=V(_.prototype,"uploadDropZone",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V(_.prototype,"resetIdle",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"resetIdle"),_.prototype),V(_.prototype,"messagesLoader",[s.cached],Object.getOwnPropertyDescriptor(_.prototype,"messagesLoader"),_.prototype),V(_.prototype,"handleKeydown",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"handleKeydown"),_.prototype),V(_.prototype,"didUpdateThread",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"didUpdateThread"),_.prototype),V(_.prototype,"setUploadDropZone",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"setUploadDropZone"),_.prototype),V(_.prototype,"subscribeToUpdates",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"subscribeToUpdates"),_.prototype),V(_.prototype,"teardown",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"teardown"),_.prototype),V(_.prototype,"onScroll",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"onScroll"),_.prototype),V(_.prototype,"onScrollEnd",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"onScrollEnd"),_.prototype),V(_.prototype,"updateLastReadMessage",[u.bind],Object.getOwnPropertyDescriptor(_.prototype,"updateLastReadMessage"),_.prototype),V(_.prototype,"setScrollable",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"setScrollable"),_.prototype),V(_.prototype,"loadMessages",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"loadMessages"),_.prototype),V(_.prototype,"didResizePane",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"didResizePane"),_.prototype),V(_.prototype,"fetchMoreMessages",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"fetchMoreMessages"),_.prototype),V(_.prototype,"scrollToLatestMessage",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"scrollToLatestMessage"),_.prototype),V(_.prototype,"processMessages",[u.bind],Object.getOwnPropertyDescriptor(_.prototype,"processMessages"),_.prototype),V(_.prototype,"onSendMessage",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"onSendMessage"),_.prototype),V(_.prototype,"resetComposerMessage",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"resetComposerMessage"),_.prototype),V(_.prototype,"scrollToBottom",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"scrollToBottom"),_.prototype),V(_.prototype,"scrollToTop",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"scrollToTop"),_.prototype),V(_.prototype,"resendStagedMessage",[o.action],Object.getOwnPropertyDescriptor(_.prototype,"resendStagedMessage"),_.prototype),_)
async function K(e){if(!this.chatThreadPane.sending){this.chatThreadPane.sending=!0,this._ignoreNextScroll=!0,(0,v.stackingContextFix)(this.scrollable,(async()=>{await this.args.thread.stageMessage(e)})),this.resetComposerMessage(),this.messagesLoader.canLoadMoreFuture||this.scrollToLatestMessage()
try{const t=await this.chatApi.sendMessage(this.args.thread.channel.id,{message:e.message,in_reply_to_id:e.thread.staged?e.thread.originalMessage?.id:null,staged_id:e.id,upload_ids:e.uploads.map((e=>e.id)),thread_id:e.thread.staged?null:e.thread.id,staged_thread_id:e.thread.staged?e.thread.id:null})
this.args.thread.currentUserMembership??=a.default.create({notification_level:r.NotificationLevels.TRACKING,last_read_message_id:t.message_id}),this.scrollToLatestMessage()}catch(t){$(this,R,Y).call(this,e.id,t)}finally{this.chatThreadPane.sending=!1}}}async function J(e){this.chatThreadPane.sending=!0
const t={new_message:e.message,upload_ids:e.uploads.map((e=>e.id))}
this.resetComposerMessage()
try{return await this.chatApi.editMessage(e.channel.id,e.id,t)}catch(i){(0,c.popupAjaxError)(i)}finally{this.chatThreadPane.sending=!1}}function Y(e,t){const i=this.args.thread.messagesManager.findStagedMessage(e)
i&&(t.jqXHR?.responseJSON?.errors?.length?i.error=t.jqXHR.responseJSON.errors[0]:(this.chat.markNetworkAsUnreliable(),i.error="network_error")),this.resetComposerMessage()}function Z(){const e=this._ignoreNextScroll
return this._ignoreNextScroll=!1,e}e.default=G,(0,t.setComponentTemplate)(q,G)})),define("discourse/plugins/chat/discourse/components/chat-to-topic-selector",["exports","@ember/component","@ember/template-factory","@ember/template","discourse-common/utils/decorators","@ember/object/computed"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.NEW_TOPIC_SELECTION=e.NEW_MESSAGE_SELECTION=e.EXISTING_TOPIC_SELECTION=void 0
const d=(0,i.createTemplateFactory)({id:"NiQ70pNF",block:'[[[10,0],[14,0,"chat-to-topic-selector"],[12],[1,"\\n  "],[10,0],[14,0,"radios"],[12],[1,"\\n    "],[10,"label"],[14,0,"radio-label"],[14,"for","move-to-new-topic"],[12],[1,"\\n      "],[8,[39,0],null,[["@id","@name","@value","@selection"],["move-to-new-topic","move-to-entity",[30,0,["newTopicSelection"]],[30,0,["selection"]]]],null],[1,"\\n      "],[10,"b"],[12],[1,[28,[35,1],["topic.split_topic.radio_label"],null]],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,"label"],[14,0,"radio-label"],[14,"for","move-to-existing-topic"],[12],[1,"\\n      "],[8,[39,0],null,[["@id","@name","@value","@selection"],["move-to-existing-topic","move-to-entity",[30,0,["existingTopicSelection"]],[30,0,["selection"]]]],null],[1,"\\n      "],[10,"b"],[12],[1,[28,[35,1],["topic.merge_topic.radio_label"],null]],[13],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,0,["allowNewMessage"]],[[[1,"      "],[10,"label"],[14,0,"radio-label"],[14,"for","move-to-new-message"],[12],[1,"\\n        "],[8,[39,0],null,[["@id","@name","@value","@selection"],["move-to-new-message","move-to-entity",[30,0,["newMessageSelection"]],[30,0,["selection"]]]],null],[1,"\\n        "],[10,"b"],[12],[1,[28,[35,1],["topic.move_to_new_message.radio_label"],null]],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n\\n"],[41,[30,0,["newTopic"]],[[[1,"    "],[10,2],[12],[1,[30,0,["newTopicInstruction"]]],[13],[1,"\\n\\n    "],[10,"form"],[12],[1,"\\n      "],[10,"label"],[14,"for","split-topic-name"],[12],[1,"\\n        "],[1,[28,[35,1],["topic.split_topic.topic_name"],null]],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[39,3],null,[["@value","@placeholderKey","@id"],[[30,0,["topicTitle"]],"composer.title_placeholder","split-topic-name"]],null],[1,"\\n\\n      "],[10,"label"],[12],[1,[28,[35,1],["categories.category"],null]],[13],[1,"\\n\\n      "],[8,[39,4],null,[["@id","@value","@class","@onChange"],["new-topic-category-selector",[30,0,["categoryId"]],"small",[28,[37,5],[[30,0],[28,[37,6],[[30,0,["categoryId"]]],null]],null]]],null],[1,"\\n\\n"],[41,[30,0,["canAddTags"]],[[[1,"        "],[10,"label"],[12],[1,[28,[35,1],["tagging.tags"],null]],[13],[1,"\\n        "],[8,[39,7],null,[["@tags","@filterable","@categoryId"],[[30,0,["tags"]],true,[30,0,["categoryId"]]]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["existingTopic"]],[[[1,"    "],[10,2],[12],[1,[30,0,["existingTopicInstruction"]]],[13],[1,"\\n    "],[10,"form"],[12],[1,"\\n      "],[8,[39,8],null,[["@selectedTopicId"],[[30,0,["selectedTopicId"]]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[28,[37,9],[[30,0,["allowNewMessage"]],[30,0,["newMessage"]]],null],[[[1,"    "],[10,2],[12],[1,[30,0,["newMessageInstruction"]]],[13],[1,"\\n\\n    "],[10,"form"],[12],[1,"\\n      "],[10,"label"],[14,"for","split-message-title"],[12],[1,"\\n        "],[1,[28,[35,1],["topic.move_to_new_message.message_title"],null]],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[39,3],null,[["@value","@placeholderKey","@id"],[[30,0,["topicTitle"]],"composer.title_placeholder","split-message-title"]],null],[1,"\\n\\n"],[41,[30,0,["canTagMessages"]],[[[1,"        "],[10,"label"],[12],[1,[28,[35,1],["tagging.tags"],null]],[13],[1,"\\n        "],[8,[39,7],null,[["@tags","@filterable"],[[30,0,["tags"]],true]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n"]],[]],null],[13]],[],false,["radio-button","i18n","if","text-field","category-chooser","action","mut","tag-chooser","choose-topic","and"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-to-topic-selector.hbs",isStrictMode:!1}),h="new_topic"
e.NEW_TOPIC_SELECTION=h
const p="existing_topic"
e.EXISTING_TOPIC_SELECTION=p
const m="new_message"
e.NEW_MESSAGE_SELECTION=m
var b=(0,t.setComponentTemplate)(d,t.default.extend((s=(0,r.default)(),o=(0,r.default)(),l=(0,r.default)(),u(c={newTopicSelection:h,existingTopicSelection:p,newMessageSelection:m,selection:null,newTopic:(0,a.equal)("selection",h),existingTopic:(0,a.equal)("selection",p),newMessage:(0,a.equal)("selection",m),canAddTags:(0,a.alias)("site.can_create_tag"),canTagMessages:(0,a.alias)("site.can_tag_pms"),topicTitle:null,categoryId:null,tags:null,selectedTopicId:null,chatMessageIds:null,chatChannelId:null,newTopicInstruction(){return(0,n.htmlSafe)(this.instructionLabels[h])},existingTopicInstruction(){return(0,n.htmlSafe)(this.instructionLabels[p])},newMessageInstruction(){return(0,n.htmlSafe)(this.instructionLabels[m])}},"newTopicInstruction",[s],Object.getOwnPropertyDescriptor(c,"newTopicInstruction"),c),u(c,"existingTopicInstruction",[o],Object.getOwnPropertyDescriptor(c,"existingTopicInstruction"),c),u(c,"newMessageInstruction",[l],Object.getOwnPropertyDescriptor(c,"newMessageInstruction"),c),c)))
e.default=b})),define("discourse/plugins/chat/discourse/components/chat-upload-drop-zone",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/plugins/chat/discourse/models/chat-thread","I18n"],(function(e,t,i,n,r,a){"use strict"
function s(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"N5UT4JeN",block:'[[[10,0],[14,0,"chat-upload-drop-zone"],[12],[1,"\\n  "],[10,0],[14,0,"chat-upload-drop-zone__content"],[12],[1,"\\n    "],[10,0],[14,0,"chat-upload-drop-zone__background"],[12],[1,"\\n      "],[10,"svg"],[14,"width","94"],[14,"height","90"],[14,"viewBox","0 0 94 90"],[14,"fill","none"],[14,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[12],[1,"\\n        "],[10,"path"],[14,"d","M94 40.5591C94 69.8685 64.0686 90 40.9592 90C17.8499 90 0 83.9085 0 60.6907C0 37.4729 28.458 0 51.5674 0C74.6768 0 94 17.3413 94 40.5591Z"],[14,"fill","#D1F0FF"],[12],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n    "],[10,0],[14,0,"chat-upload-drop-zone__illustration"],[12],[1,"\\n      "],[10,"svg"],[14,"width","106"],[14,"height","84"],[14,"viewBox","0 0 106 84"],[14,"fill","none"],[14,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[12],[1,"\\n        "],[10,"rect"],[14,"x","55.832"],[14,"y","6.82959"],[14,"width","45.7854"],[14,"height","33.8408"],[14,"transform","rotate(13.4039 55.832 6.82959)"],[14,"fill","#D9D9D9"],[12],[13],[1,"\\n        "],[10,"path"],[14,"d","M100.66 13.7645L61.1414 4.34705C58.6715 3.75846 56.1786 5.37298 55.59 7.84288L47.6214 41.2815C47.0102 43.8464 48.5297 46.3167 50.9996 46.9053L90.518 56.3227C92.9879 56.9113 95.5532 55.4145 96.1644 52.8496L104.133 19.4109C104.722 16.941 103.225 14.3757 100.66 13.7645ZM58.7093 41.5144C58.5961 41.9894 58.1482 42.1838 57.7682 42.0933L53.2084 41.0067C52.7334 40.8935 52.5163 40.5406 52.6295 40.0656L53.7161 35.5058C53.8067 35.1258 54.1822 34.8137 54.6572 34.9269L59.122 35.9909C59.502 36.0815 59.7915 36.552 59.7009 36.932L58.7093 41.5144ZM61.6069 29.3549C61.4938 29.8299 61.0459 30.0243 60.6659 29.9338L56.1061 28.8472C55.6311 28.734 55.414 28.3811 55.5272 27.9061L56.6138 23.3463C56.7044 22.9663 57.0799 22.6542 57.5549 22.7674L62.0197 23.8314C62.3997 23.922 62.6891 24.3925 62.5986 24.7725L61.5119 29.3323L61.6069 29.3549ZM64.5046 17.1954C64.3914 17.6704 63.9435 17.8648 63.5635 17.7743L59.0037 16.6877C58.5287 16.5745 58.3117 16.2216 58.4249 15.7466L59.5115 11.1868C59.602 10.8068 59.9776 10.4947 60.4526 10.6079L64.9174 11.6719C65.2974 11.7625 65.5868 12.233 65.4962 12.613L64.5046 17.1954ZM81.6894 46.1876C81.4857 47.0426 80.5673 47.5264 79.8073 47.3453L64.6079 43.7232C63.753 43.5195 63.2464 42.6961 63.4502 41.8411L65.6234 32.7215C65.8045 31.9615 66.6506 31.36 67.5056 31.5637L82.705 35.1858C83.4649 35.3669 84.0438 36.308 83.8627 37.068L81.6894 46.1876ZM86.036 27.9483C85.8322 28.8033 84.9138 29.2872 84.1538 29.1061L68.9544 25.484C68.0995 25.2802 67.593 24.4568 67.7967 23.6018L69.97 14.4822C70.1511 13.7222 70.9971 13.1207 71.8521 13.3245L87.0515 16.9466C87.8114 17.1277 88.3903 18.0687 88.2092 18.8287L86.036 27.9483ZM92.1479 49.483C92.0347 49.958 91.5868 50.1524 91.2068 50.0619L86.742 48.9979C86.267 48.8847 86.05 48.5318 86.1631 48.0568L87.2498 43.497C87.3403 43.117 87.8109 42.8276 88.1908 42.9181L92.7507 44.0048C93.1306 44.0953 93.4201 44.5659 93.3295 44.9458L92.2429 49.5057L92.1479 49.483ZM95.0456 37.3235C94.9324 37.7985 94.4845 37.9929 94.1045 37.9024L89.6397 36.8384C89.1647 36.7252 88.9476 36.3723 89.0608 35.8973L90.1474 31.3375C90.238 30.9575 90.6135 30.6455 91.0885 30.7586L95.5533 31.8226C95.9333 31.9132 96.2228 32.3837 96.1322 32.7637L95.0456 37.3235ZM97.9432 25.164C97.8301 25.639 97.3822 25.8334 97.0022 25.7429L92.5374 24.6789C92.0624 24.5657 91.8453 24.2128 91.9585 23.7378L93.0451 19.178C93.1357 18.798 93.5112 18.486 93.8912 18.5765L98.356 19.6405C98.736 19.731 99.0254 20.2016 98.9349 20.5816L97.8483 25.1414L97.9432 25.164Z"],[14,"fill","#AFAFAF"],[12],[13],[1,"\\n        "],[10,"path"],[14,"d","M30.7898 24.814L27.2823 9.2672L4.41944 14.4252C2.81904 14.7863 1.95958 16.3017 2.29486 17.7878L14.2615 70.8296C14.6226 72.43 16.0236 73.3153 17.624 72.9542L56.0337 64.2887C57.5198 63.9534 58.5193 62.5266 58.1582 60.9262L49.699 23.4311L34.1523 26.9385C32.5519 27.2996 31.1508 26.4144 30.7898 24.814ZM48.719 19.0871C48.5643 18.4012 48.0666 17.7927 47.4804 17.3243L33.7501 8.64894C33.0754 8.32063 32.3121 8.13243 31.6263 8.28717L30.9404 8.44191L34.2415 23.0742L48.8738 19.773L48.719 19.0871Z"],[14,"fill","#0AADFF"],[12],[13],[1,"\\n        "],[10,"rect"],[14,"x","41.7334"],[14,"y","40.3967"],[14,"width","37.6309"],[14,"height","28.6511"],[14,"transform","rotate(6.29289 41.7334 40.3967)"],[14,"fill","#66CCFF"],[12],[13],[1,"\\n        "],[10,"path"],[14,"d","M76.768 40.4721L44.4638 36.9097C42.3671 36.6785 40.548 38.2071 40.3254 40.2261L37.8591 62.5905C37.6279 64.6872 39.0788 66.4977 41.1755 66.729L73.4796 70.2913C75.4987 70.514 77.3869 69.0716 77.6181 66.9749L80.0843 44.6105C80.307 42.5915 78.787 40.6947 76.768 40.4721ZM73.4248 66.5125L42.0524 63.0529C41.7418 63.0187 41.6036 62.8462 41.6379 62.5356L44.0014 41.103C44.0271 40.8701 44.2081 40.6542 44.5187 40.6885L75.891 44.1481C76.124 44.1738 76.3312 44.4324 76.3056 44.6654L73.9421 66.098C73.9078 66.4086 73.6577 66.5382 73.4248 66.5125ZM49.9226 44.4284C48.1365 44.2314 46.6623 45.4836 46.4739 47.192C46.2769 48.978 47.4514 50.4437 49.2375 50.6407C50.9459 50.8291 52.4892 49.6631 52.6862 47.8771C52.8746 46.1687 51.631 44.6168 49.9226 44.4284ZM45.725 59.6852L70.5743 62.4255L71.2594 56.2131L65.1708 48.7036C64.8254 48.2725 64.2818 48.2126 63.8507 48.558L53.5908 56.7799L50.8186 53.4088C50.4732 52.9777 49.9296 52.9178 49.4985 53.2632L46.136 55.9578L45.725 59.6852Z"],[14,"fill","white"],[12],[13],[1,"\\n        "],[10,"path"],[14,"d","M37.8174 63.0181L77.5892 66.862L77.012 72.8342C76.9057 73.9336 75.9283 74.7388 74.8288 74.6325L39.0385 71.1734C37.939 71.0671 37.1339 70.0897 37.2402 68.9902L37.8174 63.0181Z"],[14,"fill","white"],[12],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n    "],[10,0],[14,0,"chat-upload-drop-zone__text"],[12],[1,"\\n      "],[10,1],[14,0,"chat-upload-drop-zone__text__title"],[12],[1,"\\n        "],[1,[30,0,["title"]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13]],[],false,[]]',moduleName:"discourse/plugins/chat/discourse/components/chat-upload-drop-zone.hbs",isStrictMode:!1})
var l=new WeakSet
class c extends n.default{constructor(){super(...arguments),s(this,l)}get title(){return function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,l,u).call(this)?a.default.t("chat.upload_to_thread"):a.default.t("chat.upload_to_channel",{title:this.args.model.title})}}function u(){return this.args.model instanceof r.default}e.default=c,(0,t.setComponentTemplate)(o,c)})),define("discourse/plugins/chat/discourse/components/chat-upload",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service","discourse/lib/uploads","@ember/object","@glimmer/tracking","@ember/template"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,i.createTemplateFactory)({id:"o9Feodj5",block:'[[[41,[28,[37,1],[[30,0,["type"]],[30,0,["IMAGE_TYPE"]]],null],[[[1,"  "],[11,"img"],[24,0,"chat-img-upload"],[16,"data-orig-src",[30,1,["short_url"]]],[16,"height",[30,0,["size","height"]]],[16,"width",[30,0,["size","width"]]],[16,"src",[30,1,["url"]]],[16,5,[30,0,["imageStyle"]]],[24,"loading","lazy"],[24,"tabindex","0"],[4,[38,2],["load",[30,0,["imageLoaded"]]],null],[12],[13],[1,"\\n"]],[]],[[[41,[28,[37,1],[[30,0,["type"]],[30,0,["VIDEO_TYPE"]]],null],[[[1,"  "],[10,"video"],[14,0,"chat-video-upload"],[14,"preload","metadata"],[14,"controls",""],[12],[1,"\\n    "],[10,"source"],[15,"src",[30,1,["url"]]],[12],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[41,[28,[37,1],[[30,0,["type"]],[30,0,["AUDIO_TYPE"]]],null],[[[1,"  "],[10,"audio"],[14,0,"chat-audio-upload"],[14,"preload","metadata"],[14,"controls",""],[12],[1,"\\n    "],[10,"source"],[15,"src",[30,1,["url"]]],[12],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[1,"  "],[10,3],[14,0,"chat-other-upload"],[15,"data-orig-href",[30,1,["short_url"]]],[15,6,[30,1,["url"]]],[12],[1,"\\n    "],[1,[30,1,["original_filename"]]],[1,"\\n  "],[13],[1,"\\n"]],[]]]],[]]]],[]]]],["@upload"],false,["if","eq","on"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-upload.hbs",isStrictMode:!1})
var g=(0,t.setComponentTemplate)(b,(c=class extends n.default{constructor(){super(...arguments),h(this,"siteSettings",u,this),h(this,"loaded",d,this),p(this,"IMAGE_TYPE","image"),p(this,"VIDEO_TYPE","video"),p(this,"AUDIO_TYPE","audio"),p(this,"ATTACHMENT_TYPE","attachment")}get type(){return(0,a.isImage)(this.args.upload.original_filename)?this.IMAGE_TYPE:(0,a.isVideo)(this.args.upload.original_filename)?this.VIDEO_TYPE:(0,a.isAudio)(this.args.upload.original_filename)?this.AUDIO_TYPE:this.ATTACHMENT_TYPE}get size(){const e=this.args.upload.width,t=this.args.upload.height,i=Math.min(this.siteSettings.max_image_width/e,this.siteSettings.max_image_height/t)
return{width:e*i,height:t*i}}get imageStyle(){if(this.args.upload.dominant_color&&!this.loaded)return(0,l.htmlSafe)(`background-color: #${this.args.upload.dominant_color};`)}imageLoaded(){this.loaded=!0}},u=m(c.prototype,"siteSettings",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(c.prototype,"loaded",[o.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m(c.prototype,"imageLoaded",[s.action],Object.getOwnPropertyDescriptor(c.prototype,"imageLoaded"),c.prototype),c))
e.default=g})),define("discourse/plugins/chat/discourse/components/chat-user-display-name",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/lib/utilities","@ember/service"],(function(e,t,i,n,r,a){"use strict"
var s,o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,i.createTemplateFactory)({id:"l+SlWfo/",block:'[[[10,1],[14,0,"chat-user-display-name"],[12],[1,"\\n"],[41,[30,0,["shouldShowNameFirst"]],[[[1,"    "],[10,1],[14,0,"chat-user-display-name__name -first"],[12],[1,[30,1,["name"]]],[13],[1,"\\n    "],[10,1],[14,0,"separator"],[12],[1,""],[13],[1,"\\n"]],[]],null],[1,"\\n  "],[10,1],[15,0,[28,[37,1],["chat-user-display-name__username",[52,[51,[30,0,["shouldShowNameFirst"]]],"-first"]],null]],[12],[1,"\\n    "],[1,[30,0,["formattedUsername"]]],[1,"\\n  "],[13],[1,"\\n\\n"],[41,[30,0,["shouldShowNameLast"]],[[[1,"    "],[10,1],[14,0,"separator"],[12],[1,""],[13],[1,"\\n    "],[10,1],[14,0,"chat-user-display-name__name"],[12],[1,[30,1,["name"]]],[13],[1,"\\n"]],[]],null],[13]],["@user"],false,["if","concat-class","unless"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-user-display-name.hbs",isStrictMode:!1})
let c=(s=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="siteSettings",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get shouldPrioritizeNameInUx(){return!this.siteSettings.prioritize_username_in_ux}get hasValidName(){return this.args.user?.name&&this.args.user.name.trim().length>0}get formattedUsername(){return(0,r.formatUsername)(this.args.user?.username)}get shouldShowNameFirst(){return this.shouldPrioritizeNameInUx&&this.hasValidName}get shouldShowNameLast(){return!this.shouldPrioritizeNameInUx&&this.hasValidName}},u=s.prototype,d="siteSettings",h=[a.inject],p={configurable:!0,enumerable:!0,writable:!0,initializer:null},b={},Object.keys(p).forEach((function(e){b[e]=p[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=h.slice().reverse().reduce((function(e,t){return t(u,d,e)||e}),b),m&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(m):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(u,d,b),b=null),o=b,s)
var u,d,h,p,m,b
e.default=c,(0,t.setComponentTemplate)(l,c)})),define("discourse/plugins/chat/discourse/components/chat-user-info",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/lib/url"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,i.createTemplateFactory)({id:"5di20JWa",block:'[[[41,[30,1],[[[1,"  "],[10,3],[15,6,[30,0,["userPath"]]],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n    "],[8,[39,1],null,[["@user","@avatarSize"],[[30,1],"medium"]],null],[1,"\\n  "],[13],[1,"\\n  "],[10,3],[15,6,[30,0,["userPath"]]],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n    "],[8,[39,2],null,[["@user"],[[30,1]]],null],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@user"],false,["if","chat/user-avatar","chat-user-display-name"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-user-info.hbs",isStrictMode:!1})
class s extends n.default{get userPath(){return(0,r.userPath)(this.args.user.username)}}e.default=s,(0,t.setComponentTemplate)(a,s)})),define("discourse/plugins/chat/discourse/components/chat-vh",["exports","discourse-common/utils/decorators","@ember/component","@ember/service","discourse/plugins/chat/discourse/lib/zoom-check"],(function(e,t,i,n,r){"use strict"
var a,s,o
function l(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function c(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let d,h=(o=new WeakSet,a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),l(this,o),e=this,t="capabilities",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),c(this,"tagName","")}didInsertElement(){this._super(...arguments),"virtualKeyboard"in navigator&&(navigator.virtualKeyboard.overlaysContent=!0,navigator.virtualKeyboard.addEventListener("geometrychange",this.setVH)),this.activeWindow=window.visualViewport||window,this.activeWindow.addEventListener("resize",this.setVH),this.setVH()}willDestroyElement(){this._super(...arguments),this.activeWindow?.removeEventListener("resize",this.setVH),d=null,"virtualKeyboard"in navigator&&navigator.virtualKeyboard.removeEventListener("geometrychange",this.setVH)}setVH(){if((0,r.default)())return
let e
e="virtualKeyboard"in navigator?window.visualViewport.height-navigator.virtualKeyboard.boundingRect.height:this.activeWindow?.height||window.innerHeight
const t=.01*e
d!==t&&(d=t,document.documentElement.style.setProperty("--chat-vh",`${t}px`))}},s=u(a.prototype,"capabilities",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(a.prototype,"setVH",[t.bind],Object.getOwnPropertyDescriptor(a.prototype,"setVH"),a.prototype),a)
e.default=h})),define("discourse/plugins/chat/discourse/components/chat/admin/export-messages",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object","@ember/service","discourse/lib/ajax-error","I18n"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,i.createTemplateFactory)({id:"jRHxYVaG",block:'[[[10,"section"],[14,0,"admin-section"],[12],[1,"\\n  "],[10,"h3"],[12],[1,[28,[35,0],["chat.admin.export_messages.title"],null]],[13],[1,"\\n  "],[10,2],[12],[1,[28,[35,0],["chat.admin.export_messages.description"],null]],[13],[1,"\\n  "],[8,[39,1],null,[["@label","@title","@class","@action"],["chat.admin.export_messages.create_export","chat.admin.export_messages.create_export","btn-primary",[30,0,["exportMessages"]]]],null],[1,"\\n"],[13]],[],false,["i18n","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/admin/export-messages.hbs",isStrictMode:!1})
let m=(l=class extends n.default{constructor(){super(...arguments),d(this,"chatAdminApi",c,this),d(this,"dialog",u,this)}async exportMessages(){try{await this.chatAdminApi.exportMessages(),this.dialog.alert(o.default.t("chat.admin.export_messages.export_has_started"))}catch(e){(0,s.popupAjaxError)(e)}}},c=h(l.prototype,"chatAdminApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(l.prototype,"dialog",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(l.prototype,"exportMessages",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"exportMessages"),l.prototype),l)
e.default=m,(0,t.setComponentTemplate)(p,m)})),define("discourse/plugins/chat/discourse/components/chat/composer/button",["exports","@ember/component","@ember/template-factory","@glimmer/component"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"UWG6Qkfs",block:'[[[10,0],[14,0,"chat-composer-button__wrapper"],[12],[1,"\\n  "],[11,"button"],[24,4,"button"],[24,0,"chat-composer-button"],[17,1],[12],[1,"\\n    "],[1,[28,[35,0],[[30,2]],null]],[1,"\\n  "],[13],[1,"\\n"],[13]],["&attrs","@icon"],false,["d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/composer/button.hbs",isStrictMode:!1})
class a extends n.default{}e.default=a,(0,t.setComponentTemplate)(r,a)})),define("discourse/plugins/chat/discourse/components/chat/composer/channel",["exports","discourse/plugins/chat/discourse/components/chat-composer","@ember/service","I18n","discourse-common/lib/debounce","@ember/object"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function g(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let v=(s=(0,i.inject)("chat-channel-composer"),o=(0,i.inject)("chat-channel-pane"),p=new WeakSet,l=class extends t.default{constructor(){super(...arguments),b(this,p),m(this,"composer",c,this),m(this,"pane",u,this),m(this,"chatDraftsManager",d,this),m(this,"currentUser",h,this),g(this,"context","channel"),g(this,"composerId","channel-composer")}get shouldRenderReplyingIndicator(){return this.args.channel}get presenceChannelName(){return`/chat-reply/${this.args.channel.id}`}get disabled(){return!this.chat.userCanInteractWithChat||!this.args.channel.canModifyMessages(this.currentUser)}reset(){this.composer.reset(this.args.channel)}persistDraft(){this.chatDraftsManager.add(this.currentMessage),this._persistHandler=(0,r.default)(this,this._debouncedPersistDraft,this.args.channel.id,this.currentMessage.toJSONDraft(),2e3)}_debouncedPersistDraft(e,t){this.chatApi.saveDraft(e,t).then((()=>{this.currentMessage&&(this.currentMessage.draftSaved=!0)}))}get lastMessage(){return this.args.channel.lastMessage}lastUserMessage(e){return this.args.channel.messagesManager.findLastUserMessage(e)}get placeholder(){return this.args.channel.canModifyMessages(this.currentUser)?this.chat.userCanInteractWithChat?function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,p,y).call(this,this.args.channel):n.default.t("chat.placeholder_silenced"):n.default.t(`chat.placeholder_new_message_disallowed.${this.args.channel.status}`)}handleEscape(e){e.stopPropagation(),this.currentMessage?.inReplyTo?this.reset():this.currentMessage?.editing?this.composer.cancel(this.args.channel):e.target.blur()}},c=f(l.prototype,"composer",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=f(l.prototype,"pane",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=f(l.prototype,"chatDraftsManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=f(l.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f(l.prototype,"reset",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"reset"),l.prototype),f(l.prototype,"persistDraft",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"persistDraft"),l.prototype),f(l.prototype,"_debouncedPersistDraft",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"_debouncedPersistDraft"),l.prototype),l)
function y(e){if(e.isDirectMessageChannel){const t=e.chatable.users
return 1===t.length&&t[0].id===this.currentUser.id?n.default.t("chat.placeholder_self"):n.default.t("chat.placeholder_users",{commaSeparatedNames:t.map((e=>e.name||`@${e.username}`)).join(n.default.t("word_connector.comma"))})}return n.default.t("chat.placeholder_channel",{channelName:`#${e.title}`})}e.default=v})),define("discourse/plugins/chat/discourse/components/chat/composer/separator",["exports","@ember/component","@ember/template-factory","@glimmer/component"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"eEB+qb1x",block:'[[[10,0],[14,0,"chat-composer-separator"],[12],[13]],[],false,[]]',moduleName:"discourse/plugins/chat/discourse/components/chat/composer/separator.hbs",isStrictMode:!1})
class a extends n.default{}e.default=a,(0,t.setComponentTemplate)(r,a)})),define("discourse/plugins/chat/discourse/components/chat/composer/thread",["exports","discourse/plugins/chat/discourse/components/chat-composer","@ember/service","I18n","@ember/object"],(function(e,t,i,n,r){"use strict"
var a,s,o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let g=(a=(0,i.inject)("chat-channel-composer"),s=(0,i.inject)("chat-thread-composer"),o=(0,i.inject)("chat-thread-pane"),l=class extends t.default{constructor(){super(...arguments),p(this,"channelComposer",c,this),p(this,"composer",u,this),p(this,"pane",d,this),p(this,"currentUser",h,this),m(this,"context","thread"),m(this,"composerId","thread-composer")}reset(){this.composer.reset(this.args.thread)}get shouldRenderReplyingIndicator(){return this.args.thread}get disabled(){return!this.chat.userCanInteractWithChat||!this.args.thread.channel.canModifyMessages(this.currentUser)}get presenceChannelName(){const e=this.args.thread
return`/chat-reply/${e.channel.id}/thread/${e.id}`}get placeholder(){return n.default.t("chat.placeholder_thread")}lastUserMessage(e){return this.args.thread.messagesManager.findLastUserMessage(e)}handleEscape(e){if(this.currentMessage.editing)return e.stopPropagation(),void this.composer.cancel(this.args.thread)
this.isFocused?(e.stopPropagation(),this.composer.blur()):this.pane.close().then((()=>{this.channelComposer.focus()}))}},c=b(l.prototype,"channelComposer",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=b(l.prototype,"composer",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=b(l.prototype,"pane",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=b(l.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b(l.prototype,"reset",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"reset"),l.prototype),l)
e.default=g})),define("discourse/plugins/chat/discourse/components/chat/header/icon",["exports","@ember/component","@ember/template-factory","@ember/service","@glimmer/component","discourse-common/lib/get-url"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,i.createTemplateFactory)({id:"keqoXnwH",block:'[[[10,3],[15,6,[30,0,["href"]]],[14,"tabindex","0"],[15,0,[28,[37,0],["icon","btn-flat",[52,[30,0,["isActive"]],"active"]],null]],[12],[1,"\\n  "],[1,[28,[35,2],["d-chat"],null]],[1,"\\n"],[41,[51,[30,0,["currentUserInDnD"]]],[[[1,"    "],[8,[39,4],null,[["@urgentCount","@unreadCount","@indicatorPreference"],[[30,1],[30,2],[30,3]]],null],[1,"\\n"]],[]],null],[13]],["@urgentCount","@unreadCount","@indicatorPreference"],false,["concat-class","if","d-icon","unless","chat/header/icon/unread-indicator"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/header/icon.hbs",isStrictMode:!1})
let m=(s=class extends r.default{constructor(){super(...arguments),d(this,"currentUser",o,this),d(this,"site",l,this),d(this,"chatStateManager",c,this),d(this,"router",u,this)}get currentUserInDnD(){return this.args.currentUserInDnD||this.currentUser.isInDoNotDisturb()}get isActive(){return this.args.isActive||this.chatStateManager.isFullPageActive||this.chatStateManager.isDrawerActive}get href(){return this.chatStateManager.isFullPageActive?this.site.mobileView?(0,a.default)("/chat"):(0,a.default)(this.router.currentURL):this.chatStateManager.isDrawerActive?(0,a.default)("/chat"):(0,a.default)(this.chatStateManager.lastKnownChatURL||"/chat")}},o=h(s.prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=h(s.prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(s.prototype,"chatStateManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(s.prototype,"router",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s)
e.default=m,(0,t.setComponentTemplate)(p,m)})),define("discourse/plugins/chat/discourse/components/chat/header/icon/unread-indicator",["exports","@ember/component","@ember/template-factory","@ember/service","@glimmer/component","discourse/plugins/chat/discourse/controllers/preferences-chat"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function h(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,i.createTemplateFactory)({id:"+OVZiQuE",block:'[[[41,[30,0,["showUrgentIndicator"]],[[[1,"  "],[10,0],[14,0,"chat-channel-unread-indicator -urgent"],[12],[1,"\\n    "],[10,0],[14,0,"chat-channel-unread-indicator__number"],[12],[1,"\\n      "],[1,[30,0,["unreadCountLabel"]]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[41,[30,0,["showUnreadIndicator"]],[[[1,"  "],[10,0],[14,0,"chat-channel-unread-indicator"],[12],[13],[1,"\\n"]],[]],null]],[]]]],[],false,["if"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/header/icon/unread-indicator.hbs",isStrictMode:!1})
let b=(c=new WeakSet,s=class extends r.default{constructor(){super(...arguments),d(this,c),u(this,"chatTrackingStateManager",o,this),u(this,"currentUser",l,this)}get urgentCount(){return this.args.urgentCount||this.chatTrackingStateManager.allChannelUrgentCount}get unreadCount(){return this.args.unreadCount||this.chatTrackingStateManager.publicChannelUnreadCount}get indicatorPreference(){return this.args.indicatorPreference||this.currentUser.user_option.chat_header_indicator_preference}get showUrgentIndicator(){return this.urgentCount>0&&h(this,c,g).call(this,[a.HEADER_INDICATOR_PREFERENCE_ALL_NEW,a.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS])}get showUnreadIndicator(){return this.unreadCount>0&&h(this,c,g).call(this,[a.HEADER_INDICATOR_PREFERENCE_ALL_NEW])}get unreadCountLabel(){return this.urgentCount>99?"99+":this.urgentCount}},o=p(s.prototype,"chatTrackingStateManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=p(s.prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s)
function g(e){return!(!this.currentUser||this.indicatorPreference===a.HEADER_INDICATOR_PREFERENCE_NEVER)&&e.includes(this.indicatorPreference)}e.default=b,(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/chat/message-creator",["exports","@ember/component","@ember/template-factory","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@ember-compat/tracked-built-ins","@ember/runloop","discourse-common/lib/debounce","@ember/application","discourse-common/config/environment","I18n","discourse/plugins/chat/discourse/models/chat-chatable","discourse/lib/utilities","@ember/template"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b){"use strict"
var g,f,v,y,_,w,j,M,z,k,O,C,S,P,T,E,x,D,I,A,U,L,N,R,F,W,B,H,$,V,q,G,K,J,Y,Z,X
function Q(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ee(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function te(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function ie(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const ne=(0,i.createTemplateFactory)({id:"2/zTAMN2",block:'[[[10,0],[14,0,"chat-message-creator__container"],[12],[1,"\\n  "],[10,0],[14,0,"chat-message-creator"],[12],[1,"\\n    "],[11,0],[24,0,"chat-message-creator__selection-container"],[17,1],[4,[38,0],[[30,0,["focusInput"]]],null],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__selection"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-creator__search-icon-container"],[12],[1,"\\n          "],[1,[28,[35,1],["search"],[["class"],["chat-message-creator__search-icon"]]]],[1,"\\n        "],[13],[1,"\\n\\n"],[42,[28,[37,3],[[28,[37,3],[[30,0,["selection"]]],null]],null],null,[[[1,"          "],[11,0],[16,0,[28,[37,4],["chat-message-creator__selection-item",[28,[37,5],["-",[30,2,["type"]]],null],[52,[28,[37,7],[[30,0,["activeSelectionIdentifiers"]],[30,2,["identifier"]]],null],"-active"]],null]],[24,"tabindex","-1"],[16,"data-id",[30,2,["identifier"]]],[4,[38,8],["click",[28,[37,9],[[30,0,["removeSelection"]],[30,2,["identifier"]]],null]],null],[12],[1,"\\n            "],[46,[28,[37,5],["chat/message-creator/",[30,2,["type"]],"-selection"],null],null,[["selection"],[[30,2]]],null],[1,"\\n            "],[10,"i"],[14,0,"chat-message-creator__selection__remove-btn"],[14,"aria-hidden","true"],[12],[1,"\\n              "],[1,[28,[35,1],["times"],null]],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[2]],null],[1,"\\n        "],[8,[39,11],[[24,0,"chat-message-creator__input"],[16,"placeholder",[30,0,["placeholder"]]],[4,[38,0],[[30,0,["setQueryElement"]]],null],[4,[38,8],["input",[30,0,["handleInput"]]],null],[4,[38,8],["keydown",[30,0,["handleKeydown"]]],null]],[["@value","@type"],[[28,[37,12],[[30,0,["query"]]],null],"text"]],null],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[39,13],[[24,0,"chat-message-creator__close-btn btn-flat"]],[["@icon","@action"],["times",[30,3]]],null],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,0,["showResults"]],[[[1,"      "],[10,0],[14,0,"chat-message-creator__content-container"],[14,"role","presentation"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-creator__content"],[14,"role","listbox"],[14,"aria-multiselectable","true"],[14,"tabindex","-1"],[12],[1,"\\n"],[41,[30,0,["searchRequest","loading"]],[[[1,"            "],[10,0],[14,0,"chat-message-creator__loader-container"],[12],[1,"\\n              "],[10,0],[14,0,"chat-message-creator__loader spinner small"],[12],[13],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[42,[28,[37,3],[[28,[37,3],[[30,0,["searchRequest","value"]]],null]],null],null,[[[1,"              "],[11,0],[16,0,[28,[37,4],["chat-message-creator__row",[28,[37,5],["-",[30,4,["type"]]],null],[52,[51,[30,4,["enabled"]]],"-disabled"],[52,[28,[37,15],[[30,0,["activeResultIdentifier"]],[30,4,["identifier"]]],null],"-active"],[52,[28,[37,7],[[30,0,["selectionIdentifiers"]],[30,4,["identifier"]]],null],"-selected"]],null]],[16,"data-id",[30,4,["identifier"]]],[24,"tabindex","-1"],[24,"role","option"],[16,"aria-selected",[52,[28,[37,7],[[30,0,["selectionIdentifiers"]],[30,4,["identifier"]]],null],"true","false"]],[4,[38,8],["click",[28,[37,9],[[30,0,["handleRowClick"]],[30,4,["identifier"]]],null]],null],[4,[38,8],["mousemove",[28,[37,9],[[28,[37,16],[[30,0,["activeResult"]]],null],[30,4]],null]],null],[4,[38,8],["keydown",[30,0,["handleKeydown"]]],null],[12],[1,"\\n                "],[46,[28,[37,5],["chat/message-creator/",[30,4,["type"]],"-row"],null],null,[["content","selected","active","hasSelectedUsers"],[[30,4],[28,[37,7],[[30,0,["selectionIdentifiers"]],[30,4,["identifier"]]],null],[28,[37,15],[[30,0,["activeResultIdentifier"]],[30,4,["identifier"]]],null],[30,0,["hasSelectedUsers"]]]],null],[1,"\\n              "],[13],[1,"\\n"]],[4]],[[[41,[30,0,["query","length"]],[[[1,"                "],[10,0],[14,0,"chat-message-creator__no-items-container"],[12],[1,"\\n                  "],[10,1],[14,0,"chat-message-creator__no-items"],[12],[1,"\\n                    "],[1,[28,[35,17],["chat.new_message_modal.no_items"],null]],[1,"\\n                  "],[13],[1,"\\n                "],[13],[1,"\\n"]],[]],null]],[]]]],[]]],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["showFooter"]],[[[1,"      "],[10,0],[14,0,"chat-message-creator__footer-container"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-creator__footer"],[12],[1,"\\n"],[41,[30,0,["showShortcut"]],[[[1,"            "],[10,0],[14,0,"chat-message-creator__shortcut"],[12],[1,"\\n              "],[1,[30,0,["shortcutLabel"]]],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["hasSelectedUsers"]],[[[1,"            "],[8,[39,13],[[24,0,"chat-message-creator__open-dm-btn btn-primary"]],[["@action","@translatedLabel"],[[28,[37,9],[[30,0,["openChannel"]],[30,0,["selection"]]],null],[30,0,["openChannelLabel"]]]],null],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"],[13]],["&attrs","selection","@onClose","result"],false,["did-insert","d-icon","each","-track-array","concat-class","concat","if","includes","on","fn","component","input","readonly","d-button","unless","eq","mut","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message-creator.hbs",isStrictMode:!1}),re="channel",ae="user"
let se=(g=(0,s.inject)("chat-api"),z=new WeakSet,k=new WeakSet,f=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
ee(this,k),ee(this,z),Q(this,"api",v,this),Q(this,"chat",y,this),Q(this,"chatChannelsManager",_,this),Q(this,"loading",w,this),Q(this,"value",j,this),Q(this,"query",M,this),(0,u.setOwner)(this,e),t.preload??=!1,t.onlyUsers??=!1,(t.term||t.preload)&&(t.term||!t.preload?(this.loading=!0,this.api.chatables({term:t.term}).then((e=>{let i=[...e.users,...e.direct_message_channels,...e.category_channels]
t.excludeUserId&&(i=i.filter((e=>e.identifier!==`u-${t.excludeUserId}`))),this.value=i.map((e=>{const t=p.default.create(e)
return t.tracking=te(this,k,le).call(this,t),t})).slice(0,10)})).catch((()=>this.value=[])).finally((()=>this.loading=!1))):this.value=te(this,z,oe).call(this))}},v=ie(f.prototype,"api",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=ie(f.prototype,"chat",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=ie(f.prototype,"chatChannelsManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=ie(f.prototype,"loading",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=ie(f.prototype,"value",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=ie(f.prototype,"query",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),f)
function oe(){return this.chatChannelsManager.allChannels.map((e=>{let t
return 1===e.chatable?.users?.length?(t=p.default.createUser(e.chatable.users[0]),t.tracking=te(this,k,le).call(this,t)):(t=p.default.createChannel(e),t.tracking=e.tracking),t})).filter(Boolean).slice(0,10)}function le(e){switch(e.type){case re:return this.chatChannelsManager.allChannels.find((t=>t.id===e.model.id))?.tracking
case ae:return this.chatChannelsManager.directMessageChannels.find((t=>1===t.chatable.users.length&&t.chatable.users[0].id===e.model.id))?.tracking}}let ce=(O=(0,s.inject)("chat-api"),C=(0,s.inject)("chat-channel-composer"),$=new WeakSet,V=new WeakSet,q=new WeakSet,G=new WeakSet,K=new WeakSet,J=new WeakSet,Y=new WeakSet,Z=new WeakSet,X=new WeakSet,S=class extends n.default{constructor(){super(...arguments),ee(this,X),ee(this,Z),ee(this,Y),ee(this,J),ee(this,K),ee(this,G),ee(this,q),ee(this,V),ee(this,$),Q(this,"api",P,this),Q(this,"composer",T,this),Q(this,"chat",E,this),Q(this,"site",x,this),Q(this,"router",D,this),Q(this,"currentUser",I,this),Q(this,"siteSettings",A,this),Q(this,"selection",U,this),Q(this,"activeSelection",L,this),Q(this,"query",N,this),Q(this,"queryElement",R,this),Q(this,"loading",F,this),Q(this,"activeSelectionIdentifiers",W,this),Q(this,"selectedIdentifiers",B,this),Q(this,"_activeResultIdentifier",H,this)}get placeholder(){return this.siteSettings.enable_public_channels&&this.chat.userCanDirectMessage?this.hasSelectedUsers?h.default.t("chat.new_message_modal.user_search_placeholder"):h.default.t("chat.new_message_modal.default_search_placeholder"):this.siteSettings.enable_public_channels?h.default.t("chat.new_message_modal.default_channel_search_placeholder"):this.chat.userCanDirectMessage?this.hasSelectedUsers?h.default.t("chat.new_message_modal.user_search_placeholder"):h.default.t("chat.new_message_modal.default_user_search_placeholder"):void 0}get showFooter(){return this.showShortcut||this.hasSelectedUsers}get showResults(){return!(this.hasSelectedUsers&&!this.query.length)}get shortcutLabel(){let e
return e=this.activeResult?.isUser?this.activeResult.model.username:this.activeResult.model.chatable.users[0].username,(0,b.htmlSafe)(h.default.t("chat.new_message_modal.add_user_long",{username:(0,m.escapeExpression)(e)}))}get showShortcut(){return!this.hasSelectedUsers&&this.searchRequest?.value?.length&&this.site.desktopView&&(this.activeResult?.isUser||this.activeResult?.isSingleUserChannel)}get activeResultIdentifier(){return this._activeResultIdentifier||this.searchRequest.value.find((e=>e.enabled))?.identifier}get hasSelectedUsers(){return this.selection.some((e=>e.isUser))}get activeResult(){return this.searchRequest.value.findBy("identifier",this.activeResultIdentifier)}set activeResult(e){e?.enabled&&(this._activeResultIdentifier=e?.identifier)}get selectionIdentifiers(){return this.selection.mapBy("identifier")}get openChannelLabel(){const e=this.selection.mapBy("model")
return h.default.t("chat.placeholder_users",{commaSeparatedNames:e.map((e=>e.name||e.username)).join(h.default.t("word_connector.comma"))})}get searchRequest(){let e=this.query
return e?.length&&(this.hasSelectedUsers&&e.startsWith("#")&&(e=e.replace(/^#/,"@")),this.hasSelectedUsers&&!e.startsWith("@")&&(e="@"+e)),new se((0,u.getOwner)(this),{term:e,preload:!this.selection?.length,onlyUsers:this.hasSelectedUsers,excludeUserId:this.hasSelectedUsers?this.currentUser?.id:null})}onFilter(e){this._activeResultIdentifier=null,this.activeSelectionIdentifiers=[],this.query=e}setQueryElement(e){this.queryElement=e}focusInput(){(0,l.schedule)("afterRender",(()=>{this.queryElement.focus()}))}handleKeydown(e){if("Escape"===e.key&&this.activeSelectionIdentifiers.length>0)return this.activeSelectionIdentifiers=[],e.preventDefault(),void e.stopPropagation()
if("a"===e.key&&(e.metaKey||e.ctrlKey))return void(this.activeSelectionIdentifiers=this.selection.mapBy("identifier"))
if("Enter"===e.key){if(this.activeSelectionIdentifiers.length>0)return this.activeSelectionIdentifiers.forEach((e=>{this.removeSelection(e)})),this.activeSelectionIdentifiers=[],void e.preventDefault()
if(this.activeResultIdentifier)return this.toggleSelection(this.activeResultIdentifier,{altSelection:e.shiftKey||e.ctrlKey}),void e.preventDefault()
if(0===this.query?.length)return this.openChannel(this.selection),void e.preventDefault()}if("ArrowDown"===e.key&&this.searchRequest.value.length>0)return this.activeSelectionIdentifiers=[],this._activeResultIdentifier=te(this,J,be).call(this)?.identifier,void e.preventDefault()
if("ArrowUp"===e.key&&this.searchRequest.value.length>0)return this.activeSelectionIdentifiers=[],this._activeResultIdentifier=te(this,K,me).call(this)?.identifier,void e.preventDefault()
const t=te(this,X,ve).call(this,e.code)
return e.ctrlKey&&t?(this._activeResultIdentifier=this.searchRequest.value.objectAt(t-1)?.identifier,void e.preventDefault()):0===e.target.selectionEnd&&0===e.target.selectionStart?"Backspace"===e.key&&this.selection.length?this.activeSelectionIdentifiers.length?(this.activeSelectionIdentifiers.forEach((e=>{this.removeSelection(e)})),this.activeSelectionIdentifiers=[],void e.preventDefault()):(this.activeSelectionIdentifiers=[te(this,G,pe).call(this).identifier],void e.preventDefault()):"ArrowLeft"!==e.key||e.shiftKey?"ArrowRight"!==e.key||e.shiftKey?void 0:(this._activeResultIdentifier=null,this.activeSelectionIdentifiers=[te(this,q,he).call(this)?.identifier].filter(Boolean),void e.preventDefault()):(this._activeResultIdentifier=null,this.activeSelectionIdentifiers=[te(this,V,de).call(this)?.identifier].filter(Boolean),void e.preventDefault()):void 0}replaceActiveSelection(e){this.activeSelection.clear(),this.activeSelection.push(e.identifier)}handleInput(e){(0,c.default)(this,this.onFilter,e.target.value,d.INPUT_DELAY)}toggleSelection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
this.selectionIdentifiers.includes(e)?this.removeSelection(e,t):this.addSelection(e,t),this.focusInput()}handleRowClick(e,t){this.toggleSelection(e,{altSelection:t.shiftKey||t.ctrlKey}),t.preventDefault()}removeSelection(e){this.selection=this.selection.filter((t=>t.identifier!==e)),te(this,$,ue).call(this)}addSelection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.searchRequest.value.findBy("identifier",e)
if(i&&i.enabled)if(i.type!==re||i.isSingleUserChannel)if(this.hasSelectedUsers||t.altSelection||this.site.mobileView){if(i.isSingleUserChannel){const e=i.model.chatable.users[0]
i=new p.default({identifier:`u-${e.id}`,type:ae,model:e})}this.selection=[...this.selection.filter((e=>e.type!==re)),i],te(this,$,ue).call(this)}else this.openChannel([i])
else this.openChannel([i])}openChannel(e){if(1===e.length&&e[0].type===re){const t=e[0].model
return this.router.transitionTo("chat.channel",...t.routeModels),void this.args.onClose?.()}const t=e.filterBy("type",ae).mapBy("model")
this.chat.upsertDmChannelForUsernames(t.mapBy("username")).then((e=>{this.router.transitionTo("chat.channel",...e.routeModels),this.args.onClose?.()}))}},P=ie(S.prototype,"api",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=ie(S.prototype,"composer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=ie(S.prototype,"chat",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=ie(S.prototype,"site",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=ie(S.prototype,"router",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=ie(S.prototype,"currentUser",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=ie(S.prototype,"siteSettings",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=ie(S.prototype,"selection",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new o.TrackedArray}}),L=ie(S.prototype,"activeSelection",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new o.TrackedArray}}),N=ie(S.prototype,"query",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),R=ie(S.prototype,"queryElement",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=ie(S.prototype,"loading",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),W=ie(S.prototype,"activeSelectionIdentifiers",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new o.TrackedArray}}),B=ie(S.prototype,"selectedIdentifiers",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=ie(S.prototype,"_activeResultIdentifier",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie(S.prototype,"searchRequest",[r.cached],Object.getOwnPropertyDescriptor(S.prototype,"searchRequest"),S.prototype),ie(S.prototype,"onFilter",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"onFilter"),S.prototype),ie(S.prototype,"setQueryElement",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"setQueryElement"),S.prototype),ie(S.prototype,"focusInput",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"focusInput"),S.prototype),ie(S.prototype,"handleKeydown",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"handleKeydown"),S.prototype),ie(S.prototype,"replaceActiveSelection",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"replaceActiveSelection"),S.prototype),ie(S.prototype,"handleInput",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"handleInput"),S.prototype),ie(S.prototype,"toggleSelection",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"toggleSelection"),S.prototype),ie(S.prototype,"handleRowClick",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"handleRowClick"),S.prototype),ie(S.prototype,"removeSelection",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"removeSelection"),S.prototype),ie(S.prototype,"addSelection",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"addSelection"),S.prototype),ie(S.prototype,"openChannel",[a.action],Object.getOwnPropertyDescriptor(S.prototype,"openChannel"),S.prototype),S)
function ue(){this.query="",this.activeSelectionIdentifiers=[],this._activeResultIdentifier=null}function de(){return te(this,Z,fe).call(this,this.selection,this.activeSelectionIdentifiers?.[0])}function he(){return te(this,Y,ge).call(this,this.selection,this.activeSelectionIdentifiers?.[0])}function pe(){return this.selection[this.selection.length-1]}function me(){return te(this,Z,fe).call(this,this.searchRequest.value,this.activeResultIdentifier)}function be(){return te(this,Y,ge).call(this,this.searchRequest.value,this.activeResultIdentifier)}function ge(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
if(0===e.length)return null
if(e=e.filterBy("enabled"),t){const i=e.mapBy("identifier").indexOf(t)
return i<e.length-1?e.objectAt(i+1):e[0]}return e[0]}function fe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
if(0===e.length)return null
if(e=e.filterBy("enabled"),t){const i=e.mapBy("identifier").indexOf(t)
return i>0?e.objectAt(i-1):e.objectAt(e.length-1)}return e.objectAt(e.length-1)}function ve(e){if("string"==typeof e){const t=e.match(/Digit(\d+)/)
if(t)return parseInt(t[1],10)}return!1}e.default=ce,(0,t.setComponentTemplate)(ne,ce)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/channel-row",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service","@ember/template","I18n"],(function(e,t,i,n,r,a,s){"use strict"
var o,l
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,i.createTemplateFactory)({id:"1z+h1Cq0",block:'[[[8,[39,0],null,[["@channel"],[[30,1,["model"]]]],null],[1,"\\n\\n"],[41,[28,[37,2],[[30,1,["tracking","unreadCount"]],0],null],[[[1,"  "],[10,0],[15,0,[28,[37,3],["unread-indicator",[52,[30,0,["isUrgent"]],"-urgent"]],null]],[12],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["site","desktopView"]],[[[1,"  "],[10,1],[14,0,"action-indicator"],[12],[1,[30,0,["openChannelLabel"]]],[13],[1,"\\n"]],[]],null]],["@content"],false,["chat-channel-title","if","gt","concat-class"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message-creator/channel-row.hbs",isStrictMode:!1})
let u=(o=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="site",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get openChannelLabel(){return(0,a.htmlSafe)(s.default.t("chat.new_message_modal.open_channel"))}get isUrgent(){return this.args.content.model.isDirectMessageChannel||this.args.content.model.isCategoryChannel&&this.args.content.model.tracking.mentionCount>0}},d=o.prototype,h="site",p=[r.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(m).forEach((function(e){g[e]=m[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(d,h,e)||e}),g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(d,h,g),g=null),l=g,o)
var d,h,p,m,b,g
e.default=u,(0,t.setComponentTemplate)(c,u)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/user-row",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service","@ember/template","I18n"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,i.createTemplateFactory)({id:"NStiU3PC",block:'[[[8,[39,0],null,[["@user"],[[30,1,["model"]]]],null],[1,"\\n"],[8,[39,1],null,[["@user"],[[30,1,["model"]]]],null],[1,"\\n\\n"],[41,[28,[37,3],[[30,1,["tracking","unreadCount"]],0],null],[[[1,"  "],[10,0],[14,0,"unread-indicator -urgent"],[12],[13],[1,"\\n"]],[]],null],[1,"\\n"],[1,[28,[35,4],[[30,1,["model"]]],[["currentUser"],[[30,0,["currentUser"]]]]]],[1,"\\n\\n"],[41,[51,[30,1,["enabled"]]],[[[1,"  "],[10,1],[14,0,"disabled-text"],[12],[1,"\\n    "],[1,[28,[35,6],["chat.new_message_modal.disabled_user"],null]],[1,"\\n  "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,2],[[[41,[30,0,["site","mobileView"]],[[[1,"    "],[10,1],[14,0,"selection-indicator -add"],[12],[1,"\\n      "],[1,[28,[35,7],["check"],null]],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[1,"    "],[10,1],[15,0,[28,[37,8],["selection-indicator",[52,[30,3],"-remove","-add"]],null]],[12],[1,"\\n      "],[1,[28,[35,7],[[52,[30,3],"times","check"]],null]],[1,"\\n    "],[13],[1,"\\n"]],[]]]],[]],[[[41,[30,0,["site","desktopView"]],[[[41,[30,4],[[[1,"      "],[10,1],[14,0,"action-indicator"],[12],[1,[30,0,["addUserLabel"]]],[13],[1,"\\n"]],[]],[[[1,"      "],[10,1],[14,0,"action-indicator"],[12],[1,[30,0,["openChannelLabel"]]],[13],[1,"\\n"]],[]]]],[]],null]],[]]]],["@content","@selected","@active","@hasSelectedUsers"],false,["chat/user-avatar","chat-user-display-name","if","gt","user-status","unless","i18n","d-icon","concat-class"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message-creator/user-row.hbs",isStrictMode:!1})
let p=(o=class extends n.default{constructor(){super(...arguments),u(this,"currentUser",l,this),u(this,"site",c,this)}get openChannelLabel(){return(0,a.htmlSafe)(s.default.t("chat.new_message_modal.open_channel"))}get addUserLabel(){return(0,a.htmlSafe)(s.default.t("chat.new_message_modal.add_user_short"))}},l=d(o.prototype,"currentUser",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=d(o.prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)
e.default=p,(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/user-selection",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"5qUFSIO3",block:'[[[8,[39,0],null,[["@user","@showPresence"],[[30,1,["model"]],false]],null],[1,"\\n\\n"],[10,1],[14,0,"chat-message-creator__selection-item__username"],[12],[1,"\\n  "],[1,[30,1,["model","username"]]],[1,"\\n"],[13]],["@selection"],false,["chat/user-avatar"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message-creator/user-selection.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,(0,n.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat/message/avatar",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"Egd2LtFf",block:'[[[10,0],[14,0,"chat-message-avatar"],[12],[1,"\\n"],[41,[30,1,["chatWebhookEvent","emoji"]],[[[1,"    "],[8,[39,1],null,[["@emoji"],[[30,1,["chatWebhookEvent","emoji"]]]],null],[1,"\\n"]],[]],[[[1,"    "],[8,[39,2],null,[["@user","@avatarSize"],[[30,1,["user"]],"medium"]],null],[1,"\\n"]],[]]],[13]],["@message"],false,["if","chat-emoji-avatar","chat/user-avatar"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message/avatar.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,(0,n.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat/message/error",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"Ut7WvhJu",block:'[[[41,[30,1,["error"]],[[[1,"  "],[10,0],[14,0,"chat-message-error"],[12],[1,"\\n"],[41,[28,[37,1],[[30,1,["error"]],"network_error"],null],[[[1,"      "],[8,[39,2],[[24,0,"chat-message-error__retry-btn"]],[["@action","@icon"],[[28,[37,3],[[30,2],[30,1]],null],"exclamation-circle"]],[["default"],[[[[1,"\\n        "],[10,1],[14,0,"chat-message-error__retry-btn-title"],[12],[1,"\\n          "],[1,[28,[35,4],["chat.retry_staged_message.title"],null]],[1,"\\n        "],[13],[1,"\\n        "],[10,1],[14,0,"chat-message-error__retry-btn-action"],[12],[1,"\\n          "],[1,[28,[35,4],["chat.retry_staged_message.action"],null]],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],[[[1,"      "],[1,[30,1,["error"]]],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n"]],[]],null]],["@message","@onRetry"],false,["if","eq","d-button","fn","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message/error.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,(0,n.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat/message/info",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/lib/settings","@ember/service","discourse-common/utils/decorators"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function h(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,i.createTemplateFactory)({id:"gbE9+Tf/",block:'[[[41,[30,1],[[[1,"  "],[11,0],[24,0,"chat-message-info"],[4,[38,1],[[30,0,["trackStatus"]]],null],[4,[38,2],[[30,0,["stopTrackingStatus"]]],null],[12],[1,"\\n"],[41,[30,2,["chatWebhookEvent"]],[[[41,[30,2,["chatWebhookEvent","username"]],[[[1,"        "],[10,1],[15,0,[28,[37,3],["chat-message-info__username",[30,0,["usernameClasses"]]],null]],[12],[1,"\\n          "],[1,[30,2,["chatWebhookEvent","username"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[10,1],[14,0,"chat-message-info__bot-indicator"],[12],[1,"\\n        "],[1,[28,[35,4],["chat.bot"],null]],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[10,1],[14,"role","button"],[15,0,[28,[37,3],["chat-message-info__username",[30,0,["usernameClasses"]],"clickable"],null]],[15,"data-user-card",[30,2,["user","username"]]],[12],[1,"\\n        "],[10,1],[14,0,"chat-message-info__username__name"],[12],[1,[30,0,["name"]]],[13],[1,"\\n"],[41,[30,0,["showStatus"]],[[[1,"          "],[10,0],[14,0,"chat-message-info__status"],[12],[1,"\\n            "],[8,[39,5],null,[["@status"],[[30,2,["user","status"]]]],null],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]]],[1,"\\n    "],[10,1],[14,0,"chat-message-info__date"],[12],[1,"\\n      "],[1,[28,[35,6],[[30,2]],null]],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,2,["bookmark"]],[[[1,"      "],[10,1],[14,0,"chat-message-info__bookmark"],[12],[1,"\\n        "],[8,[39,7],null,[["@bookmark"],[[30,2,["bookmark"]]]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["isFlagged"]],[[[1,"      "],[10,1],[14,0,"chat-message-info__flag"],[12],[1,"\\n"],[41,[30,2,["reviewableId"]],[[[1,"          "],[8,[39,8],null,[["@route","@model"],["review.show",[30,2,["reviewableId"]]]],[["default"],[[[[1,"\\n            "],[1,[28,[35,9],["flag"],[["title"],["chat.flagged"]]]],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[35,9],["flag"],[["title"],["chat.you_flagged"]]]],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@show","@message"],false,["if","did-insert","will-destroy","concat-class","i18n","user-status-message","format-chat-date","bookmark-icon","link-to","d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message/info.hbs",isStrictMode:!1})
let b=(c=new WeakMap,u=new WeakMap,o=class extends n.default{constructor(){var e,t,i,n
super(...arguments),d(this,u,{get:f,set:void 0}),d(this,c,{get:g,set:void 0}),e=this,t="siteSettings",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}trackStatus(){h(this,c)?.trackStatus?.()}stopTrackingStatus(){h(this,c)?.stopTrackingStatus?.()}get usernameClasses(){const e=h(this,c),t=this.prioritizeName?["is-full-name"]:["is-username"]
return e?(e.staff&&t.push("is-staff"),e.admin&&t.push("is-admin"),e.moderator&&t.push("is-moderator"),e.new_user&&t.push("is-new-user"),e.primary_group_name&&t.push("group--"+e.primary_group_name),t.join(" ")):t}get name(){return this.prioritizeName?h(this,c)?.get("name"):h(this,c)?.get("username")}get isFlagged(){return h(this,u)?.reviewableId||0===h(this,u)?.userFlagStatus}get prioritizeName(){return this.siteSettings.display_name_on_posts&&(0,r.prioritizeNameInUx)(h(this,c)?.get("name"))}get showStatus(){return!!h(this,c)?.get("status")}},l=p(o.prototype,"siteSettings",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(o.prototype,"trackStatus",[s.bind],Object.getOwnPropertyDescriptor(o.prototype,"trackStatus"),o.prototype),p(o.prototype,"stopTrackingStatus",[s.bind],Object.getOwnPropertyDescriptor(o.prototype,"stopTrackingStatus"),o.prototype),o)
function g(){return h(this,u)?.user}function f(){return this.args.message}e.default=b,(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/chat/message/left-gutter",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"aZfQa7lM",block:'[[[10,0],[14,0,"chat-message-left-gutter"],[12],[1,"\\n"],[41,[30,1,["reviewableId"]],[[[1,"    "],[8,[39,1],[[24,0,"chat-message-left-gutter__flag"]],[["@route","@model"],["review.show",[30,1,["reviewableId"]]]],[["default"],[[[[1,"\\n      "],[1,[28,[35,2],["flag"],[["title"],["chat.flagged"]]]],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],[[[41,[28,[37,3],[[30,1,["userFlagStatus"]],0],null],[[[1,"    "],[10,0],[14,0,"chat-message-left-gutter__flag"],[12],[1,"\\n      "],[1,[28,[35,2],["flag"],[["title"],["chat.you_flagged"]]]],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[41,[30,0,["site","desktopView"]],[[[1,"    "],[10,1],[14,0,"chat-message-left-gutter__date"],[12],[1,"\\n      "],[1,[28,[35,4],[[30,1],"tiny"],null]],[1,"\\n    "],[13],[1,"\\n  "]],[]],null]],[]]]],[]]],[41,[30,1,["bookmark"]],[[[1,"    "],[10,1],[14,0,"chat-message-left-gutter__bookmark"],[12],[1,"\\n      "],[8,[39,5],null,[["@bookmark"],[[30,1,["bookmark"]]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[13]],["@message"],false,["if","link-to","d-icon","eq","format-chat-date","bookmark-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message/left-gutter.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="site",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="site",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat/message/mention-warning",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object","discourse/lib/ajax-error","@ember/service","I18n"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d
function h(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function p(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,i.createTemplateFactory)({id:"/B8FzEgL",block:'[[[41,[30,0,["shouldRender"]],[[[1,"  "],[10,0],[14,0,"chat-message-mention-warning alert alert-info"],[12],[1,"\\n"],[41,[30,0,["mentionWarning","invitationSent"]],[[[1,"      "],[11,1],[24,0,"chat-message-mention-warning__invitation-sent"],[4,[38,1],[[30,0,["onDismissInvitationSent"]],3000],null],[12],[1,"\\n        "],[1,[28,[35,2],["check"],null]],[1,"\\n        "],[10,1],[12],[1,"\\n          "],[1,[28,[35,3],["chat.mention_warning.invitations_sent"],[["count"],[[30,0,["mentionWarning","withoutMembership","length"]]]]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[8,[39,4],[[24,0,"chat-message-mention-warning__dismiss-btn btn-flat"],[16,"title",[28,[37,3],["chat.mention_warning.dismiss"],null]]],[["@action","@icon"],[[30,0,["onDismissMentionWarning"]],"times"]],null],[1,"\\n\\n"],[41,[30,0,["mentionWarning","cannotSee"]],[[[1,"        "],[10,2],[14,0,"chat-message-mention-warning__text -cannot-see"],[12],[1,"\\n          "],[1,[30,0,["mentionedCannotSeeText"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["mentionWarning","withoutMembership"]],[[[1,"        "],[10,2],[14,0,"chat-message-mention-warning__text -without-membership"],[12],[1,"\\n          "],[10,1],[12],[1,[30,0,["mentionedWithoutMembershipText"]]],[13],[1,"\\n          "],[11,3],[24,6,""],[4,[38,5],["click",[30,0,["onSendInvite"]]],[["bubbles"],[false]]],[12],[1,"\\n            "],[1,[28,[35,3],["chat.mention_warning.invite"],null]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["mentionWarning","groupWithMentionsDisabled"]],[[[1,"        "],[10,2],[14,0,"chat-message-mention-warning__text -groups-with-mentions-disabled"],[12],[1,"\\n          "],[1,[30,0,["groupsWithDisabledMentions"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["mentionWarning","groupsWithTooManyMembers"]],[[[1,"        "],[10,2],[14,0,"chat-message-mention-warning__text -groups-with-too-many-members"],[12],[1,"\\n          "],[1,[30,0,["groupsWithTooManyMembers"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null]],[]]],[1,"  "],[13],[1,"\\n"]],[]],null]],[],false,["if","chat/later-fn","d-icon","i18n","d-button","on"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/message/mention-warning.hbs",isStrictMode:!1})
let g=(l=(0,s.inject)("chat-api"),d=new WeakSet,c=class extends n.default{constructor(){var e,t,i,n
super(...arguments),h(this,d),e=this,t="api",n=this,(i=u)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}async onSendInvite(){const e=this.mentionWarning.withoutMembership.mapBy("id")
try{await this.api.invite(this.args.message.channel.id,e,{messageId:this.args.message.id}),this.mentionWarning.invitationSent=!0}catch(t){(0,a.popupAjaxError)(t)}}onDismissInvitationSent(){this.mentionWarning.invitationSent=!1}onDismissMentionWarning(){this.args.message.mentionWarning=null}get shouldRender(){return this.mentionWarning&&(this.mentionWarning.groupWithMentionsDisabled?.length||this.mentionWarning.cannotSee?.length||this.mentionWarning.withoutMembership?.length||this.mentionWarning.groupsWithTooManyMembers?.length)}get mentionWarning(){return this.args.message.mentionWarning}get mentionedCannotSeeText(){return p(this,d,f).call(this,"chat.mention_warning.cannot_see","chat.mention_warning.cannot_see_multiple",{username:this.mentionWarning?.cannotSee?.[0]?.username,count:this.mentionWarning?.cannotSee?.length})}get mentionedWithoutMembershipText(){return p(this,d,f).call(this,"chat.mention_warning.without_membership","chat.mention_warning.without_membership_multiple",{username:this.mentionWarning?.withoutMembership?.[0]?.username,count:this.mentionWarning?.withoutMembership?.length})}get groupsWithDisabledMentions(){return p(this,d,f).call(this,"chat.mention_warning.group_mentions_disabled","chat.mention_warning.group_mentions_disabled_multiple",{group_name:this.mentionWarning?.groupWithMentionsDisabled?.[0],count:this.mentionWarning?.groupWithMentionsDisabled?.length})}get groupsWithTooManyMembers(){return p(this,d,f).call(this,"chat.mention_warning.too_many_members","chat.mention_warning.too_many_members_multiple",{group_name:this.mentionWarning.groupsWithTooManyMembers?.[0],count:this.mentionWarning.groupsWithTooManyMembers?.length})}},u=m(c.prototype,"api",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m(c.prototype,"onSendInvite",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"onSendInvite"),c.prototype),m(c.prototype,"onDismissInvitationSent",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"onDismissInvitationSent"),c.prototype),m(c.prototype,"onDismissMentionWarning",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"onDismissMentionWarning"),c.prototype),c)
function f(e,t,i){const n=1===i.count?e:t
return i.count--,o.default.t(n,i)}e.default=g,(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/chat/modal/archive-channel",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object","@ember/service","@glimmer/tracking","discourse/lib/ajax-error","@ember/template","I18n","discourse-common/lib/later","discourse/plugins/chat/discourse/components/chat-to-topic-selector","discourse/plugins/chat/discourse/models/chat-channel","@ember/utils"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b,g,f,v,y,_,w,j,M,z,k
function O(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function C(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function S(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const P=(0,i.createTemplateFactory)({id:"kM3b20dG",block:'[[[8,[39,0],[[24,0,"chat-modal-archive-channel"]],[["@closeModal","@inline","@title","@flash","@flashType"],[[30,1],[30,2],[28,[37,1],["chat.channel_archive.title"],null],[30,0,["flash"]],[30,0,["flashType"]]]],[["body","footer"],[[[[1,"\\n    "],[10,2],[14,0,"chat-modal-archive-channel__instructions"],[12],[1,"\\n      "],[1,[30,0,["instructionsText"]]],[1,"\\n    "],[13],[1,"\\n    "],[8,[39,2],null,[["@selection","@topicTitle","@categoryId","@tags","@selectedTopicId","@instructionLabels","@allowNewMessage"],[[30,0,["selection"]],[30,0,["topicTitle"]],[30,0,["categoryId"]],[30,0,["tags"]],[30,0,["selectedTopicId"]],[30,0,["instructionLabels"]],false]],null],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,3],null,[["@class","@disabled","@action","@label","@id"],["btn-primary",[30,0,["buttonDisabled"]],[30,0,["archiveChannel"]],"chat.channel_archive.title","chat-confirm-archive-channel"]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","chat-to-topic-selector","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/archive-channel.hbs",isStrictMode:!1})
let T=(k=new WeakSet,m=class extends n.default{constructor(){super(...arguments),C(this,k),O(this,"chatApi",b,this),O(this,"siteSettings",g,this),O(this,"selection",f,this),O(this,"saving",v,this),O(this,"topicTitle",y,this),O(this,"categoryId",_,this),O(this,"tags",w,this),O(this,"selectedTopicId",j,this),O(this,"flash",M,this),O(this,"flashType",z,this)}get channel(){return this.args.model.channel}get newTopic(){return this.selection===d.NEW_TOPIC_SELECTION}get existingTopic(){return this.selection===d.EXISTING_TOPIC_SELECTION}get buttonDisabled(){return!!this.saving||(!(!this.newTopic||!(!this.topicTitle||this.topicTitle.length<this.siteSettings.min_topic_title_length||this.topicTitle.length>this.siteSettings.max_topic_title_length))||!(!this.existingTopic||!(0,p.isEmpty)(this.selectedTopicId)))}get instructionLabels(){const e={}
return e[d.NEW_TOPIC_SELECTION]=c.default.t("chat.selection.new_topic.instructions_channel_archive"),e[d.EXISTING_TOPIC_SELECTION]=c.default.t("chat.selection.existing_topic.instructions_channel_archive"),e}get instructionsText(){return(0,l.htmlSafe)(c.default.t("chat.channel_archive.instructions",{channelTitle:this.channel.escapedTitle}))}archiveChannel(){return this.saving=!0,this.chatApi.createChannelArchive(this.channel.id,function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,k,E).call(this)).then((()=>{this.flash=c.default.t("chat.channel_archive.process_started"),this.flashType="success",this.channel.status=h.CHANNEL_STATUSES.archived,(0,u.default)((()=>{this.args.closeModal()}),3e3)})).catch(o.popupAjaxError).finally((()=>this.saving=!1))}},b=S(m.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=S(m.prototype,"siteSettings",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=S(m.prototype,"selection",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return d.NEW_TOPIC_SELECTION}}),v=S(m.prototype,"saving",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=S(m.prototype,"topicTitle",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=S(m.prototype,"categoryId",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=S(m.prototype,"tags",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=S(m.prototype,"selectedTopicId",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=S(m.prototype,"flash",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=S(m.prototype,"flashType",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S(m.prototype,"archiveChannel",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"archiveChannel"),m.prototype),m)
function E(){const e={type:this.selection}
return this.newTopic&&(e.title=this.topicTitle,e.category_id=this.categoryId,e.tags=this.tags),this.existingTopic&&(e.topic_id=this.selectedTopicId),e}e.default=T,(0,t.setComponentTemplate)(P,T)})),define("discourse/plugins/chat/discourse/components/chat/modal/channel-summary",["exports","@ember/component","@ember/template-factory","@glimmer/component","@glimmer/tracking","discourse/lib/ajax-error","@ember/object","I18n","@ember/service"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const f=(0,i.createTemplateFactory)({id:"k3KLu8u/",block:'[[[8,[39,0],[[24,0,"chat-modal-channel-summary"]],[["@closeModal","@title"],[[30,1],[28,[37,1],["chat.summarization.title"],null]]],[["body","footer"],[[[[1,"\\n    "],[10,1],[12],[1,[28,[35,1],["chat.summarization.description"],null]],[13],[1,"\\n    "],[8,[39,2],null,[["@value","@content","@onChange","@valueProperty","@class"],[[30,0,["sinceHours"]],[30,0,["sinceOptions"]],[30,0,["summarize"]],"value","summarization-since"]],null],[1,"\\n    "],[8,[39,3],null,[["@isLoading"],[[30,0,["loading"]]]],[["default"],[[[[1,"\\n      "],[10,2],[14,0,"summary-area"],[12],[1,[30,0,["summary"]]],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,4],null,[["@close"],[[30,1]]],null],[1,"\\n  "]],[]]]]]],["@closeModal"],false,["d-modal","i18n","combo-box","conditional-loading-section","d-modal-cancel"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/channel-summary.hbs",isStrictMode:!1})
let v=(c=class extends n.default{constructor(){super(...arguments),m(this,"chatApi",u,this),m(this,"sinceHours",d,this),m(this,"loading",h,this),m(this,"summary",p,this),b(this,"availableSummaries",{}),b(this,"sinceOptions",[1,3,6,12,24,72,168].map((e=>({name:o.default.t("chat.summarization.since",{count:e}),value:e}))))}get channelId(){return this.args.model.channelId}summarize(e){return this.sinceHours=e,this.loading=!0,this.availableSummaries[e]?(this.summary=this.availableSummaries[e],void(this.loading=!1)):this.chatApi.summarize(this.channelId,{since:e}).then((e=>{this.availableSummaries[this.sinceHours]=e.summary,this.summary=this.availableSummaries[this.sinceHours]})).catch(a.popupAjaxError).finally((()=>this.loading=!1))}},u=g(c.prototype,"chatApi",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=g(c.prototype,"sinceHours",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=g(c.prototype,"loading",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=g(c.prototype,"summary",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g(c.prototype,"summarize",[s.action],Object.getOwnPropertyDescriptor(c.prototype,"summarize"),c.prototype),c)
e.default=v,(0,t.setComponentTemplate)(f,v)})),define("discourse/plugins/chat/discourse/components/chat/modal/create-channel",["exports","@ember/component","@ember/template-factory","discourse/lib/utilities","discourse/lib/ajax","@ember/runloop","discourse-common/lib/debounce","@glimmer/component","I18n","@ember/object","@ember/service","@ember/utils","@ember/template","@glimmer/tracking"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b,g,f,v,y,_,w,j,M,z,k,O,C,S,P,T,E,x,D,I,A,U,L
function N(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function R(e,t){F(e,t),t.add(e)}function F(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function W(e,t,i){return function(e,t,i){if(t.set)t.set.call(e,i)
else{if(!t.writable)throw new TypeError("attempted to set read only private field")
t.value=i}}(e,$(e,t,"set"),i),i}function B(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function H(e,t){return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,$(e,t,"get"))}function $(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}function V(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const q=(0,i.createTemplateFactory)({id:"d48yUZBc",block:'[[[8,[39,0],[[24,0,"chat-modal-create-channel"],[4,[38,2],["submit",[30,0,["onSave"]]],null]],[["@closeModal","@inline","@title","@flash","@tagName"],[[30,1],[30,2],[28,[37,1],["chat.create_channel.title"],null],[30,0,["flash"]],"form"]],[["body","footer"],[[[[1,"\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -name"],[12],[1,"\\n      "],[10,"label"],[14,"for","name"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.name"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,3],[[24,3,"name"],[24,0,"chat-modal-create-channel__input"],[4,[38,2],["input",[28,[37,4],[[30,0],[30,0,["onNameChange"]]],[["value"],["target.value"]]]],null]],[["@type","@value"],["text",[30,0,["name"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -slug"],[12],[1,"\\n      "],[10,"label"],[14,"for","slug"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.slug"],null]],[1,"\\n        "],[10,1],[12],[1,"\\n          "],[1,[28,[35,5],["info-circle"],null]],[1,"\\n          "],[8,[39,6],null,null,[["default"],[[[[1,"\\n            "],[1,[28,[35,1],["chat.channel_edit_name_slug_modal.slug_description"],null]],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,3],[[24,3,"slug"],[24,0,"chat-modal-create-channel__input"],[16,"placeholder",[30,0,["autoGeneratedSlug"]]]],[["@type","@value"],["text",[30,0,["slug"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -description"],[12],[1,"\\n      "],[10,"label"],[14,"for","description"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.description"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,3],[[24,3,"description"],[24,0,"chat-modal-create-channel__input"]],[["@type","@value"],["textarea",[30,0,["description"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-modal-create-channel__control"],[12],[1,"\\n      "],[10,"label"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.choose_category.label"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,7],null,[["@value","@onChange","@options"],[[30,0,["categoryId"]],[28,[37,4],[[30,0],[30,0,["onCategoryChange"]]],null],[28,[37,8],null,[["formName","none"],["chatable_id","chat.create_channel.choose_category.none"]]]]],null],[1,"\\n\\n"],[41,[30,0,["categoryPermissionsHint"]],[[[1,"        "],[10,0],[15,0,[28,[37,10],["chat-modal-create-channel__hint",[52,[30,0,["loadingPermissionHint"]],"loading-permissions"]],null]],[12],[1,"\\n          "],[1,[30,0,["categoryPermissionsHint"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n\\n"],[41,[30,0,["autoJoinAvailable"]],[[[1,"      "],[10,0],[14,0,"chat-modal-create-channel__control -auto-join"],[12],[1,"\\n        "],[10,"label"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n          "],[8,[39,3],[[24,3,"auto_join_users"]],[["@type","@checked"],["checkbox",[30,0,["autoJoinUsers"]]]],null],[1,"\\n          "],[10,0],[14,0,"auto-join-channel"],[12],[1,"\\n            "],[10,1],[14,0,"chat-modal-create-channel__label-title"],[12],[1,"\\n              "],[1,[28,[35,1],["chat.settings.auto_join_users_label"],null]],[1,"\\n            "],[13],[1,"\\n            "],[10,2],[14,0,"chat-modal-create-channel__label-description"],[12],[1,"\\n"],[41,[30,0,["categoryName"]],[[[1,"                "],[1,[28,[35,1],["chat.settings.auto_join_users_info"],[["category"],[[30,0,["categoryName"]]]]]],[1,"\\n"]],[]],[[[1,"                "],[1,[28,[35,1],["chat.settings.auto_join_users_info_no_category"],null]],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -threading-toggle"],[12],[1,"\\n      "],[10,"label"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[8,[39,3],[[24,3,"threading_enabled"]],[["@type","@checked"],["checkbox",[30,0,["threadingEnabled"]]]],null],[1,"\\n        "],[10,0],[14,0,"threading-channel"],[12],[1,"\\n          "],[10,1],[14,0,"chat-modal-create-channel__label-title"],[12],[1,"\\n            "],[1,[28,[35,1],["chat.create_channel.threading.label"],null]],[1,"\\n          "],[13],[1,"\\n          "],[10,2],[14,0,"chat-modal-create-channel__label-description"],[12],[1,"\\n            "],[1,[28,[35,1],["chat.settings.channel_threading_description"],null]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[]],[[[1,"\\n    "],[10,"button"],[14,0,"btn btn-primary create"],[15,"disabled",[30,0,["createDisabled"]]],[14,4,"submit"],[12],[1,"\\n      "],[1,[28,[35,1],["chat.create_channel.create"],null]],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","on","input","action","d-icon","d-tooltip","category-chooser","hash","if","concat-class"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/create-channel.hbs",isStrictMode:!1}),G=(0,h.htmlSafe)(l.default.t("chat.create_channel.choose_category.default_hint",{link:"/categories",category:"category"}))
let K=(E=new WeakMap,x=new WeakSet,D=new WeakSet,I=new WeakSet,A=new WeakSet,U=new WeakSet,L=new WeakSet,m=class extends o.default{constructor(){var e,t,i
super(...arguments),R(this,L),R(this,U),R(this,A),R(this,I),R(this,D),R(this,x),N(this,"chat",b,this),N(this,"dialog",g,this),N(this,"chatChannelsManager",f,this),N(this,"chatApi",v,this),N(this,"router",y,this),N(this,"currentUser",_,this),N(this,"siteSettings",w,this),N(this,"site",j,this),N(this,"flash",M,this),N(this,"name",z,this),N(this,"category",k,this),N(this,"categoryId",O,this),N(this,"autoGeneratedSlug",C,this),N(this,"categoryPermissionsHint",S,this),N(this,"autoJoinWarning",P,this),N(this,"loadingPermissionHint",T,this),i={writable:!0,value:null},F(e=this,t=E),t.set(e,i)}willDestroy(){(0,a.cancel)(H(this,E))}get autoJoinAvailable(){return this.siteSettings.max_chat_auto_joined_users>0}get categorySelected(){return(0,d.isPresent)(this.category)}get createDisabled(){return!this.categorySelected||(0,d.isBlank)(this.name)}get categoryName(){return this.categorySelected&&(0,d.isPresent)(this.name)?(0,n.escapeExpression)(this.name):null}onShow(){this.categoryPermissionsHint=G}onCategoryChange(e){const t=e?this.site.categories.findBy("id",e):null
B(this,A,X).call(this,t)
const i=this.name||t?.name||""
this.categoryId=e,this.category=t,this.name=i,B(this,L,ee).call(this,i)}onNameChange(e){B(this,L,ee).call(this,e)}onSave(e){if(e.preventDefault(),this.createDisabled)return
const t=new FormData(e.currentTarget),i=Object.fromEntries(t.entries())
i.auto_join_users="on"===i.auto_join_users,i.slug??=this.autoGeneratedSlug,i.threading_enabled="on"===i.threading_enabled,i.auto_join_users?this.dialog.yesNoConfirm({message:this.autoJoinWarning,didConfirm:()=>B(this,x,J).call(this,i)}):B(this,x,J).call(this,i)}},b=V(m.prototype,"chat",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=V(m.prototype,"dialog",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=V(m.prototype,"chatChannelsManager",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=V(m.prototype,"chatApi",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=V(m.prototype,"router",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=V(m.prototype,"currentUser",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=V(m.prototype,"siteSettings",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=V(m.prototype,"site",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=V(m.prototype,"flash",[p.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=V(m.prototype,"name",[p.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=V(m.prototype,"category",[p.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=V(m.prototype,"categoryId",[p.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=V(m.prototype,"autoGeneratedSlug",[p.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),S=V(m.prototype,"categoryPermissionsHint",[p.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=V(m.prototype,"autoJoinWarning",[p.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),T=V(m.prototype,"loadingPermissionHint",[p.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),V(m.prototype,"onShow",[c.action],Object.getOwnPropertyDescriptor(m.prototype,"onShow"),m.prototype),V(m.prototype,"onCategoryChange",[c.action],Object.getOwnPropertyDescriptor(m.prototype,"onCategoryChange"),m.prototype),V(m.prototype,"onNameChange",[c.action],Object.getOwnPropertyDescriptor(m.prototype,"onNameChange"),m.prototype),V(m.prototype,"onSave",[c.action],Object.getOwnPropertyDescriptor(m.prototype,"onSave"),m.prototype),m)
function J(e){return this.chatApi.createChannel(e).then((e=>{this.args.closeModal(),this.chatChannelsManager.follow(e),this.router.transitionTo("chat.channel",...e.routeModels)})).catch((e=>{this.flash=e.jqXHR.responseJSON.errors[0]}))}function Y(e){const t=e.parentCategory
return t?`${B(this,D,Y).call(this,t)}/${e.slug}`:e.slug}function Z(e,t){const i=t.allowed_groups
let r
if(t.private)switch(i.length){case 1:r=l.default.t("chat.create_channel.auto_join_users.warning_1_group",{count:t.members_count,group:(0,n.escapeExpression)(i[0])})
break
case 2:r=l.default.t("chat.create_channel.auto_join_users.warning_2_groups",{count:t.members_count,group1:(0,n.escapeExpression)(i[0]),group2:(0,n.escapeExpression)(i[1])})
break
default:r=l.default.messageFormat("chat.create_channel.auto_join_users.warning_multiple_groups_MF",{groupCount:i.length-1,userCount:t.members_count,groupName:(0,n.escapeExpression)(i[0])})}else r=l.default.t("chat.create_channel.auto_join_users.public_category_warning",{category:(0,n.escapeExpression)(e.name)})
this.autoJoinWarning=r}function X(e){if(e){const t=B(this,D,Y).call(this,e)
return this.loadingPermissionHint=!0,this.chatApi.categoryPermissions(e.id).then((i=>{B(this,I,Z).call(this,e,i)
const r=i.allowed_groups,a=`/c/${(0,n.escapeExpression)(t)}/edit/security`
let s
switch(r.length){case 1:s=l.default.t("chat.create_channel.choose_category.hint_1_group",{settingLink:a,group:(0,n.escapeExpression)(r[0])})
break
case 2:s=l.default.t("chat.create_channel.choose_category.hint_2_groups",{settingLink:a,group1:(0,n.escapeExpression)(r[0]),group2:(0,n.escapeExpression)(r[1])})
break
default:s=l.default.t("chat.create_channel.choose_category.hint_multiple_groups",{settingLink:a,group:(0,n.escapeExpression)(r[0]),count:r.length-1})}this.categoryPermissionsHint=(0,h.htmlSafe)(s)})).finally((()=>{this.loadingPermissionHint=!1}))}this.categoryPermissionsHint=G,this.autoJoinWarning=""}function Q(e){return(0,r.ajax)("/slugs.json",{type:"POST",data:{name:e}}).then((e=>{this.autoGeneratedSlug=e.slug}))}function ee(e){(0,a.cancel)(H(this,E)),this.autoGeneratedSlug="",e&&W(this,E,(0,s.default)(this,B(this,U,Q),e,300))}e.default=K,(0,t.setComponentTemplate)(q,K)})),define("discourse/plugins/chat/discourse/components/chat/modal/delete-channel",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/utils","I18n","@ember/object","@ember/service","discourse/lib/ajax-error","discourse-common/lib/later","@ember/template","@glimmer/tracking"],(function(e,t,i,n,r,a,s,o,l,c,u,d){"use strict"
var h,p,m,b,g,f,v,y
function _(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function w(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const j=(0,i.createTemplateFactory)({id:"bI4qgMSp",block:'[[[8,[39,0],[[24,0,"chat-modal-delete-channel"]],[["@closeModal","@inline","@title","@flash","@flashType"],[[30,1],[30,2],[28,[37,1],["chat.channel_delete.title"],null],[30,0,["flash"]],[30,0,["flashType"]]]],[["body","footer"],[[[[1,"\\n    "],[10,2],[14,0,"chat-modal-delete-channel__instructions"],[12],[1,"\\n      "],[1,[30,0,["instructionsText"]]],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[39,2],null,[["@value","@id","@placeholderKey","@autocorrect","@autocapitalize"],[[30,0,["channelNameConfirmation"]],"channel-delete-confirm-name","chat.channel_delete.confirm_channel_name","off","off"]],null],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,3],null,[["@disabled","@class","@action","@label","@id"],[[30,0,["buttonDisabled"]],"btn-danger",[30,0,["deleteChannel"]],"chat.channel_delete.confirm","chat-confirm-delete-channel"]],null],[1,"\\n    "],[8,[39,3],null,[["@label","@class","@action"],["cancel","btn-flat",[30,1]]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","text-field","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/delete-channel.hbs",isStrictMode:!1})
let M=(h=class extends n.default{constructor(){super(...arguments),_(this,"chatApi",p,this),_(this,"router",m,this),_(this,"channelNameConfirmation",b,this),_(this,"deleting",g,this),_(this,"confirmed",f,this),_(this,"flash",v,this),_(this,"flashType",y,this)}get channel(){return this.args.model.channel}get buttonDisabled(){return!(!this.deleting&&!this.confirmed)||!(!(0,r.isEmpty)(this.channelNameConfirmation)&&this.channelNameConfirmation.toLowerCase()===this.channel.title.toLowerCase())}get instructionsText(){return(0,u.htmlSafe)(a.default.t("chat.channel_delete.instructions",{name:this.channel.escapedTitle}))}deleteChannel(){return this.deleting=!0,this.chatApi.destroyChannel(this.channel.id,this.channelNameConfirmation).then((()=>{this.confirmed=!0,this.flash=a.default.t("chat.channel_delete.process_started"),this.flashType="success",(0,c.default)((()=>{this.args.closeModal(),this.router.transitionTo("chat")}),3e3)})).catch(l.popupAjaxError).finally((()=>this.deleting=!1))}},p=w(h.prototype,"chatApi",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=w(h.prototype,"router",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=w(h.prototype,"channelNameConfirmation",[d.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=w(h.prototype,"deleting",[d.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=w(h.prototype,"confirmed",[d.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),v=w(h.prototype,"flash",[d.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=w(h.prototype,"flashType",[d.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w(h.prototype,"deleteChannel",[s.action],Object.getOwnPropertyDescriptor(h.prototype,"deleteChannel"),h.prototype),h)
e.default=M,(0,t.setComponentTemplate)(j,M)}))
define("discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object","@glimmer/tracking","@ember/service"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,i.createTemplateFactory)({id:"KCdIdVHm",block:'[[[8,[39,0],[[24,0,"chat-modal-edit-channel-description"]],[["@closeModal","@inline","@title","@flash"],[[30,1],[30,2],[28,[37,1],["chat.channel_edit_description_modal.title"],null],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n    "],[10,1],[14,0,"chat-modal-edit-channel-description__description"],[12],[1,[28,[35,1],["chat.channel_edit_description_modal.description"],null]],[13],[1,"\\n    "],[8,[39,2],null,[["@value","@max"],[[30,0,["editedDescription"]],[30,0,["descriptionMaxLength"]]]],[["default"],[[[[1,"\\n      "],[11,"textarea"],[24,0,"chat-modal-edit-channel-description__description-input"],[16,"placeholder",[28,[37,1],["chat.channel_edit_description_modal.input_placeholder"],null]],[4,[38,3],["input",[28,[37,4],[[30,0],[30,0,["onChangeChatChannelDescription"]]],[["value"],["target.value"]]]],null],[12],[1,[30,0,["editedDescription"]]],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,5],null,[["@class","@action","@label","@disabled"],["btn-primary create",[30,0,["onSaveChatChannelDescription"]],"save",[30,0,["isSaveDisabled"]]]],null],[1,"\\n    "],[8,[39,6],null,[["@close"],[[30,1]]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","char-counter","on","action","d-button","d-modal-cancel"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description.hbs",isStrictMode:!1})
let m=(o=class extends n.default{constructor(){super(...arguments),d(this,"chatApi",l,this),d(this,"editedDescription",c,this),d(this,"flash",u,this)}get channel(){return this.args.model}get isSaveDisabled(){return this.channel.description===this.editedDescription||this.editedDescription?.length>280}get descriptionMaxLength(){return 280}onSaveChatChannelDescription(){return this.chatApi.updateChannel(this.channel.id,{description:this.editedDescription}).then((e=>{this.channel.description=e.channel.description,this.args.closeModal()})).catch((e=>{e.jqXHR?.responseJSON?.errors&&(this.flash=e.jqXHR.responseJSON.errors.join("\n"))}))}onChangeChatChannelDescription(e){this.flash=null,this.editedDescription=e}},l=h(o.prototype,"chatApi",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(o.prototype,"editedDescription",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.channel.description||""}}),u=h(o.prototype,"flash",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(o.prototype,"onSaveChatChannelDescription",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"onSaveChatChannelDescription"),o.prototype),h(o.prototype,"onChangeChatChannelDescription",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"onChangeChatChannelDescription"),o.prototype),o)
e.default=m,(0,t.setComponentTemplate)(p,m)})),define("discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse-common/lib/debounce","discourse/lib/ajax","@ember/runloop","@ember/object","discourse/lib/ajax-error","@glimmer/tracking","@ember/service"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g,f,v,y,_
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(e,t){M(e,t),t.add(e)}function M(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z(e,t,i){return function(e,t,i){if(t.set)t.set.call(e,i)
else{if(!t.writable)throw new TypeError("attempted to set read only private field")
t.value=i}}(e,k(e,t,"set"),i),i}function k(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}function O(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function C(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const S=(0,i.createTemplateFactory)({id:"2d9f8GGM",block:'[[[8,[39,0],[[24,0,"chat-modal-edit-channel-name"]],[["@closeModal","@inline","@title","@flash"],[[30,1],[30,2],[28,[37,1],["chat.channel_edit_name_slug_modal.title"],null],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n    "],[10,0],[14,0,"edit-channel-control"],[12],[1,"\\n      "],[10,"label"],[14,"for","channel-name"],[14,0,"edit-channel-label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.channel_edit_name_slug_modal.name"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,2],[[24,3,"channel-name"],[24,0,"chat-channel-edit-name-slug-modal__name-input"],[16,"placeholder",[28,[37,1],["chat.channel_edit_name_slug_modal.input_placeholder"],null]],[4,[38,3],["input",[28,[37,4],[[30,0],"onChangeChatChannelName"],[["value"],["target.value"]]]],null]],[["@type","@value"],["text",[30,0,["editedName"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"edit-channel-control"],[12],[1,"\\n      "],[10,"label"],[14,"for","channel-slug"],[14,0,"edit-channel-label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.channel_edit_name_slug_modal.slug"],null]],[1,"\\n        "],[10,1],[12],[1,"\\n          "],[1,[28,[35,5],["info-circle"],null]],[1,"\\n          "],[8,[39,6],null,null,[["default"],[[[[1,[28,[35,1],["chat.channel_edit_name_slug_modal.slug_description"],null]]],[]]]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,2],[[24,3,"channel-slug"],[24,0,"chat-channel-edit-name-slug-modal__slug-input"],[16,"placeholder",[30,0,["autoGeneratedSlug"]]],[4,[38,3],["input",[28,[37,4],[[30,0],"onChangeChatChannelSlug"],[["value"],["target.value"]]]],null]],[["@type","@value"],["text",[30,0,["editedSlug"]]]],null],[1,"\\n    "],[13],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,7],null,[["@class","@action","@label","@disabled"],["btn-primary create",[30,0,["onSave"]],"save",[30,0,["isSaveDisabled"]]]],null],[1,"\\n    "],[8,[39,8],null,[["@close"],[[30,1]]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","input","on","action","d-icon","d-tooltip","d-button","d-modal-cancel"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name.hbs",isStrictMode:!1})
let P=(v=new WeakMap,y=new WeakSet,_=new WeakSet,d=class extends n.default{constructor(){var e,t,i
super(...arguments),j(this,_),j(this,y),w(this,"chatApi",h,this),w(this,"siteSettings",p,this),w(this,"editedName",m,this),w(this,"editedSlug",b,this),w(this,"autoGeneratedSlug",g,this),w(this,"flash",f,this),i={writable:!0,value:null},M(e=this,t=v),t.set(e,i)}get channel(){return this.args.model}get isSaveDisabled(){return this.channel.title===this.editedName&&this.channel.slug===this.editedSlug||this.editedName?.length>this.siteSettings.max_topic_title_length}onSave(){return this.chatApi.updateChannel(this.channel.id,{name:this.editedName,slug:this.editedSlug||this.autoGeneratedSlug||this.channel.slug}).then((e=>{this.channel.title=e.channel.title,this.args.closeModal()})).catch((e=>this.flash=(0,l.extractError)(e)))}onChangeChatChannelName(e){this.flash=null,O(this,y,T).call(this,e)}onChangeChatChannelSlug(){this.flash=null,O(this,y,T).call(this,this.editedName)}},h=C(d.prototype,"chatApi",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=C(d.prototype,"siteSettings",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=C(d.prototype,"editedName",[c.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.channel.title}}),b=C(d.prototype,"editedSlug",[c.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.channel.slug}}),g=C(d.prototype,"autoGeneratedSlug",[c.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),f=C(d.prototype,"flash",[c.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C(d.prototype,"onSave",[o.action],Object.getOwnPropertyDescriptor(d.prototype,"onSave"),d.prototype),C(d.prototype,"onChangeChatChannelName",[o.action],Object.getOwnPropertyDescriptor(d.prototype,"onChangeChatChannelName"),d.prototype),C(d.prototype,"onChangeChatChannelSlug",[o.action],Object.getOwnPropertyDescriptor(d.prototype,"onChangeChatChannelSlug"),d.prototype),d)
function T(e){var t;(0,s.cancel)(function(e,t){return t.get?t.get.call(e):t.value}(t=this,k(t,v,"get"))),this.autoGeneratedSlug="",e&&z(this,v,(0,r.default)(this,O(this,_,E),e,300))}function E(e){return(0,a.ajax)("/slugs.json",{type:"POST",data:{name:e}}).then((e=>{this.autoGeneratedSlug=e.slug}))}e.default=P,(0,t.setComponentTemplate)(S,P)})),define("discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/utils","@ember/object","@ember/service","@glimmer/tracking","discourse/lib/ajax-error","@ember/template","I18n"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const y=(0,i.createTemplateFactory)({id:"K0jWJ7XN",block:'[[[8,[39,0],[[24,0,"chat-modal-move-message-to-channel"]],[["@closeModal","@inline","@title"],[[30,1],[30,2],[28,[37,1],["chat.move_to_channel.title"],null]]],[["body","footer"],[[[[1,"\\n"],[41,[30,0,["selectedMessageCount"]],[[[1,"      "],[10,2],[12],[1,[30,0,["instructionsText"]]],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[8,[39,3],null,[["@class","@content","@value","@nameProperty"],["chat-modal-move-message-to-channel__channel-chooser",[30,0,["availableChannels"]],[30,0,["destinationChannelId"]],"title"]],null],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,4],null,[["@class","@icon","@disabled","@action","@label"],["btn-primary","sign-out-alt",[30,0,["disableMoveButton"]],[30,0,["moveMessages"]],"chat.move_to_channel.confirm_move"]],null],[1,"\\n    "],[8,[39,4],null,[["@label","@class","@action"],["cancel","btn-flat",[30,1]]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","if","chat-channel-chooser","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel.hbs",isStrictMode:!1})
let _=(d=class extends n.default{constructor(){super(...arguments),f(this,"chat",h,this),f(this,"chatApi",p,this),f(this,"router",m,this),f(this,"chatChannelsManager",b,this),f(this,"destinationChannelId",g,this)}get sourceChannel(){return this.args.model.sourceChannel}get selectedMessageIds(){return this.args.model.selectedMessageIds}get selectedMessageCount(){return this.selectedMessageIds?.length}get disableMoveButton(){return(0,r.isBlank)(this.destinationChannelId)}get availableChannels(){return(this.args.model.availableChannels||this.chatChannelsManager.publicMessageChannels).rejectBy("id",this.sourceChannel.id)}get instructionsText(){return(0,c.htmlSafe)(u.default.t("chat.move_to_channel.instructions",{channelTitle:this.sourceChannel.escapedTitle,count:this.selectedMessageCount}))}moveMessages(){return this.chatApi.moveChannelMessages(this.sourceChannel.id,{message_ids:this.selectedMessageIds,destination_channel_id:this.destinationChannelId}).then((e=>{this.args.closeModal(),this.router.transitionTo("chat.channel.near-message","-",e.destination_channel_id,e.first_moved_message_id)})).catch(l.popupAjaxError)}},h=v(d.prototype,"chat",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=v(d.prototype,"chatApi",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=v(d.prototype,"router",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=v(d.prototype,"chatChannelsManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=v(d.prototype,"destinationChannelId",[o.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v(d.prototype,"moveMessages",[a.action],Object.getOwnPropertyDescriptor(d.prototype,"moveMessages"),d.prototype),d)
e.default=_,(0,t.setComponentTemplate)(y,_)})),define("discourse/plugins/chat/discourse/components/chat/modal/new-message",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const u=(0,i.createTemplateFactory)({id:"RbZVRt9q",block:'[[[41,[30,0,["shouldRender"]],[[[1,"  "],[8,[39,1],[[24,0,"chat-modal-new-message"]],[["@closeModal","@title","@inline"],[[30,1],"chat.new_message_modal.title",[30,2]]],[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@onClose"],[[30,1]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]],null]],["@closeModal","@inline"],false,["if","d-modal","chat/message-creator"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/new-message.hbs",isStrictMode:!1})
let d=(a=class extends n.default{constructor(){super(...arguments),l(this,"chat",s,this),l(this,"siteSettings",o,this)}get shouldRender(){return this.siteSettings.enable_public_channels||this.chat.userCanDirectMessage}},s=c(a.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(a.prototype,"siteSettings",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a)
e.default=d,(0,t.setComponentTemplate)(u,d)})),define("discourse/plugins/chat/discourse/components/chat/modal/thread-settings",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/lib/ajax-error","@glimmer/tracking","@ember/service","@ember/object"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,i.createTemplateFactory)({id:"4tCQ7pKi",block:'[[[8,[39,0],[[24,0,"chat-modal-thread-settings"]],[["@closeModal","@inline","@title"],[[30,1],[30,2],[28,[37,1],["chat.thread.settings"],null]]],[["body","footer"],[[[[1,"\\n    "],[10,"label"],[14,"for","thread-title"],[14,0,"thread-title-label"],[12],[1,"\\n      "],[1,[28,[35,1],["chat.thread.title"],null]],[1,"\\n    "],[13],[1,"\\n    "],[8,[39,2],[[24,3,"thread-title"],[24,0,"chat-modal-thread-settings__title-input"]],[["@type","@value"],["text",[30,0,["editedTitle"]]]],null],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,3],null,[["@class","@disabled","@action","@label"],["btn-primary",[30,0,["buttonDisabled"]],[30,0,["saveThread"]],"save"]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","input","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/thread-settings.hbs",isStrictMode:!1})
let b=(l=class extends n.default{constructor(){super(...arguments),h(this,"chatApi",c,this),h(this,"editedTitle",u,this),h(this,"saving",d,this)}get buttonDisabled(){return this.saving}get thread(){return this.args.model}saveThread(){this.saving=!0,this.chatApi.editThread(this.thread.channel.id,this.thread.id,{title:this.editedTitle}).then((()=>{this.thread.title=this.editedTitle,this.args.closeModal()})).catch(r.popupAjaxError).finally((()=>{this.saving=!1}))}},c=p(l.prototype,"chatApi",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(l.prototype,"editedTitle",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.thread.title||""}}),d=p(l.prototype,"saving",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p(l.prototype,"saveThread",[o.action],Object.getOwnPropertyDescriptor(l.prototype,"saveThread"),l.prototype),l)
e.default=b,(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object","@ember/template","discourse/plugins/chat/discourse/models/chat-channel","I18n","@ember/service","discourse/lib/ajax-error"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,i.createTemplateFactory)({id:"9U4zEqWu",block:'[[[8,[39,0],[[24,0,"chat-modal-toggle-channel-status"]],[["@closeModal","@inline","@title"],[[30,1],[30,2],[28,[37,1],[[30,0,["modalTitle"]]],null]]],[["body","footer"],[[[[1,"\\n    "],[10,2],[14,0,"chat-modal-toggle-channel-status__instructions"],[12],[1,[30,0,["instructions"]]],[13],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,2],null,[["@class","@action","@label","@id"],["btn-primary",[30,0,["onStatusChange"]],[30,0,["buttonLabel"]],"chat-channel-toggle-btn"]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status.hbs",isStrictMode:!1})
let g=(u=class extends n.default{constructor(){super(...arguments),p(this,"chatApi",d,this),p(this,"router",h,this)}get channel(){return this.args.model}get buttonLabel(){return this.channel?.isClosed?"chat.channel_settings.open_channel":"chat.channel_settings.close_channel"}get instructions(){return this.channel?.isClosed?(0,a.htmlSafe)(o.default.t("chat.channel_open.instructions")):(0,a.htmlSafe)(o.default.t("chat.channel_close.instructions"))}get modalTitle(){return this.channel?.isClosed?"chat.channel_open.title":"chat.channel_close.title"}onStatusChange(){const e=this.channel.isClosed?s.CHANNEL_STATUSES.open:s.CHANNEL_STATUSES.closed
return this.chatApi.updateChannelStatus(this.channel.id,e).then((()=>{this.args.closeModal(),this.router.transitionTo("chat.channel",...this.channel.routeModels)})).catch(c.popupAjaxError)}},d=m(u.prototype,"chatApi",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=m(u.prototype,"router",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m(u.prototype,"onStatusChange",[r.action],Object.getOwnPropertyDescriptor(u.prototype,"onStatusChange"),u.prototype),u)
e.default=g,(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/chat/scroll-to-bottom-arrow",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"FdcovQgc",block:'[[[10,0],[14,0,"chat-scroll-to-bottom"],[12],[1,"\\n  "],[8,[39,0],[[16,0,[28,[37,1],["btn-flat","chat-scroll-to-bottom__button",[52,[30,1],"visible"]],null]]],[["@action"],[[30,2]]],[["default"],[[[[1,"\\n    "],[10,1],[14,0,"chat-scroll-to-bottom__arrow"],[12],[1,"\\n      "],[1,[28,[35,3],["arrow-down"],null]],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]],[1,"\\n"],[13]],["@isVisible","@onScrollToBottom"],false,["d-button","concat-class","if","d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/scroll-to-bottom-arrow.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,(0,n.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat/selection-manager",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object","discourse/lib/utilities","discourse-common/lib/get-owner","discourse-common/config/environment","discourse/lib/ajax-error","@ember/service","discourse-common/utils/decorators","@glimmer/tracking","discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g,f,v,y,_,w,j
function M(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function z(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const k=(0,i.createTemplateFactory)({id:"Zw554Rl5",block:'[[[10,0],[14,0,"chat-selection-management"],[15,"data-last-copy-successful",[30,0,["lastCopySuccessful"]]],[12],[1,"\\n  "],[10,0],[14,0,"chat-selection-management__buttons"],[12],[1,"\\n    "],[8,[39,0],null,[["@id","@icon","@label","@disabled","@action"],["chat-quote-btn","quote-left","chat.selection.quote_selection",[28,[37,1],[[30,0,["anyMessagesSelected"]]],null],[30,0,["quoteMessages"]]]],null],[1,"\\n\\n"],[41,[30,0,["site","desktopView"]],[[[1,"      "],[8,[39,0],null,[["@id","@icon","@label","@disabled","@action"],["chat-copy-btn","copy","chat.selection.copy",[28,[37,1],[[30,0,["anyMessagesSelected"]]],null],[30,0,["copyMessages"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["enableMove"]],[[[1,"      "],[8,[39,0],null,[["@id","@icon","@label","@disabled","@action"],["chat-move-to-channel-btn","sign-out-alt","chat.selection.move_selection_to_channel",[28,[37,1],[[30,0,["anyMessagesSelected"]]],null],[30,0,["openMoveMessageModal"]]]],null],[1,"\\n"]],[]],null],[1,"\\n    "],[8,[39,0],null,[["@id","@icon","@class","@label","@action"],["chat-cancel-selection-btn","times","btn-secondary cancel-btn","chat.selection.cancel",[30,1,["cancelSelecting"]]]],null],[1,"\\n  "],[13],[1,"\\n\\n"],[41,[30,0,["showCopySuccess"]],[[[1,"    "],[11,1],[24,0,"chat-selection-management__copy-success"],[4,[38,3],[[28,[37,4],[[28,[37,5],[[30,0,["showCopySuccess"]]],null],false],null]],null],[12],[1,"\\n      "],[1,[28,[35,6],["chat.quote.copy_success"],null]],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[13]],["@pane"],false,["d-button","not","if","chat/on-animation-end","fn","mut","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/selection-manager.hbs",isStrictMode:!1})
let O=(p=(0,c.inject)("composer"),m=(0,c.inject)("chat-api"),b=class extends n.default{constructor(){super(...arguments),M(this,"topicComposer",g,this),M(this,"router",f,this),M(this,"modal",v,this),M(this,"site",y,this),M(this,"api",_,this),M(this,"showCopySuccess",w,this),M(this,"lastCopySuccessful",j,this)}get enableMove(){return this.args.enableMove??!1}get anyMessagesSelected(){return this.args.pane.selectedMessageIds.length>0}async generateQuote(){const{markdown:e}=await this.api.generateQuote(this.args.pane.channel.id,this.args.pane.selectedMessageIds)
return new Blob([e],{type:"text/plain"})}openMoveMessageModal(){this.modal.show(h.default,{model:{sourceChannel:this.args.pane.channel,selectedMessageIds:this.args.pane.selectedMessageIds}})}async quoteMessages(){let e
try{const t=await this.generateQuote()
e=await t.text()}catch(i){(0,l.popupAjaxError)(i)}const t={}
if(this.args.pane.channel.isCategoryChannel&&(t.categoryId=this.args.pane.channel.chatableId),this.site.mobileView)this.args.pane.channel.chatableUrl&&this.router.transitionTo(this.args.pane.channel.chatableUrl),await this.topicComposer.focusComposer({fallbackToNewTopic:!0,insertText:e,openOpts:t})
else{const i=(0,s.getOwner)(this).lookup("controller:topic")
await this.topicComposer.focusComposer({fallbackToNewTopic:!0,topic:i?.model,insertText:e,openOpts:t})}}async copyMessages(){try{this.lastCopySuccessful=!1,this.showCopySuccess=!1,(0,o.isTesting)()||await(0,a.clipboardCopyAsync)(this.generateQuote),this.showCopySuccess=!0,this.lastCopySuccessful=!0}catch(e){(0,l.popupAjaxError)(e)}}},g=z(b.prototype,"topicComposer",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=z(b.prototype,"router",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=z(b.prototype,"modal",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=z(b.prototype,"site",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=z(b.prototype,"api",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=z(b.prototype,"showCopySuccess",[d.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=z(b.prototype,"lastCopySuccessful",[d.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),z(b.prototype,"generateQuote",[u.bind],Object.getOwnPropertyDescriptor(b.prototype,"generateQuote"),b.prototype),z(b.prototype,"openMoveMessageModal",[r.action],Object.getOwnPropertyDescriptor(b.prototype,"openMoveMessageModal"),b.prototype),z(b.prototype,"quoteMessages",[r.action],Object.getOwnPropertyDescriptor(b.prototype,"quoteMessages"),b.prototype),z(b.prototype,"copyMessages",[r.action],Object.getOwnPropertyDescriptor(b.prototype,"copyMessages"),b.prototype),b)
e.default=O,(0,t.setComponentTemplate)(k,O)})),define("discourse/plugins/chat/discourse/components/chat/thread-list",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse-common/utils/decorators","@glimmer/tracking","@ember/object","@ember/service"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function g(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const v=(0,i.createTemplateFactory)({id:"BbtiV8Xy",block:'[[[41,[30,0,["shouldRender"]],[[[1,"  "],[11,0],[24,0,"chat-thread-list"],[4,[38,1],[[30,0,["subscribe"]]],null],[4,[38,1],[[30,0,["loadThreads"]]],null],[4,[38,2],[[30,0,["loadThreads"]],[30,1]],null],[4,[38,2],[[30,0,["subscribe"]],[30,1]],null],[4,[38,3],[[30,0,["teardown"]]],null],[12],[1,"\\n"],[41,[30,2],[[[1,"      "],[8,[39,4],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,0,"chat-thread-list__items"],[12],[1,"\\n"],[42,[28,[37,6],[[28,[37,6],[[30,0,["sortedThreads"]]],null]],null],null,[[[1,"        "],[8,[39,7],[[4,[52,[28,[37,8],[[30,3],[30,0,["lastThread"]]],null],[50,[28,[37,10],["modifier:chat/track-message"],null],2,[[30,0,["loadThreads"]]],null]],null,null]],[["@thread"],[[30,3]]],null],[1,"\\n"]],[3]],[[[41,[30,0,["threadsCollection","fetchedOnce"]],[[[1,"          "],[10,0],[14,0,"chat-thread-list__no-threads"],[12],[1,"\\n            "],[1,[28,[35,11],["chat.threads.none"],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],null]],[]]],[1,"      "],[8,[39,12],null,[["@condition"],[[30,0,["threadsCollection","loading"]]]],null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@channel","@includeHeader","thread"],false,["if","did-insert","did-update","will-destroy","chat/thread-list/header","each","-track-array","chat/thread-list/item","eq","modifier","-resolve","i18n","conditional-loading-spinner"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread-list.hbs",isStrictMode:!1})
let y=(p=new WeakSet,l=class extends n.default{constructor(){super(...arguments),b(this,p),m(this,"chat",c,this),m(this,"chatApi",u,this),m(this,"messageBus",d,this),m(this,"chatTrackingStateManager",h,this)}get threadsManager(){return this.args.channel.threadsManager}get sortedThreads(){return this.threadsManager.threads.filter((e=>e.currentUserMembership&&!e.originalMessage.deletedAt)).sort(((e,t)=>e.tracking.unreadCount&&t.tracking.unreadCount?e.preview.lastReplyCreatedAt>t.preview.lastReplyCreatedAt?-1:1:e.tracking.unreadCount?-1:t.tracking.unreadCount?1:e.preview.lastReplyCreatedAt>t.preview.lastReplyCreatedAt?-1:1))}get lastThread(){return this.sortedThreads[this.sortedThreads.length-1]}get shouldRender(){return!!this.args.channel}loadThreads(){return this.threadsCollection.load({limit:10})}subscribe(){g(this,p,_).call(this),this.messageBus.subscribe(`/chat/${this.args.channel.id}`,this.onMessageBus,this.args.channel.messageBusLastId)}onMessageBus(e){switch(e.type){case"delete":this.handleDeleteMessage(e)
break
case"restore":this.handleRestoreMessage(e)}}handleDeleteMessage(e){const t=this.threadsManager.threads.findBy("originalMessage.id",e.deleted_id)
t&&(t.originalMessage.deletedAt=new Date)}handleRestoreMessage(e){const t=this.threadsManager.threads.findBy("originalMessage.id",e.chat_message.id)
t&&(t.originalMessage.deletedAt=null)}get threadsCollection(){return this.chatApi.threads(this.args.channel.id,this.handleLoadedThreads)}handleLoadedThreads(e){return e.threads.map((t=>{const i=this.threadsManager.add(this.args.channel,t,{replace:!0})
return this.chatTrackingStateManager.setupChannelThreadState(this.args.channel,e.tracking),i}))}teardown(){g(this,p,_).call(this)}},c=f(l.prototype,"chat",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=f(l.prototype,"chatApi",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=f(l.prototype,"messageBus",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=f(l.prototype,"chatTrackingStateManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f(l.prototype,"loadThreads",[s.action],Object.getOwnPropertyDescriptor(l.prototype,"loadThreads"),l.prototype),f(l.prototype,"subscribe",[s.action],Object.getOwnPropertyDescriptor(l.prototype,"subscribe"),l.prototype),f(l.prototype,"onMessageBus",[r.bind],Object.getOwnPropertyDescriptor(l.prototype,"onMessageBus"),l.prototype),f(l.prototype,"threadsCollection",[a.cached],Object.getOwnPropertyDescriptor(l.prototype,"threadsCollection"),l.prototype),f(l.prototype,"handleLoadedThreads",[r.bind],Object.getOwnPropertyDescriptor(l.prototype,"handleLoadedThreads"),l.prototype),f(l.prototype,"teardown",[s.action],Object.getOwnPropertyDescriptor(l.prototype,"teardown"),l.prototype),l)
function _(){this.args.channel&&this.messageBus.unsubscribe(`/chat/${this.args.channel.id}`,this.onMessageBus)}e.default=y,(0,t.setComponentTemplate)(v,y)})),define("discourse/plugins/chat/discourse/components/chat/thread-list/header",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"5OYm993C",block:'[[[10,0],[14,0,"chat-thread-header"],[12],[1,"\\n  "],[10,1],[14,0,"chat-thread-header__label"],[12],[1,"\\n    "],[1,[28,[35,0],[[28,[37,1],["chat.threads.list"],null]],null]],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"chat-thread-header__buttons"],[12],[1,"\\n    "],[8,[39,2],[[24,0,"chat-thread__close btn-flat btn btn-icon no-text"],[16,"title",[28,[37,1],["chat.thread.close"],null]]],[["@route","@models"],["chat.channel",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n      "],[1,[28,[35,3],["times"],null]],[1,"\\n    "]],[]]]]],[1,"\\n  "],[13],[1,"\\n"],[13]],["@channel"],false,["replace-emoji","i18n","link-to","d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread-list/header.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,(0,n.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat/thread-list/item",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service","@ember/object"],(function(e,t,i,n,r,a){"use strict"
var s,o
function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,i.createTemplateFactory)({id:"hisfhiMD",block:'[[[11,0],[16,0,[28,[37,0],["chat-thread-list-item",[52,[28,[37,2],[[30,1,["tracking","unreadCount"]],0],null],"-is-unread"]],null]],[16,"data-thread-id",[30,1,["id"]]],[17,2],[12],[1,"\\n  "],[10,0],[14,0,"chat-thread-list-item__main"],[12],[1,"\\n    "],[11,0],[16,"title",[28,[37,3],["chat.thread.view_thread"],null]],[24,"role","button"],[24,0,"chat-thread-list-item__open-button"],[4,[38,4],["click",[28,[37,5],[[30,0,["openThread"]],[30,1]],null]],[["passive"],[true]]],[12],[1,"\\n      "],[10,0],[14,0,"chat-thread-list-item__header"],[12],[1,"\\n        "],[10,0],[14,0,"chat-thread-list-item__om-user-avatar"],[12],[1,"\\n          "],[8,[39,6],null,[["@user"],[[30,1,["originalMessage","user"]]]],null],[1,"\\n        "],[13],[1,"\\n        "],[10,0],[14,0,"chat-thread-list-item__title overflow-ellipsis"],[12],[1,"\\n          "],[1,[28,[35,7],[[30,0,["title"]]],null]],[1,"\\n        "],[13],[1,"\\n        "],[10,0],[14,0,"chat-thread-list-item__unread-indicator"],[12],[1,"\\n          "],[8,[39,8],null,[["@thread"],[[30,1]]],null],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"chat-thread-list-item__body"],[12],[1,"\\n        "],[1,[28,[35,7],[[28,[37,9],[[30,1,["originalMessage","excerpt"]]],null]],null]],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"chat-thread-list-item__metadata"],[12],[1,"\\n        "],[10,0],[14,0,"chat-thread-list-item__participants"],[12],[13],[1,"\\n        "],[10,0],[14,0,"chat-thread-list-item__last-reply"],[12],[1,"\\n"],[41,[30,1,["preview","lastReplyCreatedAt"]],[[[1,"            "],[1,[28,[35,3],["chat.thread.last_reply"],null]],[1,"\\n            "],[1,[28,[35,10],[[30,1,["preview","lastReplyCreatedAt"]]],[["leaveAgo"],["true"]]]],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13]],["@thread","&attrs"],false,["concat-class","if","gt","i18n","on","fn","chat/user-avatar","replace-emoji","chat/thread-list/item/unread-indicator","html-safe","format-date"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread-list/item.hbs",isStrictMode:!1})
let u=(s=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get title(){return this.args.thread.escapedTitle}openThread(e){this.router.transitionTo("chat.channel.thread",...e.routeModels)}},o=l(s.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l(s.prototype,"openThread",[a.action],Object.getOwnPropertyDescriptor(s.prototype,"openThread"),s.prototype),s)
e.default=u,(0,t.setComponentTemplate)(c,u)})),define("discourse/plugins/chat/discourse/components/chat/thread-list/item/unread-indicator",["exports","@ember/component","@ember/template-factory","@glimmer/component"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"rDctiubz",block:'[[[41,[30,0,["showUnreadIndicator"]],[[[1,"  "],[10,0],[14,0,"chat-thread-list-item-unread-indicator"],[12],[1,"\\n    "],[10,0],[14,0,"chat-thread-list-item-unread-indicator__number"],[12],[1,"\\n      "],[1,[30,0,["unreadCountLabel"]]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread-list/item/unread-indicator.hbs",isStrictMode:!1})
class a extends n.default{get unreadCount(){return this.args.thread.tracking.unreadCount}get showUnreadIndicator(){return this.unreadCount>0}get unreadCountLabel(){return this.unreadCount>99?"99+":this.unreadCount}}e.default=a,(0,t.setComponentTemplate)(r,a)})),define("discourse/plugins/chat/discourse/components/chat/thread/header-unread-indicator",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"03TVnh5M",block:'[[[41,[30,0,["showUnreadIndicator"]],[[[1,"  "],[10,0],[14,0,"chat-thread-header-unread-indicator"],[15,"aria-label",[28,[37,1],["chat.unread_threads_count"],[["count"],[[30,0,["unreadCountLabel"]]]]]],[15,"title",[28,[37,1],["chat.unread_threads_count"],[["count"],[[30,0,["unreadCountLabel"]]]]]],[12],[1,"\\n    "],[10,0],[14,0,"chat-thread-header-unread-indicator__number"],[12],[1,[30,0,["unreadCountLabel"]]],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread/header-unread-indicator.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="currentUser",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get currentUserInDnD(){return this.currentUser.isInDoNotDisturb()}get unreadCount(){return this.args.channel.threadsManager.unreadThreadCount}get showUnreadIndicator(){return!this.currentUserInDnD&&this.unreadCount>0}get unreadCountLabel(){return this.unreadCount>99?"99+":this.unreadCount}},c=a.prototype,u="currentUser",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat/thread/header",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/lib/notification-levels","discourse/lib/ajax-error","@ember/service","@ember/object","discourse/plugins/chat/discourse/models/user-chat-thread-membership","@glimmer/tracking","discourse/plugins/chat/discourse/components/chat/modal/thread-settings"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g,f,v,y
function _(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function w(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const j=(0,i.createTemplateFactory)({id:"+O1mD1SI",block:'[[[10,0],[14,0,"chat-thread-header"],[12],[1,"\\n  "],[10,0],[14,0,"chat-thread-header__left-buttons"],[12],[1,"\\n"],[41,[30,1],[[[1,"      "],[8,[39,1],[[24,0,"chat-thread__back-to-previous-route btn-flat btn btn-icon no-text"],[16,"title",[28,[37,2],["chat.return_to_threads_list"],null]]],[["@route","@models"],[[30,0,["backLink","route"]],[30,0,["backLink","models"]]]],[["default"],[[[[1,"\\n        "],[8,[39,3],null,[["@channel"],[[30,1,["channel"]]]],null],[1,"\\n        "],[1,[28,[35,4],["chevron-left"],null]],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n\\n  "],[10,1],[14,0,"chat-thread-header__label overflow-ellipsis"],[12],[1,"\\n    "],[1,[28,[35,5],[[30,0,["label"]]],null]],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[15,0,[28,[37,6],["chat-thread-header__buttons",[52,[30,0,["persistedNotificationLevel"]],"-persisted"]],null]],[12],[1,"\\n    "],[8,[39,7],null,[["@value","@onChange"],[[30,0,["threadNotificationLevel"]],[30,0,["updateThreadNotificationLevel"]]]],null],[1,"\\n"],[41,[30,0,["canChangeThreadSettings"]],[[[1,"      "],[8,[39,8],null,[["@action","@class","@icon","@title"],[[30,0,["openThreadSettings"]],"btn-flat chat-thread-header__settings","cog","chat.thread.settings"]],null],[1,"\\n"]],[]],null],[1,"    "],[8,[39,1],[[24,0,"chat-thread__close btn-flat btn btn-icon no-text"],[16,"title",[28,[37,2],["chat.thread.close"],null]]],[["@route","@models"],["chat.channel",[30,1,["channel","routeModels"]]]],[["default"],[[[[1,"\\n      "],[1,[28,[35,4],["times"],null]],[1,"\\n    "]],[]]]]],[1,"\\n  "],[13],[1,"\\n"],[13]],["@thread"],false,["if","link-to","i18n","chat/thread/header-unread-indicator","d-icon","replace-emoji","concat-class","thread-notifications-button","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread/header.hbs",isStrictMode:!1})
let M=(d=class extends n.default{constructor(){super(...arguments),_(this,"currentUser",h,this),_(this,"chatApi",p,this),_(this,"router",m,this),_(this,"chatStateManager",b,this),_(this,"chatHistory",g,this),_(this,"site",f,this),_(this,"modal",v,this),_(this,"persistedNotificationLevel",y,this)}get backLink(){let e
return e="chat.channel.index"===this.chatHistory.previousRoute?.name&&this.site.mobileView?"chat.channel.index":"chat.channel.threads",{route:e,models:this.args.channel.routeModels}}get label(){return this.args.thread.escapedTitle}get canChangeThreadSettings(){return!!this.args.thread&&(this.currentUser.staff||this.currentUser.id===this.args.thread.originalMessage.user.id)}get threadNotificationLevel(){return this.membership?.notificationLevel||r.NotificationLevels.REGULAR}get membership(){return this.args.thread.currentUserMembership}openThreadSettings(){this.modal.show(u.default,{model:this.args.thread})}updateThreadNotificationLevel(e){let t
this.persistedNotificationLevel=!1,this.membership?(t=this.membership.notificationLevel,this.membership.notificationLevel=e):this.args.thread.currentUserMembership=l.default.create({notification_level:e,last_read_message_id:null}),this.chatApi.updateCurrentUserThreadNotificationsSettings(this.args.thread.channel.id,this.args.thread.id,{notificationLevel:e}).then((e=>{this.membership.last_read_message_id=e.membership.last_read_message_id,this.persistedNotificationLevel=!0})).catch((e=>{this.membership.notificationLevel=t,(0,a.popupAjaxError)(e)}))}},h=w(d.prototype,"currentUser",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=w(d.prototype,"chatApi",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=w(d.prototype,"router",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=w(d.prototype,"chatStateManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=w(d.prototype,"chatHistory",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=w(d.prototype,"site",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=w(d.prototype,"modal",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=w(d.prototype,"persistedNotificationLevel",[c.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),w(d.prototype,"openThreadSettings",[o.action],Object.getOwnPropertyDescriptor(d.prototype,"openThreadSettings"),d.prototype),w(d.prototype,"updateThreadNotificationLevel",[o.action],Object.getOwnPropertyDescriptor(d.prototype,"updateThreadNotificationLevel"),d.prototype),d)
e.default=M,(0,t.setComponentTemplate)(j,M)})),define("discourse/plugins/chat/discourse/components/chat/thread/participants",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"cjTUyqFN",block:'[[[41,[28,[37,1],[[30,1,["preview","participantUsers","length"]],1],null],[[[1,"  "],[10,0],[14,0,"chat-thread-participants"],[12],[1,"\\n    "],[10,0],[14,0,"chat-thread-participants__avatar-group"],[12],[1,"\\n"],[42,[28,[37,3],[[28,[37,3],[[30,1,["preview","participantUsers"]]],null]],null],null,[[[1,"        "],[8,[39,4],null,[["@user","@avatarSize","@showPresence"],[[30,2],"tiny",false]],null],[1,"\\n"]],[2]],null],[1,"    "],[13],[1,"\\n"],[41,[30,1,["preview","otherParticipantCount"]],[[[1,"      "],[10,0],[14,0,"chat-thread-participants__other-count"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.thread.participants_other_count"],[["count"],[[30,1,["preview","otherParticipantCount"]]]]]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],["@thread","user"],false,["if","gt","each","-track-array","chat/user-avatar","i18n"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread/participants.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,(0,n.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat/thread/threads-list-button",["exports","@ember/component","@ember/template-factory","@glimmer/component"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"S775/LGw",block:'[[[8,[39,0],[[16,"title",[28,[37,1],["chat.threads.list"],null]],[16,0,[28,[37,2],["chat-threads-list-button btn btn-flat",[52,[30,1,["threadsManager","unreadThreadCount"]],"has-unreads"]],null]]],[["@route","@models"],["chat.channel.threads",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n  "],[1,[28,[35,4],["discourse-threads"],null]],[1,"\\n\\n  "],[8,[39,5],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]]]]]],["@channel"],false,["link-to","i18n","concat-class","if","d-icon","chat/thread/header-unread-indicator"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/thread/threads-list-button.hbs",isStrictMode:!1})
class a extends n.default{}e.default=a,(0,t.setComponentTemplate)(r,a)})),define("discourse/plugins/chat/discourse/components/chat/user-avatar",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"f0tFQuum",block:'[[[10,0],[15,0,[29,["chat-user-avatar ",[52,[30,0,["isOnline"]],"is-online"]]]],[12],[1,"\\n  "],[10,0],[14,"role","button"],[14,0,"chat-user-avatar__container clickable"],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n    "],[1,[28,[35,1],[[30,1]],[["imageSize"],[[30,0,["avatarSize"]]]]]],[1,"\\n  "],[13],[1,"\\n"],[13]],["@user"],false,["if","avatar"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/user-avatar.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get avatarSize(){return this.args.avatarSize||"tiny"}get showPresence(){return this.args.showPresence??!0}get isOnline(){const e=(this.args.chat||this.chat).presenceChannel?.users
return this.showPresence&&!!e?.find((e=>{let{id:t,username:i}=e
return this.args.user?.id===t||this.args.user?.username===i}))}},c=a.prototype,u="chat",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/chat/user-card-button",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object","@ember/service"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,i.createTemplateFactory)({id:"ZJfNMbRe",block:'[[[41,[30,0,["shouldRender"]],[[[1,"  "],[8,[39,1],null,[["@class","@action","@label","@icon"],["btn-primary chat-user-card-btn",[30,0,["startChatting"]],"chat.title_capitalized","d-chat"]],null],[1,"\\n"]],[]],null]],[],false,["if","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/user-card-button.hbs",isStrictMode:!1})
let p=(s=class extends n.default{constructor(){super(...arguments),u(this,"chat",o,this),u(this,"appEvents",l,this),u(this,"router",c,this)}get shouldRender(){return this.chat.userCanDirectMessage&&!this.args.user.suspended}startChatting(){return this.chat.upsertDmChannelForUsernames([this.args.user.username]).then((e=>{this.router.transitionTo("chat.channel",...e.routeModels),this.appEvents.trigger("card:close")}))}},o=d(s.prototype,"chat",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=d(s.prototype,"appEvents",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=d(s.prototype,"router",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(s.prototype,"startChatting",[r.action],Object.getOwnPropertyDescriptor(s.prototype,"startChatting"),s.prototype),s)
e.default=p,(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/collapser",["exports","@ember/component","@ember/template-factory","@ember/object"],(function(e,t,i,n){"use strict"
var r
function a(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const s=(0,i.createTemplateFactory)({id:"yuAZdViD",block:'[[[10,0],[14,0,"chat-message-collapser-header"],[12],[1,"\\n  "],[1,[30,0,["header"]]],[1,"\\n\\n"],[41,[30,0,["collapsed"]],[[[1,"    "],[8,[39,1],null,[["@action","@icon","@class"],[[28,[37,2],[[30,0],"open"],null],"caret-right","chat-message-collapser-button chat-message-collapser-closed"]],null],[1,"\\n"]],[]],[[[1,"    "],[8,[39,1],null,[["@action","@icon","@class"],[[28,[37,2],[[30,0],"close"],null],"caret-down","chat-message-collapser-button chat-message-collapser-opened"]],null],[1,"\\n"]],[]]],[13],[1,"\\n\\n"],[10,0],[15,0,[28,[37,3],["chat-message-collapser-body",[52,[30,0,["collapsed"]],"hidden"]],null]],[12],[1,"\\n  "],[18,1,[[30,0,["collapsed"]]]],[1,"\\n"],[13]],["&default"],false,["if","d-button","action","concat-class","yield"]]',moduleName:"discourse/plugins/chat/discourse/components/collapser.hbs",isStrictMode:!1})
var o=(0,t.setComponentTemplate)(s,t.default.extend((a(r={tagName:"",collapsed:!1,header:null,onToggle:null,open(){this.set("collapsed",!1),this.onToggle?.(!1)},close(){this.set("collapsed",!0),this.onToggle?.(!0)}},"open",[n.action],Object.getOwnPropertyDescriptor(r,"open"),r),a(r,"close",[n.action],Object.getOwnPropertyDescriptor(r,"close"),r),r)))
e.default=o})),define("discourse/plugins/chat/discourse/components/dc-filter-input",["exports","@ember/component","@ember/template-factory","@glimmer/component"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"kO9Zer//",block:'[[[10,0],[15,0,[28,[37,0],[[30,1]," dc-filter-input-container",[52,[30,0,["isFocused"]]," is-focused"]],null]],[12],[1,"\\n"],[41,[30,2,["left"]],[[[1,"    "],[1,[28,[35,2],[[30,2,["left"]]],[["class"],["-left"]]]],[1,"\\n"]],[]],null],[1,"\\n  "],[8,[39,3],[[24,0,"dc-filter-input"],[17,3],[4,[38,4],["input",[52,[30,5],[30,5],[28,[37,5],null,null]]],null],[4,[38,4],["focusin",[28,[37,6],[[30,0],[28,[37,7],[[30,0,["isFocused"]]],null],true],null]],null],[4,[38,4],["focusout",[28,[37,6],[[30,0],[28,[37,7],[[30,0,["isFocused"]]],null],false],null]],null]],[["@value"],[[30,4]]],null],[1,"\\n\\n  "],[18,6,null],[1,"\\n\\n"],[41,[30,2,["right"]],[[[1,"    "],[1,[28,[35,2],[[30,2,["right"]]],[["class"],["-right"]]]],[1,"\\n"]],[]],null],[13]],["@class","@icons","&attrs","@value","@filterAction","&default"],false,["concat","if","d-icon","input","on","noop","action","mut","yield"]]',moduleName:"discourse/plugins/chat/discourse/components/dc-filter-input.hbs",isStrictMode:!1})
class a extends n.default{}e.default=a,(0,t.setComponentTemplate)(r,a)})),define("discourse/plugins/chat/discourse/components/full-page-chat",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,i.createTemplateFactory)({id:"JGZ6+MLD",block:'[[[41,[30,1,["id"]],[[[1,"  "],[8,[39,1],null,[["@channel","@targetMessageId"],[[30,1],[28,[37,2],[[30,2]],null]]],null],[1,"\\n"]],[]],null]],["@channel","@targetMessageId"],false,["if","chat-channel","readonly"]]',moduleName:"discourse/plugins/chat/discourse/components/full-page-chat.hbs",isStrictMode:!1})
let l=(a=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},c=a.prototype,u="chat",d=[r.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s=m,a)
var c,u,d,h,p,m
e.default=l,(0,t.setComponentTemplate)(o,l)})),define("discourse/plugins/chat/discourse/components/reviewable-chat-message",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/service","@glimmer/tracking","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,i.createTemplateFactory)({id:"NmMCpC+0",block:'[[[10,0],[14,0,"flagged-post-header"],[12],[1,"\\n  "],[8,[39,0],null,[["@route","@models"],["chat.channel.near-message",[28,[37,1],[[30,0,["chatChannel","slugifiedTitle"]],[30,0,["chatChannel","id"]],[30,1,["target_id"]]],null]]],[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@channel"],[[30,0,["chatChannel"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"post-contents-wrapper"],[12],[1,"\\n  "],[8,[39,3],null,[["@user","@tagName"],[[30,1,["target_created_by"]],""]],null],[1,"\\n  "],[10,0],[14,0,"post-contents"],[12],[1,"\\n    "],[8,[39,4],null,[["@reviewable","@createdBy","@tagName"],[[30,1],[30,1,["target_created_by"]],""]],null],[1,"\\n\\n    "],[10,0],[14,0,"post-body"],[12],[1,"\\n      "],[1,[28,[35,5],[[28,[37,6],[[30,1,["payload","message_cooked"]],[30,1,["cooked"]]],null]],null]],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,1,["payload","transcript_topic_id"]],[[[1,"      "],[10,0],[14,0,"transcript"],[12],[1,"\\n        "],[8,[39,0],[[24,0,"btn btn-small"]],[["@route","@models"],["topic",[28,[37,1],["-",[30,1,["payload","transcript_topic_id"]]],null]]],[["default"],[[[[1,"\\n          "],[1,[28,[35,8],["review.transcript.view"],null]],[1,"\\n        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[18,2,null],[1,"\\n  "],[13],[1,"\\n"],[13]],["@reviewable","&default"],false,["link-to","array","chat-channel-title","reviewable-created-by","reviewable-post-header","html-safe","or","if","i18n","yield"]]',moduleName:"discourse/plugins/chat/discourse/components/reviewable-chat-message.hbs",isStrictMode:!1})
let p=(o=class extends n.default{constructor(){super(...arguments),u(this,"store",l,this),u(this,"chatChannelsManager",c,this)}get chatChannel(){return s.default.create(this.args.reviewable.chat_channel)}},l=d(o.prototype,"store",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=d(o.prototype,"chatChannelsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(o.prototype,"chatChannel",[a.cached],Object.getOwnPropertyDescriptor(o.prototype,"chatChannel"),o.prototype),o)
e.default=p,(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-composer-message-details",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/plugins/chat/discourse/lib/fabricators","@ember/object","@glimmer/tracking","@ember/service"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,i.createTemplateFactory)({id:"UdTTMEaX",block:'[[[8,[39,0],null,[["@title"],["<ChatComposerMessageDetails>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@message"],[[30,0,["message"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["Mode"]],[["default"],[[[[1,"\\n"],[41,[30,0,["message","editing"]],[[[1,"        "],[8,[39,6],null,[["@action","@translatedLabel"],[[30,0,["toggleMode"]],"Reply"]],null],[1,"\\n"]],[]],[[[1,"        "],[8,[39,6],null,[["@action","@translatedLabel"],[[30,0,["toggleMode"]],"Editing"]],null],[1,"\\n"]],[]]],[1,"    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat-composer-message-details","styleguide/controls","styleguide/controls/row","if","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-composer-message-details.hbs",isStrictMode:!1})
let g=(l=class extends n.default{constructor(){super(...arguments),p(this,"site",c,this),p(this,"session",u,this),p(this,"keyValueStore",d,this),p(this,"currentUser",h,this)}get message(){return r.default.message({user:this.currentUser})}toggleMode(){this.message.editing?(this.message.editing=!1,this.message.inReplyTo=r.default.message()):(this.message.editing=!0,this.message.inReplyTo=null)}},c=m(l.prototype,"site",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=m(l.prototype,"session",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(l.prototype,"keyValueStore",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=m(l.prototype,"currentUser",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m(l.prototype,"message",[s.cached],Object.getOwnPropertyDescriptor(l.prototype,"message"),l.prototype),m(l.prototype,"toggleMode",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"toggleMode"),l.prototype),l)
e.default=g,(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-composer",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/plugins/chat/discourse/lib/fabricators","@ember/object","@ember/service","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,i.createTemplateFactory)({id:"44rPT0VR",block:'[[[8,[39,0],null,[["@title"],["<ChatComposer>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@channel","@onSendMessage"],[[30,0,["channel"]],[30,0,["onSendMessage"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["Disabled"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleDisabled"]]],null]],[["@state"],[[30,0,["channel","isReadOnly"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Sending"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleSending"]]],null]],[["@state"],[[30,0,["chatChannelPane","sending"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat/composer/channel","styleguide/controls","styleguide/controls/row","d-toggle-switch","on"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-composer.hbs",isStrictMode:!1})
let b=(l=class extends n.default{constructor(){super(...arguments),d(this,"chatChannelComposer",c,this),d(this,"chatChannelPane",u,this),h(this,"channel",r.default.channel({id:-999}))}toggleDisabled(){this.channel.status===o.CHANNEL_STATUSES.open?this.channel.status=o.CHANNEL_STATUSES.readOnly:this.channel.status=o.CHANNEL_STATUSES.open}toggleSending(){this.chatChannelPane.sending=!this.chatChannelPane.sending}onSendMessage(){this.chatChannelComposer.reset()}},c=p(l.prototype,"chatChannelComposer",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(l.prototype,"chatChannelPane",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(l.prototype,"toggleDisabled",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"toggleDisabled"),l.prototype),p(l.prototype,"toggleSending",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"toggleSending"),l.prototype),p(l.prototype,"onSendMessage",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"onSendMessage"),l.prototype),l)
e.default=b,(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-header-icon",["exports","@ember/component","@ember/template-factory","@glimmer/component","@ember/object","discourse/plugins/chat/discourse/controllers/preferences-chat","@glimmer/tracking"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,i.createTemplateFactory)({id:"3vsUy2AB",block:'[[[8,[39,0],null,[["@title"],["<Chat::Header::Icon>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[10,"header"],[14,0,"d-header"],[14,5,"display: flex; align-items: center; justify-content: center;"],[12],[1,"\\n      "],[10,"ul"],[14,0,"d-header-icons"],[12],[1,"\\n        "],[10,"li"],[14,0,"header-dropdown-toggle chat-header-icon"],[12],[1,"\\n          "],[8,[39,2],null,[["@isActive","@currentUserInDnD","@unreadCount","@urgentCount","@indicatorPreference"],[[30,0,["isActive"]],[30,0,["currentUserInDnD"]],[30,0,["unreadCount"]],[30,0,["urgentCount"]],[30,0,["indicatorPreference"]]]],null],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["isActive"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleIsActive"]]],null]],[["@state"],[[30,0,["isActive"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["currentUserInDnD"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleCurrentUserInDnD"]]],null]],[["@state"],[[30,0,["currentUserInDnD"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,4],null,[["@name"],["Unread count"]],[["default"],[[[[1,"\\n    "],[11,"input"],[16,2,[30,0,["unreadCount"]]],[24,4,"number"],[4,[38,6],["input",[30,0,["updateUnreadCount"]]],null],[12],[13],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,4],null,[["@name"],["Urgent count"]],[["default"],[[[[1,"\\n    "],[11,"input"],[16,2,[30,0,["urgentCount"]]],[24,4,"number"],[4,[38,6],["input",[30,0,["updateUrgentCount"]]],null],[12],[13],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,4],null,[["@name"],["Indicator preference"]],[["default"],[[[[1,"\\n    "],[8,[39,7],null,[["@value","@content","@onChange","@valueProperty","@nameProperty"],[[30,0,["indicatorPreference"]],[30,0,["indicatorPreferences"]],[30,0,["updateIndicatorPreference"]],null,null]],null],[1,"\\n\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat/header/icon","styleguide/controls","styleguide/controls/row","d-toggle-switch","on","combo-box"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-header-icon.hbs",isStrictMode:!1})
let g=(o=class extends n.default{constructor(){super(...arguments),p(this,"isActive",l,this),p(this,"currentUserInDnD",c,this),p(this,"urgentCount",u,this),p(this,"unreadCount",d,this),p(this,"indicatorPreference",h,this)}get indicatorPreferences(){return[a.HEADER_INDICATOR_PREFERENCE_ALL_NEW,a.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS,a.HEADER_INDICATOR_PREFERENCE_NEVER]}toggleIsActive(){this.isActive=!this.isActive}toggleCurrentUserInDnD(){this.currentUserInDnD=!this.currentUserInDnD}updateUnreadCount(e){this.unreadCount=e.target.value}updateUrgentCount(e){this.urgentCount=e.target.value}updateIndicatorPreference(e){this.indicatorPreference=e}},l=m(o.prototype,"isActive",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=m(o.prototype,"currentUserInDnD",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=m(o.prototype,"urgentCount",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(o.prototype,"unreadCount",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=m(o.prototype,"indicatorPreference",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return a.HEADER_INDICATOR_PREFERENCE_ALL_NEW}}),m(o.prototype,"toggleIsActive",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"toggleIsActive"),o.prototype),m(o.prototype,"toggleCurrentUserInDnD",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"toggleCurrentUserInDnD"),o.prototype),m(o.prototype,"updateUnreadCount",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"updateUnreadCount"),o.prototype),m(o.prototype,"updateUrgentCount",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"updateUrgentCount"),o.prototype),m(o.prototype,"updateIndicatorPreference",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"updateIndicatorPreference"),o.prototype),o)
e.default=g,(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-message-mention-warning",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/plugins/chat/discourse/lib/fabricators","@ember/object","@ember/service"],(function(e,t,i,n,r,a,s){"use strict"
var o,l
function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const u=(0,i.createTemplateFactory)({id:"AgUlVZG+",block:'[[[8,[39,0],null,[["@title"],["<Chat::Message::MentionWarning>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@message"],[[30,0,["message"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,3],null,[["@name"],["Cannot see"]],[["default"],[[[[1,"\\n    "],[8,[39,4],[[4,[38,6],["click",[30,0,["toggleCannotSee"]]],null]],[["@state"],[[28,[37,5],[[30,0,["message","mentionWarning","cannotSee","length"]],0],null]]],null],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,3],null,[["@name"],["Group with mentions disabled"]],[["default"],[[[[1,"\\n    "],[8,[39,4],[[4,[38,6],["click",[30,0,["toggleGroupWithMentionsDisabled"]]],null]],[["@state"],[[28,[37,5],[[30,0,["message","mentionWarning","groupWithMentionsDisabled","length"]],0],null]]],null],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,3],null,[["@name"],["Group with too many members"]],[["default"],[[[[1,"\\n    "],[8,[39,4],[[4,[38,6],["click",[30,0,["toggleGroupsWithTooManyMembers"]]],null]],[["@state"],[[28,[37,5],[[30,0,["message","mentionWarning","groupsWithTooManyMembers","length"]],0],null]]],null],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,3],null,[["@name"],["Without membership"]],[["default"],[[[[1,"\\n    "],[8,[39,4],[[4,[38,6],["click",[30,0,["toggleWithoutMembership"]]],null]],[["@state"],[[28,[37,5],[[30,0,["message","mentionWarning","withoutMembership","length"]],0],null]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat/message/mention-warning","styleguide/controls/row","d-toggle-switch","gt","on"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-message-mention-warning.hbs",isStrictMode:!1})
let d=(o=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="currentUser",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),this.message=r.default.message({user:this.currentUser})}toggleCannotSee(){this.message.mentionWarning?.cannotSee?this.message.mentionWarning=null:this.message.mentionWarning=r.default.messageMentionWarning(this.message,{cannot_see:[r.default.user({username:"bob"})].map((e=>({username:e.username,id:e.id})))})}toggleGroupWithMentionsDisabled(){this.message.mentionWarning?.groupWithMentionsDisabled?this.message.mentionWarning=null:this.message.mentionWarning=r.default.messageMentionWarning(this.message,{group_mentions_disabled:[r.default.group()].mapBy("name")})}toggleGroupsWithTooManyMembers(){this.message.mentionWarning?.groupsWithTooManyMembers?this.message.mentionWarning=null:this.message.mentionWarning=r.default.messageMentionWarning(this.message,{groups_with_too_many_members:[r.default.group(),r.default.group({name:"Moderators"})].mapBy("name")})}toggleWithoutMembership(){this.message.mentionWarning?.withoutMembership?this.message.mentionWarning=null:this.message.mentionWarning=r.default.messageMentionWarning(this.message,{without_membership:[r.default.user()].map((e=>({username:e.username,id:e.id})))})}},l=c(o.prototype,"currentUser",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(o.prototype,"toggleCannotSee",[a.action],Object.getOwnPropertyDescriptor(o.prototype,"toggleCannotSee"),o.prototype),c(o.prototype,"toggleGroupWithMentionsDisabled",[a.action],Object.getOwnPropertyDescriptor(o.prototype,"toggleGroupWithMentionsDisabled"),o.prototype),c(o.prototype,"toggleGroupsWithTooManyMembers",[a.action],Object.getOwnPropertyDescriptor(o.prototype,"toggleGroupsWithTooManyMembers"),o.prototype),c(o.prototype,"toggleWithoutMembership",[a.action],Object.getOwnPropertyDescriptor(o.prototype,"toggleWithoutMembership"),o.prototype),o)
e.default=d,(0,t.setComponentTemplate)(u,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-message",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/plugins/chat/discourse/lib/fabricators","@ember/object","discourse/plugins/chat/discourse/lib/chat-messages-manager","discourse-common/lib/get-owner","@ember/service"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u
function d(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,i.createTemplateFactory)({id:"4ZwlpP03",block:'[[[8,[39,0],null,[["@title"],["<ChatMessage>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@message","@context"],[[30,0,["message"]],"channel"]],null],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["Last Visit"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleLastVisit"]]],null]],[["@state"],[[30,0,["message","newest"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Deleted"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleDeleted"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","deletedAt"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Bookmark"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleBookmarked"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","bookmark"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Thread"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleThread"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","thread"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Reactions"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleReaction"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","reactions"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Upload"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleUpload"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","uploads"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Message"]],[["default"],[[[[1,"\\n      "],[11,"textarea"],[4,[38,6],["input",[30,0,["updateMessage"]]],null],[12],[1,[30,0,["message","message"]]],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat-message","styleguide/controls","styleguide/controls/row","d-toggle-switch","on","not"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-message.hbs",isStrictMode:!1})
let m=(c=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="currentUser",n=this,(i=u)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),d(this,"manager",new s.default((0,o.getOwner)(this))),this.message=r.default.message({user:this.currentUser}),this.message.cook()}toggleDeleted(){this.message.deletedAt?this.message.deletedAt=null:this.message.deletedAt=moment()}toggleBookmarked(){this.message.bookmark?this.message.bookmark=null:this.message.bookmark=r.default.bookmark()}toggleHighlighted(){this.message.highlighted=!this.message.highlighted}toggleEdited(){this.message.edited=!this.message.edited}toggleLastVisit(){this.message.newest=!this.message.newest}toggleThread(){this.message.thread?(this.message.channel.threadingEnabled=!1,this.message.thread=null):(this.message.thread=r.default.thread({channel:this.message.channel}),this.message.thread.preview.replyCount=1,this.message.channel.threadingEnabled=!0)}async updateMessage(e){this.message.message=e.target.value,await this.message.cook()}toggleReaction(){this.message.reactions?.length?this.message.reactions=[]:this.message.reactions=[r.default.reaction({emoji:"heart"}),r.default.reaction({emoji:"rocket",reacted:!0})]}toggleUpload(){this.message.uploads?.length?this.message.uploads=[]:this.message.uploads=[r.default.upload(),r.default.upload()]}},u=h(c.prototype,"currentUser",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(c.prototype,"toggleDeleted",[a.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleDeleted"),c.prototype),h(c.prototype,"toggleBookmarked",[a.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleBookmarked"),c.prototype),h(c.prototype,"toggleHighlighted",[a.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleHighlighted"),c.prototype),h(c.prototype,"toggleEdited",[a.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleEdited"),c.prototype),h(c.prototype,"toggleLastVisit",[a.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleLastVisit"),c.prototype),h(c.prototype,"toggleThread",[a.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleThread"),c.prototype),h(c.prototype,"updateMessage",[a.action],Object.getOwnPropertyDescriptor(c.prototype,"updateMessage"),c.prototype),h(c.prototype,"toggleReaction",[a.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleReaction"),c.prototype),h(c.prototype,"toggleUpload",[a.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleUpload"),c.prototype),c)
e.default=m,(0,t.setComponentTemplate)(p,m)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-archive-channel",["exports","@ember/component","@ember/template-factory","discourse/plugins/chat/discourse/lib/fabricators","@ember/service","@ember/object","discourse/plugins/chat/discourse/components/chat/modal/archive-channel","@glimmer/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,i.createTemplateFactory)({id:"6txBnytZ",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ArchiveChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-archive-channel.hbs",isStrictMode:!1})
let p=(l=class extends o.default{constructor(){var e,t,i,r
super(...arguments),e=this,t="modal",r=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0}),u(this,"channel",n.default.channel())}openModal(){return this.modal.show(s.default,{model:{channel:this.channel}})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l)
e.default=p,(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-channel-summary",["exports","@ember/component","@ember/template-factory","discourse/plugins/chat/discourse/lib/fabricators","@glimmer/component","discourse/plugins/chat/discourse/components/chat/modal/channel-summary","@ember/service","@ember/object"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,i.createTemplateFactory)({id:"9Nkr9oRZ",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ChannelSummary>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-channel-summary.hbs",isStrictMode:!1})
let h=(l=class extends r.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(a.default,{model:{channelId:n.default.channel().id}})}},c=u(l.prototype,"modal",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(l.prototype,"openModal",[o.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l)
e.default=h,(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-create-channel",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/plugins/chat/discourse/components/chat/modal/create-channel","@ember/service","@ember/object"],(function(e,t,i,n,r,a,s){"use strict"
var o,l
function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const u=(0,i.createTemplateFactory)({id:"W0WNy+Vl",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::CreateChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-create-channel.hbs",isStrictMode:!1})
let d=(o=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(r.default)}},l=c(o.prototype,"modal",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(o.prototype,"openModal",[s.action],Object.getOwnPropertyDescriptor(o.prototype,"openModal"),o.prototype),o)
e.default=d,(0,t.setComponentTemplate)(u,d)}))
define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-delete-channel",["exports","@ember/component","@ember/template-factory","discourse/plugins/chat/discourse/lib/fabricators","@ember/service","@ember/object","discourse/plugins/chat/discourse/components/chat/modal/delete-channel","@glimmer/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,i.createTemplateFactory)({id:"RePA6/AH",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::DeleteChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-delete-channel.hbs",isStrictMode:!1})
let p=(l=class extends o.default{constructor(){var e,t,i,r
super(...arguments),e=this,t="modal",r=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0}),u(this,"channel",n.default.channel())}openModal(){return this.modal.show(s.default,{model:{channel:this.channel}})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l)
e.default=p,(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-description",["exports","@ember/component","@ember/template-factory","discourse/plugins/chat/discourse/lib/fabricators","@ember/service","@ember/object","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description","@glimmer/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,i.createTemplateFactory)({id:"3ae/A2qR",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::EditChannelDescription>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-description.hbs",isStrictMode:!1})
let p=(l=class extends o.default{constructor(){var e,t,i,r
super(...arguments),e=this,t="modal",r=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0}),u(this,"channel",n.default.channel())}openModal(){return this.modal.show(s.default,{model:this.channel})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l)
e.default=p,(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-name",["exports","@ember/component","@ember/template-factory","discourse/plugins/chat/discourse/lib/fabricators","@ember/service","@ember/object","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name","@glimmer/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,i.createTemplateFactory)({id:"ilAVl2Kg",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::EditChannelName>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-name.hbs",isStrictMode:!1})
let p=(l=class extends o.default{constructor(){var e,t,i,r
super(...arguments),e=this,t="modal",r=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0}),u(this,"channel",n.default.channel())}openModal(){return this.modal.show(s.default,{model:this.channel})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[a.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l)
e.default=p,(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-move-message-to-channel",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/plugins/chat/discourse/lib/fabricators","@ember/service","@ember/object","discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,i.createTemplateFactory)({id:"ATPl85dR",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::MoveMessageToChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-move-message-to-channel.hbs",isStrictMode:!1})
let p=(l=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),u(this,"channel",r.default.channel()),u(this,"selectedMessageIds",[r.default.message({channel:this.channel})].mapBy("id"))}openModal(){return this.modal.show(o.default,{model:{sourceChannel:this.channel,selectedMessageIds:[r.default.message({channel:this.channel})].mapBy("id")}})}},c=d(l.prototype,"modal",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[s.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l)
e.default=p,(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-new-message",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/plugins/chat/discourse/components/chat/modal/new-message","@ember/service","@ember/object"],(function(e,t,i,n,r,a,s){"use strict"
var o,l
function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const u=(0,i.createTemplateFactory)({id:"tf8RWlBH",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::NewMessage>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-new-message.hbs",isStrictMode:!1})
let d=(o=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(r.default)}},l=c(o.prototype,"modal",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(o.prototype,"openModal",[s.action],Object.getOwnPropertyDescriptor(o.prototype,"openModal"),o.prototype),o)
e.default=d,(0,t.setComponentTemplate)(u,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-thread-settings",["exports","@ember/component","@ember/template-factory","discourse/plugins/chat/discourse/lib/fabricators","@glimmer/component","discourse/plugins/chat/discourse/components/modal/chat/thread-settings","@ember/service","@ember/object"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,i.createTemplateFactory)({id:"fzsrgZZ3",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ThreadSettings>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-thread-settings.hbs",isStrictMode:!1})
let h=(l=class extends r.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(a.default,{model:n.default.thread()})}},c=u(l.prototype,"modal",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(l.prototype,"openModal",[o.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l)
e.default=h,(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-toggle-channel-status",["exports","@ember/component","@ember/template-factory","discourse/plugins/chat/discourse/lib/fabricators","@glimmer/component","discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status","@ember/service","@ember/object"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,i.createTemplateFactory)({id:"h5sT+PPJ",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ToggleChannelStatus>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-toggle-channel-status.hbs",isStrictMode:!1})
let h=(l=class extends r.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(a.default,{model:n.default.channel()})}},c=u(l.prototype,"modal",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(l.prototype,"openModal",[o.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l)
e.default=h,(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-thread-list-item",["exports","@ember/component","@ember/template-factory","@glimmer/component","discourse/plugins/chat/discourse/lib/fabricators","@ember/service"],(function(e,t,i,n,r,a){"use strict"
var s,o
function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,i.createTemplateFactory)({id:"lR91t83a",block:'[[[8,[39,0],null,[["@title"],["<Chat::ThreadList::Item>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@thread"],[[30,0,["thread"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat/thread-list/item"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-thread-list-item.hbs",isStrictMode:!1})
let u=(s=class extends n.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="currentUser",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),l(this,"thread",r.default.thread())}},d=s.prototype,h="currentUser",p=[a.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(m).forEach((function(e){g[e]=m[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(d,h,e)||e}),g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(d,h,g),g=null),o=g,s)
var d,h,p,m,b,g
e.default=u,(0,t.setComponentTemplate)(c,u)})),define("discourse/plugins/chat/discourse/components/styleguide/organisms/chat",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"dip3PPae",block:'[[[8,[39,0],null,null,null],[1,"\\n"],[8,[39,1],null,null,null],[1,"\\n"],[8,[39,2],null,null,null],[1,"\\n"],[8,[39,3],null,null,null],[1,"\\n"],[8,[39,4],null,null,null],[1,"\\n"],[8,[39,5],null,null,null],[1,"\\n\\n"],[10,"h2"],[12],[1,"Modals"],[13],[1,"\\n\\n"],[8,[39,6],null,null,null],[1,"\\n"],[8,[39,7],null,null,null],[1,"\\n"],[8,[39,8],null,null,null],[1,"\\n"],[8,[39,9],null,null,null],[1,"\\n"],[8,[39,10],null,null,null],[1,"\\n"],[8,[39,11],null,null,null],[1,"\\n"],[8,[39,12],null,null,null],[1,"\\n"],[8,[39,13],null,null,null],[1,"\\n"],[8,[39,14],null,null,null],[1,"\\n"],[8,[39,15],null,null,null]],[],false,["styleguide/chat-message","styleguide/chat-composer","styleguide/chat-thread-list-item","styleguide/chat-composer-message-details","styleguide/chat-header-icon","styleguide/chat-message-mention-warning","styleguide/chat-modal-archive-channel","styleguide/chat-modal-move-message-to-channel","styleguide/chat-modal-delete-channel","styleguide/chat-modal-edit-channel-description","styleguide/chat-modal-edit-channel-name","styleguide/chat-modal-thread-settings","styleguide/chat-modal-create-channel","styleguide/chat-modal-toggle-channel-status","styleguide/chat-modal-new-message","styleguide/chat-modal-channel-summary"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/organisms/chat.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,(0,n.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/toggle-channel-membership-button",["exports","@ember/component","@ember/template-factory","@glimmer/component","I18n","@ember/service","discourse/lib/ajax-error","@ember/object","@glimmer/tracking"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,i.createTemplateFactory)({id:"sMkRPVjk",block:'[[[41,[30,1,["currentUserMembership","following"]],[[[1,"  "],[8,[39,1],null,[["@action","@translatedLabel","@translatedTitle","@class","@icon","@disabled"],[[28,[37,2],[[30,0],"onLeaveChannel"],null],[30,0,["label"]],[30,0,["options","leaveTitle"]],[28,[37,3],["toggle-channel-membership-button -leave btn-flat",[30,0,["options","leaveClass"]]],null],[30,0,["options","leaveIcon"]],[30,0,["isLoading"]]]],null],[1,"\\n"]],[]],[[[1,"  "],[8,[39,1],null,[["@action","@translatedLabel","@translatedTitle","@class","@icon","@disabled"],[[28,[37,2],[[30,0],"onJoinChannel"],null],[30,0,["label"]],[30,0,["options","joinTitle"]],[28,[37,3],["toggle-channel-membership-button -join",[30,0,["options","joinClass"]]],null],[30,0,["options","joinIcon"]],[30,0,["isLoading"]]]],null],[1,"\\n"]],[]]]],["@channel"],false,["if","d-button","action","concat-class"]]',moduleName:"discourse/plugins/chat/discourse/components/toggle-channel-membership-button.hbs",isStrictMode:!1})
let g=(c=class extends n.default{constructor(){super(...arguments),h(this,"chat",u,this),h(this,"isLoading",d,this),p(this,"onToggle",null),p(this,"options",{}),this.options={labelType:"normal",joinTitle:r.default.t("chat.channel_settings.join_channel"),joinIcon:"",joinClass:"",leaveTitle:r.default.t("chat.channel_settings.leave_channel"),leaveIcon:"",leaveClass:"",...this.args.options}}get label(){return"none"===this.options.labelType?"":"short"===this.options.labelType?this.args.channel.currentUserMembership.following?r.default.t("chat.channel_settings.leave"):r.default.t("chat.channel_settings.join"):this.args.channel.currentUserMembership.following?r.default.t("chat.channel_settings.leave_channel"):r.default.t("chat.channel_settings.join_channel")}onJoinChannel(){return this.isLoading=!0,this.chat.followChannel(this.args.channel).then((()=>{this.onToggle?.()})).catch(s.popupAjaxError).finally((()=>{this.isDestroying||this.isDestroyed||(this.isLoading=!1)}))}onLeaveChannel(){return this.isLoading=!0,this.chat.unfollowChannel(this.args.channel).then((()=>{this.onToggle?.()})).catch(s.popupAjaxError).finally((()=>{this.isDestroying||this.isDestroyed||(this.isLoading=!1)}))}},u=m(c.prototype,"chat",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(c.prototype,"isLoading",[l.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m(c.prototype,"onJoinChannel",[o.action],Object.getOwnPropertyDescriptor(c.prototype,"onJoinChannel"),c.prototype),m(c.prototype,"onLeaveChannel",[o.action],Object.getOwnPropertyDescriptor(c.prototype,"onLeaveChannel"),c.prototype),c)
e.default=g,(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/user-menu/chat-notifications-list-empty-state",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.createTemplateFactory)({id:"O6dDc9NT",block:'[[[10,0],[14,0,"empty-state"],[12],[1,"\\n  "],[10,1],[14,0,"empty-state-title"],[12],[1,"\\n    "],[1,[28,[35,0],["user_menu.no_chat_notifications_title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"empty-state-body"],[12],[1,"\\n    "],[10,2],[12],[1,"\\n      "],[1,[28,[35,1],[[28,[37,0],["user_menu.no_chat_notifications_body"],[["preferencesUrl"],[[28,[37,2],["/my/preferences/notifications"],null]]]]],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13]],[],false,["i18n","html-safe","get-url"]]',moduleName:"discourse/plugins/chat/discourse/components/user-menu/chat-notifications-list-empty-state.hbs",isStrictMode:!1})
var a=(0,t.setComponentTemplate)(r,(0,n.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/user-menu/chat-notifications-list",["exports","discourse/components/user-menu/notifications-list"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{get dismissTypes(){return this.filterByTypes}get emptyStateComponent(){return"user-menu/chat-notifications-list-empty-state"}}e.default=i})),define("discourse/plugins/chat/discourse/controllers/admin-plugins-chat",["exports","@ember/controller","@ember/object","I18n","@ember/object/computed","discourse/lib/ajax","discourse/lib/ajax-error","@ember/service"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let v=(l=(0,r.and)("newWebhookName","newWebhookChannelId"),c=(0,i.computed)("model.incoming_chat_webhooks.@each.updated_at"),u=(0,i.computed)("selectedWebhookId"),d=(0,i.computed)("selectedWebhook.name","selectedWebhook.chat_channel.id"),h=class extends t.default{constructor(){super(...arguments),b(this,"dialog",p,this),g(this,"queryParams",{selectedWebhookId:"id"}),g(this,"loading",!1),g(this,"creatingNew",!1),g(this,"newWebhookName",""),g(this,"newWebhookChannelId",null),g(this,"emojiPickerIsActive",!1),b(this,"nameAndChannelValid",m,this)}get sortedWebhooks(){return this.model.incoming_chat_webhooks?.sortBy("updated_at").reverse()||[]}get selectedWebhook(){if(!this.selectedWebhookId)return
const e=parseInt(this.selectedWebhookId,10)
return this.model.incoming_chat_webhooks.findBy("id",e)}get saveEditDisabled(){return!this.selectedWebhook.name||!this.selectedWebhook.chat_channel.id}createNewWebhook(){if(this.loading)return
this.set("loading",!0)
const e={name:this.newWebhookName,chat_channel_id:this.newWebhookChannelId}
return(0,a.ajax)("/admin/plugins/chat/hooks",{data:e,type:"POST"}).then((e=>{const t=i.default.create(e)
this.set("model.incoming_chat_webhooks",[t].concat(this.model.incoming_chat_webhooks)),this.resetNewWebhook(),this.setProperties({loading:!1,selectedWebhookId:t.id})})).catch(s.popupAjaxError)}resetNewWebhook(){this.setProperties({creatingNew:!1,newWebhookName:"",newWebhookChannelId:null})}destroyWebhook(e){this.dialog.deleteConfirm({message:n.default.t("chat.incoming_webhooks.confirm_destroy"),didConfirm:()=>(this.set("loading",!0),(0,a.ajax)(`/admin/plugins/chat/hooks/${e.id}`,{type:"DELETE"}).then((()=>{this.model.incoming_chat_webhooks.removeObject(e),this.set("loading",!1)})).catch(s.popupAjaxError))})}emojiSelected(e){return this.selectedWebhook.set("emoji",`:${e}:`),this.set("emojiPickerIsActive",!1)}saveEdit(){this.set("loading",!0)
const e={name:this.selectedWebhook.name,chat_channel_id:this.selectedWebhook.chat_channel.id,description:this.selectedWebhook.description,emoji:this.selectedWebhook.emoji,username:this.selectedWebhook.username}
return(0,a.ajax)(`/admin/plugins/chat/hooks/${this.selectedWebhook.id}`,{data:e,type:"PUT"}).then((()=>{this.selectedWebhook.set("updated_at",new Date),this.setProperties({loading:!1,selectedWebhookId:null})})).catch(s.popupAjaxError)}changeChatChannel(e){this.selectedWebhook.set("chat_channel",this.model.chat_channels.findBy("id",e))}},p=f(h.prototype,"dialog",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=f(h.prototype,"nameAndChannelValid",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f(h.prototype,"sortedWebhooks",[c],Object.getOwnPropertyDescriptor(h.prototype,"sortedWebhooks"),h.prototype),f(h.prototype,"selectedWebhook",[u],Object.getOwnPropertyDescriptor(h.prototype,"selectedWebhook"),h.prototype),f(h.prototype,"saveEditDisabled",[d],Object.getOwnPropertyDescriptor(h.prototype,"saveEditDisabled"),h.prototype),f(h.prototype,"createNewWebhook",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"createNewWebhook"),h.prototype),f(h.prototype,"resetNewWebhook",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"resetNewWebhook"),h.prototype),f(h.prototype,"destroyWebhook",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"destroyWebhook"),h.prototype),f(h.prototype,"emojiSelected",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"emojiSelected"),h.prototype),f(h.prototype,"saveEdit",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"saveEdit"),h.prototype),f(h.prototype,"changeChatChannel",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"changeChatChannel"),h.prototype),h)
e.default=v})),define("discourse/plugins/chat/discourse/controllers/chat-channel-index",["exports","@ember/controller"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{}e.default=i})),define("discourse/plugins/chat/discourse/controllers/chat-channel-info-about",["exports","@ember/controller","@ember/object","discourse/mixins/modal-functionality","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name"],(function(e,t,i,n,r,a,s){"use strict"
var o,l
function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let u=(o=class extends(t.default.extend(n.default)){constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}onEditChatChannelName(){return this.modal.show(s.default,{model:this.model})}onEditChatChannelDescription(){return this.modal.show(a.default,{model:this.model})}},l=c(o.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(o.prototype,"onEditChatChannelName",[i.action],Object.getOwnPropertyDescriptor(o.prototype,"onEditChatChannelName"),o.prototype),c(o.prototype,"onEditChatChannelDescription",[i.action],Object.getOwnPropertyDescriptor(o.prototype,"onEditChatChannelDescription"),o.prototype),o)
e.default=u})),define("discourse/plugins/chat/discourse/controllers/chat-channel-info-members",["exports","@ember/controller"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{}e.default=i})),define("discourse/plugins/chat/discourse/controllers/chat-channel-info-settings",["exports","@ember/controller"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{}e.default=i})),define("discourse/plugins/chat/discourse/controllers/chat-channel-info",["exports","@ember/controller","@ember/service","@ember/object/computed","@ember/object"],(function(e,t,i,n,r){"use strict"
var a,s,o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let m=(a=(0,n.reads)("router.currentRoute.localName"),s=(0,r.computed)("model.{membershipsCount,status,currentUserMembership.following}"),o=class extends t.default{constructor(){super(...arguments),h(this,"router",l,this),h(this,"chat",c,this),h(this,"chatChannelInfoRouteOriginManager",u,this),h(this,"tab",d,this)}get tabs(){const e=[]
return this.model.isDirectMessageChannel||e.push("about"),this.model.isOpen&&this.model.membershipsCount>=1&&e.push("members"),(this.currentUser?.staff||this.model.currentUserMembership?.following)&&e.push("settings"),e}},l=p(o.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=p(o.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(o.prototype,"chatChannelInfoRouteOriginManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=p(o.prototype,"tab",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(o.prototype,"tabs",[s],Object.getOwnPropertyDescriptor(o.prototype,"tabs"),o.prototype),o)
e.default=m})),define("discourse/plugins/chat/discourse/controllers/chat-channel-thread",["exports","@ember/controller","@ember/service","@glimmer/tracking"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let c=(r=class extends t.default{constructor(){super(...arguments),o(this,"chat",a,this),o(this,"targetMessageId",s,this)}},a=l(r.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=l(r.prototype,"targetMessageId",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),r)
e.default=c})),define("discourse/plugins/chat/discourse/controllers/chat-channel",["exports","@ember/controller","@ember/service","@glimmer/tracking"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let u=(r=class extends t.default{constructor(){super(...arguments),o(this,"chat",a,this),o(this,"targetMessageId",s,this),l(this,"queryParams",["messageId"])}},a=c(r.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"targetMessageId",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),r)
e.default=u})),define("discourse/plugins/chat/discourse/controllers/chat-draft-channel",["exports","@ember/controller","@ember/service"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let a=(n=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},s=n.prototype,o="chat",l=[i.inject],c={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),r=d,n)
var s,o,l,c,u,d
e.default=a})),define("discourse/plugins/chat/discourse/controllers/chat-index",["exports","@ember/controller","@ember/service"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let a=(n=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},s=n.prototype,o="chat",l=[i.inject],c={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),r=d,n)
var s,o,l,c,u,d
e.default=a})),define("discourse/plugins/chat/discourse/controllers/chat",["exports","@ember/controller","@ember/service"],(function(e,t,i){"use strict"
var n,r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let c=(n=class extends t.default{constructor(){super(...arguments),o(this,"chat",r,this),o(this,"chatStateManager",a,this),o(this,"router",s,this)}get shouldUseChatSidebar(){return!this.site.mobileView&&!this.shouldUseCoreSidebar}get shouldUseCoreSidebar(){return"sidebar"===this.siteSettings.navigation_menu}get mainOutletModifierClasses(){let e=[]
return this.chatStateManager.isSidePanelExpanded&&e.push("has-side-panel-expanded"),this.router.currentRouteName.startsWith("chat.channel.info")||this.router.currentRouteName.startsWith("chat.browse")||e.push("chat-view"),e.join(" ")}},r=l(n.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=l(n.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=l(n.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)
e.default=c})),define("discourse/plugins/chat/discourse/controllers/preferences-chat",["exports","@ember/controller","discourse-common/config/environment","discourse-common/utils/decorators","I18n","@ember/object","discourse/lib/ajax-error","discourse/plugins/chat/discourse/services/chat-audio-manager","@ember/service"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u
function d(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.HEADER_INDICATOR_PREFERENCE_NEVER=e.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS=e.HEADER_INDICATOR_PREFERENCE_ALL_NEW=void 0
const p=["chat_enabled","only_chat_push_notifications","ignore_channel_wide_mention","chat_sound","chat_email_frequency","chat_header_indicator_preference"],m="never"
e.HEADER_INDICATOR_PREFERENCE_NEVER=m
const b="dm_and_mentions"
e.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS=b
const g="all_new"
e.HEADER_INDICATOR_PREFERENCE_ALL_NEW=g
const f=[{name:r.default.t("chat.email_frequency.never"),value:"never"},{name:r.default.t("chat.email_frequency.when_away"),value:"when_away"}],v=[{name:r.default.t("chat.header_indicator_preference.all_new"),value:g},{name:r.default.t("chat.header_indicator_preference.dm_and_mentions"),value:b},{name:r.default.t("chat.header_indicator_preference.never"),value:m}]
let y=(c=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatAudioManager",n=this,(i=u)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),d(this,"subpageTitle",r.default.t("chat.admin.title")),d(this,"emailFrequencyOptions",f),d(this,"headerIndicatorOptions",v)}chatSounds(){return Object.keys(o.CHAT_SOUNDS).map((e=>({name:r.default.t(`chat.sounds.${e}`),value:e})))}onChangeChatSound(e){e&&this.chatAudioManager.playImmediately(e),this.model.set("user_option.chat_sound",e)}save(){return this.set("saved",!1),this.model.save(p).then((()=>{this.set("saved",!0),(0,i.isTesting)()||location.reload()})).catch(s.popupAjaxError)}},u=h(c.prototype,"chatAudioManager",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(c.prototype,"chatSounds",[n.default],Object.getOwnPropertyDescriptor(c.prototype,"chatSounds"),c.prototype),h(c.prototype,"onChangeChatSound",[a.action],Object.getOwnPropertyDescriptor(c.prototype,"onChangeChatSound"),c.prototype),h(c.prototype,"save",[a.action],Object.getOwnPropertyDescriptor(c.prototype,"save"),c.prototype),c)
e.default=y})),define("discourse/plugins/chat/discourse/helpers/chat-guardian",["exports","@ember/component/helper","@ember/service","@ember/string"],(function(e,t,i,n){"use strict"
var r,a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let s=(r=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatGuardian",n=this,(i=a)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}compute(e){const[t,...i]=e
if(t)return this.chatGuardian[(0,n.camelize)(t)]?.(...i)}},o=r.prototype,l="chatGuardian",c=[i.inject],u={configurable:!0,enumerable:!0,writable:!0,initializer:null},h={},Object.keys(u).forEach((function(e){h[e]=u[e]})),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=c.slice().reverse().reduce((function(e,t){return t(o,l,e)||e}),h),d&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(d):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(o,l,h),h=null),a=h,r)
var o,l,c,u,d,h
e.default=s})),define("discourse/plugins/chat/discourse/helpers/format-chat-date",["discourse-common/lib/helpers","@ember/template","discourse-common/lib/get-url","I18n","discourse/models/user"],(function(e,t,i,n,r){"use strict";(0,e.registerUnbound)("format-chat-date",(function(e,a){const s=r.default.current(),o=s?s.user_option.timezone:moment.tz.guess(),l=moment(new Date(e.createdAt),o),c=l.format(n.default.t("dates.long_with_year")),u="tiny"===a?l.format(n.default.t("chat.dates.time_tiny")):l.format(n.default.t("dates.time"))
if(e.staged)return(0,t.htmlSafe)(`<span title='${c}' tabindex="-1" class='chat-time'>${u}</span>`)
{const n=(0,i.default)(`/chat/c/-/${e.channel.id}/${e.id}`)
return(0,t.htmlSafe)(`<a title='${c}' tabindex="-1" class='chat-time' href='${n}'>${u}</a>`)}}))})),define("discourse/plugins/chat/discourse/helpers/noop",["exports","@ember/component/helper"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.helper)((function(){return()=>{}}))
e.default=i})),define("discourse/plugins/chat/discourse/helpers/tonable-emoji-title",["discourse-common/lib/helpers"],(function(e){"use strict";(0,e.registerUnbound)("tonable-emoji-title",(function(e,t){return e.tonable&&1!==t?`:${e.name}:t${t}:`:`:${e.name}:`}))})),define("discourse/plugins/chat/discourse/helpers/tonable-emoji-url",["discourse-common/lib/helpers"],(function(e){"use strict";(0,e.registerUnbound)("tonable-emoji-url",(function(e,t){return e.tonable&&1!==t?e.url.split(".png")[0]+`/${t}.png`:e.url}))})),define("discourse/plugins/chat/discourse/initializers/chat-audio",["exports","discourse/lib/plugin-api"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=[29,30]
var n={name:"chat-audio",initialize(e){if(!e.lookup("service:chat").userCanChat)return
const n=e.lookup("service:chat-audio-manager")
n.setup(),(0,t.withPluginApi)("0.12.1",(e=>{e.registerDesktopNotificationHandler(((e,t,r)=>{r.isInDoNotDisturb()||r.chat_sound&&i.includes(e.notification_type)&&n.play(r.chat_sound)}))}))}}
e.default=n}))
define("discourse/plugins/chat/discourse/initializers/chat-decorators",["exports","discourse/instance-initializers/onebox-decorators","discourse/lib/hashtag-autocomplete","discourse/lib/plugin-api","discourse/lib/highlight-syntax","I18n","discourse/lib/url","discourse-common/lib/get-url","discourse/lib/load-script","discourse/helpers/loading-spinner"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var u={name:"chat-decorators",initializeWithPluginApi(e,n){const a=n.lookup("service:site-settings"),s=n.lookup("service:lightbox"),o=n.lookup("service:site")
e.decorateChatMessage((e=>(0,t.decorateGithubOneboxBody)(e)),{id:"onebox-github-body"}),e.decorateChatMessage((e=>{e.querySelectorAll(".onebox.githubblob li.selected").forEach((e=>{const t=this._getScrollParent(e,"onebox")
if(!t)return
const i=t.offsetHeight-t.clientHeight
t.scroll({top:e.offsetTop+i-t.offsetHeight/2+e.offsetHeight/2})}))}),{id:"onebox-github-scrolling"}),e.decorateChatMessage((e=>(0,r.default)(e,a,n.lookup("service:session"))),{id:"highlightSyntax"}),e.decorateChatMessage(this.renderChatTranscriptDates,{id:"transcriptDates"}),e.decorateChatMessage(this.forceLinksToOpenNewTab,{id:"linksNewTab"}),a.enable_experimental_lightbox?e.decorateChatMessage((e=>{s.setupLightboxes({container:e,selector:"img:not(.emoji, .avatar, .site-icon)"})}),{id:"experimental-chat-lightbox"}):e.decorateChatMessage((e=>this.lightbox(e.querySelectorAll("img:not(.emoji, .avatar)"))),{id:"lightbox"}),e.decorateChatMessage((e=>(0,i.decorateHashtags)(e,o)),{id:"hashtagIcons"})},_getScrollParent(e,t){return null===e||e.classList.contains(t)?null:e.scrollHeight>e.clientHeight?e:this._getScrollParent(e.parentNode,t)},renderChatTranscriptDates(e){e.querySelectorAll(".chat-transcript").forEach((e=>{const t=e.dataset.datetime,i=e.querySelector(".chat-transcript-datetime a")
i&&""===i.innerText&&(this.currentUserTimezone?i.innerText=moment.tz(t,this.currentUserTimezone).format(a.default.t("dates.long_no_year")):i.innerText=moment(t).format(a.default.t("dates.long_no_year")))}))},forceLinksToOpenNewTab(e){const t=e.querySelectorAll(".chat-message-text a:not([target='_blank'])")
for(let i=0;i<t.length;i++){const e=t[i]
s.default.isInternal(e.href)&&(0,o.samePrefix)(e.href)||e.setAttribute("target","_blank")}},lightbox(e){(0,l.default)("/javascripts/jquery.magnific-popup.min.js").then((function(){$(e).magnificPopup({type:"image",closeOnContentClick:!1,mainClass:"mfp-zoom-in",tClose:a.default.t("lightbox.close"),tLoading:c.spinnerHTML,image:{verticalFit:!0},callbacks:{elementParse:e=>{e.src=e.el[0].src}}})}))},initialize(e){e.lookup("service:chat").userCanChat&&(0,n.withPluginApi)("0.8.42",(t=>this.initializeWithPluginApi(t,e)))}}
e.default=u})),define("discourse/plugins/chat/discourse/initializers/chat-keyboard-shortcuts",["exports","discourse/lib/plugin-api","discourse/lib/keyboard-shortcuts","discourse/plugins/chat/discourse/components/chat/modal/new-message"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var r={name:"chat-keyboard-shortcuts",initialize(e){const r=e.lookup("service:chat")
if(!r.userCanChat)return
const a=e.lookup("service:router"),s=e.lookup("service:app-events"),o=e.lookup("service:modal"),l=e.lookup("service:chat-state-manager"),c=e.lookup("service:chat-thread-pane"),u=e.lookup("service:chat-thread-list-pane"),d=e.lookup("service:chat-channels-manager"),h=e=>{e.preventDefault(),e.stopPropagation(),o.show(n.default)},p=e=>{e.preventDefault(),e.stopPropagation(),r.switchChannelUpOrDown("up")},m=e=>{e.preventDefault(),e.stopPropagation(),r.switchChannelUpOrDown("down")},b=e=>e.classList.contains("chat-composer__input"),g=(e,t)=>{b(e.target)&&(e.preventDefault(),e.stopPropagation(),s.trigger("chat:modify-selection",e,{type:t,context:e.target.dataset.chatComposerContext}))};(0,t.withPluginApi)("0.12.1",(e=>{e.addKeyboardShortcut(`${i.PLATFORM_KEY_MODIFIER}+k`,h,{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.open_quick_channel_selector",definition:{keys1:["meta","k"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut("alt+up",p,{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.switch_channel_arrows",definition:{keys1:["alt","&uarr;"],keys2:["alt","&darr;"],keysDelimiter:"plus",shortcutsDelimiter:"slash"}}}),e.addKeyboardShortcut("alt+down",m,{global:!0}),e.addKeyboardShortcut(`${i.PLATFORM_KEY_MODIFIER}+b`,(e=>g(e,"bold")),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.composer_bold",definition:{keys1:["meta","b"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut(`${i.PLATFORM_KEY_MODIFIER}+i`,(e=>g(e,"italic")),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.composer_italic",definition:{keys1:["meta","i"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut(`${i.PLATFORM_KEY_MODIFIER}+e`,(e=>g(e,"code")),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.composer_code",definition:{keys1:["meta","e"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut(`${i.PLATFORM_KEY_MODIFIER}+l`,(e=>(e=>{b(e.target)&&(e.preventDefault(),e.stopPropagation(),s.trigger("chat:open-insert-link-modal",e,{context:e.target.dataset.chatComposerContext}))})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.open_insert_link_modal",definition:{keys1:["meta","l"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut("-",(e=>(e=>{(e=>{const t=e?.tagName.toLowerCase()
return!["input","textarea","select","button"].includes(t)})(e.target)&&(e.preventDefault(),e.stopPropagation(),l.prefersDrawer(),a.transitionTo(l.lastKnownChatURL||"chat"))})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.drawer_open",definition:{keys1:["-"]}}}),e.addKeyboardShortcut("esc",(e=>(e=>{if(!e.srcElement?.classList?.value?.includes("mfp-wrap"))return l.isDrawerActive?(e.preventDefault(),e.stopPropagation(),void s.trigger("chat:toggle-close",e)):c.isOpened?(e.preventDefault(),e.stopPropagation(),void c.close()):u.isOpened?(e.preventDefault(),e.stopPropagation(),void u.close()):void 0})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.drawer_close",definition:{keys1:["esc"]}}}),e.addKeyboardShortcut("shift+esc",(e=>(e=>{e.preventDefault(),e.stopPropagation(),l.isActive&&d.markAllChannelsRead()})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.mark_all_channels_read",definition:{keys1:["shift","esc"],keysDelimiter:"plus"}}})}))}}
e.default=r})),define("discourse/plugins/chat/discourse/initializers/chat-plugin-decorators",["exports","discourse/lib/plugin-api","discourse/lib/local-dates"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var n={name:"chat-plugin-decorators",initializeWithPluginApi(e,t){if(e.decorateChatMessage((e=>{(0,i.applyLocalDates)(e.querySelectorAll(".discourse-local-date"),t)}),{id:"local-dates"}),t.spoiler_enabled){const t=requirejs("discourse/plugins/discourse-spoiler-alert/lib/apply-spoiler").default
e.decorateChatMessage((e=>{e.querySelectorAll(".spoiler").forEach((e=>{e.classList.remove("spoiler"),e.classList.add("spoiled"),t(e)}))}),{id:"spoiler"})}},initialize(e){if(e.lookup("service:chat").userCanChat){const i=e.lookup("service:site-settings");(0,t.withPluginApi)("0.8.42",(e=>{this.initializeWithPluginApi(e,i)}))}}}
e.default=n})),define("discourse/plugins/chat/discourse/initializers/chat-setup",["exports","discourse/lib/plugin-api","I18n","discourse-common/utils/decorators","discourse-common/lib/get-owner","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/lib/chat-composer-buttons","discourse/plugins/chat/discourse/lib/hashtag-types/channel","discourse-common/lib/icon-library","discourse/plugins/chat/discourse/components/styleguide/organisms/chat"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u
function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}let h
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;(0,l.replaceIcon)("d-chat","comment")
var p=(d(u={name:"chat-setup",before:"hashtag-css-generator",initialize(e){this.router=e.lookup("service:router"),this.chatService=e.lookup("service:chat"),this.chatHistory=e.lookup("service:chat-history"),this.site=e.lookup("service:site"),this.siteSettings=e.lookup("service:site-settings"),this.currentUser=e.lookup("service:current-user"),this.appEvents=e.lookup("service:app-events"),this.appEvents.on("discourse:focus-changed",this,"_handleFocusChanged"),this.chatService.userCanChat&&(0,t.withPluginApi)("0.12.1",(t=>{t.onPageChange((e=>{const t=this.router.recognize(e)
t.name.startsWith("chat.")&&this.chatHistory.visit(t)})),t.registerHashtagType("channel",new o.default(e)),t.registerChatComposerButton({id:"chat-upload-btn",icon:"far-image",label:"chat.upload",position:"dropdown",action:"uploadClicked",dependentKeys:["canAttachUploads"],displayed(){return this.canAttachUploads}}),this.siteSettings.discourse_local_dates_enabled&&t.registerChatComposerButton({label:"discourse_local_dates.title",id:"local-dates",class:"chat-local-dates-btn",icon:"calendar-alt",position:"dropdown",action(){this.insertDiscourseLocalDate()}}),t.registerChatComposerButton({label:"chat.emoji",id:"emoji",class:"chat-emoji-btn",icon:"far-smile",position:this.site.desktopView?"inline":"dropdown",context:"channel",action(){e.lookup("service:chat-emoji-picker-manager").open({context:"channel"})}}),t.registerChatComposerButton({label:"chat.emoji",id:"channel-emoji",class:"chat-emoji-btn",icon:"discourse-emojis",position:"dropdown",context:"thread",action(){e.lookup("service:chat-emoji-picker-manager").open({context:"thread"})}})
const n=this.siteSettings.custom_summarization_allowed_groups.split("|").map((e=>parseInt(e,10)))
if(this.siteSettings.summarization_strategy&&this.currentUser&&this.currentUser.groups.some((e=>n.includes(e.id)))&&t.registerChatComposerButton({translatedLabel:"chat.summarization.title",id:"channel-summary",icon:"magic",position:"dropdown",action:"showChannelSummaryModal"}),t.decorateCookedElement((e=>{const t=(0,r.getOwner)(this).lookup("service:current-user"),n=t?.user_option?.timezone
e.querySelectorAll(".chat-transcript").forEach((e=>{const t=e.dataset.datetime,r=e.querySelector(".chat-transcript-datetime a, .chat-transcript-datetime span")
r.innerText=n?moment.tz(t,n).format(i.default.t("dates.long_no_year")):moment(t).format(i.default.t("dates.long_no_year")),r.dataset.dateFormatted=!0}))}),{id:"chat-transcript-datetime"}),!this.chatService.userCanChat)return
document.body.classList.add("chat-enabled")
const s=t.getCurrentUser()
s?.chat_channels&&this.chatService.setupWithPreloadedChannels(s.chat_channels)
e.lookup("service:chat-notification-manager").start(),this._registeredDocumentTitleCountCallback||(t.addDocumentTitleCounter(this.documentTitleCountCallback),this._registeredDocumentTitleCountCallback=!0),t.addCardClickListenerSelector(".chat-drawer-outlet"),t.addToHeaderIcons("chat-header-icon"),t.addStyleguideSection?.({component:c.default,category:"organisms",id:"chat"}),t.addChatDrawerStateCallback((e=>{let{isDrawerActive:t}=e
t?document.body.classList.add("chat-drawer-active"):document.body.classList.remove("chat-drawer-active")})),t.decorateChatMessage((function(e,t){if(!this.currentUser)return
const i=[`@${this.currentUser.username}`]
t.allowChannelWideMentions&&i.push(...a.MENTION_KEYWORDS.map((e=>`@${e}`))),e.querySelectorAll(".mention").forEach((e=>{const t=e.textContent.trim()
i.includes(t)&&e.classList.add("highlighted","valid-mention")}))}))}))},documentTitleCountCallback(){return this.chatService.getDocumentTitleCount()},teardown(){this.appEvents.off("discourse:focus-changed",this,"_handleFocusChanged"),this.chatService.userCanChat&&(h=null,(0,s.clearChatComposerButtons)())},_handleFocusChanged(e){if(!this.chatService.userCanChat)return
if(!e)return void(h=Date.now())
h=h||Date.now()
Date.now()-h<=18e4||(h=Date.now())}},"documentTitleCountCallback",[n.bind],Object.getOwnPropertyDescriptor(u,"documentTitleCountCallback"),u),d(u,"_handleFocusChanged",[n.bind],Object.getOwnPropertyDescriptor(u,"_handleFocusChanged"),u),u)
e.default=p})),define("discourse/plugins/chat/discourse/initializers/chat-sidebar",["exports","@ember/template","discourse/lib/plugin-api","I18n","discourse-common/utils/decorators","@glimmer/tracking","discourse/lib/utilities","discourse-common/lib/avatar-utils","@ember/string","discourse/lib/text","discourse/helpers/decorate-username-selector","discourse/lib/formatter","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/new-message"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var g={name:"chat-sidebar",initialize(e){this.chatService=e.lookup("service:chat"),this.chatService.userCanChat&&(this.siteSettings=e.lookup("service:site-settings"),(0,i.withPluginApi)("1.3.0",(i=>{this.siteSettings.enable_public_channels&&i.addSidebarSection(((i,r)=>{var s,o,u
const d=class extends r{constructor(e){let{channel:t,chatService:i}=e
super(...arguments),this.channel=t,this.chatService=i}get name(){return(0,l.dasherize)(this.channel.slugifiedTitle)}get classNames(){const e=[]
return this.channel.currentUserMembership.muted&&e.push("sidebar-section-link--muted"),this.channel.id===this.chatService.activeChannel?.id&&e.push("sidebar-section-link--active"),e.push(`channel-${this.channel.id}`),e.join(" ")}get route(){return"chat.channel"}get models(){return this.channel.routeModels}get text(){return(0,t.htmlSafe)((0,c.emojiUnescape)(this.channel.escapedTitle))}get prefixType(){return"icon"}get prefixValue(){return"d-chat"}get prefixColor(){return this.channel.chatable.color}get title(){return this.channel.escapedDescription?(0,t.htmlSafe)(this.channel.escapedDescription):`${this.channel.escapedTitle} ${n.default.t("chat.title")}`}get prefixBadge(){return this.channel.chatable.read_restricted?"lock":""}get suffixType(){return"icon"}get suffixValue(){return this.channel.tracking.unreadCount>0||this.chatService.activeChannel?.id!==this.channel.id&&this.channel.unreadThreadsCountSinceLastViewed>0?"circle":""}get suffixCSSClass(){return this.channel.tracking.mentionCount>0?"urgent":"unread"}},p=(s=class extends i{constructor(){super(...arguments),m(this,"currentUser",o,this),m(this,"currentUserCanJoinPublicChannels",u,this),e.isDestroyed||(this.chatService=e.lookup("service:chat"),this.chatChannelsManager=e.lookup("service:chat-channels-manager"),this.router=e.lookup("service:router"))}get sectionLinks(){return this.chatChannelsManager.publicMessageChannels.map((e=>new d({channel:e,chatService:this.chatService})))}get name(){return"chat-channels"}get title(){return n.default.t("chat.chat_channels")}get text(){return n.default.t("chat.chat_channels")}get actions(){return[{id:"browseChannels",title:n.default.t("chat.channels_list_popup.browse"),action:()=>this.router.transitionTo("chat.browse.open")}]}get actionsIcon(){return"pencil-alt"}get links(){return this.sectionLinks}get displaySection(){return this.sectionLinks.length>0||this.currentUserCanJoinPublicChannels}},o=b(s.prototype,"currentUser",[h.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=b(s.prototype,"currentUserCanJoinPublicChannels",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.currentUser&&(this.currentUser.staff||this.currentUser.has_joinable_public_channels)}}),s)
return p})),i.addSidebarSection(((i,l)=>{var c,g,f,v,y,_
const w=(c=class extends l{constructor(e){let{channel:t,chatService:i}=e
super(...arguments),this.channel=t,this.chatService=i,this.oneOnOneMessage&&this.channel.chatable.users[0].trackStatus()}willDestroy(){this.oneOnOneMessage&&this.channel.chatable.users[0].stopTrackingStatus()}get name(){return this.channel.slugifiedTitle}get classNames(){const e=[]
return this.channel.currentUserMembership.muted&&e.push("sidebar-section-link--muted"),this.channel.id===this.chatService.activeChannel?.id&&e.push("sidebar-section-link--active"),e.push(`channel-${this.channel.id}`),e.join(" ")}get route(){return"chat.channel"}get models(){return this.channel.routeModels}get title(){return n.default.t("chat.placeholder_channel",{channelName:this.channel.escapedTitle})}get oneOnOneMessage(){return 1===this.channel.chatable.users.length}get contentComponentArgs(){return this.channel.chatable.users[0].get("status")}get contentComponent(){return"user-status-message"}get text(){const e=this.channel.escapedTitle.replaceAll("@","")
return this.oneOnOneMessage?(0,t.htmlSafe)(`${(0,s.escapeExpression)(e)}${(0,u.decorateUsername)((0,s.escapeExpression)(e))}`):e}get prefixType(){return this.oneOnOneMessage?"image":"text"}get prefixValue(){return 1===this.channel.chatable.users.length?(0,o.avatarUrl)(this.channel.chatable.users[0].avatar_template,"tiny"):this.channel.chatable.users.length}get prefixCSSClass(){const e=this.chatService.presenceChannel.users,t=this.channel.chatable.users[0]
return e?.findBy("id",t?.id)||e?.findBy("username",t?.username)?"active":""}get suffixType(){return"icon"}get suffixValue(){return this.channel.tracking.unreadCount>0?"circle":""}get suffixCSSClass(){return"urgent"}get hoverType(){return"icon"}get hoverValue(){return"times"}get hoverAction(){return e=>{e.stopPropagation(),e.preventDefault(),this.chatService.unfollowChannel(this.channel)}}get hoverTitle(){return n.default.t("chat.direct_messages.leave")}_userStatusTitle(e){let t=`${(0,s.escapeExpression)(e.description)}`
if(e.ends_at){t+=` ${(0,d.until)(e.ends_at,this.chatService.currentUser.user_option.timezone,this.chatService.currentUser.locale)}`}return t}},b(c.prototype,"willDestroy",[r.bind],Object.getOwnPropertyDescriptor(c.prototype,"willDestroy"),c.prototype),c),j=(g=class extends i{constructor(){super(...arguments),m(this,"site",f,this),m(this,"modal",v,this),m(this,"router",y,this),m(this,"userCanDirectMessage",_,this),e.isDestroyed||(this.chatService=e.lookup("service:chat"),this.chatChannelsManager=e.lookup("service:chat-channels-manager"))}get sectionLinks(){return this.chatChannelsManager.truncatedDirectMessageChannels.map((e=>new w({channel:e,chatService:this.chatService})))}get name(){return"chat-dms"}get title(){return n.default.t("chat.direct_messages.title")}get text(){return n.default.t("chat.direct_messages.title")}get actions(){return this.userCanDirectMessage?[{id:"startDm",title:n.default.t("chat.direct_messages.new"),action:()=>{this.modal.show(p.default)}}]:[]}get actionsIcon(){return"plus"}get links(){return this.sectionLinks}get displaySection(){return this.sectionLinks.length>0||this.userCanDirectMessage}},f=b(g.prototype,"site",[h.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=b(g.prototype,"modal",[h.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=b(g.prototype,"router",[h.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=b(g.prototype,"userCanDirectMessage",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.chatService.userCanDirectMessage}}),g)
return j}))})))}}
e.default=g})),define("discourse/plugins/chat/discourse/initializers/chat-user-menu",["exports","I18n","discourse/lib/plugin-api","discourse/lib/utilities","discourse/plugins/chat/discourse/lib/slugify-channel"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var a={name:"chat-user-menu",initialize(e){(0,i.withPluginApi)("1.3.0",(i=>{e.lookup("service:chat").userCanChat&&(i.registerNotificationTypeRenderer&&(i.registerNotificationTypeRenderer("chat_invitation",(e=>class extends e{get linkHref(){return`/chat/c/${(0,r.default)({title:this.notification.data.chat_channel_title,slug:this.notification.data.chat_channel_slug})||"-"}/${this.notification.data.chat_channel_id}/${this.notification.data.chat_message_id}`}get linkTitle(){return t.default.t("notifications.titles.chat_invitation")}get icon(){return"link"}get label(){return(0,n.formatUsername)(this.notification.data.invited_by_username)}get description(){return t.default.t("notifications.chat_invitation")}})),i.registerNotificationTypeRenderer("chat_mention",(e=>class extends e{get linkHref(){let e=`/chat/c/${(0,r.default)({title:this.notification.data.chat_channel_title,slug:this.notification.data.chat_channel_slug})||"-"}/${this.notification.data.chat_channel_id}`
return this.notification.data.chat_thread_id?e+=`/t/${this.notification.data.chat_thread_id}`:e+=`/${this.notification.data.chat_message_id}`,e}get linkTitle(){return t.default.t("notifications.titles.chat_mention")}get icon(){return"d-chat"}get label(){return(0,n.formatUsername)(this.notification.data.mentioned_by_username)}get description(){const e=this.notification.data.identifier?`@${this.notification.data.identifier}`:null,i=this.notification.data.is_direct_message_channel?"notifications.popup.direct_message_chat_mention":"notifications.popup.chat_mention",n=e?"other_plain":"direct"
return t.default.t(`${i}.${n}`,{identifier:e,channel:this.notification.data.chat_channel_title})}}))),i.registerUserMenuTab&&i.registerUserMenuTab((e=>class extends e{get id(){return"chat-notifications"}get panelComponent(){return"user-menu/chat-notifications-list"}get icon(){return"d-chat"}get count(){return this.getUnreadCountForType("chat_mention")+this.getUnreadCountForType("chat_invitation")}get notificationTypes(){return["chat_invitation","chat_mention","chat_message","chat_quoted"]}})))}))}}
e.default=a})),define("discourse/plugins/chat/discourse/initializers/chat-user-options",["exports","discourse/lib/plugin-api"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i={name:"chat-user-options",initialize(e){(0,t.withPluginApi)("0.11.0",(t=>{e.lookup("service:site-settings").chat_enabled&&(t.addSaveableUserOptionField("chat_enabled"),t.addSaveableUserOptionField("only_chat_push_notifications"),t.addSaveableUserOptionField("ignore_channel_wide_mention"),t.addSaveableUserOptionField("chat_sound"),t.addSaveableUserOptionField("chat_email_frequency"),t.addSaveableUserOptionField("chat_header_indicator_preference"))}))}}
e.default=i})),define("discourse/plugins/chat/discourse/lib/chat-composer-buttons",["exports","I18n"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.chatComposerButtons=function(e,a,s){return Object.values(i).filter((t=>{let i=n(e,t,"displayed")&&n(e,t,"position")===a
return t.context&&(i=i&&n(e,t,"context")===s),i})).map((i=>{const a={id:i.id},o=n(e,i,"label")
a.label=o||n(e,i,"translatedLabel")
const l=n(e,i,"ariaLabel")
if(l)a.ariaLabel=t.default.t(l)
else{const t=n(e,i,"translatedAriaLabel")
a.ariaLabel=t||a.label}const c=n(e,i,"title")
if(a.title=c?t.default.t(c):n(e,i,"translatedTitle"),a.classNames=(n(e,i,"classNames")||[]).join(" "),a.icon=n(e,i,"icon"),a.disabled=n(e,i,"disabled"),a.priority=n(e,i,"priority"),r(i.action))a.action=()=>{i.action.apply(e,[s])}
else{const t=i.action
a.action=()=>{e[t](s)}}return a}))},e.chatComposerButtonsDependentKeys=function(){return[].concat(...Object.values(i).mapBy("dependentKeys").filter(Boolean))},e.clearChatComposerButtons=function(){i=[]},e.registerChatComposerButton=function(e){if(!e.id)throw new Error("Attempted to register a chat composer button with no id.")
if(i[e.id])return
const t=Object.assign({id:null,action:null,icon:null,title:null,translatedTitle:null,label:null,translatedLabel:null,ariaLabel:null,translatedAriaLabel:null,position:"inline",classNames:[],dependentKeys:[],displayed:!0,disabled:!1,priority:0},e)
if(!t.icon&&!t.label&&!t.translatedLabel)throw new Error(`Attempted to register a chat composer button: ${e.id} with no icon or label.`)
i[t.id]=t}
let i={}
function n(e,t,i){const n=t[i]
return r(n)?n.apply(e):n}function r(e){return e&&"function"==typeof e}})),define("discourse/plugins/chat/discourse/lib/chat-constants",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.READ_INTERVAL_MS=e.PAST=e.FUTURE=e.DEFAULT_MESSAGE_PAGE_SIZE=void 0
e.PAST="past"
e.FUTURE="future"
e.READ_INTERVAL_MS=1e3
e.DEFAULT_MESSAGE_PAGE_SIZE=50})),define("discourse/plugins/chat/discourse/lib/chat-ios-hacks",["exports","discourse/plugins/chat/discourse/lib/zoom-check","discourse/services/capabilities","@ember/runloop","discourse-common/lib/later"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.bodyScrollFix=function(){i.capabilities.isIOS&&document.documentElement.classList.contains("keyboard-visible")&&!(0,t.default)()&&document.documentElement.scrollTo(0,0)},e.stackingContextFix=function(e,t){i.capabilities.isIOS&&(e.style.overflow="hidden",e.querySelectorAll(".chat-message-separator__text-container").forEach((e=>e.style.zIndex="1")))
t?.(),i.capabilities.isIOS&&(0,n.next)((()=>{(0,n.schedule)("afterRender",(()=>{e.style.overflow="auto",(0,r.default)((()=>{e&&e.querySelectorAll(".chat-message-separator__text-container").forEach((e=>e.style.zIndex="2"))}),50)}))}))}})),define("discourse/plugins/chat/discourse/lib/chat-message-container",["exports","discourse/plugins/chat/discourse/components/chat-message"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,i){let n
n=i===t.MESSAGE_CONTEXT_THREAD?`.chat-thread .chat-message-container[data-id="${e}"]`:`.chat-channel .chat-message-container[data-id="${e}"]`
return document.querySelector(n)}})),define("discourse/plugins/chat/discourse/lib/chat-message-flag",["exports","discourse/lib/ajax","discourse/lib/ajax-error","I18n","discourse-common/lib/get-url"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=class{title(){return"flagging.title"}customSubmitLabel(){return"flagging.notify_action"}submitLabel(){return"chat.flagging.action"}targetsTopic(){return!1}editable(){return!1}_rewriteFlagDescriptions(e){return e.map((e=>(e.set("description",n.default.t(`chat.flags.${e.name_key}`,{basePath:(0,r.default)("")})),e)))}flagsAvailable(e,t,i){let n=t.flagTypes
n=n.filter((e=>i.availableFlags.includes(e.name_key)))
const r=n.indexOf(n.filterBy("name_key","notify_user")[0])
if(-1!==r){const e=n[r]
n.splice(r,1),n.splice(0,0,e)}return this._rewriteFlagDescriptions(n)}create(e,n){return e.send("hideModal"),(0,t.ajax)("/chat/flag",{method:"PUT",data:{chat_message_id:e.get("model.id"),flag_type_id:e.get("selected.id"),message:n.message,is_warning:n.isWarning,take_action:n.takeAction,queue_for_review:n.queue_for_review}}).then((()=>{e.isDestroying||e.isDestroyed||(n.skipClose||e.send("closeModal"),n.message&&e.set("message",""))})).catch((t=>{e.isDestroying||e.isDestroyed||e.send("closeModal"),(0,i.popupAjaxError)(t)}))}}})),define("discourse/plugins/chat/discourse/lib/chat-message-interactor",["exports","discourse-common/lib/get-url","discourse-common/utils/decorators","discourse/lib/show-modal","discourse/plugins/chat/discourse/lib/chat-message-flag","discourse/models/bookmark","discourse/components/modal/bookmark","discourse/lib/bookmark","discourse/lib/ajax-error","@ember/object","@ember/service","discourse-common/config/environment","discourse/lib/utilities","discourse/plugins/chat/discourse/models/chat-message-reaction","@ember/application","@glimmer/tracking","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/components/chat-message","I18n"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v){"use strict"
var y,_,w,j,M,z,k,O,C,S,P,T,E,x,D,I,A,U
function L(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function N(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function R(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.removeChatComposerSecondaryActions=function(e){e.forEach((e=>F.add(e)))},e.resetRemovedChatComposerSecondaryActions=function(){F.clear()}
const F=new Set
let W=(y=class{constructor(e,t,i){L(this,"appEvents",_,this),L(this,"dialog",w,this),L(this,"chat",j,this),L(this,"chatEmojiReactionStore",M,this),L(this,"chatEmojiPickerManager",z,this),L(this,"chatChannelComposer",k,this),L(this,"chatThreadComposer",O,this),L(this,"chatChannelPane",C,this),L(this,"chatThreadPane",S,this),L(this,"chatApi",P,this),L(this,"currentUser",T,this),L(this,"site",E,this),L(this,"router",x,this),L(this,"modal",D,this),L(this,"capabilities",I,this),L(this,"message",A,this),L(this,"context",U,this),N(this,"cachedFavoritesReactions",null),(0,m.setOwner)(this,e),this.message=t,this.context=i,this.cachedFavoritesReactions=this.chatEmojiReactionStore.favorites}get pane(){return this.context===f.MESSAGE_CONTEXT_THREAD?this.chatThreadPane:this.chatChannelPane}get emojiReactions(){let e=this.cachedFavoritesReactions
return e&&e.slice?e.slice(0,3).map((e=>this.message.reactions.find((t=>t.emoji===e))||p.default.create({emoji:e}))):[]}get canEdit(){return!this.message.deletedAt&&this.currentUser.id===this.message.user.id&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canInteractWithMessage(){return!this.message?.deletedAt&&this.message?.channel?.canModifyMessages(this.currentUser)}get canRestoreMessage(){return this.message?.deletedAt&&(this.currentUser.staff||this.message?.user?.id===this.currentUser.id&&this.message?.deletedById===this.currentUser.id)&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canBookmark(){return this.message?.channel?.canModifyMessages?.(this.currentUser)}get canReply(){return this.canInteractWithMessage&&this.context!==f.MESSAGE_CONTEXT_THREAD}get canReact(){return this.canInteractWithMessage}get canFlagMessage(){return this.currentUser.id!==this.message?.user?.id&&void 0===this.message?.userFlagStatus&&this.message.channel?.canFlag&&!this.message?.chatWebhookEvent&&!this.message?.deletedAt}get canRebakeMessage(){return this.currentUser.staff&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canDeleteMessage(){return this.canDelete&&!this.message?.deletedAt&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canDelete(){return this.currentUser.id===this.message.user.id?this.message.channel?.canDeleteSelf:this.message.channel?.canDeleteOthers}get composer(){return this.context===f.MESSAGE_CONTEXT_THREAD?this.chatThreadComposer:this.chatChannelComposer}get secondaryActions(){const e=[]
return e.push({id:"copyLink",name:v.default.t("chat.copy_link"),icon:"link"}),this.canEdit&&e.push({id:"edit",name:v.default.t("chat.edit"),icon:"pencil-alt"}),this.pane.selectingMessages||e.push({id:"select",name:v.default.t("chat.select"),icon:"tasks"}),this.canFlagMessage&&e.push({id:"flag",name:v.default.t("chat.flag"),icon:"flag"}),this.canDeleteMessage&&e.push({id:"delete",name:v.default.t("chat.delete"),icon:"trash-alt"}),this.canRestoreMessage&&e.push({id:"restore",name:v.default.t("chat.restore"),icon:"undo"}),this.canRebakeMessage&&e.push({id:"rebake",name:v.default.t("chat.rebake_message"),icon:"sync-alt"}),e.reject((e=>F.has(e.id)))}select(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0]
this.message.selected=e,this.pane.onSelectMessage(this.message)}bulkSelect(e){const t=this.message.manager,i=[t.findIndexOfMessage(this.pane.lastSelectedMessage.id),t.findIndexOfMessage(this.message.id)].sort(((e,t)=>e-t))
for(let n=i[0];n<=i[1];n++)t.messages[n].selected=e}copyLink(){const{protocol:e,host:i}=window.location,n=this.message.channel.id,r=this.message.thread?.id
let a
a=this.context===f.MESSAGE_CONTEXT_THREAD&&r?(0,t.default)(`/chat/c/-/${n}/t/${r}/${this.message.id}`):(0,t.default)(`/chat/c/-/${n}/${this.message.id}`),a=0===a.indexOf("/")?e+"//"+i+a:a,(0,h.clipboardCopy)(a)}react(e,t){if(this.chat.userCanInteractWithChat&&!this.pane.reacting)return this.capabilities.canVibrate&&!(0,d.isTesting)()&&navigator.vibrate(5),this.site.mobileView&&(this.chat.activeMessage=null),t===p.REACTIONS.add&&this.chatEmojiReactionStore.track(`:${e}:`),this.pane.reacting=!0,this.message.react(e,t,this.currentUser,this.currentUser.id),this.chatApi.publishReaction(this.message.channel.id,this.message.id,e,t).catch((t=>{(0,l.popupAjaxError)(t),this.message.react(e,p.REACTIONS.remove,this.currentUser,this.currentUser.id)})).finally((()=>{this.pane.reacting=!1}))}toggleBookmark(){this.modal.show(s.default,{model:{bookmark:new o.BookmarkFormData(this.message.bookmark||a.default.createFor(this.currentUser,"Chat::Message",this.message.id)),afterSave:e=>{const t=a.default.create(e)
this.message.bookmark=t,this.appEvents.trigger("bookmarks:changed",e,t.attachedTo())},afterDelete:()=>{this.message.bookmark=null}}})}flag(){const e=new g.default(this.message.channel,this.message)
e.username=this.message.user?.username,e.user_id=this.message.user?.id;(0,n.default)("flag",{model:e}).set("flagTarget",new r.default)}delete(){return this.chatApi.trashMessage(this.message.channel.id,this.message.id).catch(l.popupAjaxError)}restore(){return this.chatApi.restoreMessage(this.message.channel.id,this.message.id).catch(l.popupAjaxError)}rebake(){return this.chatApi.rebakeMessage(this.message.channel.id,this.message.id).catch(l.popupAjaxError)}reply(){this.composer.replyTo(this.message)}edit(){this.composer.edit(this.message)}openEmojiPicker(e,t){let{target:i}=t
const n={didSelectEmoji:this.selectReaction,trigger:i,context:"chat-channel-message"}
this.chatEmojiPickerManager.open(n)}selectReaction(e){this.chat.userCanInteractWithChat&&this.react(e,p.REACTIONS.add)}handleSecondaryActions(e){this[e](this.message)}},_=R(y.prototype,"appEvents",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=R(y.prototype,"dialog",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=R(y.prototype,"chat",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=R(y.prototype,"chatEmojiReactionStore",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=R(y.prototype,"chatEmojiPickerManager",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=R(y.prototype,"chatChannelComposer",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=R(y.prototype,"chatThreadComposer",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=R(y.prototype,"chatChannelPane",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=R(y.prototype,"chatThreadPane",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=R(y.prototype,"chatApi",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=R(y.prototype,"currentUser",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=R(y.prototype,"site",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=R(y.prototype,"router",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=R(y.prototype,"modal",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=R(y.prototype,"capabilities",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=R(y.prototype,"message",[b.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=R(y.prototype,"context",[b.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R(y.prototype,"react",[c.action],Object.getOwnPropertyDescriptor(y.prototype,"react"),y.prototype),R(y.prototype,"toggleBookmark",[c.action],Object.getOwnPropertyDescriptor(y.prototype,"toggleBookmark"),y.prototype),R(y.prototype,"flag",[c.action],Object.getOwnPropertyDescriptor(y.prototype,"flag"),y.prototype),R(y.prototype,"delete",[c.action],Object.getOwnPropertyDescriptor(y.prototype,"delete"),y.prototype),R(y.prototype,"restore",[c.action],Object.getOwnPropertyDescriptor(y.prototype,"restore"),y.prototype),R(y.prototype,"rebake",[c.action],Object.getOwnPropertyDescriptor(y.prototype,"rebake"),y.prototype),R(y.prototype,"reply",[c.action],Object.getOwnPropertyDescriptor(y.prototype,"reply"),y.prototype),R(y.prototype,"edit",[c.action],Object.getOwnPropertyDescriptor(y.prototype,"edit"),y.prototype),R(y.prototype,"openEmojiPicker",[c.action],Object.getOwnPropertyDescriptor(y.prototype,"openEmojiPicker"),y.prototype),R(y.prototype,"selectReaction",[i.bind],Object.getOwnPropertyDescriptor(y.prototype,"selectReaction"),y.prototype),R(y.prototype,"handleSecondaryActions",[c.action],Object.getOwnPropertyDescriptor(y.prototype,"handleSecondaryActions"),y.prototype),y)
e.default=W})),define("discourse/plugins/chat/discourse/lib/chat-messages-loader",["exports","@ember/application","@glimmer/tracking","discourse/plugins/chat/discourse/models/chat-channel","@ember/service","discourse/plugins/chat/discourse/lib/chat-constants","discourse/lib/ajax-error"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h,p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function y(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function _(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let w=(p=new WeakSet,m=new WeakSet,b=new WeakSet,g=new WeakSet,o=class{constructor(e,i){v(this,g),v(this,b),v(this,m),v(this,p),f(this,"chatApi",l,this),f(this,"loading",c,this),f(this,"canLoadMorePast",u,this),f(this,"canLoadMoreFuture",d,this),f(this,"fetchedOnce",h,this),(0,t.setOwner)(this,e),this.model=i}get loadedPast(){return!1===this.canLoadMorePast&&this.fetchedOnce}async loadMore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(!1===this.canLoadMoreFuture&&e.direction===a.FUTURE)return
if(!1===this.canLoadMorePast&&e.direction===a.PAST)return
const t=y(this,b,z).call(this,e.direction,this.model)
let i
e={direction:e.direction,page_size:a.DEFAULT_MESSAGE_PAGE_SIZE,target_message_id:t?.id},e=y(this,m,M).call(this,e)
try{this.loading=!0,i=await y(this,p,j).call(this,e),this.canLoadMoreFuture=i.meta.can_load_more_future,this.canLoadMorePast=i.meta.can_load_more_past}catch(n){y(this,g,k).call(this,n)}finally{this.loading=!1}return i}async load(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.canLoadMorePast=!0,this.canLoadMoreFuture=!0,this.fetchedOnce=!1,this.loading=!0,t.page_size??=a.DEFAULT_MESSAGE_PAGE_SIZE,t=y(this,m,M).call(this,t)
try{e=await y(this,p,j).call(this,t),this.canLoadMoreFuture=e.meta.can_load_more_future,this.canLoadMorePast=e.meta.can_load_more_past,this.fetchedOnce=!0}catch(i){y(this,g,k).call(this,i)}finally{this.loading=!1}return e}},l=_(o.prototype,"chatApi",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=_(o.prototype,"loading",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=_(o.prototype,"canLoadMorePast",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=_(o.prototype,"canLoadMoreFuture",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h=_(o.prototype,"fetchedOnce",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o)
function j(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return this.model instanceof n.default?this.chatApi.channelMessages(this.model.id,e):this.chatApi.channelThreadMessages(this.model.channel.id,this.model.id,e)}function M(e){return Object.keys(e).filter((t=>null!=e[t])).reduce(((t,i)=>({...t,[i]:e[i]})),{})}function z(e,t){return e===a.PAST?t.messagesManager.messages.find((e=>!e.staged)):t.messagesManager.messages.findLast((e=>!e.staged))}function k(e){switch(e?.jqXHR?.status){case 429:case 404:(0,s.popupAjaxError)(e)
break
default:throw e}}e.default=w})),define("discourse/plugins/chat/discourse/lib/chat-messages-manager",["exports","@glimmer/tracking","@ember/application"],(function(e,t,i){"use strict"
var n,r
function a(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let s=(n=class{constructor(e){var t,n,a,s
t=this,n="messages",s=this,(a=r)&&Object.defineProperty(t,n,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(s):void 0}),(0,i.setOwner)(this,e)}get stagedMessages(){return this.messages.filterBy("staged")}get selectedMessages(){return this.messages.filterBy("selected")}clearSelectedMessages(){this.selectedMessages.forEach((e=>e.selected=!1))}clear(){this.messages=[]}addMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]
this.messages=this.messages.concat(e).uniqBy("id").sort(((e,t)=>e.createdAt-t.createdAt))}findMessage(e){return this.messages.find((t=>t.id===parseInt(e,10)))}findFirstMessageOfDay(e){return this.messages.find((t=>e.getFullYear()===t.createdAt.getFullYear()&&e.getMonth()===t.createdAt.getMonth()&&e.getDate()===t.createdAt.getDate()))}removeMessage(e){return this.messages.removeObject(e)}findStagedMessage(e){return this.stagedMessages.find((t=>t.id===e))}findIndexOfMessage(e){return this.messages.findIndex((t=>t.id===e))}findLastMessage(){return this.messages.findLast((e=>!e.deletedAt))}findLastUserMessage(e){return this.messages.findLast((t=>t.user.id===e.id&&!t.deletedAt))}},r=a(n.prototype,"messages",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a(n.prototype,"stagedMessages",[t.cached],Object.getOwnPropertyDescriptor(n.prototype,"stagedMessages"),n.prototype),a(n.prototype,"selectedMessages",[t.cached],Object.getOwnPropertyDescriptor(n.prototype,"selectedMessages"),n.prototype),n)
e.default=s})),define("discourse/plugins/chat/discourse/lib/chat-notification-levels",["exports","discourse/lib/notification-levels"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.threadNotificationButtonLevels=void 0
const i=[t.NotificationLevels.TRACKING,t.NotificationLevels.REGULAR].map(t.buttonDetails)
e.threadNotificationButtonLevels=i})),define("discourse/plugins/chat/discourse/lib/chat-threads-manager",["exports","@ember/service","@ember/application","rsvp","discourse/plugins/chat/discourse/models/chat-thread","@glimmer/tracking","@ember-compat/tracked-built-ins"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h,p,m,b
function g(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function f(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function v(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let _=(p=new WeakSet,m=new WeakSet,b=new WeakSet,o=class{constructor(e){f(this,b),f(this,m),f(this,p),g(this,"chatTrackingStateManager",l,this),g(this,"chatChannelsManager",c,this),g(this,"chatApi",u,this),g(this,"_cached",d,this),g(this,"_unreadThreadOverview",h,this),(0,i.setOwner)(this,e)}get unreadThreadCount(){return this.unreadThreadOverview.size}get unreadThreadOverview(){return this._unreadThreadOverview}set unreadThreadOverview(e){this._unreadThreadOverview.clear()
for(const[t,i]of Object.entries(e))this.markThreadUnread(t,i)}markThreadUnread(e,t){this.unreadThreadOverview.set(parseInt(e,10),new Date(t))}get threads(){return Object.values(this._cached)}async find(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{fetchIfNotFound:!0}
const r=v(this,m,j).call(this,t)
return r?n.default.resolve(r):i.fetchIfNotFound?v(this,b,M).call(this,e,t):n.default.resolve()}remove(e){delete this._cached[e.id]}add(e,t){let i
return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).replace||(i=v(this,m,j).call(this,t.id)),i||(i=t instanceof r.default?t:r.default.create(e,t),v(this,p,w).call(this,i)),t?.meta?.message_bus_last_ids?.thread_message_bus_last_id&&(i.threadMessageBusLastId=t.meta.message_bus_last_ids.thread_message_bus_last_id),i}},l=y(o.prototype,"chatTrackingStateManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=y(o.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=y(o.prototype,"chatApi",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=y(o.prototype,"_cached",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new s.TrackedObject}}),h=y(o.prototype,"_unreadThreadOverview",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new s.TrackedMap}}),y(o.prototype,"threads",[a.cached],Object.getOwnPropertyDescriptor(o.prototype,"threads"),o.prototype),o)
function w(e){this._cached[e.id]=e}function j(e){return this._cached[e]}async function M(e,t){return this.chatApi.thread(e,t).then((t=>this.chatChannelsManager.find(e).then((e=>e.threadsManager.add(e,t.thread)))))}e.default=_})),define("discourse/plugins/chat/discourse/lib/check-message-visibility",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.checkMessageBottomVisibility=function(e,t){const i=window.pageYOffset+e.getBoundingClientRect().top
return t.getBoundingClientRect().bottom-i<=e.clientHeight+1},e.checkMessageTopVisibility=function(e,t){const i=window.pageYOffset+e.getBoundingClientRect().top
return t.getBoundingClientRect().top-i>=-1}})),define("discourse/plugins/chat/discourse/lib/collection",["exports","discourse/lib/ajax","@glimmer/tracking","discourse-common/utils/decorators","rsvp"],(function(e,t,i,n,r){"use strict"
let a
var s,o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let b=(d=new WeakSet,a=Symbol.iterator,s=class{constructor(e,t){p(this,d),h(this,"items",o,this),h(this,"meta",l,this),h(this,"loading",c,this),h(this,"fetchedOnce",u,this),this._resourceURL=e,this._handler=t,this._fetchedAll=!1}get loadMoreURL(){return this.meta?.load_more_url}get totalRows(){return this.meta?.total_rows}get length(){return this.items?.length}[a](){let e=0
return{next:()=>e<this.length?{value:this.items[e++],done:!1}:{done:!0}}}load(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(this.loading||this._fetchedAll||this.totalRows&&this.items.length>=this.totalRows)return r.Promise.resolve()
if(this.loading=!0,this.loadMoreURL)e=this.loadMoreURL
else{const i=Object.entries(t).filter((e=>{let[,t]=e
return void 0!==t})),n=new URLSearchParams(i).toString()
e=this._resourceURL+(n?`?${n}`:"")}return function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,d,g).call(this,e).then((e=>{const i=this._handler(e)
i.length&&(this.items=(this.items??[]).concat(i)),(!i.length||i.length<t.limit)&&(this._fetchedAll=!0),this.meta=e.meta,this.fetchedOnce=!0})).finally((()=>{this.loading=!1}))}},o=m(s.prototype,"items",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=m(s.prototype,"meta",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),c=m(s.prototype,"loading",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=m(s.prototype,"fetchedOnce",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m(s.prototype,"load",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"load"),s.prototype),s)
function g(e){return(0,t.ajax)(e,{type:"GET"})}e.default=b})),define("discourse/plugins/chat/discourse/lib/fabricators",["exports","discourse/plugins/chat/discourse/models/chat-channel","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-thread","discourse/plugins/chat/discourse/models/chat-thread-preview","discourse/plugins/chat/discourse/models/chat-direct-message","discourse/plugins/chat/discourse/models/chat-message-mention-warning","discourse/plugins/chat/discourse/models/chat-message-reaction","discourse/models/user","discourse/models/bookmark","discourse/models/category","discourse/models/group"],(function(e,t,i,n,r,a,s,o,l,c,u,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let h=0
function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.channel||m(),n=i.default.create(t,Object.assign({id:e.id||h++,user:e.user||f(),message:e.message||"@discobot **abc**defghijklmnopqrstuvwxyz [discourse](discourse.org) :rocket: ",created_at:e.created_at||moment()},e)),r=n.message.toString()
return r.length<=50?n.excerpt=r:n.excerpt=r.slice(0,50)+"...",n}function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const i=e.id||h++,n=t.default.create({id:i,chatable_type:e.chatable?.type||e.chatable_type||t.CHATABLE_TYPES.categoryChannel,chatable_id:e.chatable?.id||e.chatable_id,title:e.title||"General",description:e.description,chatable:e.chatable||b(),status:e.status||t.CHANNEL_STATUSES.open,slug:e.chatable?.slug||"general",meta:Object.assign({can_delete_self:!0},e.meta||{}),archive_failed:e.archive_failed??!1})
return n.lastMessage=p({channel:n}),n}function b(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return u.default.create({id:e.id||h++,color:e.color||"D56353",read_restricted:!1,name:e.name||"General",slug:e.slug||"general"})}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return a.default.create({id:e.id||h++,users:e.users||[f(),f()]})}function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return l.default.create({id:e.id||h++,username:e.username||"hawk",name:e.name,avatar_template:"/letter_avatar_proxy/v3/letter/t/41988e/{size}.png",suspended_till:e.suspended_till})}function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return r.default.create({last_reply_id:e.last_reply_id||h++,last_reply_created_at:e.last_reply_created_at||Date.now(),last_reply_excerpt:e.last_reply_excerpt||"This is a reply"})}var y={bookmark:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return c.default.create({id:e.id||h++})},user:f,channel:m,directMessageChannel:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const i=e.chatable||g({id:e.chatable_id||h++})
return m(Object.assign(e,{chatable_type:t.CHATABLE_TYPES.directMessageChannel,chatable_id:i.id,chatable:i}))},message:p,thread:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.channel||m()
return n.default.create(t,{id:e.id||h++,original_message:e.original_message||p({channel:t}),preview:e.preview||v({channel:t})})},threadPreview:v,reaction:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return o.default.create({count:e.count||1,users:e.users||[f()],emoji:e.emoji||"heart",reacted:e.reacted||!1})},upload:function(){return{extension:"jpeg",filesize:126177,height:800,human_filesize:"123 KB",id:202,original_filename:"avatar.PNG.jpg",retain_hours:null,short_path:"/images/avatar.png",short_url:"upload://yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg",thumbnail_height:320,thumbnail_width:690,url:"/images/avatar.png",width:1920}},category:b,directMessage:g,messageMentionWarning:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return s.default.create(e,t)},group:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return d.default.create({name:e.name||"Engineers"})}}
e.default=y})),define("discourse/plugins/chat/discourse/lib/hashtag-types/channel",["exports","discourse/lib/hashtag-types/base","discourse-common/lib/icon-library","@ember/service"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let c=(r=class extends t.default{constructor(){super(...arguments),o(this,"chatChannelsManager",a,this),o(this,"currentUser",s,this)}get type(){return"channel"}get preloadedData(){return this.currentUser?this.chatChannelsManager.publicMessageChannels:[]}generateColorCssClasses(e){return[`.d-icon.hashtag-color--${this.type}-${e.id} { color: var(--category-${e.chatable.id}-color); }`]}generateIconHTML(e){const t=parseInt(e.id,10),n=this.preloadedData.mapBy("id").includes(t)?`hashtag-color--${this.type}-${e.id}`:"hashtag-missing"
return(0,i.iconHTML)(e.icon,{class:n})}},a=l(r.prototype,"chatChannelsManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=l(r.prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)
e.default=c})),define("discourse/plugins/chat/discourse/lib/scroll-helpers",["exports","@ember/runloop","discourse/plugins/chat/discourse/lib/chat-ios-hacks"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.scrollListToBottom=function(e){(0,i.stackingContextFix)(e,(()=>{e.scrollTo({top:0,behavior:"auto"})}))},e.scrollListToMessage=function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{highlight:!1,position:"start",autoExpand:!1}
if(!n)return
n?.deletedAt&&r.autoExpand&&(n.expanded=!0);(0,t.schedule)("afterRender",(()=>{const t=e.querySelector(`.chat-message-container[data-id='${n.id}']`)
t&&(r.highlight&&n.highlight(),(0,i.stackingContextFix)(e,(()=>{t.scrollIntoView({behavior:"auto",block:r.position||"center"})})))}))},e.scrollListToTop=function(e){(0,i.stackingContextFix)(e,(()=>{e.scrollTo({top:-e.scrollHeight,behavior:"auto"})}))}})),define("discourse/plugins/chat/discourse/lib/simple-category-hash-mention-transform",["exports","discourse-common/lib/get-url"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,n){let r=i.parseFromString(e,"text/html")
return function(e){(e.querySelectorAll("span.mention")||[]).forEach((e=>{let i=document.createElement("a"),n=document.createTextNode(e.innerText)
i.classList.add("mention"),i.appendChild(n),i.href=(0,t.default)(`/u/${e.innerText.substring(1)}`),e.parentNode.replaceChild(i,e)}))}(r),function(e,i){(e.querySelectorAll("span.hashtag")||[]).forEach((e=>{const n=e.innerText.substring(1),r=i.find((e=>e.name.toLowerCase()===n.toLowerCase())),a=(0,t.default)(r?`/c/${r.name}/${r.id}`:`/tag/${n}`)
let s=document.createElement("a"),o=document.createTextNode(e.innerText)
s.classList.add("hashtag"),s.appendChild(o),s.href=a,e.parentNode.replaceChild(s,e)}))}(r,n),r.body.innerHTML}
const i=new DOMParser})),define("discourse/plugins/chat/discourse/lib/slugify-channel",["exports","discourse/lib/utilities"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){if(e.slug)return e.slug
if(!e.escapedTitle&&!e.title)return"-"
const i=(0,t.slugify)(e.escapedTitle||e.title),n=(i.length?i:e.title.trim().toLowerCase().replace(/\s|_+/g,"-")).slice(0,100)
if(!n)return"-"
return n}})),define("discourse/plugins/chat/discourse/lib/textarea-interactor",["exports","@ember/object","discourse/mixins/textarea-text-manipulation","@ember/runloop","@ember/application","@ember/service","@ember/destroyable"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let p=(o=class extends(t.default.extend(i.default)){constructor(e,t){super(...arguments),d(this,"capabilities",l,this),d(this,"site",c,this),d(this,"siteSettings",u,this),(0,r.setOwner)(this,e),this.textarea=t,this._textarea=t,this.element=this._textarea,this.ready=!0,this.composerFocusSelector=`#${t.id}`,this.init(),this.composerEventPrefix=null,this.textarea.addEventListener("paste",this.paste),(0,s.registerDestructor)(this,(e=>e.teardown()))}teardown(){this.textarea.removeEventListener("paste",this.paste)}set value(e){this._textarea.value=e
const t=new Event("input",{bubbles:!0,cancelable:!0})
this._textarea.dispatchEvent(t)}blur(){(0,n.next)((()=>{(0,n.schedule)("afterRender",(()=>{this._textarea.blur()}))}))}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{ensureAtEnd:!1,refreshHeight:!0,addText:null};(0,n.next)((()=>{(0,n.schedule)("afterRender",(()=>{e.refreshHeight&&this.refreshHeight(),e.ensureAtEnd&&this.ensureCaretAtEnd(),this.capabilities.isIpadOS||this.site.mobileView||(e.addText&&this.addText(this.getSelected(),e.addText),this.focusTextArea())}))}))}ensureCaretAtEnd(){(0,n.schedule)("afterRender",(()=>{this._textarea.setSelectionRange(this._textarea.value.length,this._textarea.value.length)}))}refreshHeight(){(0,n.schedule)("afterRender",(()=>{this._textarea.style.height="auto",this._textarea.style.height=this._textarea.scrollHeight+1+"px"}))}},l=h(o.prototype,"capabilities",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(o.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(o.prototype,"siteSettings",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)
e.default=p})),define("discourse/plugins/chat/discourse/lib/zoom-check",["exports","discourse-common/config/environment"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return!(0,t.isTesting)()&&1!==visualViewport?.scale&&document.documentElement.clientWidth/window.innerWidth!=1}})),define("discourse/plugins/chat/discourse/models/chat-channel-archive",["exports","@glimmer/tracking"],(function(e,t){"use strict"
var i,n,r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let u=(i=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
l(this,"failed",n,this),l(this,"completed",r,this),l(this,"messages",a,this),l(this,"topicId",s,this),l(this,"totalMessages",o,this),this.failed=e.archive_failed,this.completed=e.archive_completed,this.messages=e.archived_messages,this.topicId=e.archive_topic_id,this.totalMessages=e.total_messages}},n=c(i.prototype,"failed",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=c(i.prototype,"completed",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=c(i.prototype,"messages",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(i.prototype,"topicId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(i.prototype,"totalMessages",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)
e.default=u})),define("discourse/plugins/chat/discourse/models/chat-channel",["exports","discourse/plugins/chat/discourse/models/user-chat-channel-membership","discourse/plugins/chat/discourse/models/chat-message","discourse/lib/utilities","@glimmer/tracking","discourse/plugins/chat/discourse/lib/slugify-channel","discourse/plugins/chat/discourse/lib/chat-threads-manager","discourse/plugins/chat/discourse/lib/chat-messages-manager","discourse-common/lib/get-owner","pretty-text/guid","discourse/plugins/chat/discourse/models/chat-thread","discourse/plugins/chat/discourse/models/chat-direct-message","discourse/plugins/chat/discourse/models/chat-channel-archive","discourse/models/category","discourse/plugins/chat/discourse/models/chat-tracking-state"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m){"use strict"
var b,g,f,v,y,_,w,j,M,z,k,O,C,S,P,T,E
function x(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function D(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function I(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.CHATABLE_TYPES=e.CHANNEL_STATUSES=void 0,e.channelStatusIcon=function(e){if(e===U.open)return null
switch(e){case U.closed:return"lock"
case U.readOnly:return"comment-slash"
case U.archived:return"archive"}},e.default=void 0
const A={directMessageChannel:"DirectMessage",categoryChannel:"Category"}
e.CHATABLE_TYPES=A
const U={open:"open",readOnly:"read_only",closed:"closed",archived:"archived"}
e.CHANNEL_STATUSES=U
const L=[U.readOnly,U.archived],N=[U.closed,U.readOnly,U.archived]
let R=(b=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
x(this,"title",g,this),x(this,"slug",f,this),x(this,"description",v,this),x(this,"status",y,this),x(this,"activeThread",_,this),x(this,"meta",w,this),x(this,"chatableType",j,this),x(this,"chatableUrl",M,this),x(this,"autoJoinUsers",z,this),x(this,"allowChannelWideMentions",k,this),x(this,"membershipsCount",O,this),x(this,"archive",C,this),x(this,"tracking",S,this),x(this,"threadingEnabled",P,this),D(this,"threadsManager",new s.default((0,l.getOwner)(this))),D(this,"messagesManager",new o.default((0,l.getOwner)(this))),x(this,"_currentUserMembership",T,this),x(this,"_lastMessage",E,this),this.id=e.id,this.chatableId=e.chatable_id,this.chatableUrl=e.chatable_url,this.chatableType=e.chatable_type,this.membershipsCount=e.memberships_count,this.slug=e.slug,this.title=e.title,this.status=e.status,this.description=e.description,this.threadingEnabled=e.threading_enabled,this.autoJoinUsers=e.auto_join_users,this.allowChannelWideMentions=e.allow_channel_wide_mentions
this.chatable=this.isDirectMessageChannel?d.default.create({id:e.chatable?.id,users:e.chatable?.users}):p.default.create(e.chatable),this.currentUserMembership=e.current_user_membership,(e.archive_completed||e.archive_failed)&&(this.archive=h.default.create(e)),this.tracking=new m.default((0,l.getOwner)(this)),this.lastMessage=e.last_message,this.meta=e.meta}get unreadThreadsCountSinceLastViewed(){return Array.from(this.threadsManager.unreadThreadOverview.values()).filter((e=>e>=this.currentUserMembership.lastViewedAt)).length}updateLastViewedAt(){this.currentUserMembership.lastViewedAt=new Date}get canDeleteSelf(){return this.meta.can_delete_self}get canDeleteOthers(){return this.meta.can_delete_others}get canFlag(){return this.meta.can_flag}get userSilenced(){return this.meta.user_silenced}get canModerate(){return this.meta.can_moderate}get escapedTitle(){return(0,n.escapeExpression)(this.title)}get escapedDescription(){return(0,n.escapeExpression)(this.description)}get slugifiedTitle(){return this.slug||(0,a.default)(this)}get routeModels(){return[this.slugifiedTitle,this.id]}get isDirectMessageChannel(){return this.chatableType===A.directMessageChannel}get isCategoryChannel(){return this.chatableType===A.categoryChannel}get isOpen(){return!this.status||this.status===U.open}get isReadOnly(){return this.status===U.readOnly}get isClosed(){return this.status===U.closed}get isArchived(){return this.status===U.archived}get isJoinable(){return this.isOpen&&!this.isArchived}get isFollowing(){return this.currentUserMembership.following}get canJoin(){return this.meta.can_join_chat_channel}createStagedThread(e){const t=e.duplicate(),i=new u.default(this,{id:`staged-thread-${e.channel.id}-${e.id}`,original_message:e,staged:!0,created_at:moment.utc().format()})
return t.thread=i,t.manager=i.messagesManager,i.messagesManager.addMessages([t]),i}async stageMessage(e){e.id=(0,c.default)(),e.staged=!0,e.draft=!1,e.createdAt=new Date,e.channel=this,e.inReplyTo&&this.threadingEnabled||this.messagesManager.addMessages([e]),e.manager=this.messagesManager}canModifyMessages(e){return e.staff?!L.includes(this.status):!N.includes(this.status)}get currentUserMembership(){return this._currentUserMembership}set currentUserMembership(e){e instanceof t.default?this._currentUserMembership=e:this._currentUserMembership=t.default.create(e)}get lastMessage(){return this._lastMessage}set lastMessage(e){e?e instanceof i.default?this._lastMessage=e:this._lastMessage=i.default.create(this,e):this._lastMessage=null}},g=I(b.prototype,"title",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=I(b.prototype,"slug",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=I(b.prototype,"description",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=I(b.prototype,"status",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=I(b.prototype,"activeThread",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=I(b.prototype,"meta",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=I(b.prototype,"chatableType",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=I(b.prototype,"chatableUrl",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=I(b.prototype,"autoJoinUsers",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),k=I(b.prototype,"allowChannelWideMentions",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),O=I(b.prototype,"membershipsCount",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),C=I(b.prototype,"archive",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=I(b.prototype,"tracking",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=I(b.prototype,"threadingEnabled",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),T=I(b.prototype,"_currentUserMembership",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=I(b.prototype,"_lastMessage",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b)
e.default=R})),define("discourse/plugins/chat/discourse/models/chat-chatable",["exports","discourse/plugins/chat/discourse/models/chat-channel","discourse/models/user","@glimmer/tracking","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s,o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let m=(a=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static createUser(t){return new e({type:"user",model:t,identifier:`u-${t.id}`})}static createChannel(t){return new e({type:"channel",model:t,identifier:`c-${t.id}`})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
switch(h(this,"chatChannelsManager",s,this),h(this,"identifier",o,this),h(this,"type",l,this),h(this,"model",c,this),h(this,"enabled",u,this),h(this,"tracking",d,this),this.identifier=e.identifier,this.type=e.type,this.type){case"channel":if(1===e.model.chatable?.users?.length&&(this.enabled=e.model.chatable?.users[0].has_chat_enabled),e.model instanceof t.default){this.model=e.model
break}this.model=t.default.create(e.model)
break
case"user":if(this.enabled=e.model.has_chat_enabled,e.model instanceof i.default){this.model=e.model
break}this.model=i.default.create(e.model)}}get isUser(){return"user"===this.type}get isSingleUserChannel(){return"channel"===this.type&&1===this.model?.chatable?.users?.length}},s=p(a.prototype,"chatChannelsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=p(a.prototype,"identifier",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=p(a.prototype,"type",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=p(a.prototype,"model",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(a.prototype,"enabled",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),d=p(a.prototype,"tracking",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a)
e.default=m})),define("discourse/plugins/chat/discourse/models/chat-direct-message",["exports","discourse/models/user","@glimmer/tracking","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n){"use strict"
var r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let h=(o=new WeakSet,r=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
c(this,o),l(this,"id",a,this),l(this,"users",s,this),u(this,"type",n.CHATABLE_TYPES.directMessageChannel),this.id=e.id,this.users=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,o,p).call(this,e.users||[])}},a=d(r.prototype,"id",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=d(r.prototype,"users",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),r)
function p(e){return e.map((e=>!e||e instanceof t.default?e:t.default.create(e)))}e.default=h}))
define("discourse/plugins/chat/discourse/models/chat-message-mention-warning",["exports","@glimmer/tracking"],(function(e,t){"use strict"
var i,n,r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let u=(i=class e{static create(t){return new e(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
l(this,"invitationSent",n,this),l(this,"cannotSee",r,this),l(this,"withoutMembership",a,this),l(this,"groupsWithTooManyMembers",s,this),l(this,"groupWithMentionsDisabled",o,this),this.message=t.message,this.cannotSee=t.cannot_see,this.withoutMembership=t.without_membership,this.groupsWithTooManyMembers=t.groups_with_too_many_members,this.groupWithMentionsDisabled=t.group_mentions_disabled}},n=c(i.prototype,"invitationSent",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r=c(i.prototype,"cannotSee",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=c(i.prototype,"withoutMembership",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(i.prototype,"groupsWithTooManyMembers",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(i.prototype,"groupWithMentionsDisabled",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)
e.default=u})),define("discourse/plugins/chat/discourse/models/chat-message-reaction",["exports","@glimmer/tracking","discourse/models/user","@ember-compat/tracked-built-ins"],(function(e,t,i,n){"use strict"
var r,a,s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.REACTIONS=void 0
e.REACTIONS={add:"add",remove:"remove"}
let p=(c=new WeakSet,r=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
d(this,c),u(this,"count",a,this),u(this,"reacted",s,this),u(this,"users",o,this),u(this,"emoji",l,this),this.count=e.count,this.emoji=e.emoji,this.users=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,c,m).call(this,e.users),this.reacted=e.reacted}},a=h(r.prototype,"count",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),s=h(r.prototype,"reacted",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=h(r.prototype,"users",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=h(r.prototype,"emoji",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)
function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]
return new n.TrackedArray(e.map((e=>e instanceof i.default?e:i.default.create(e))))}e.default=p})),define("discourse/plugins/chat/discourse/models/chat-message",["exports","discourse/models/user","@glimmer/tracking","@ember-compat/tracked-built-ins","discourse/plugins/chat/discourse/models/chat-message-reaction","discourse/models/bookmark","I18n","discourse/lib/text","discourse/plugins/chat/discourse/lib/simple-category-hash-mention-transform","discourse-common/lib/get-owner","discourse-common/lib/later"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g,f,v,y,_,w,j,M,z,k,O,C,S,P,T,E,x,D,I,A,U,L,N,R,F,W,B,H,$,V,q,G,K,J,Y,Z
function X(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function Q(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function ee(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function te(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let ie=(q=new WeakSet,G=new WeakSet,K=new WeakSet,J=new WeakSet,Y=new WeakSet,Z=new WeakSet,V=class e{static create(t){return new e(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}static createDraftMessage(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return i.draft=!0,e.create(t,i)}constructor(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
Q(this,Z),Q(this,Y),Q(this,J),Q(this,K),Q(this,G),Q(this,q),X(this,"id",h,this),X(this,"error",p,this),X(this,"selected",m,this),X(this,"channel",b,this),X(this,"staged",g,this),X(this,"draftSaved",f,this),X(this,"draft",v,this),X(this,"createdAt",y,this),X(this,"uploads",_,this),X(this,"excerpt",w,this),X(this,"reactions",j,this),X(this,"reviewableId",M,this),X(this,"user",z,this),X(this,"inReplyTo",k,this),X(this,"expanded",O,this),X(this,"bookmark",C,this),X(this,"userFlagStatus",S,this),X(this,"hidden",P,this),X(this,"version",T,this),X(this,"edited",E,this),X(this,"editing",x,this),X(this,"chatWebhookEvent",D,this),X(this,"mentionWarning",I,this),X(this,"availableFlags",A,this)
X(this,"newest",U,this),X(this,"highlighted",L,this),X(this,"firstOfResults",N,this),X(this,"message",R,this),X(this,"manager",F,this),X(this,"deletedById",W,this),X(this,"_deletedAt",B,this),X(this,"_cooked",H,this),X(this,"_thread",$,this),this.id=i.id,this.channel=t,this.manager=i.manager,this.newest=i.newest||!1,this.draftSaved=i.draftSaved||i.draft_saved||!1,this.firstOfResults=i.firstOfResults||i.first_of_results||!1,this.staged=i.staged||!1,this.edited=i.edited||!1,this.editing=i.editing||!1,this.availableFlags=i.availableFlags||i.available_flags,this.hidden=i.hidden||!1,this.chatWebhookEvent=i.chatWebhookEvent||i.chat_webhook_event,this.createdAt=i.created_at?new Date(i.created_at):null,this.deletedById=i.deletedById||i.deleted_by_id,this._deletedAt=i.deletedAt||i.deleted_at,this.expanded=!this.hidden&&!this._deletedAt&&(i.expanded||!0),this.excerpt=i.excerpt,this.reviewableId=i.reviewableId||i.reviewable_id,this.userFlagStatus=i.userFlagStatus||i.user_flag_status,this.draft=i.draft,this.message=i.message||""
this._cooked=i.cooked||"",this.inReplyTo=i.inReplyTo||(i.in_reply_to||i.replyToMsg?e.create(t,i.in_reply_to||i.replyToMsg):null),this.reactions=ee(this,G,oe).call(this,i.reactions),this.uploads=new n.TrackedArray(i.uploads||[]),this.user=ee(this,J,ce).call(this,i.user),this.bookmark=i.bookmark?a.default.create(i.bookmark):null,this.mentionedUsers=ee(this,K,le).call(this,i.mentioned_users),i.thread&&(this.thread=i.thread)}duplicate(){const t=new e(this.channel,{id:this.id,newest:this.newest,staged:this.staged,edited:this.edited,availableFlags:this.availableFlags,hidden:this.hidden,chatWebhookEvent:this.chatWebhookEvent,createdAt:this.createdAt,deletedAt:this.deletedAt,excerpt:this.excerpt,reviewableId:this.reviewableId,userFlagStatus:this.userFlagStatus,draft:this.draft,message:this.message,cooked:this.cooked})
return t.reactions=this.reactions,t.user=this.user,t.inReplyTo=this.inReplyTo,t.bookmark=this.bookmark,t.uploads=this.uploads,t}get replyable(){return!this.staged&&!this.error}get editable(){return!this.staged&&!this.error}get thread(){return this._thread}set thread(e){this._thread=this.channel.threadsManager.add(this.channel,e,{replace:!0})}get deletedAt(){return this._deletedAt}set deletedAt(e){return this._deletedAt=e,this.incrementVersion(),this._deletedAt}get cooked(){return this._cooked}set cooked(e){e!==this._cooked&&(this._cooked=e,this.incrementVersion())}async cook(){const t=(0,c.getOwner)(this).lookup("service:site")
if(this.isDestroyed||this.isDestroying)return
const i={featuresOverride:t.markdown_additional_options?.chat?.limited_pretty_text_features,markdownItRules:t.markdown_additional_options?.chat?.limited_pretty_text_markdown_rules,hashtagTypesInPriorityOrder:t.hashtag_configurations?.["chat-composer"],hashtagIcons:t.hashtag_icons}
if(e.cookFunction)this.cooked=e.cookFunction(this.message)
else{const n=await(0,o.generateCookFunction)(i)
e.cookFunction=e=>(0,l.default)(n(e),t.categories),this.cooked=e.cookFunction(this.message)}}get read(){return this.channel.currentUserMembership?.lastReadMessageId>=this.id}get firstMessageOfTheDayAt(){return this.previousMessage&&ee(this,Y,ue).call(this,this.previousMessage.createdAt,this.createdAt)?void 0:ee(this,Z,de).call(this,this.createdAt)}get formattedFirstMessageDate(){if(this.firstMessageOfTheDayAt)return ee(this,q,se).call(this,this.firstMessageOfTheDayAt)}get index(){return this.manager?.messages?.indexOf(this)}get previousMessage(){return this.manager?.messages?.objectAt?.(this.index-1)}get nextMessage(){return this.manager?.messages?.objectAt?.(this.index+1)}highlight(){this.highlighted=!0,(0,u.default)((()=>{this.isDestroying||this.isDestroyed||(this.highlighted=!1)}),2e3)}incrementVersion(){this.version++}toJSONDraft(){if(0===this.message?.length&&0===this.uploads?.length&&!this.inReplyTo)return null
const e={}
return this.uploads?.length>0&&(e.uploads=this.uploads),this.message?.length>0&&(e.message=this.message),this.inReplyTo&&(e.replyToMsg={id:this.inReplyTo.id,excerpt:this.inReplyTo.excerpt,user:{id:this.inReplyTo.user.id,name:this.inReplyTo.user.name,avatar_template:this.inReplyTo.user.avatar_template,username:this.inReplyTo.user.username}}),this.editing&&(e.editing=!0,e.id=this.id,e.excerpt=this.excerpt),JSON.stringify(e)}react(e,t,i,n){const a=i.id===n,s=this.reactions.find((t=>t.emoji===e))
if(s)if("add"===t){if(a&&s.reacted)return
if(s.users.find((e=>e.id===i.id)))return
s.count=s.count+1,a&&(s.reacted=!0),s.users.pushObject(i)}else{const e=s.users.find((e=>e.id===i.id))
if(!e)return
a&&(s.reacted=!1),1===s.count?this.reactions.removeObject(s):(s.count=s.count-1,s.users.removeObject(e))}else"add"===t&&this.reactions.pushObject(r.default.create({count:1,emoji:e,reacted:a,users:[i]}))}},ne=V,ae=null,(re=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(re="cookFunction"))in ne?Object.defineProperty(ne,re,{value:ae,enumerable:!0,configurable:!0,writable:!0}):ne[re]=ae,h=te((d=V).prototype,"id",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=te(d.prototype,"error",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=te(d.prototype,"selected",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=te(d.prototype,"channel",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=te(d.prototype,"staged",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=te(d.prototype,"draftSaved",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=te(d.prototype,"draft",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=te(d.prototype,"createdAt",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=te(d.prototype,"uploads",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=te(d.prototype,"excerpt",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=te(d.prototype,"reactions",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=te(d.prototype,"reviewableId",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=te(d.prototype,"user",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=te(d.prototype,"inReplyTo",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=te(d.prototype,"expanded",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),C=te(d.prototype,"bookmark",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=te(d.prototype,"userFlagStatus",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=te(d.prototype,"hidden",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=te(d.prototype,"version",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),E=te(d.prototype,"edited",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=te(d.prototype,"editing",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=te(d.prototype,"chatWebhookEvent",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new n.TrackedObject}}),I=te(d.prototype,"mentionWarning",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=te(d.prototype,"availableFlags",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=te(d.prototype,"newest",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=te(d.prototype,"highlighted",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=te(d.prototype,"firstOfResults",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=te(d.prototype,"message",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=te(d.prototype,"manager",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=te(d.prototype,"deletedById",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=te(d.prototype,"_deletedAt",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=te(d.prototype,"_cooked",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=te(d.prototype,"_thread",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te(d.prototype,"firstMessageOfTheDayAt",[i.cached],Object.getOwnPropertyDescriptor(d.prototype,"firstMessageOfTheDayAt"),d.prototype),te(d.prototype,"formattedFirstMessageDate",[i.cached],Object.getOwnPropertyDescriptor(d.prototype,"formattedFirstMessageDate"),d.prototype),te(d.prototype,"index",[i.cached],Object.getOwnPropertyDescriptor(d.prototype,"index"),d.prototype),te(d.prototype,"previousMessage",[i.cached],Object.getOwnPropertyDescriptor(d.prototype,"previousMessage"),d.prototype),te(d.prototype,"nextMessage",[i.cached],Object.getOwnPropertyDescriptor(d.prototype,"nextMessage"),d.prototype),d)
var ne,re,ae
function se(e){return moment(e).calendar(moment(),{sameDay:`[${s.default.t("chat.chat_message_separator.today")}]`,lastDay:`[${s.default.t("chat.chat_message_separator.yesterday")}]`,lastWeek:"LL",sameElse:"LL"})}function oe(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((e=>r.default.create(e)))}function le(e){const i=new Map
return e&&e.forEach((e=>{const n=t.default.create(e)
i.set(n.id,n)})),i}function ce(e){return!e||e instanceof t.default?e:t.default.create(e)}function ue(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function de(e){return moment(e).startOf("day").format()}e.default=ie})),define("discourse/plugins/chat/discourse/models/chat-notice",["exports","@glimmer/tracking"],(function(e,t){"use strict"
var i,n,r
function a(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function s(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let o=(i=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
a(this,"channelId",n,this),a(this,"textContent",r,this),this.channelId=e.channel_id,this.textContent=e.text_content}},n=s(i.prototype,"channelId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=s(i.prototype,"textContent",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)
e.default=o})),define("discourse/plugins/chat/discourse/models/chat-thread-preview",["exports","@glimmer/tracking","@ember-compat/tracked-built-ins"],(function(e,t,i){"use strict"
var n,r,a,s,o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let p=(n=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
d(this,"replyCount",r,this),d(this,"lastReplyId",a,this),d(this,"lastReplyCreatedAt",s,this),d(this,"lastReplyExcerpt",o,this),d(this,"lastReplyUser",l,this),d(this,"participantCount",c,this),d(this,"participantUsers",u,this),e||(e={}),this.replyCount=e.reply_count||e.replyCount||0,this.lastReplyId=e.last_reply_id||e.lastReplyId,this.lastReplyCreatedAt=new Date(e.last_reply_created_at||e.lastReplyCreatedAt),this.lastReplyExcerpt=e.last_reply_excerpt||e.lastReplyExcerpt,this.lastReplyUser=e.last_reply_user||e.lastReplyUser,this.participantCount=e.participant_count||e.participantCount||0,this.participantUsers=new i.TrackedArray(e.participant_users||e.participantUsers||[])}get otherParticipantCount(){return this.participantCount-this.participantUsers.length}},r=h(n.prototype,"replyCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=h(n.prototype,"lastReplyId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=h(n.prototype,"lastReplyCreatedAt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=h(n.prototype,"lastReplyExcerpt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=h(n.prototype,"lastReplyUser",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(n.prototype,"participantCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(n.prototype,"participantUsers",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)
e.default=p})),define("discourse/plugins/chat/discourse/models/chat-thread",["exports","discourse-common/lib/get-owner","I18n","discourse/plugins/chat/discourse/lib/chat-messages-manager","discourse/lib/utilities","@glimmer/tracking","pretty-text/guid","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-tracking-state","discourse/plugins/chat/discourse/models/user-chat-thread-membership","discourse/plugins/chat/discourse/models/chat-thread-preview"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g,f,v,y,_,w,j,M
function z(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function k(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function O(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.THREAD_STATUSES=void 0
e.THREAD_STATUSES={open:"open",readOnly:"read_only",closed:"closed",archived:"archived"}
let C=(d=class e{static create(t){return new e(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}constructor(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
z(this,"id",h,this),z(this,"title",p,this),z(this,"status",m,this),z(this,"draft",b,this),z(this,"staged",g,this),z(this,"channel",f,this),z(this,"originalMessage",v,this),z(this,"threadMessageBusLastId",y,this),z(this,"replyCount",_,this),z(this,"tracking",w,this),z(this,"currentUserMembership",j,this),z(this,"preview",M,this),k(this,"messagesManager",new n.default((0,t.getOwner)(this))),this.id=r.id,this.channel=e,this.status=r.status,this.draft=r.draft,this.staged=r.staged,this.replyCount=r.reply_count,this.originalMessage=r.original_message?o.default.create(e,r.original_message):null,this.title=r.title||`${i.default.t("chat.thread.default_title",{thread_id:this.id})}`,r.current_user_membership&&(this.currentUserMembership=c.default.create(r.current_user_membership)),this.tracking=new l.default((0,t.getOwner)(this)),this.preview=u.default.create(r.preview)}async stageMessage(e){e.id=(0,s.default)(),e.staged=!0,e.draft=!1,e.createdAt??=moment.utc().format(),e.thread=this,this.messagesManager.addMessages([e]),e.manager=this.messagesManager}get routeModels(){return[...this.channel.routeModels,this.id]}get escapedTitle(){return(0,r.escapeExpression)(this.title)}},h=O(d.prototype,"id",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=O(d.prototype,"title",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=O(d.prototype,"status",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=O(d.prototype,"draft",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=O(d.prototype,"staged",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=O(d.prototype,"channel",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=O(d.prototype,"originalMessage",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=O(d.prototype,"threadMessageBusLastId",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=O(d.prototype,"replyCount",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=O(d.prototype,"tracking",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=O(d.prototype,"currentUserMembership",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=O(d.prototype,"preview",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d)
e.default=C})),define("discourse/plugins/chat/discourse/models/chat-tracking-state",["exports","@ember/application","@ember/service","@glimmer/tracking"],(function(e,t,i,n){"use strict"
var r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let u=(r=class{constructor(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
l(this,"chatTrackingStateManager",a,this),l(this,"_unreadCount",s,this),l(this,"_mentionCount",o,this),(0,t.setOwner)(this,e),this._unreadCount=i.unreadCount||0,this._mentionCount=i.mentionCount||0}reset(){this._unreadCount=0,this._mentionCount=0}get unreadCount(){return this._unreadCount}set unreadCount(e){this._unreadCount!==e&&(this._unreadCount=e,this.chatTrackingStateManager.triggerNotificationsChanged())}get mentionCount(){return this._mentionCount}set mentionCount(e){this._mentionCount!==e&&(this._mentionCount=e,this.chatTrackingStateManager.triggerNotificationsChanged())}},a=c(r.prototype,"chatTrackingStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"_unreadCount",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o=c(r.prototype,"_mentionCount",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r)
e.default=u})),define("discourse/plugins/chat/discourse/models/user-chat-channel-membership",["exports","@glimmer/tracking","discourse/models/user"],(function(e,t,i){"use strict"
var n,r,a,s,o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let b=(d=new WeakSet,n=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
p(this,d),h(this,"following",r,this),h(this,"muted",a,this),h(this,"desktopNotificationLevel",s,this),h(this,"mobileNotificationLevel",o,this),h(this,"lastReadMessageId",l,this),h(this,"lastViewedAt",c,this),h(this,"user",u,this),this.following=e.following,this.muted=e.muted,this.desktopNotificationLevel=e.desktop_notification_level,this.mobileNotificationLevel=e.mobile_notification_level,this.lastReadMessageId=e.last_read_message_id,this.lastViewedAt=new Date(e.last_viewed_at),this.user=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,d,g).call(this,e.user)}},r=m(n.prototype,"following",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),a=m(n.prototype,"muted",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=m(n.prototype,"desktopNotificationLevel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),o=m(n.prototype,"mobileNotificationLevel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l=m(n.prototype,"lastReadMessageId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=m(n.prototype,"lastViewedAt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),u=m(n.prototype,"user",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),n)
function g(e){return!e||e instanceof i.default?e:i.default.create(e)}e.default=b})),define("discourse/plugins/chat/discourse/models/user-chat-thread-membership",["exports","@glimmer/tracking","discourse/lib/notification-levels"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let l=(n=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
s(this,"lastReadMessageId",r,this),s(this,"notificationLevel",a,this),this.lastReadMessageId=e.last_read_message_id,this.notificationLevel=e.notification_level}get isQuiet(){return this.notificationLevel===i.NotificationLevels.REGULAR||this.notificationLevel===i.NotificationLevels.MUTED}},r=o(n.prototype,"lastReadMessageId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),a=o(n.prototype,"notificationLevel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),n)
e.default=l})),define("discourse/plugins/chat/discourse/modifiers/chat/emoji-picker-scroll-listener",["exports","ember-modifier","@ember/service","@ember/destroyable"],(function(e,t,i,n){"use strict"
var r,a
function s(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let o=(r=class extends t.default{constructor(e,t){var i,r,o,l
super(e,t),i=this,r="emojiPickerScrollObserver",l=this,(o=a)&&Object.defineProperty(i,r,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(l):void 0}),s(this,"element",null),(0,n.registerDestructor)(this,(e=>e.cleanup()))}modify(e){this.element=e,this.emojiPickerScrollObserver.observe(e)}cleanup(){this.emojiPickerScrollObserver.unobserve(this.element)}},l=r.prototype,c="emojiPickerScrollObserver",u=[i.inject],d={configurable:!0,enumerable:!0,writable:!0,initializer:null},p={},Object.keys(d).forEach((function(e){p[e]=d[e]})),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=u.slice().reverse().reduce((function(e,t){return t(l,c,e)||e}),p),h&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(h):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(l,c,p),p=null),a=p,r)
var l,c,u,d,h,p
e.default=o})),define("discourse/plugins/chat/discourse/modifiers/chat/later-fn",["exports","ember-modifier","@ember/destroyable","@ember/runloop","discourse-common/lib/later"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{constructor(e,t){super(e,t),(0,i.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i,n]=t
this.handler=(0,r.default)((()=>{i?.(e)}),n)}cleanup(){(0,n.cancel)(this.handler)}}e.default=a})),define("discourse/plugins/chat/discourse/modifiers/chat/on-animation-end",["exports","ember-modifier","@ember/destroyable","@ember/runloop","discourse-common/utils/decorators"],(function(e,t,i,n,r){"use strict"
var a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let s=(a=class extends t.default{constructor(e,t){super(e,t),(0,i.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i]=t
this.element=e,this.fn=i,this.handler=(0,n.schedule)("afterRender",(()=>{this.element.addEventListener("animationend",this.handleAnimationEnd)}))}handleAnimationEnd(){this.isDestroying||this.isDestroyed||this.fn?.(this.element)}cleanup(){(0,n.cancel)(this.handler),this.element?.removeEventListener("animationend",this.handleAnimationEnd)}},o=a.prototype,l="handleAnimationEnd",c=[r.bind],u=Object.getOwnPropertyDescriptor(a.prototype,"handleAnimationEnd"),d=a.prototype,h={},Object.keys(u).forEach((function(e){h[e]=u[e]})),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=c.slice().reverse().reduce((function(e,t){return t(o,l,e)||e}),h),d&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(d):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(o,l,h),h=null),a)
var o,l,c,u,d,h
e.default=s})),define("discourse/plugins/chat/discourse/modifiers/chat/on-long-press",["exports","ember-modifier","@ember/destroyable","@ember/service","discourse-common/utils/decorators","@ember/runloop","discourse-common/lib/later"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function h(e){e.stopPropagation()}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let p=(o=class extends t.default{constructor(e,t){super(e,t),u(this,"capabilities",l,this),u(this,"site",c,this),(0,i.registerDestructor)(this,(e=>e.cleanup()))}get enabled(){return this.capabilities.touch&&this.site.mobileView}modify(e,t){let[i,n,r]=t
this.enabled&&(this.element=e,this.onLongPressStart=i||(()=>{}),this.onLongPressEnd=n||(()=>{}),this.onLongPressCancel=r||(()=>{}),this.element.addEventListener("touchstart",this.handleTouchStart,{passive:!0}))}onCancel(){(0,a.cancel)(this.timeout),this.capabilities.touch&&(this.element.removeEventListener("touchmove",this.onCancel,{passive:!0}),this.element.removeEventListener("touchend",this.onCancel),this.element.removeEventListener("touchcancel",this.onCancel)),this.onLongPressCancel(this.element)}handleTouchStart(e){e.touches.length>1?this.onCancel():(this.onLongPressStart(this.element,e),this.element.addEventListener("touchmove",this.onCancel,{passive:!0}),this.element.addEventListener("touchend",this.onCancel),this.element.addEventListener("touchcancel",this.onCancel),this.timeout=(0,s.default)((()=>{this.isDestroying||this.isDestroyed||(this.element.addEventListener("touchend",h,{once:!0,passive:!0}),this.onLongPressEnd(this.element,e))}),400))}cleanup(){this.enabled&&(this.element.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),this.onCancel())}},l=d(o.prototype,"capabilities",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=d(o.prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(o.prototype,"onCancel",[r.bind],Object.getOwnPropertyDescriptor(o.prototype,"onCancel"),o.prototype),d(o.prototype,"handleTouchStart",[r.bind],Object.getOwnPropertyDescriptor(o.prototype,"handleTouchStart"),o.prototype),o)
e.default=p})),define("discourse/plugins/chat/discourse/modifiers/chat/on-resize",["exports","ember-modifier","@ember/destroyable","@ember/runloop"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{constructor(e,t){super(e,t),(0,i.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i,r={}]=t
this.resizeObserver=new ResizeObserver((e=>{this.throttleHandler=(0,n.throttle)(this,i,e,r.delay??0,r.immediate??!1)})),this.resizeObserver.observe(e)}cleanup(){(0,n.cancel)(this.throttleHandler),this.resizeObserver?.disconnect()}}e.default=r})),define("discourse/plugins/chat/discourse/modifiers/chat/on-scroll",["exports","ember-modifier","@ember/destroyable","@ember/runloop","discourse-common/utils/decorators"],(function(e,t,i,n,r){"use strict"
var a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let s=(a=class extends t.default{constructor(e,t){super(e,t),(0,i.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i,n]=t
this.element=e,this.callback=i,this.options=n,this.element.addEventListener("scroll",this.throttledCallback,{passive:!0})}throttledCallback(e){this.throttledHandler=(0,n.throttle)(this,this.callback,e,this.options.delay??100,this.options.immediate??!1)}cleanup(){(0,n.cancel)(this.throttledHandler),this.element.removeEventListener("scroll",this.throttledCallback)}},o=a.prototype,l="throttledCallback",c=[r.bind],u=Object.getOwnPropertyDescriptor(a.prototype,"throttledCallback"),d=a.prototype,h={},Object.keys(u).forEach((function(e){h[e]=u[e]})),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=c.slice().reverse().reduce((function(e,t){return t(o,l,e)||e}),h),d&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(d):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(o,l,h),h=null),a)
var o,l,c,u,d,h
e.default=s})),define("discourse/plugins/chat/discourse/modifiers/chat/resizable-node",["exports","ember-modifier","@ember/destroyable","discourse-common/utils/decorators","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s
function o(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let c=(a=class extends t.default{constructor(e,t){var n,r,a,l
super(e,t),n=this,r="capabilities",l=this,(a=s)&&Object.defineProperty(n,r,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(l):void 0}),o(this,"element",null),o(this,"resizerSelector",null),o(this,"didResizeContainer",null),o(this,"options",null),o(this,"_originalWidth",0),o(this,"_originalHeight",0),o(this,"_originalX",0),o(this,"_originalY",0),o(this,"_originalPageX",0),o(this,"_originalPageY",0),(0,i.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i,n,r={}]=t
this.resizerSelector=i,this.element=e,this.didResizeContainer=n,this.options=Object.assign({vertical:!0,horizontal:!0,position:!0,mutate:!0},r),this.capabilities.touch?this.element.querySelector(this.resizerSelector)?.addEventListener("touchstart",this._startResize):this.element.querySelector(this.resizerSelector)?.addEventListener("mousedown",this._startResize)}cleanup(){this.capabilities.touch?this.element.querySelector(this.resizerSelector)?.addEventListener("touchstart",this._startResize):this.element.querySelector(this.resizerSelector)?.removeEventListener("mousedown",this._startResize)}_startResize(e){e.preventDefault(),this._originalWidth=parseFloat(getComputedStyle(this.element,null).getPropertyValue("width").replace("px","")),this._originalHeight=parseFloat(getComputedStyle(this.element,null).getPropertyValue("height").replace("px","")),this._originalX=this.element.getBoundingClientRect().left,this._originalY=this.element.getBoundingClientRect().top,this._originalPageX=this._eventValueForProperty(e,"pageX"),this._originalPageY=this._eventValueForProperty(e,"pageY"),this.capabilities.touch?(window.addEventListener("touchmove",this._resize),window.addEventListener("touchend",this._stopResize)):(window.addEventListener("mousemove",this._resize),window.addEventListener("mouseup",this._stopResize))}_resize(e){let t=this._originalWidth,i=this._eventValueForProperty(e,"pageX")-this._originalPageX
t=document.documentElement.classList.contains("rtl")?Math.ceil(t+i):Math.ceil(t-i)
const n=Math.ceil(this._originalHeight-(this._eventValueForProperty(e,"pageY")-this._originalPageY)),r={}
this.options.horizontal&&t>20&&(r.width=t+"px",this.options.position&&(r.left=Math.ceil(this._originalX+(this._eventValueForProperty(e,"pageX")-this._originalPageX))+"px")),this.options.vertical&&n>20&&(r.height=n+"px",this.options.position&&(r.top=Math.ceil(this._originalY+(this._eventValueForProperty(e,"pageY")-this._originalPageY))+"px")),this.options.mutate&&Object.assign(this.element.style,r),this.didResizeContainer?.(this.element,{width:t,height:n})}_stopResize(){this.capabilities.touch?(window.removeEventListener("touchmove",this._resize),window.removeEventListener("touchend",this._stopResize)):(window.removeEventListener("mousemove",this._resize),window.removeEventListener("mouseup",this._stopResize))}_eventValueForProperty(e,t){return this.capabilities.touch?e.changedTouches[0][t]:e[t]}},s=l(a.prototype,"capabilities",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l(a.prototype,"_startResize",[n.bind],Object.getOwnPropertyDescriptor(a.prototype,"_startResize"),a.prototype),l(a.prototype,"_resize",[n.bind],Object.getOwnPropertyDescriptor(a.prototype,"_resize"),a.prototype),l(a.prototype,"_stopResize",[n.bind],Object.getOwnPropertyDescriptor(a.prototype,"_stopResize"),a.prototype),a)
e.default=c})),define("discourse/plugins/chat/discourse/modifiers/chat/scrollable-list",["exports","ember-modifier","@ember/destroyable","discourse-common/utils/decorators","@ember/runloop","discourse-common/lib/later"],(function(e,t,i,n,r,a){"use strict"
var s
function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l="down"
let c=(o((s=class extends t.default{constructor(e,t){super(e,t),(0,i.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i]=t
this.element=e,this.options=i,this.lastScrollTop=this.computeInitialScrollTop(),this.element.addEventListener("scroll",this.handleScroll,{passive:!0}),this.element.addEventListener("wheel",this.handleWheel,{passive:!0})}handleScroll(){this.throttleComputeScroll()}handleWheel(){this.throttleComputeScroll()}computeScroll(){const e=this.element.scrollTop
this.options.onScroll?.(this.computeState()),this.lastScrollTop=e}throttleComputeScroll(){(0,r.cancel)(this.scrollTimer),this.throttleTimer=(0,r.throttle)(this,this.computeScroll,50,!0),this.scrollTimer=(0,a.default)((()=>{this.options.onScrollEnd?.(this.computeState())}),this.options.delay||250)}cleanup(){(0,r.cancel)(this.scrollTimer),(0,r.cancel)(this.throttleTimer),this.element.removeEventListener("scroll",this.handleScroll),this.element.removeEventListener("wheel",this.handleWheel)}computeState(){const e=this.computeScrollDirection(),t=this.computeDistanceToBottom(),i=this.computeDistanceToTop()
return{up:"up"===e,down:e===l,distanceToBottom:t,distanceToTop:i,atBottom:t.pixels<=1,atTop:i.pixels<=1}}computeInitialScrollTop(){return this.options.reverse?this.element.scrollHeight-this.element.clientHeight:this.element.scrollTop}computeScrollTop(){return this.options.reverse?this.element.scrollHeight-this.element.clientHeight-this.element.scrollTop:this.element.scrollTop}computeDistanceToTop(){let e
const t=this.element.scrollHeight-this.element.clientHeight
return e=this.options.reverse?t-Math.abs(this.element.scrollTop):Math.abs(this.element.scrollTop),{pixels:e,percentage:Math.round(e/t*100)}}computeDistanceToBottom(){let e
const t=this.element.scrollHeight-this.element.clientHeight
return e=this.options.reverse?-this.element.scrollTop:t-Math.abs(this.element.scrollTop),{pixels:e,percentage:Math.round(e/t*100)}}computeScrollDirection(){return this.element.scrollTop===this.lastScrollTop?null:this.element.scrollTop<this.lastScrollTop?"up":l}}).prototype,"handleScroll",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"handleScroll"),s.prototype),o(s.prototype,"handleWheel",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"handleWheel"),s.prototype),o(s.prototype,"computeScroll",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"computeScroll"),s.prototype),s)
e.default=c})),define("discourse/plugins/chat/discourse/modifiers/chat/track-message-separator-date",["exports","ember-modifier","@ember/destroyable"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n="is-pinned"
class r extends t.default{constructor(e,t){super(e,t),(0,i.registerDestructor)(this,(e=>e.cleanup()))}modify(e){this.intersectionObserver=new IntersectionObserver((e=>{let[t]=e
t.isIntersecting&&t.intersectionRatio<1&&t.boundingClientRect.y<t.intersectionRect.y?t.target.classList.add(n):t.target.classList.remove(n)}),{threshold:[0,1]}),this.intersectionObserver.observe(e)}cleanup(){this.intersectionObserver?.disconnect()}}e.default=r})),define("discourse/plugins/chat/discourse/modifiers/chat/track-message",["exports","ember-modifier","@ember/destroyable","discourse-common/utils/decorators"],(function(e,t,i,n){"use strict"
var r
function a(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let s=(r=class extends t.default{constructor(e,t){super(e,t),a(this,"didEnterViewport",null),a(this,"didLeaveViewport",null),(0,i.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i,n]=t
this.didEnterViewport=i,this.didLeaveViewport=n,this.intersectionObserver=new IntersectionObserver(this._intersectionObserverCallback,{root:document,threshold:0}),this.intersectionObserver.observe(e)}cleanup(){this.intersectionObserver?.disconnect()}_intersectionObserverCallback(e){e.forEach((e=>{e.isIntersecting?this.didEnterViewport?.():this.didLeaveViewport?.()}))}},o=r.prototype,l="_intersectionObserverCallback",c=[n.bind],u=Object.getOwnPropertyDescriptor(r.prototype,"_intersectionObserverCallback"),d=r.prototype,h={},Object.keys(u).forEach((function(e){h[e]=u[e]})),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=c.slice().reverse().reduce((function(e,t){return t(o,l,e)||e}),h),d&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(d):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(o,l,h),h=null),r)
var o,l,c,u,d,h
e.default=s})),define("discourse/plugins/chat/discourse/pre-initializers/chat-plugin-api",["exports","discourse/lib/plugin-api","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/lib/chat-composer-buttons","discourse/plugins/chat/discourse/services/chat-state-manager","discourse/plugins/chat/discourse/lib/chat-message-interactor"],(function(e,t,i,n,r,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s={name:"chat-plugin-api",after:"inject-discourse-objects",initialize(){(0,t.withPluginApi)("1.2.0",(e=>{const t=Object.getPrototypeOf(e)
t.hasOwnProperty("decorateChatMessage")||Object.defineProperty(t,"decorateChatMessage",{value(e){(0,i.addChatMessageDecorator)(e)}}),t.hasOwnProperty("registerChatComposerButton")||Object.defineProperty(t,"registerChatComposerButton",{value(e){(0,n.registerChatComposerButton)(e)}}),t.hasOwnProperty("addChatDrawerStateCallback")||Object.defineProperty(t,"addChatDrawerStateCallback",{value(e){(0,r.addChatDrawerStateCallback)(e)}}),t.hasOwnProperty("sendChatMessage")||Object.defineProperty(t,"sendChatMessage",{async value(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return this.container.lookup("service:chat-api").sendMessage(e,{thread_id:t.threadId,message:t.message,uploads:t.uploads})}}),t.hasOwnProperty("removeChatComposerSecondaryActions")||Object.defineProperty(t,"removeChatComposerSecondaryActions",{value(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];(0,a.removeChatComposerSecondaryActions)(t)}})}))},teardown(){(0,i.resetChatMessageDecorators)()}}
e.default=s})),define("discourse/plugins/chat/discourse/preferences-chat-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var t={resource:"user.preferences",map(){this.route("chat")}}
e.default=t})),define("discourse/plugins/chat/discourse/routes/admin-plugins-chat",["exports","discourse/routes/discourse","@ember/object","discourse/plugins/chat/discourse/models/chat-channel","discourse/lib/ajax"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{model(){return this.currentUser?.admin?(0,r.ajax)("/admin/plugins/chat.json").then((e=>(e.incoming_chat_webhooks=e.incoming_chat_webhooks.map((e=>i.default.create(e))),e.chat_channels=e.chat_channels.map((e=>n.default.create(e))),e))):{model:null}}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-browse-archived",["exports","discourse/routes/discourse"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{afterModel(){this.siteSettings.chat_allow_archiving_channels||this.replaceWith("chat.browse")}}e.default=i})),define("discourse/plugins/chat/discourse/routes/chat-browse-index",["exports","discourse/routes/discourse","@ember/service","discourse/lib/utilities"],(function(e,t,i,n){"use strict"
var r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let u=(r=class extends t.default{constructor(){super(...arguments),l(this,"chat",a,this),l(this,"siteSettings",s,this),l(this,"router",o,this)}beforeModel(){if(!this.siteSettings.enable_public_channels)return this.router.transitionTo(`discovery.${(0,n.defaultHomepage)()}`)}activate(){this.chat.activeChannel=null}afterModel(){this.replaceWith("chat.browse.open")}},a=c(r.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"siteSettings",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(r.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)
e.default=u})),define("discourse/plugins/chat/discourse/routes/chat-channel-decorator",["exports","@ember/service"],(function(e,t){"use strict"
function i(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function n(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){var r,a,s,o
return r=class extends e{constructor(){super(...arguments),i(this,"chatChannelsManager",a,this),i(this,"chat",s,this),i(this,"router",o,this)}async model(e){return this.chatChannelsManager.find(e.channelId)}titleToken(){if(this.currentModel)return this.currentModel.isDirectMessageChannel?`${this.currentModel.title}`:`#${this.currentModel.title}`}afterModel(e){if(super.afterModel?.(...arguments),this.chat.activeChannel=e,!e)return this.router.replaceWith("chat")
let{messageId:t,channelTitle:i}=this.paramsFor(this.routeName)
if(t&&this.router.replaceWith("chat.channel",...e.routeModels,t),i&&i!==e.slugifiedTitle){t=this.paramsFor("chat.channel.near-message").messageId
const i=this.paramsFor("chat.channel.thread").threadId
if(i){const t=this.paramsFor("chat.channel.thread.near-message").messageId
t?this.router.replaceWith("chat.channel.thread.near-message",...e.routeModels,i,t):this.router.replaceWith("chat.channel.thread",...e.routeModels,i)}else t?this.router.replaceWith("chat.channel.near-message",...e.routeModels,t):this.router.replaceWith("chat.channel",...e.routeModels)}else this.controllerFor("chat-channel").set("targetMessageId",null)}},a=n(r.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=n(r.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=n(r.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r}})),define("discourse/plugins/chat/discourse/routes/chat-channel-info-about",["exports","discourse/routes/discourse"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{afterModel(e){e.isDirectMessageChannel&&this.replaceWith("chat.channel.info.index")}}e.default=i})),define("discourse/plugins/chat/discourse/routes/chat-channel-info-index",["exports","discourse/routes/discourse"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{afterModel(e){e.isDirectMessageChannel?e.isOpen&&e.membershipsCount>=1?this.replaceWith("chat.channel.info.members"):this.replaceWith("chat.channel.info.settings"):this.replaceWith("chat.channel.info.about")}}e.default=i})),define("discourse/plugins/chat/discourse/routes/chat-channel-info-members",["exports","discourse/routes/discourse"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{afterModel(e){return e.isOpen?e.membershipsCount<1?this.replaceWith("chat.channel.info"):void 0:this.replaceWith("chat.channel.info.settings")}}e.default=i})),define("discourse/plugins/chat/discourse/routes/chat-channel-info-settings",["exports","discourse/routes/discourse"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{afterModel(e){this.currentUser?.staff||e.currentUserMembership?.following||this.replaceWith("chat.channel.info")}}e.default=i})),define("discourse/plugins/chat/discourse/routes/chat-channel-info",["exports","discourse/routes/discourse","@ember/service","discourse/plugins/chat/discourse/services/chat-channel-info-route-origin-manager","discourse/plugins/chat/discourse/routes/chat-channel-decorator"],(function(e,t,i,n,r){"use strict"
var a,s,o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let l=(0,r.default)((s=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatChannelInfoRouteOriginManager",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}activate(e){const t=e?.from?.name
t&&(this.chatChannelInfoRouteOriginManager.origin=t.startsWith("chat.browse")?n.ORIGINS.browse:n.ORIGINS.channel)}deactivate(){this.chatChannelInfoRouteOriginManager.origin=null}},c=s.prototype,u="chatChannelInfoRouteOriginManager",d=[i.inject],h={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),o=m,a=s))||a
var c,u,d,h,p,m
e.default=l}))
define("discourse/plugins/chat/discourse/routes/chat-channel-legacy",["exports","discourse/routes/discourse","@ember/service"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let a=(n=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}redirect(){const{channelTitle:e,channelId:t,messageId:i}=this.paramsFor(this.routeName)
this.router.replaceWith("chat.channel",e,t,{queryParams:{messageId:i}})}},s=n.prototype,o="router",l=[i.inject],c={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),r=d,n)
var s,o,l,c,u,d
e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-channel-near-message",["exports","discourse/routes/discourse","@ember/service"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let a=(n=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}beforeModel(){const e=this.modelFor("chat-channel"),{messageId:t}=this.paramsFor(this.routeName)
this.controllerFor("chat-channel").set("messageId",null),(t||this.controllerFor("chat-channel").get("targetMessageId"))&&this.controllerFor("chat-channel").set("targetMessageId",t),this.router.replaceWith("chat.channel",...e.routeModels)}},s=n.prototype,o="router",l=[i.inject],c={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),r=d,n)
var s,o,l,c,u,d
e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-channel-thread-near-message",["exports","discourse/routes/discourse","@ember/service"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let a=(n=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}beforeModel(){const e=this.modelFor("chat-channel-thread"),{messageId:t}=this.paramsFor(this.routeName);(t||this.controllerFor("chat-channel-thread").get("targetMessageId"))&&this.controllerFor("chat-channel-thread").set("targetMessageId",t),this.router.replaceWith("chat.channel.thread",...e.routeModels)}},s=n.prototype,o="router",l=[i.inject],c={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),r=d,n)
var s,o,l,c,u,d
e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-channel-thread",["exports","discourse/routes/discourse","@ember/service","@ember/object"],(function(e,t,i,n){"use strict"
var r,a,s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let h=(r=class extends t.default{constructor(){super(...arguments),u(this,"router",a,this),u(this,"chatStateManager",s,this),u(this,"chat",o,this),u(this,"chatStagedThreadMapping",l,this),u(this,"chatThreadPane",c,this)}model(e,t){const i=this.modelFor("chat.channel")
return i.threadsManager.find(i.id,e.threadId).catch((()=>{t.abort(),this.chatStateManager.closeSidePanel(),this.router.transitionTo("chat.channel",...i.routeModels)}))}afterModel(e){this.chat.activeChannel.activeThread=e}willTransition(e){"chat.channel.index"!==e.targetName&&"chat.channel.near-message"!==e.targetName&&"chat.index"!==e.targetName||this.chatStateManager.closeSidePanel()}beforeModel(e){const t=this.modelFor("chat.channel")
if(!t.threadingEnabled)return e.abort(),void this.router.transitionTo("chat.channel",...t.routeModels)
const{threadId:i}=this.paramsFor(this.routeName)
if(i?.startsWith("staged-thread-")){const n=this.chatStagedThreadMapping.getMapping()
if(n[i])return e.abort(),this.router.transitionTo(this.routeName,...t.routeModels,n[i])}const{messageId:n}=this.paramsFor(this.routeName+".near-message")
!n&&this.controllerFor("chat-channel-thread").get("targetMessageId")&&this.controllerFor("chat-channel-thread").set("targetMessageId",null),this.chatStateManager.openSidePanel()}},a=d(r.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=d(r.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=d(r.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=d(r.prototype,"chatStagedThreadMapping",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=d(r.prototype,"chatThreadPane",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(r.prototype,"willTransition",[n.action],Object.getOwnPropertyDescriptor(r.prototype,"willTransition"),r.prototype),r)
e.default=h})),define("discourse/plugins/chat/discourse/routes/chat-channel-threads",["exports","discourse/routes/discourse","@ember/service","@ember/object"],(function(e,t,i,n){"use strict"
var r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let u=(r=class extends t.default{constructor(){super(...arguments),l(this,"router",a,this),l(this,"chatThreadListPane",s,this),l(this,"chatStateManager",o,this)}beforeModel(e){const t=this.modelFor("chat.channel")
if(!t.threadingEnabled)return e.abort(),void this.router.transitionTo("chat.channel",...t.routeModels)
this.chatStateManager.openSidePanel()}willTransition(e){"chat.channel.index"===e.targetName&&this.chatStateManager.closeSidePanel()}},a=c(r.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"chatThreadListPane",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(r.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(r.prototype,"willTransition",[n.action],Object.getOwnPropertyDescriptor(r.prototype,"willTransition"),r.prototype),r)
e.default=u})),define("discourse/plugins/chat/discourse/routes/chat-channel",["exports","discourse/routes/discourse","discourse/plugins/chat/discourse/routes/chat-channel-decorator"],(function(e,t,i){"use strict"
var n
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let r=(0,i.default)(n=class extends t.default{})||n
e.default=r})),define("discourse/plugins/chat/discourse/routes/chat-draft-channel",["exports","discourse/routes/discourse","@ember/service"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let l=(n=class extends t.default{constructor(){super(...arguments),s(this,"chat",r,this),s(this,"router",a,this)}beforeModel(){this.chat.userCanDirectMessage||this.router.transitionTo("chat")}activate(){this.chat.activeChannel=null}},r=o(n.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=o(n.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)
e.default=l})),define("discourse/plugins/chat/discourse/routes/chat-index",["exports","discourse/routes/discourse","@ember/service"],(function(e,t,i){"use strict"
var n,r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let c=(n=class extends t.default{constructor(){super(...arguments),o(this,"chat",r,this),o(this,"chatChannelsManager",a,this),o(this,"router",s,this)}activate(){this.chat.activeChannel=null}redirect(){if(this.site.mobileView)return
const e=this.chat.getIdealFirstChannelId()
return e?this.chatChannelsManager.find(e).then((e=>this.router.replaceWith("chat.channel",...e.routeModels))):this.router.replaceWith("chat.browse")}model(){if(this.site.mobileView)return this.chatChannelsManager.channels}},r=l(n.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=l(n.prototype,"chatChannelsManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=l(n.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)
e.default=c})),define("discourse/plugins/chat/discourse/routes/chat-message",["exports","discourse/routes/discourse","discourse/lib/ajax","discourse/lib/utilities","@ember/service"],(function(e,t,i,n,r){"use strict"
var a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let u=(a=class extends t.default{constructor(){super(...arguments),l(this,"chat",s,this),l(this,"router",o,this)}async model(e){return(0,i.ajax)(`/chat/message/${e.messageId}.json`).then((t=>{this.router.transitionTo("chat.channel.near-message",t.chat_channel_title,t.chat_channel_id,e.messageId)})).catch((()=>this.replaceWith("/404")))}beforeModel(){if(!this.chat.userCanChat)return this.router.transitionTo(`discovery.${(0,n.defaultHomepage)()}`)}},s=c(a.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(a.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a)
e.default=u})),define("discourse/plugins/chat/discourse/routes/chat",["exports","discourse/routes/discourse","I18n","discourse/lib/utilities","@ember/service","discourse/mixins/scroll-top","@ember/runloop"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let p=(o=class extends t.default{constructor(){super(...arguments),d(this,"chat",l,this),d(this,"router",c,this),d(this,"chatStateManager",u,this)}titleToken(){return i.default.t("chat.title_capitalized")}beforeModel(e){if(!this.chat.userCanChat)return this.router.transitionTo(`discovery.${(0,n.defaultHomepage)()}`)
if(e.from&&this.chatStateManager.isDrawerPreferred&&["chat.channel","chat.channel.thread","chat.channel.thread.index","chat.channel.thread.near-message","chat.channel.threads","chat.channel.index","chat.channel.near-message","chat.channel-legacy","chat","chat.index"].includes(e.targetName)){e.abort()
let t=e.intent.url
return e.targetName.startsWith("chat.channel")?t??=this.router.urlFor(e.targetName,...e.intent.contexts):t??=this.router.urlFor(e.targetName),void this.appEvents.trigger("chat:open-url",t)}this.appEvents.trigger("chat:toggle-close")}activate(){this.chatStateManager.storeAppURL(),this.chat.updatePresence(),(0,s.schedule)("afterRender",(()=>{document.body.classList.add("has-full-page-chat"),document.documentElement.classList.add("has-full-page-chat"),(0,a.scrollTop)()}))}deactivate(e){if(e){const t=this.router.urlFor(e.from.name)
this.chatStateManager.storeChatURL(t)}this.chat.activeChannel=null,this.chat.updatePresence(),(0,s.schedule)("afterRender",(()=>{document.body.classList.remove("has-full-page-chat"),document.documentElement.classList.remove("has-full-page-chat")}))}},l=h(o.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(o.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(o.prototype,"chatStateManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)
e.default=p})),define("discourse/plugins/chat/discourse/routes/preferences-chat",["exports","discourse/routes/restricted-user","discourse/lib/utilities","@ember/service"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let u=(r=class extends t.default{constructor(){super(...arguments),o(this,"chat",a,this),o(this,"router",s,this),l(this,"showFooter",!0)}setupController(e,t){if(!t?.can_chat&&!this.currentUser.admin)return this.router.transitionTo(`discovery.${(0,i.defaultHomepage)()}`)
e.set("model",t)}},a=c(r.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"router",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)
e.default=u})),define("discourse/plugins/chat/discourse/services/chat-admin-api",["exports","@ember/service","discourse/lib/ajax"],(function(e,t,i){"use strict"
function n(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var a=new WeakMap,s=new WeakSet
class o extends t.default{constructor(){var e,t
super(...arguments),n(e=this,t=s),t.add(e),function(e,t,i){n(e,t),t.set(e,i)}(this,a,{get:l,set:void 0})}async exportMessages(){await function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,s,c).call(this,"/export/messages")}}function l(){return"/chat/admin"}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${r(this,a)}${e}`,{type:"POST",data:t})}e.default=o})),define("discourse/plugins/chat/discourse/services/chat-api",["exports","@ember/service","discourse/lib/ajax","discourse/plugins/chat/discourse/models/user-chat-channel-membership","discourse/plugins/chat/discourse/lib/collection"],(function(e,t,i,n,r){"use strict"
var a,s,o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t){b(e,t),t.add(e)}function b(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function g(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function f(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function v(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let y=(l=new WeakMap,c=new WeakSet,u=new WeakSet,d=new WeakSet,h=new WeakSet,a=class extends t.default{constructor(){var e,t,i
super(...arguments),m(this,h),m(this,d),m(this,u),m(this,c),i={get:_,set:void 0},b(e=this,t=l),t.set(e,i),p(this,"chat",s,this),p(this,"chatChannelsManager",o,this)}channel(e){return f(this,c,w).call(this,`/channels/${e}`)}channelThreadMessages(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
return f(this,c,w).call(this,`/channels/${e}/threads/${t}/messages?${new URLSearchParams(i).toString()}`)}channelMessages(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,c,w).call(this,`/channels/${e}/messages?${new URLSearchParams(t).toString()}`)}thread(e,t){return f(this,c,w).call(this,`/channels/${e}/threads/${t}`)}threads(e,t){return new r.default(`${g(this,l)}/channels/${e}/threads`,t)}channels(){return new r.default(`${g(this,l)}/channels`,(e=>e.channels.map((e=>this.chatChannelsManager.store(e)))))}moveChannelMessages(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,d,M).call(this,`/channels/${e}/messages/moves`,{move:t})}destroyChannel(e){return f(this,h,z).call(this,`/channels/${e}`)}createChannel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return f(this,d,M).call(this,"/channels",{channel:e}).then((e=>this.chatChannelsManager.store(e.channel)))}categoryPermissions(e){return f(this,c,w).call(this,`/category-chatables/${e}/permissions`)}sendMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`/chat/${e}`,{ignoreUnsent:!1,type:"POST",data:t})}trashMessage(e,t){return f(this,h,z).call(this,`/channels/${e}/messages/${t}`)}createChannelArchive(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,d,M).call(this,`/channels/${e}/archives`,{archive:t})}updateChannel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,u,j).call(this,`/channels/${e}`,{channel:t})}updateChannelStatus(e,t){return f(this,u,j).call(this,`/channels/${e}/status`,{status:t})}listChannelMemberships(e){return new r.default(`${g(this,l)}/channels/${e}/memberships`,(e=>e.memberships.map((e=>n.default.create(e)))))}listCurrentUserChannels(){return f(this,c,w).call(this,"/channels/me")}followChannel(e){return f(this,d,M).call(this,`/channels/${e}/memberships/me`).then((e=>n.default.create(e.membership)))}unfollowChannel(e){return f(this,h,z).call(this,`/channels/${e}/memberships/me`).then((e=>n.default.create(e.membership)))}updateCurrentUserChannelNotificationsSettings(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,u,j).call(this,`/channels/${e}/notifications-settings/me`,{notifications_settings:t})}updateCurrentUserThreadNotificationsSettings(e,t,i){return f(this,u,j).call(this,`/channels/${e}/threads/${t}/notifications-settings/me`,{notification_level:i.notificationLevel})}saveDraft(e,t){return(0,i.ajax)("/chat/drafts",{type:"POST",data:{chat_channel_id:e,data:t},ignoreUnsent:!1}).then((()=>{this.chat.markNetworkAsReliable()})).catch((e=>{e.jqXHR?.responseJSON?.errors?.length||this.chat.markNetworkAsUnreliable()}))}publishReaction(e,t,n,r){return(0,i.ajax)(`/chat/${e}/react/${t}`,{type:"PUT",data:{react_action:r,emoji:n}})}restoreMessage(e,t){return f(this,u,j).call(this,`/channels/${e}/messages/${t}/restore`)}rebakeMessage(e,t){return(0,i.ajax)(`/chat/${e}/${t}/rebake`,{type:"PUT"})}editMessage(e,t,n){return(0,i.ajax)(`/chat/${e}/edit/${t}`,{type:"PUT",data:n})}markAllChannelsAsRead(){return f(this,u,j).call(this,"/channels/read")}chatables(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return f(this,c,w).call(this,"/chatables",e)}markChannelAsRead(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
return f(this,u,j).call(this,`/channels/${e}/read/${t}`)}markThreadAsRead(e,t){return f(this,u,j).call(this,`/channels/${e}/threads/${t}/read`)}editThread(e,t,i){return f(this,u,j).call(this,`/channels/${e}/threads/${t}`,i)}generateQuote(e,t){return(0,i.ajax)(`/chat/${e}/quote`,{type:"POST",data:{message_ids:t}})}invite(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
return(0,i.ajax)(`/chat/${e}/invite`,{type:"put",data:{user_ids:t,chat_message_id:n.messageId}})}summarize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,c,w).call(this,`/channels/${e}/summarize`,t)}},s=v(a.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=v(a.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a)
function _(){return"/chat/api"}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${g(this,l)}${e}`,{type:"GET",data:t})}function j(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${g(this,l)}${e}`,{type:"PUT",data:t})}function M(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${g(this,l)}${e}`,{type:"POST",data:t})}function z(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${g(this,l)}${e}`,{type:"DELETE",data:t})}e.default=y})),define("discourse/plugins/chat/discourse/services/chat-audio-manager",["exports","@ember/service","discourse-common/utils/decorators","discourse-common/config/environment","discourse-common/lib/get-url"],(function(e,t,i,n,r){"use strict"
var a,s
function o(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.CHAT_SOUNDS=void 0
const l={bell:[{src:"/plugins/chat/audio/bell.mp3",type:"audio/mpeg"}],ding:[{src:"/plugins/chat/audio/ding.mp3",type:"audio/mpeg"}]}
e.CHAT_SOUNDS=l
let c=(a=(0,i.debounce)(3e3,!0),s=class extends t.default{constructor(){super(...arguments),o(this,"_audioCache",{})}setup(){Object.keys(l).forEach((e=>{this._audioCache[e]=(e=>{const t=new Audio
return t.pause(),e.forEach((e=>{let{type:i,src:n}=e
const a=document.createElement("source")
a.type=i,a.src=(0,r.getURLWithCDN)(n),t.appendChild(a)})),t})(l[e])}))}willDestroy(){this._super(...arguments),this._audioCache={}}playImmediately(e){return this._play(e)}play(e){return this._play(e)}_play(e){const t=this._audioCache[e]||this._audioCache.bell
return t.muted=(0,n.isTesting)(),t.paused||(t.pause(),"function"==typeof t.fastSeek?t.fastSeek(0):t.currentTime=0),t.play().catch((()=>{(0,n.isTesting)()||console.info("[chat] User needs to interact with DOM before we can play notification sounds.")}))}},u=s.prototype,d="play",h=[a],p=Object.getOwnPropertyDescriptor(s.prototype,"play"),m=s.prototype,b={},Object.keys(p).forEach((function(e){b[e]=p[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=h.slice().reverse().reduce((function(e,t){return t(u,d,e)||e}),b),m&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(m):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(u,d,b),b=null),s)
var u,d,h,p,m,b
e.default=c})),define("discourse/plugins/chat/discourse/services/chat-channel-composer",["exports","@ember/service","@ember/object","discourse/plugins/chat/discourse/models/chat-message","@glimmer/tracking"],(function(e,t,i,n,r){"use strict"
var a,s,o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let b=(a=(0,t.inject)("chat-thread-composer"),s=class extends t.default{constructor(){super(...arguments),p(this,"chat",o,this),p(this,"currentUser",l,this),p(this,"router",c,this),p(this,"threadComposer",u,this),p(this,"message",d,this),p(this,"textarea",h,this)}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.textarea?.focus(e)}blur(){this.textarea.blur()}reset(e){this.message=n.default.createDraftMessage(e,{user:this.currentUser})}cancel(){this.message.editing?this.reset(this.message.channel):this.message.inReplyTo&&(this.message.inReplyTo=null),this.focus({ensureAtEnd:!0,refreshHeight:!0})}edit(e){this.chat.activeMessage=null,e.editing=!0,this.message=e,this.focus({refreshHeight:!0,ensureAtEnd:!0})}async replyTo(e){this.chat.activeMessage=null,e.channel.threadingEnabled?(e.thread?.id||(e.thread=e.channel.createStagedThread(e)),this.reset(e.channel),await this.router.transitionTo("chat.channel.thread",...e.thread.routeModels),this.threadComposer.focus({ensureAtEnd:!0,refreshHeight:!0})):(this.message.inReplyTo=e,this.focus({ensureAtEnd:!0,refreshHeight:!0}))}},o=m(s.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=m(s.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=m(s.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=m(s.prototype,"threadComposer",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(s.prototype,"message",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=m(s.prototype,"textarea",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m(s.prototype,"focus",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"focus"),s.prototype),m(s.prototype,"blur",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"blur"),s.prototype),m(s.prototype,"reset",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"reset"),s.prototype),m(s.prototype,"cancel",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"cancel"),s.prototype),m(s.prototype,"edit",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"edit"),s.prototype),m(s.prototype,"replyTo",[i.action],Object.getOwnPropertyDescriptor(s.prototype,"replyTo"),s.prototype),s)
e.default=b})),define("discourse/plugins/chat/discourse/services/chat-channel-emoji-picker-manager",["exports","discourse/plugins/chat/discourse/services/chat-emoji-picker-manager"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{}e.default=i})),define("discourse/plugins/chat/discourse/services/chat-channel-info-route-origin-manager",["exports","discourse/lib/key-value-store","@ember/service","@ember/utils"],(function(e,t,i,n){"use strict"
function r(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.ORIGINS=e.INFO_ROUTE_NAMESPACE=e.BACK_KEY=void 0
const a="back"
e.BACK_KEY=a
const s="discourse_chat_info_route"
e.INFO_ROUTE_NAMESPACE=s
const o={channel:"channel",browse:"browse"}
e.ORIGINS=o
class l extends i.default{constructor(){super(...arguments),r(this,"store",new t.default(s))}get origin(){const e=this.store.getObject(a)
if(e)return o[e]}set origin(e){this.store.setObject({key:a,value:e})}get isBrowse(){return this.origin===o.browse}get isChannel(){return this.origin===o.channel||(0,n.isEmpty)(this.origin)}}e.default=l})),define("discourse/plugins/chat/discourse/services/chat-channel-pane-subscriptions-manager",["exports","@ember/service","@glimmer/tracking","@ember-compat/tracked-built-ins","discourse/plugins/chat/discourse/services/chat-pane-base-subscriptions-manager","discourse/plugins/chat/discourse/models/chat-thread-preview","discourse/plugins/chat/discourse/models/chat-notice"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let p=(o=class extends r.default{constructor(){super(...arguments),d(this,"chat",l,this),d(this,"currentUser",c,this),d(this,"notices",u,this)}get messageBusChannel(){return`/chat/${this.model.id}`}get messageBusLastId(){return this.model.channelMessageBusLastId}handleSentMessage(){}handleNotice(e){this.notices.push(s.default.create(e))}clearNotice(e){const t=this.notices.indexOf(e)
t>-1&&this.notices.splice(t,1)}handleThreadOriginalMessageUpdate(e){const t=this.messagesManager.findMessage(e.original_message_id)
t?.thread&&(t.thread.preview=a.default.create(e.preview))}_afterDeleteMessage(e,t){this.model.currentUserMembership.lastReadMessageId===e.id&&(this.model.currentUserMembership.lastReadMessageId=t.latest_not_deleted_message_id)}},l=h(o.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(o.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(o.prototype,"notices",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new n.TrackedArray}}),o)
e.default=p})),define("discourse/plugins/chat/discourse/services/chat-channel-pane",["exports","@glimmer/tracking","@ember/object","@ember/service"],(function(e,t,i,n){"use strict"
var r,a,s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let h=(r=class extends n.default{constructor(){super(...arguments),u(this,"chat",a,this),u(this,"reacting",s,this),u(this,"selectingMessages",o,this),u(this,"lastSelectedMessage",l,this),u(this,"sending",c,this)}get channel(){return this.chat.activeChannel}get selectedMessageIds(){return this.channel.messagesManager.selectedMessages.mapBy("id")}cancelSelecting(){this.selectingMessages=!1,this.channel.messagesManager.clearSelectedMessages()}onSelectMessage(e){this.lastSelectedMessage=e,this.selectingMessages=!0}},a=d(r.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=d(r.prototype,"reacting",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=d(r.prototype,"selectingMessages",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=d(r.prototype,"lastSelectedMessage",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=d(r.prototype,"sending",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d(r.prototype,"cancelSelecting",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"cancelSelecting"),r.prototype),d(r.prototype,"onSelectMessage",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"onSelectMessage"),r.prototype),r)
e.default=h})),define("discourse/plugins/chat/discourse/services/chat-channels-manager",["exports","@ember/service","discourse-common/utils/decorators","rsvp","discourse/plugins/chat/discourse/models/chat-channel","@glimmer/tracking","@ember-compat/tracked-built-ins","discourse/lib/ajax-error"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h,p,m,b,g,f
function v(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function y(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function _(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function w(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let j=(l=(0,i.debounce)(300),m=new WeakSet,b=new WeakSet,g=new WeakSet,f=new WeakSet,c=class extends t.default{constructor(){super(...arguments),y(this,f),y(this,g),y(this,b),y(this,m),v(this,"chatSubscriptionsManager",u,this),v(this,"chatApi",d,this),v(this,"currentUser",h,this),v(this,"_cached",p,this)}async find(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fetchIfNotFound:!0}
const i=_(this,g,k).call(this,e)
return i?n.default.resolve(i):t.fetchIfNotFound?_(this,m,M).call(this,e):n.default.resolve()}get channels(){return Object.values(this._cached)}store(e){let t
return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).replace||(t=_(this,g,k).call(this,e.id)),t||(t=e instanceof r.default?e:r.default.create(e),_(this,b,z).call(this,t)),void 0!==e.meta?.message_bus_last_ids?.channel_message_bus_last_id&&(t.channelMessageBusLastId=e.meta.message_bus_last_ids.channel_message_bus_last_id),t}async follow(e){return this.chatSubscriptionsManager.startChannelSubscription(e),e.currentUserMembership.following?e:this.chatApi.followChannel(e.id).then((t=>(e.currentUserMembership=t,e)))}async unfollow(e){return this.chatSubscriptionsManager.stopChannelSubscription(e),this.chatApi.unfollowChannel(e.id).then((t=>(e.currentUserMembership=t,e)))}async markAllChannelsRead(){return this.chatApi.markAllChannelsAsRead()}remove(e){this.chatSubscriptionsManager.stopChannelSubscription(e),delete this._cached[e.id]}get allChannels(){return[...this.publicMessageChannels,...this.directMessageChannels].sort(((e,t)=>t?.currentUserMembership?.lastViewedAt?.localeCompare?.(e?.currentUserMembership?.lastViewedAt)))}get publicMessageChannels(){return this.channels.filter((e=>e.isCategoryChannel&&e.currentUserMembership.following)).sort(((e,t)=>e?.slug?.localeCompare?.(t?.slug)))}get directMessageChannels(){return _(this,f,O).call(this,this.channels.filter((e=>{const t=e.currentUserMembership
return e.isDirectMessageChannel&&t.following})))}get truncatedDirectMessageChannels(){return this.directMessageChannels.slice(0,20)}},u=w(c.prototype,"chatSubscriptionsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=w(c.prototype,"chatApi",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=w(c.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=w(c.prototype,"_cached",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new s.TrackedObject}}),w(c.prototype,"markAllChannelsRead",[l],Object.getOwnPropertyDescriptor(c.prototype,"markAllChannelsRead"),c.prototype),c)
async function M(e){return this.chatApi.channel(e).catch(o.popupAjaxError).then((e=>this.store(e.channel)))}function z(e){e&&(this._cached[e.id]=e)}function k(e){return this._cached[e]}function O(e){return e.sort(((e,t)=>e.lastMessage?t.lastMessage?e.tracking.unreadCount===t.tracking.unreadCount?new Date(e.lastMessage.createdAt)>new Date(t.lastMessage.createdAt)?-1:1:e.tracking.unreadCount>t.tracking.unreadCount?-1:1:-1:1))}e.default=j})),define("discourse/plugins/chat/discourse/services/chat-composer-presence-manager",["exports","@ember/service","@ember/runloop","discourse-common/config/environment"],(function(e,t,i,n){"use strict"
var r,a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let s=(r=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="presence",n=this,(i=a)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}willDestroy(){this.leave()}notifyState(e,t){t?(this._channelName!==e&&(this._enter(e),this._channelName=e),(0,n.isTesting)()||(this._autoLeaveTimer=(0,i.debounce)(this,this.leave,1e4))):this.leave()}leave(){this._presentChannel?.leave(),this._presentChannel=null,this._channelName=null,this._autoLeaveTimer&&((0,i.cancel)(this._autoLeaveTimer),this._autoLeaveTimer=null)}_enter(e){this.leave(),this._presentChannel=this.presence.getChannel(e),this._presentChannel.enter()}},o=r.prototype,l="presence",c=[t.inject],u={configurable:!0,enumerable:!0,writable:!0,initializer:null},h={},Object.keys(u).forEach((function(e){h[e]=u[e]})),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=c.slice().reverse().reduce((function(e,t){return t(o,l,e)||e}),h),d&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(d):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(o,l,h),h=null),a=h,r)
var o,l,c,u,d,h
e.default=s})),define("discourse/plugins/chat/discourse/services/chat-composer-warnings-tracker",["exports","@ember/service","discourse/lib/ajax","discourse-common/lib/debounce","discourse-common/utils/decorators","pretty-text/mentions","@ember/runloop","@glimmer/tracking"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const v=-1,y=0,_=1
let w=(l=class extends t.default{constructor(){super(...arguments),b(this,"siteSettings",c,this),b(this,"unreachableGroupMentions",u,this),b(this,"overMembersLimitGroupMentions",d,this),b(this,"tooManyMentions",h,this),b(this,"mentionsCount",p,this),b(this,"mentionsTimer",m,this),g(this,"_mentionWarningsSeen",{})}willDestroy(){(0,s.cancel)(this.mentionsTimer)}trackMentions(e){this.mentionsTimer=(0,n.default)(this,this._trackMentions,e,1e3)}_trackMentions(e){if(!this.siteSettings.enable_mentions)return
const t=this._extractMentions(e)
if(this.mentionsCount=t?.length,this.mentionsCount>0){if(this.tooManyMentions=this.mentionsCount>this.siteSettings.max_mentions_per_chat_message,!this.tooManyMentions){const e=t.filter((e=>!(e in this._mentionWarningsSeen)))
e?.length>0?this._recordNewWarnings(e,t):this._rebuildWarnings(t)}}else this.tooManyMentions=!1,this.unreachableGroupMentions=[],this.overMembersLimitGroupMentions=[]}_extractMentions(e){const t=(0,a.mentionRegex)(this.siteSettings.unicode_usernames),i=[]
let n=!0
for(;n;){const r=e.match(t)
if(r){const t=r[1]||r[2]
i.push(t),e=e.replaceAll(`${t}`,""),i.length>this.siteSettings.max_mentions_per_chat_message&&(n=!1)}else n=!1}return i}_recordNewWarnings(e,t){(0,i.ajax)("/chat/api/mentions/groups.json",{data:{mentions:e}}).then((e=>{e.unreachable.forEach((e=>{this._mentionWarningsSeen[e]=y})),e.over_members_limit.forEach((e=>{this._mentionWarningsSeen[e]=_})),e.invalid.forEach((e=>{this._mentionWarningsSeen[e]=v})),this._rebuildWarnings(t)})).catch(this._rebuildWarnings(t))}_rebuildWarnings(e){const t=e.reduce(((e,t)=>(t in this._mentionWarningsSeen&&this._mentionWarningsSeen[t]!==v&&(this._mentionWarningsSeen[t]===y?e[0].push(t):e[1].push(t)),e)),[[],[]])
this.unreachableGroupMentions=t[0],this.overMembersLimitGroupMentions=t[1]}},c=f(l.prototype,"siteSettings",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=f(l.prototype,"unreachableGroupMentions",[o.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),d=f(l.prototype,"overMembersLimitGroupMentions",[o.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),h=f(l.prototype,"tooManyMentions",[o.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=f(l.prototype,"mentionsCount",[o.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),m=f(l.prototype,"mentionsTimer",[o.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f(l.prototype,"trackMentions",[r.bind],Object.getOwnPropertyDescriptor(l.prototype,"trackMentions"),l.prototype),f(l.prototype,"_trackMentions",[r.bind],Object.getOwnPropertyDescriptor(l.prototype,"_trackMentions"),l.prototype),l)
e.default=w})),define("discourse/plugins/chat/discourse/services/chat-drafts-manager",["exports","@ember/service","discourse/plugins/chat/discourse/models/chat-message"],(function(e,t,i){"use strict"
function n(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{constructor(){super(...arguments),n(this,"drafts",{})}add(e){if(!(e instanceof i.default))throw new Error("message must be an instance of ChatMessage")
this.drafts[e.channel.id]=e}get(e){let{channelId:t}=e
return this.drafts[t]}remove(e){let{channelId:t}=e
delete this.drafts[t]}reset(){this.drafts={}}}e.default=r})),define("discourse/plugins/chat/discourse/services/chat-drawer-router",["exports","@ember/service","@glimmer/tracking","discourse/plugins/chat/discourse/components/chat-drawer/channel","discourse/plugins/chat/discourse/components/chat-drawer/thread","discourse/plugins/chat/discourse/components/chat-drawer/threads","discourse/plugins/chat/discourse/components/chat-drawer/index"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b={"chat.channel":{name:n.default},"chat.channel.thread":{name:r.default,extractParams:e=>({channelId:e.parent.params.channelId,threadId:e.params.threadId})},"chat.channel.thread.index":{name:r.default,extractParams:e=>({channelId:e.parent.params.channelId,threadId:e.params.threadId})},"chat.channel.thread.near-message":{name:r.default,extractParams:e=>({channelId:e.parent.parent.params.channelId,threadId:e.parent.params.threadId,messageId:e.params.messageId})},"chat.channel.threads":{name:a.default,extractParams:e=>({channelId:e.parent.params.channelId})},chat:{name:s.default},"chat.channel.near-message":{name:n.default,extractParams:e=>({channelId:e.parent.params.channelId,messageId:e.params.messageId})},"chat.channel-legacy":{name:n.default,extractParams:e=>({channelId:e.params.channelId,messageId:e.queryParams.messageId})}}
let g=(o=class extends t.default{constructor(){super(...arguments),p(this,"router",l,this),p(this,"chatHistory",c,this),p(this,"component",u,this),p(this,"drawerRoute",d,this),p(this,"params",h,this)}stateFor(e){this.drawerRoute?.deactivate?.(this.chatHistory.currentRoute),this.chatHistory.visit(e),this.drawerRoute=b[e.name],this.params=this.drawerRoute?.extractParams?.(e)||e.params,this.component=this.drawerRoute?.name||s.default,this.drawerRoute.activate?.(e)}},l=m(o.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=m(o.prototype,"chatHistory",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=m(o.prototype,"component",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=m(o.prototype,"drawerRoute",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=m(o.prototype,"params",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),o)
e.default=g})),define("discourse/plugins/chat/discourse/services/chat-drawer-size",["exports","@ember/service","discourse/lib/key-value-store"],(function(e,t,i){"use strict"
function n(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function r(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s=new WeakSet
class o extends t.default{constructor(){super(...arguments),n(this,s),r(this,"STORE_NAMESPACE","discourse_chat_drawer_size_"),r(this,"MIN_HEIGHT",300),r(this,"MIN_WIDTH",250),r(this,"store",new i.default(this.STORE_NAMESPACE))}get size(){return{width:this.store.getObject("width")||400,height:this.store.getObject("height")||530}}set size(e){let{width:t,height:i}=e
this.store.setObject({key:"width",value:a(this,s,l).call(this,t,this.MIN_WIDTH)}),this.store.setObject({key:"height",value:a(this,s,l).call(this,i,this.MIN_HEIGHT)})}}function l(e,t){return Math.max(e,t)}e.default=o})),define("discourse/plugins/chat/discourse/services/chat-emoji-picker-manager",["exports","@glimmer/tracking","discourse/lib/ajax","discourse/lib/ajax-error","discourse-common/utils/decorators","@ember/runloop","discourse-common/lib/helpers","rsvp","discourse-common/config/environment","@ember/object","@ember/service"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g,f,v,y
function _(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function w(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const j=(0,l.isTesting)()?0:125,M=["favorites","smileys_&_emotion"],z="favorites"
let k=(d=class extends u.default{constructor(){super(...arguments),_(this,"appEvents",h,this),_(this,"closing",p,this),_(this,"loading",m,this),_(this,"picker",b,this),_(this,"emojis",g,this),_(this,"visibleSections",f,this),_(this,"lastVisibleSection",v,this),_(this,"element",y,this)}get sections(){return!this.loading&&this.emojis?Object.keys(this.emojis):[]}closeExisting(){this.visibleSections=M,this.lastVisibleSection=z,this.picker=null}close(){this.closing=!0,(0,a.later)((()=>{this.isDestroyed||this.isDestroying||(this.visibleSections=M,this.lastVisibleSection=z,this.closing=!1,this.picker=null)}),j)}addVisibleSections(e){this.visibleSections=(0,s.makeArray)(this.visibleSections).concat((0,s.makeArray)(e)).uniq()}open(e){this.loadEmojis(),this.picker?this.picker.trigger===e.trigger?this.closeExisting():(this.closeExisting(),this.picker=e):this.picker=e}loadEmojis(){return this.emojis?o.Promise.resolve():(this.loading=!0,(0,i.ajax)("/chat/emojis.json").then((e=>{this.emojis=e})).catch(n.popupAjaxError).finally((()=>{this.loading=!1})))}},h=w(d.prototype,"appEvents",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=w(d.prototype,"closing",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m=w(d.prototype,"loading",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b=w(d.prototype,"picker",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=w(d.prototype,"emojis",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=w(d.prototype,"visibleSections",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M}}),v=w(d.prototype,"lastVisibleSection",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return z}}),y=w(d.prototype,"element",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w(d.prototype,"closeExisting",[r.bind],Object.getOwnPropertyDescriptor(d.prototype,"closeExisting"),d.prototype),w(d.prototype,"close",[r.bind],Object.getOwnPropertyDescriptor(d.prototype,"close"),d.prototype),w(d.prototype,"loadEmojis",[c.action],Object.getOwnPropertyDescriptor(d.prototype,"loadEmojis"),d.prototype),d)
e.default=k})),define("discourse/plugins/chat/discourse/services/chat-emoji-reaction-store",["exports","discourse/lib/key-value-store","@ember/service"],(function(e,t,i){"use strict"
function n(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends i.default{constructor(){super(...arguments),n(this,"STORE_NAMESPACE","discourse_chat_emoji_reaction_"),n(this,"MAX_DISPLAYED_EMOJIS",20),n(this,"MAX_TRACKED_EMOJIS",2*this.MAX_DISPLAYED_EMOJIS),n(this,"SKIN_TONE_STORE_KEY","emojiSelectedDiversity"),n(this,"USER_EMOJIS_STORE_KEY","emojiUsage"),n(this,"store",new t.default(this.STORE_NAMESPACE)),this.store.getObject(this.USER_EMOJIS_STORE_KEY)||(this.storedFavorites=[])}get diversity(){return this.store.getObject(this.SKIN_TONE_STORE_KEY)||1}set diversity(e){void 0===e&&(e=1),this.store.setObject({key:this.SKIN_TONE_STORE_KEY,value:e}),this.notifyPropertyChange("diversity")}get storedFavorites(){let e=this.store.getObject(this.USER_EMOJIS_STORE_KEY)||[]
return e.length<1&&(e=this.siteSettings.default_emoji_reactions?this.siteSettings.default_emoji_reactions.split("|").filter(Boolean):[],this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:e})),e}set storedFavorites(e){this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:e}),this.notifyPropertyChange("favorites")}get favorites(){return[...new Set(this._frequencySort(this.storedFavorites))].slice(0,this.MAX_DISPLAYED_EMOJIS)}set favorites(e){void 0===e&&(e=[]),this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:e})}track(e){const t=e.replace(/(^:)|(:$)/g,"")
let i=this.storedFavorites
i.unshift(t),i.length=Math.min(i.length,this.MAX_TRACKED_EMOJIS),this.storedFavorites=i}reset(){this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:[]}),this.store.setObject({key:this.SKIN_TONE_STORE_KEY,value:1})}_frequencySort(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{})
return Object.keys(e).sort(((t,i)=>e[i]-e[t]))}}e.default=r})),define("discourse/plugins/chat/discourse/services/chat-guardian",["exports","@ember/service"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{canEditChatChannel(){return this.canUseChat()&&this.currentUser.staff}canArchiveChannel(e){return this.canEditChatChannel()&&this.siteSettings.chat_allow_archiving_channels&&!e.isArchived&&!e.isReadOnly}canUseChat(){return this.currentUser?.has_chat_enabled&&this.siteSettings?.chat_enabled}}e.default=i})),define("discourse/plugins/chat/discourse/services/chat-history",["exports","@ember/service","@glimmer/tracking"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let a=(n=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="history",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get previousRoute(){if(this.history?.length>1)return this.history[this.history.length-2]}get currentRoute(){if(this.history?.length>0)return this.history[this.history.length-1]}visit(e){this.history=(this.history||[]).slice(-9).concat([e])}},s=n.prototype,o="history",l=[i.tracked],c={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),r=d,n)
var s,o,l,c,u,d
e.default=a})),define("discourse/plugins/chat/discourse/services/chat-notification-manager",["exports","@ember/service","discourse/lib/plugin-api","discourse-common/config/environment","discourse/lib/desktop-notifications","discourse-common/utils/decorators"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let p=(s=class extends t.default{constructor(){super(...arguments),u(this,"presence",o,this),u(this,"chat",l,this),u(this,"chatStateManager",c,this),d(this,"_subscribedToCore",!0),d(this,"_subscribedToChat",!1),d(this,"_countChatInDocTitle",!0)}start(){this._shouldRun()&&(this.set("_chatPresenceChannel",this.presence.getChannel(`/chat-user/chat/${this.currentUser.id}`)),this.set("_corePresenceChannel",this.presence.getChannel(`/chat-user/core/${this.currentUser.id}`)),this._chatPresenceChannel.subscribe(),this._corePresenceChannel.subscribe(),(0,i.withPluginApi)("0.12.1",(e=>{e.onPageChange(this._pageChanged)})),this._pageChanged(),this._chatPresenceChannel.on("change",this._subscribeToCorrectNotifications),this._corePresenceChannel.on("change",this._subscribeToCorrectNotifications))}willDestroy(){super.willDestroy(...arguments),this._shouldRun()&&(this._chatPresenceChannel.off("change",this._subscribeToCorrectNotifications),this._chatPresenceChannel.unsubscribe(),this._chatPresenceChannel.leave(),this._corePresenceChannel.off("change",this._subscribeToCorrectNotifications),this._corePresenceChannel.unsubscribe(),this._corePresenceChannel.leave())}shouldCountChatInDocTitle(){return this._countChatInDocTitle}_pageChanged(){this.chatStateManager.isActive?(this._chatPresenceChannel.enter({onlyWhileActive:!1}),this._corePresenceChannel.leave()):(this._chatPresenceChannel.leave(),this._corePresenceChannel.enter({onlyWhileActive:!1}))}_coreAlertChannel(){return(0,r.alertChannel)(this.currentUser)}_chatAlertChannel(){return`/chat${(0,r.alertChannel)(this.currentUser)}`}_subscribeToCorrectNotifications(){this._chatPresenceChannel.count>0&&this._corePresenceChannel.count>0?this.chatStateManager.isActive?this._subscribeToChat({only:!0}):this._subscribeToCore({only:!0}):this._subscribeToBoth()}_subscribeToBoth(){this._subscribeToChat(),this._subscribeToCore()}_subscribeToChat(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{only:!1}
this.set("_countChatInDocTitle",!0),this._subscribedToChat||(this.messageBus.subscribe(this._chatAlertChannel(),this.onMessage),this.set("_subscribedToChat",!0)),e.only&&this._subscribedToCore&&(this.messageBus.unsubscribe(this._coreAlertChannel(),this.onMessage),this.set("_subscribedToCore",!1))}_subscribeToCore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{only:!1}
e.only&&this.set("_countChatInDocTitle",!1),this._subscribedToCore||(this.messageBus.subscribe(this._coreAlertChannel(),this.onMessage),this.set("_subscribedToCore",!0)),e.only&&this._subscribedToChat&&(this.messageBus.unsubscribe(this._chatAlertChannel(),this.onMessage),this.set("_subscribedToChat",!1))}onMessage(e){return(0,r.onNotification)(e,this.siteSettings,this.currentUser)}_shouldRun(){return this.chat.userCanChat&&!(0,n.isTesting)()}},o=h(s.prototype,"presence",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=h(s.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(s.prototype,"chatStateManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(s.prototype,"_pageChanged",[a.bind],Object.getOwnPropertyDescriptor(s.prototype,"_pageChanged"),s.prototype),h(s.prototype,"_subscribeToCorrectNotifications",[a.bind],Object.getOwnPropertyDescriptor(s.prototype,"_subscribeToCorrectNotifications"),s.prototype),h(s.prototype,"onMessage",[a.bind],Object.getOwnPropertyDescriptor(s.prototype,"onMessage"),s.prototype),s)
e.default=p}))
define("discourse/plugins/chat/discourse/services/chat-pane-base-subscriptions-manager",["exports","@ember/service","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-message-mention-warning","discourse-common/lib/object","discourse-common/utils/decorators"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function h(e,t,i){const n=t.findStagedMessage(i.staged_id)
if(n)return n.error=null,n.id=i.chat_message.id,n.staged=!1,n.excerpt=i.chat_message.excerpt,n.channel=e,n.createdAt=new Date(i.chat_message.created_at),n.cooked=i.chat_message.cooked,n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.handleStagedMessage=h
let p=(s=class extends t.default{constructor(){super(...arguments),u(this,"chat",o,this),u(this,"currentUser",l,this),u(this,"chatStagedThreadMapping",c,this)}get messageBusChannel(){throw"not implemented"}get messageBusLastId(){throw"not implemented"}get messagesManager(){return this.model.messagesManager}subscribe(e){this.unsubscribe(),this.model=e,this.messageBus.subscribe(this.messageBusChannel,this.onMessage,this.messageBusLastId)}unsubscribe(){this.model&&(this.messageBus.unsubscribe(this.messageBusChannel,this.onMessage),this.model=null)}handleStagedMessageInternal(e,t){return h(e,this.messagesManager,t)}onMessage(e){switch(e.type){case"sent":this.handleSentMessage(e)
break
case"reaction":this.handleReactionMessage(e)
break
case"processed":this.handleProcessedMessage(e)
break
case"edit":this.handleEditMessage(e)
break
case"refresh":this.handleRefreshMessage(e)
break
case"delete":this.handleDeleteMessage(e)
break
case"bulk_delete":this.handleBulkDeleteMessage(e)
break
case"restore":this.handleRestoreMessage(e)
break
case"mention_warning":this.handleMentionWarning(e)
break
case"self_flagged":this.handleSelfFlaggedMessage(e)
break
case"flag":this.handleFlaggedMessage(e)
break
case"thread_created":this.handleNewThreadCreated(e)
break
case"update_thread_original_message":this.handleThreadOriginalMessageUpdate(e)
break
case"notice":this.handleNotice(e)}}handleSentMessage(){throw"not implemented"}handleProcessedMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&(t.cooked=e.chat_message.cooked)}handleReactionMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&t.react(e.emoji,e.action,e.user,this.currentUser.id)}handleEditMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&(t.message=e.chat_message.message,t.cooked=e.chat_message.cooked,t.excerpt=e.chat_message.excerpt,t.uploads=(0,r.cloneJSON)(e.chat_message.uploads||[]),t.edited=!0)}handleRefreshMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&t.incrementVersion()}handleBulkDeleteMessage(e){e.deleted_ids.forEach((t=>{this.handleDeleteMessage({deleted_id:t,deleted_at:e.deleted_at})}))}handleDeleteMessage(e){const t=e.deleted_id,i=this.messagesManager.findMessage(t)
i&&(this.currentUser.staff||this.currentUser.id===i.user.id?(i.deletedAt=e.deleted_at,i.deletedById=e.deleted_by_id,i.expanded=!1):this.messagesManager.removeMessage(i),this._afterDeleteMessage(i,e))}handleRestoreMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
if(t)t.deletedAt=null
else{const t=i.default.create(this.model,e.chat_message)
t.manager=this.messagesManager,this.messagesManager.addMessages([t])}}handleMentionWarning(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&(t.mentionWarning=n.default.create(t,e))}handleSelfFlaggedMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&(t.userFlagStatus=e.user_flag_status)}handleFlaggedMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&(t.reviewableId=e.reviewable_id)}handleNewThreadCreated(e){this.model.threadsManager.find(this.model.id,e.staged_thread_id,{fetchIfNotFound:!1}).then((t=>{t?(this.chatStagedThreadMapping.setMapping(e.thread_id,t.id),t.staged=!1,t.id=e.thread_id,t.originalMessage.thread=t,t.originalMessage.thread.preview.replyCount??=1,this.model.threadsManager.remove({id:e.staged_thread_id}),this.model.threadsManager.add(this.model,t,{replace:!0})):e.thread_id&&this.model.threadsManager.find(this.model.id,e.thread_id,{fetchIfNotFound:!0}).then((e=>{const t=this.model.messagesManager.findMessage(e.originalMessage.id)
t&&(t.thread=e)}))}))}handleThreadOriginalMessageUpdate(){throw"not implemented"}handleNotice(){throw"not implemented"}_afterDeleteMessage(){throw"not implemented"}},o=d(s.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=d(s.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=d(s.prototype,"chatStagedThreadMapping",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(s.prototype,"onMessage",[a.bind],Object.getOwnPropertyDescriptor(s.prototype,"onMessage"),s.prototype),s)
e.default=p})),define("discourse/plugins/chat/discourse/services/chat-side-panel-size",["exports","@ember/service","discourse/lib/key-value-store"],(function(e,t,i){"use strict"
function n(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function r(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s=new WeakSet
class o extends t.default{constructor(){super(...arguments),n(this,s),r(this,"STORE_NAMESPACE","discourse_chat_side_panel_size_"),r(this,"MIN_WIDTH",250),r(this,"store",new i.default(this.STORE_NAMESPACE))}get width(){return this.store.getObject("width")||this.MIN_WIDTH}set width(e){this.store.setObject({key:"width",value:a(this,s,l).call(this,e,this.MIN_WIDTH)})}}function l(e,t){return Math.max(e,t)}e.default=o})),define("discourse/plugins/chat/discourse/services/chat-staged-thread-mapping",["exports","discourse/lib/key-value-store","@ember/service"],(function(e,t,i){"use strict"
function n(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends i.default{constructor(){super(...arguments),n(this,"STORE_NAMESPACE","discourse_chat_"),n(this,"KEY","staged_thread"),n(this,"store",new t.default(this.STORE_NAMESPACE)),this.store.getObject(this.USER_EMOJIS_STORE_KEY)||(this.storedFavorites=[])}getMapping(){return JSON.parse(this.store.getObject(this.KEY)||"{}")}setMapping(e,t){const i={}
i[t]=e,this.store.setObject({key:this.KEY,value:JSON.stringify(i)})}reset(){this.store.setObject({key:this.KEY,value:"{}"})}}e.default=r})),define("discourse/plugins/chat/discourse/services/chat-state-manager",["exports","@ember/service","discourse/lib/utilities","@glimmer/tracking","discourse/lib/key-value-store","discourse/models/site","discourse-common/lib/get-url"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h,p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function y(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function w(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.addChatDrawerStateCallback=function(e){k.push(e)},e.default=void 0,e.resetChatDrawerStateCallbacks=function(){k=[]}
const j="preferred_mode",M="FULL_PAGE_CHAT",z="DRAWER_CHAT"
let k=[]
let O=(g=new WeakSet,o=class extends t.default{constructor(){super(...arguments),v(this,g),f(this,"chat",l,this),f(this,"chatHistory",c,this),f(this,"router",u,this),f(this,"isSidePanelExpanded",d,this),f(this,"isDrawerExpanded",h,this),f(this,"isDrawerActive",p,this),f(this,"_chatURL",m,this),f(this,"_appURL",b,this),y(this,"_store",new r.default("discourse_chat_"))}reset(){this._store.remove(j),this._chatURL=null,this._appURL=null}prefersFullPage(){this._store.setObject({key:j,value:M})}prefersDrawer(){this._store.setObject({key:j,value:z})}openSidePanel(){this.isSidePanelExpanded=!0}closeSidePanel(){this.isSidePanelExpanded=!1}didOpenDrawer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null
this.isDrawerActive=!0,this.isDrawerExpanded=!0,e&&this.storeChatURL(e),this.chat.updatePresence(),_(this,g,C).call(this)}didCloseDrawer(){this.isDrawerActive=!1,this.isDrawerExpanded=!1,this.chat.updatePresence(),_(this,g,C).call(this)}didExpandDrawer(){this.isDrawerActive=!0,this.isDrawerExpanded=!0,this.chat.updatePresence()}didCollapseDrawer(){this.isDrawerActive=!0,this.isDrawerExpanded=!1,_(this,g,C).call(this)}didToggleDrawer(){this.isDrawerExpanded=!this.isDrawerExpanded,this.isDrawerActive=!0,_(this,g,C).call(this)}get isFullPagePreferred(){return!(!a.default.currentProp("mobileView")&&this._store.getObject(j)!==M)}get isDrawerPreferred(){return!(this.isFullPagePreferred&&(a.default.currentProp("mobileView")||this._store.getObject(j)&&this._store.getObject(j)!==z))}get isFullPageActive(){return this.router.currentRouteName?.startsWith("chat")}get isActive(){return this.isFullPageActive||this.isDrawerActive}storeAppURL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null
e?this._appURL=e:this.router.currentURL?.startsWith("/chat")?this._appURL="/":this._appURL=this.router.currentURL}storeChatURL(e){this._chatURL=e}get lastKnownAppURL(){let e=this._appURL
return e&&"/"!==e||(e=this.router.urlFor(`discovery.${(0,i.defaultHomepage)()}`)),(0,s.default)(e)}get lastKnownChatURL(){return(0,s.default)(this._chatURL||"/chat")}},l=w(o.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=w(o.prototype,"chatHistory",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=w(o.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=w(o.prototype,"isSidePanelExpanded",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h=w(o.prototype,"isDrawerExpanded",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=w(o.prototype,"isDrawerActive",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m=w(o.prototype,"_chatURL",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=w(o.prototype,"_appURL",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),o)
function C(){const e={isDrawerActive:this.isDrawerActive,isDrawerExpanded:this.isDrawerExpanded}
k.forEach((t=>t(e)))}e.default=O})),define("discourse/plugins/chat/discourse/services/chat-subscriptions-manager",["exports","@ember/service","I18n","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-channel","discourse/plugins/chat/discourse/models/chat-channel-archive"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let v=(s=class extends t.default{constructor(){super(...arguments),b(this,"store",o,this),b(this,"chatChannelsManager",l,this),b(this,"chatTrackingStateManager",c,this),b(this,"currentUser",u,this),b(this,"appEvents",d,this),b(this,"chat",h,this),b(this,"dialog",p,this),b(this,"router",m,this),g(this,"_channelSubscriptions",new Set)}startChannelSubscription(e){e.currentUserMembership.muted||this._channelSubscriptions.has(e.id)||(this._channelSubscriptions.add(e.id),e.isDirectMessageChannel||(this._startChannelMentionsSubscription(e),this._startKickFromChannelSubscription(e)),this._startChannelNewMessagesSubscription(e))}stopChannelSubscription(e){this.messageBus.unsubscribe(`/chat/${e.id}/new-messages`,this._onNewMessages),e.isDirectMessageChannel||(this.messageBus.unsubscribe(`/chat/${e.id}/new-mentions`,this._onNewMentions),this.messageBus.unsubscribe(`/chat/${e.id}/kick`,this._onKickFromChannel)),this._channelSubscriptions.delete(e.id)}startChannelsSubscriptions(e){this._startNewChannelSubscription(e.new_channel),this._startChannelArchiveStatusSubscription(e.archive_status),this._startUserTrackingStateSubscription(e.user_tracking_state),this._startChannelsEditsSubscription(e.channel_edits),this._startChannelsStatusChangesSubscription(e.channel_status),this._startChannelsMetadataChangesSubscription(e.channel_metadata)}stopChannelsSubscriptions(){this._stopNewChannelSubscription(),this._stopChannelArchiveStatusSubscription(),this._stopUserTrackingStateSubscription(),this._stopChannelsEditsSubscription(),this._stopChannelsStatusChangesSubscription(),this._stopChannelsMetadataChangesSubscription(),(this.chatChannelsManager.channels||[]).forEach((e=>{this.stopChannelSubscription(e)}))}_startChannelArchiveStatusSubscription(e){this.currentUser.admin&&this.messageBus.subscribe("/chat/channel-archive-status",this._onChannelArchiveStatusUpdate,e)}_stopChannelArchiveStatusSubscription(){this.currentUser.admin&&this.messageBus.unsubscribe("/chat/channel-archive-status",this._onChannelArchiveStatusUpdate)}_startChannelMentionsSubscription(e){this.messageBus.subscribe(`/chat/${e.id}/new-mentions`,this._onNewMentions,e.meta.message_bus_last_ids.new_mentions)}_startKickFromChannelSubscription(e){this.messageBus.subscribe(`/chat/${e.id}/kick`,this._onKickFromChannel,e.meta.message_bus_last_ids.kick)}_onChannelArchiveStatusUpdate(e){this.chatChannelsManager.find(e.chat_channel_id,{fetchIfNotFound:!1}).then((t=>{t&&(t.archive=a.default.create(e))}))}_onNewMentions(e){this.chatChannelsManager.find(e.channel_id).then((t=>{const i=t.currentUserMembership
e.message_id>i?.lastReadMessageId&&t.tracking.mentionCount++}))}_onKickFromChannel(e){this.chatChannelsManager.find(e.channel_id).then((e=>{this.chat.activeChannel.id===e.id?this.dialog.alert({message:i.default.t("chat.kicked_from_channel"),didConfirm:()=>{this.chatChannelsManager.remove(e)
const t=this.chatChannelsManager.publicMessageChannels[0]
t?this.router.transitionTo("chat.channel",...t.routeModels):this.router.transitionTo("chat.browse")}}):this.chatChannelsManager.remove(e)}))}_startChannelNewMessagesSubscription(e){this.messageBus.subscribe(`/chat/${e.id}/new-messages`,this._onNewMessages,e.meta.message_bus_last_ids.new_messages)}_onNewMessages(e){switch(e.type){case"channel":this._onNewChannelMessage(e)
break
case"thread":this._onNewThreadMessage(e)}}_onNewChannelMessage(e){this.chatChannelsManager.find(e.channel_id).then((t=>{t.lastMessage=e.message
const i=e.message.user
i.id===this.currentUser.id||this.currentUser.ignored_users.includes(i.username)?t.currentUserMembership.lastReadMessageId=t.lastMessage.id:(t.lastMessage.id>(t.currentUserMembership.lastReadMessageId||0)&&t.tracking.unreadCount++,e.thread_id&&t.threadingEnabled&&t.threadsManager.find(t.id,e.thread_id).then((i=>{i.currentUserMembership&&(t.threadsManager.markThreadUnread(e.thread_id,e.message.created_at),this._updateActiveLastViewedAt(t))})))}))}_onNewThreadMessage(e){this.chatChannelsManager.find(e.channel_id).then((t=>{t.threadingEnabled&&t.threadsManager.find(e.channel_id,e.thread_id).then((i=>{e.message.user.id===this.currentUser.id?i.currentUserMembership&&(t.threadsManager.unreadThreadOverview.delete(parseInt(e.thread_id,10)),i.currentUserMembership.lastReadMessageId=e.message.id):this.currentUser.ignored_users.includes(e.message.user.username)?i.currentUserMembership&&(i.currentUserMembership.lastReadMessageId=e.message.id):i.currentUserMembership&&e.message.id>(i.currentUserMembership.lastReadMessageId||0)&&!i.currentUserMembership.isQuiet&&(t.threadsManager.markThreadUnread(e.thread_id,e.message.created_at),i.tracking.unreadCount++,this._updateActiveLastViewedAt(t))}))}))}_updateActiveLastViewedAt(e){this.chat.activeChannel?.id===e.id&&e.updateLastViewedAt()}_startUserTrackingStateSubscription(e){this.currentUser&&(this.messageBus.subscribe(`/chat/user-tracking-state/${this.currentUser.id}`,this._onUserTrackingStateUpdate,e),this.messageBus.subscribe(`/chat/bulk-user-tracking-state/${this.currentUser.id}`,this._onBulkUserTrackingStateUpdate,e))}_stopUserTrackingStateSubscription(){this.currentUser&&(this.messageBus.unsubscribe(`/chat/user-tracking-state/${this.currentUser.id}`,this._onUserTrackingStateUpdate),this.messageBus.unsubscribe(`/chat/bulk-user-tracking-state/${this.currentUser.id}`,this._onBulkUserTrackingStateUpdate))}_onBulkUserTrackingStateUpdate(e){Object.keys(e).forEach((t=>{this._updateChannelTrackingData(t,e[t])}))}_onUserTrackingStateUpdate(e){this._updateChannelTrackingData(e.channel_id,e)}_updateChannelTrackingData(e,t){this.chatChannelsManager.find(e).then((i=>{t.thread_id||(i.currentUserMembership.lastReadMessageId=t.last_read_message_id),i.tracking.unreadCount=t.unread_count,i.tracking.mentionCount=t.mention_count,t.hasOwnProperty("unread_thread_overview")&&i.threadingEnabled&&(i.threadsManager.unreadThreadOverview=t.unread_thread_overview),t.thread_id&&t.hasOwnProperty("thread_tracking")&&i.threadingEnabled&&i.threadsManager.find(e,t.thread_id).then((e=>{e.currentUserMembership&&!e.currentUserMembership.isQuiet&&(e.currentUserMembership.lastReadMessageId=t.last_read_message_id,e.tracking.unreadCount=t.thread_tracking.unread_count,e.tracking.mentionCount=t.thread_tracking.mention_count)}))}))}_startNewChannelSubscription(e){this.messageBus.subscribe("/chat/new-channel",this._onNewChannelSubscription,e)}_stopNewChannelSubscription(){this.messageBus.unsubscribe("/chat/new-channel",this._onNewChannelSubscription)}_onNewChannelSubscription(e){this.chatChannelsManager.find(e.channel.id).then((t=>{t.meta=e.channel.meta,t.currentUserMembership=e.channel.current_user_membership,t.isDirectMessageChannel&&!t.currentUserMembership.following&&(t.tracking.unreadCount=1),this.chatChannelsManager.follow(t)}))}_startChannelsMetadataChangesSubscription(e){this.messageBus.subscribe("/chat/channel-metadata",this._onChannelMetadata,e)}_startChannelsEditsSubscription(e){this.messageBus.subscribe("/chat/channel-edits",this._onChannelEdits,e)}_startChannelsStatusChangesSubscription(e){this.messageBus.subscribe("/chat/channel-status",this._onChannelStatus,e)}_stopChannelsStatusChangesSubscription(){this.messageBus.unsubscribe("/chat/channel-status",this._onChannelStatus)}_stopChannelsEditsSubscription(){this.messageBus.unsubscribe("/chat/channel-edits",this._onChannelEdits)}_stopChannelsMetadataChangesSubscription(){this.messageBus.unsubscribe("/chat/channel-metadata",this._onChannelMetadata)}_onChannelMetadata(e){this.chatChannelsManager.find(e.chat_channel_id,{fetchIfNotFound:!1}).then((t=>{t&&(t.membershipsCount=e.memberships_count,this.appEvents.trigger("chat:refresh-channel-members"))}))}_onChannelEdits(e){this.chatChannelsManager.find(e.chat_channel_id).then((t=>{t&&(t.title=e.name,t.description=e.description,t.slug=e.slug)}))}_onChannelStatus(e){this.chatChannelsManager.find(e.chat_channel_id).then((t=>{t.status=e.status,e.status===r.CHANNEL_STATUSES.archived&&t.tracking.reset()}))}},o=f(s.prototype,"store",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=f(s.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=f(s.prototype,"chatTrackingStateManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=f(s.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=f(s.prototype,"appEvents",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=f(s.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=f(s.prototype,"dialog",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=f(s.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f(s.prototype,"_onChannelArchiveStatusUpdate",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onChannelArchiveStatusUpdate"),s.prototype),f(s.prototype,"_onNewMentions",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onNewMentions"),s.prototype),f(s.prototype,"_onKickFromChannel",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onKickFromChannel"),s.prototype),f(s.prototype,"_onNewMessages",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onNewMessages"),s.prototype),f(s.prototype,"_onBulkUserTrackingStateUpdate",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onBulkUserTrackingStateUpdate"),s.prototype),f(s.prototype,"_onUserTrackingStateUpdate",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onUserTrackingStateUpdate"),s.prototype),f(s.prototype,"_updateChannelTrackingData",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"_updateChannelTrackingData"),s.prototype),f(s.prototype,"_onNewChannelSubscription",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onNewChannelSubscription"),s.prototype),f(s.prototype,"_onChannelMetadata",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onChannelMetadata"),s.prototype),f(s.prototype,"_onChannelEdits",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onChannelEdits"),s.prototype),f(s.prototype,"_onChannelStatus",[n.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onChannelStatus"),s.prototype),s)
e.default=v})),define("discourse/plugins/chat/discourse/services/chat-thread-composer",["exports","discourse/plugins/chat/discourse/models/chat-message","@ember/object","@ember/service","@glimmer/tracking"],(function(e,t,i,n,r){"use strict"
var a,s,o,l
function c(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let d=(a=class extends n.default{constructor(){super(...arguments),c(this,"chat",s,this),c(this,"message",o,this),c(this,"textarea",l,this)}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.textarea?.focus(e)}blur(){this.textarea?.blur()}reset(e){this.message=t.default.createDraftMessage(e.channel,{user:this.currentUser,thread:e})}cancel(){this.message.editing?this.reset(this.message.thread):this.message.inReplyTo&&(this.message.inReplyTo=null)}edit(e){this.chat.activeMessage=null,e.editing=!0,this.message=e,this.focus({refreshHeight:!0,ensureAtEnd:!0})}replyTo(){this.chat.activeMessage=null}},s=u(a.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=u(a.prototype,"message",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=u(a.prototype,"textarea",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(a.prototype,"focus",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"focus"),a.prototype),u(a.prototype,"blur",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"blur"),a.prototype),u(a.prototype,"reset",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"reset"),a.prototype),u(a.prototype,"cancel",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"cancel"),a.prototype),u(a.prototype,"edit",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"edit"),a.prototype),u(a.prototype,"replyTo",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"replyTo"),a.prototype),a)
e.default=d})),define("discourse/plugins/chat/discourse/services/chat-thread-list-pane",["exports","@ember/service"],(function(e,t){"use strict"
var i,n,r
function a(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function s(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let o=(i=class extends t.default{constructor(){super(...arguments),a(this,"chat",n,this),a(this,"router",r,this)}get isOpened(){return"chat.channel.threads"===this.router.currentRoute.name}async close(){await this.router.transitionTo("chat.channel",...this.chat.activeChannel.routeModels)}async open(){await this.router.transitionTo("chat.channel.threads",...this.chat.activeChannel.routeModels)}},n=s(i.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=s(i.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)
e.default=o})),define("discourse/plugins/chat/discourse/services/chat-thread-pane-subscriptions-manager",["exports","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/services/chat-pane-base-subscriptions-manager"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends i.default{get messageBusChannel(){return`/chat/${this.model.channel.id}/thread/${this.model.id}`}get messageBusLastId(){return this.model.threadMessageBusLastId}handleSentMessage(e){if(e.chat_message.user.id===this.currentUser.id&&e.staged_id){if(this.handleStagedMessageInternal(this.model.channel,e))return}const i=t.default.create(this.model.channel,e.chat_message)
i.thread=this.model,i.manager=this.messagesManager,this.messagesManager.addMessages([i])}handleThreadOriginalMessageUpdate(){}handleNotice(){}_afterDeleteMessage(e,t){this.model.currentUserMembership?.lastReadMessageId===e.id&&(this.model.currentUserMembership.lastReadMessageId=t.latest_not_deleted_message_id)}}e.default=n})),define("discourse/plugins/chat/discourse/services/chat-thread-pane",["exports","discourse/plugins/chat/discourse/services/chat-channel-pane","@ember/service"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let l=(n=class extends t.default{constructor(){super(...arguments),s(this,"chat",r,this),s(this,"router",a,this)}get thread(){return this.channel?.activeThread}get isOpened(){return"chat.channel.thread"===this.router.currentRoute.name}get selectedMessageIds(){return this.thread.messagesManager.selectedMessages.mapBy("id")}async close(){await this.router.transitionTo("chat.channel",...this.channel.routeModels)}async open(e){await this.router.transitionTo("chat.channel.thread",...e.routeModels)}},r=o(n.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=o(n.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)
e.default=l})),define("discourse/plugins/chat/discourse/services/chat-tracking-state-manager",["exports","@ember/service","discourse-common/lib/debounce","@ember/runloop","discourse/plugins/chat/discourse/models/chat-tracking-state","discourse-common/lib/get-owner"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function b(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let f=(c=new WeakSet,u=new WeakSet,d=new WeakSet,h=new WeakSet,s=class extends t.default{constructor(){super(...arguments),m(this,h),m(this,d),m(this,u),m(this,c),p(this,"chatChannelsManager",o,this),p(this,"appEvents",l,this)}setupWithPreloadedState(e){let{channel_tracking:t={}}=e
this.chatChannelsManager.channels.forEach((e=>{t[e.id.toString()]&&b(this,u,y).call(this,e,t[e.id.toString()])}))}setupChannelThreadState(e,t){e.threadsManager.threads.forEach((e=>{const i=t[e.id.toString()]
i&&b(this,u,y).call(this,e,i)}))}get publicChannelUnreadCount(){return b(this,d,_).call(this).reduce(((e,t)=>e+t.tracking.unreadCount),0)}get allChannelUrgentCount(){return b(this,d,_).call(this).reduce(((e,t)=>e+t.tracking.mentionCount),0)+b(this,h,w).call(this).reduce(((e,t)=>e+t.tracking.unreadCount),0)}willDestroy(){super.willDestroy(...arguments),(0,n.cancel)(this._onTriggerNotificationDebounceHandler)}triggerNotificationsChanged(){this._onTriggerNotificationDebounceHandler=(0,i.default)(this,b(this,c,v),100)}},o=g(s.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=g(s.prototype,"appEvents",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s)
function v(){this.appEvents.trigger("notifications:changed")}function y(e,t){e.tracking||(e.tracking=new r.default((0,a.getOwner)(this))),e.tracking.unreadCount=t.unread_count,e.tracking.mentionCount=t.mention_count}function _(){return this.chatChannelsManager.publicMessageChannels}function w(){return this.chatChannelsManager.directMessageChannels}e.default=f})),define("discourse/plugins/chat/discourse/services/chat",["exports","discourse-common/lib/deprecated","@glimmer/tracking","discourse/lib/ajax-error","@ember/service","discourse/lib/ajax","@ember/runloop","@ember/object/computed","@ember/object","discourse-common/lib/later","discourse/plugins/chat/discourse/models/chat-message","discourse/lib/user-presence","discourse-common/utils/decorators"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g,f,v,y,_,w,j,M,z,k,O,C,S,P,T,E
function x(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function D(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function I(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const A={userUnseenTime:3e5,browserHiddenTime:3e5}
let U=(p=(0,o.and)("currentUser.has_chat_enabled","siteSettings.chat_enabled"),m=(0,l.computed)("currentUser.staff","currentUser.groups.[]"),b=(0,l.computed)("activeChannel.userSilenced"),g=class extends r.default{constructor(){super(...arguments),x(this,"chatApi",f,this),x(this,"appEvents",v,this),x(this,"currentUser",y,this),x(this,"chatNotificationManager",_,this),x(this,"chatSubscriptionsManager",w,this),x(this,"chatStateManager",j,this),x(this,"chatDraftsManager",M,this),x(this,"presence",z,this),x(this,"router",k,this),x(this,"site",O,this),x(this,"chatChannelsManager",C,this),x(this,"chatTrackingStateManager",S,this),D(this,"cook",null),D(this,"presenceChannel",null),D(this,"sidebarActive",!1),D(this,"isNetworkUnreliable",!1),x(this,"userCanChat",P,this),x(this,"_activeMessage",T,this),x(this,"_activeChannel",E,this)}get activeChannel(){return this._activeChannel}set activeChannel(e){e||(this._activeMessage=null),this._activeChannel&&(this._activeChannel.activeThread=null),this._activeChannel=e}get userCanDirectMessage(){return!!this.currentUser&&(this.currentUser.staff||this.currentUser.isInAnyGroups((this.siteSettings.direct_message_enabled_groups||"11").split("|").map((e=>parseInt(e,10)))))}get userCanInteractWithChat(){return!this.activeChannel?.userSilenced}get activeMessage(){return this._activeMessage}set activeMessage(e){this._activeMessage=e||null}init(){super.init(...arguments),this.userCanChat&&(this.presenceChannel=this.presence.getChannel("/chat/online"),(0,d.onPresenceChange)({callback:this.onPresenceChangeCallback,browserHiddenTime:15e4,userUnseenTime:15e4}))}onPresenceChangeCallback(e){e&&this.chatApi.listCurrentUserChannels().then((e=>{this.chatSubscriptionsManager.stopChannelsSubscriptions(),this.chatSubscriptionsManager.startChannelsSubscriptions(e.meta.message_bus_last_ids),[...e.public_channels,...e.direct_message_channels].forEach((t=>{this.chatChannelsManager.find(t.id,{fetchIfNotFound:!1}).then((i=>{if(!i)return
i.meta.message_bus_last_ids=t.meta.message_bus_last_ids
const n=e.tracking.channel_tracking[i.id]
i.tracking.unreadCount=n.unread_count,i.tracking.mentionCount=n.mention_count,i.currentUserMembership=t.current_user_membership,this.chatSubscriptionsManager.startChannelSubscription(i)}))}))}))}markNetworkAsUnreliable(){(0,s.cancel)(this._networkCheckHandler),this.set("isNetworkUnreliable",!0),this._networkCheckHandler=(0,c.default)((()=>{this.isDestroyed||this.isDestroying||this.markNetworkAsReliable()}),3e4)}markNetworkAsReliable(){(0,s.cancel)(this._networkCheckHandler),this.set("isNetworkUnreliable",!1)}setupWithPreloadedChannels(e){this.chatSubscriptionsManager.startChannelsSubscriptions(e.meta.message_bus_last_ids),this.presenceChannel.subscribe(e.global_presence_channel_state),[...e.public_channels,...e.direct_message_channels].forEach((t=>{const i=this.chatChannelsManager.store(t),n=(this.currentUser?.chat_drafts||[]).find((e=>e.channel_id===i.id))
return n&&this.chatDraftsManager.add(u.default.createDraftMessage(i,Object.assign({user:this.currentUser},JSON.parse(n.data)))),e.unread_thread_overview?.[i.id]&&(i.threadsManager.unreadThreadOverview=e.unread_thread_overview[i.id]),this.chatChannelsManager.follow(i)})),this.chatTrackingStateManager.setupWithPreloadedState(e.tracking)}willDestroy(){super.willDestroy(...arguments),this.userCanChat&&(this.chatSubscriptionsManager.stopChannelsSubscriptions(),(0,d.removeOnPresenceChange)(this.onPresenceChangeCallback))}updatePresence(){(0,s.next)((()=>{this.isDestroyed||this.isDestroying||this.currentUser.user_option?.hide_profile_and_presence||(this.chatStateManager.isActive?this.presenceChannel.enter({activeOptions:A}):this.presenceChannel.leave())}))}getDocumentTitleCount(){return this.chatNotificationManager.shouldCountChatInDocTitle()?this.chatTrackingStateManager.allChannelUrgentCount:0}switchChannelUpOrDown(e){const{activeChannel:t}=this
if(!t)return
let i,n
t.isDirectMessageChannel?(i=this.chatChannelsManager.truncatedDirectMessageChannels,n=this.chatChannelsManager.publicMessageChannels):(i=this.chatChannelsManager.publicMessageChannels,n=this.chatChannelsManager.truncatedDirectMessageChannels)
const r="up"===e,a=i.findIndex((e=>e.id===t.id))
let s=i[a+(r?-1:1)]
if(s)return this.router.transitionTo("chat.channel",...s.routeModels)
const o=n.length?n:i,l=r?o[o.length-1]:o[0]
return l.id!==t.id?this.router.transitionTo("chat.channel",...l.routeModels):void 0}getIdealFirstChannelId(){let e,t,i,n,r,a
return this.chatChannelsManager.channels.forEach((s=>{const o=s.currentUserMembership
if(o.following)if(s.isDirectMessageChannel)!t&&s.tracking.unreadCount>0?t=s.id:r||(r=s.id)
else{if(o.unread_mentions>0)return void(e=s.id)
!i&&s.tracking.unreadCount>0?i=s.id:a||parseInt(this.siteSettings.chat_default_channel_id||0,10)!==s.id?n||(n=s.id):a=s.id}})),e||t||i||a||n||r}_fireOpenFloatAppEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
t?this.router.transitionTo("chat.channel.near-message",...e.routeModels,t):this.router.transitionTo("chat.channel",...e.routeModels)}async followChannel(e){return this.chatChannelsManager.follow(e)}async unfollowChannel(e){return this.chatChannelsManager.unfollow(e).then((()=>{e===this.activeChannel&&e.isDirectMessageChannel&&this.router.transitionTo("chat")}))}upsertDmChannelForUser(e,t){const i=(e.chatable.users||[]).mapBy("username").concat(t.username).uniq()
return this.upsertDmChannelForUsernames(i)}upsertDmChannelForUsernames(e){return(0,a.ajax)("/chat/api/direct-message-channels.json",{method:"POST",data:{target_usernames:e.uniq()}}).then((e=>{const t=this.chatChannelsManager.store(e.channel)
return this.chatChannelsManager.follow(t),t})).catch(n.popupAjaxError)}getDmChannelForUsernames(e){return(0,a.ajax)("/chat/direct_messages.json",{data:{usernames:e.uniq().join(",")}})}addToolbarButton(){(0,t.default)("Use the new chat API `api.registerChatComposerButton` instead of `chat.addToolbarButton`")}},f=I(g.prototype,"chatApi",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=I(g.prototype,"appEvents",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=I(g.prototype,"currentUser",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=I(g.prototype,"chatNotificationManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=I(g.prototype,"chatSubscriptionsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=I(g.prototype,"chatStateManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=I(g.prototype,"chatDraftsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=I(g.prototype,"presence",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=I(g.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=I(g.prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=I(g.prototype,"chatChannelsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=I(g.prototype,"chatTrackingStateManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=I(g.prototype,"userCanChat",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=I(g.prototype,"_activeMessage",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=I(g.prototype,"_activeChannel",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I(g.prototype,"userCanDirectMessage",[m],Object.getOwnPropertyDescriptor(g.prototype,"userCanDirectMessage"),g.prototype),I(g.prototype,"userCanInteractWithChat",[b],Object.getOwnPropertyDescriptor(g.prototype,"userCanInteractWithChat"),g.prototype),I(g.prototype,"onPresenceChangeCallback",[h.bind],Object.getOwnPropertyDescriptor(g.prototype,"onPresenceChangeCallback"),g.prototype),g)
e.default=U})),define("discourse/plugins/chat/discourse/services/emoji-picker-scroll-observer",["exports","@ember/service","discourse-common/utils/decorators","@glimmer/tracking"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let u=(r=class extends t.default{constructor(){super(...arguments),o(this,"chatEmojiPickerManager",a,this),o(this,"enabled",s,this),l(this,"direction","up"),l(this,"prevYPosition",0)}_observerCallback(e){if(!this.enabled)return
this._setScrollDirection(e.target)
const t=[...document.querySelectorAll(".chat-emoji-picker__section")].filter((t=>this._isSectionVisibleInPicker(t,e.target)))
if(t?.length){let e
e="up"===this.direction||this.prevYPosition<50?t.firstObject:t.lastObject,this.chatEmojiPickerManager.lastVisibleSection=e.dataset.section,this.chatEmojiPickerManager.addVisibleSections(t.map((e=>e.dataset.section)))}}observe(e){e.addEventListener("scroll",this._observerCallback)}unobserve(e){e.removeEventListener("scroll",this._observerCallback)}_setScrollDirection(e){e.scrollTop>this.prevYPosition?this.direction="down":this.direction="up",this.prevYPosition=e.scrollTop}_isSectionVisibleInPicker(e,t){const{bottom:i,height:n,top:r}=e.getBoundingClientRect(),a=t.getBoundingClientRect()
return r<=a.top?a.top-r<=n:i-a.bottom<=n}},a=c(r.prototype,"chatEmojiPickerManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"enabled",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),c(r.prototype,"_observerCallback",[i.bind],Object.getOwnPropertyDescriptor(r.prototype,"_observerCallback"),r.prototype),r)
e.default=u})),define("discourse/plugins/chat/discourse/templates/admin-plugins-chat",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"qC6fvPiQ",block:'[[[8,[39,0],null,null,null],[1,"\\n\\n"],[41,[30,0,["selectedWebhook"]],[[[1,"  "],[8,[39,2],null,[["@class","@icon","@label","@title","@action"],["incoming-chat-webhooks-back","chevron-left","chat.incoming_webhooks.back","chat.incoming_webhooks.back",[28,[37,3],[[30,0],[28,[37,4],[[30,0,["selectedWebhookId"]]],null],null],null]]],null],[1,"\\n\\n  "],[10,"form"],[14,0,"form-vertical"],[12],[1,"\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.name"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,6],[[16,"placeholder",[28,[37,5],["chat.incoming_webhooks.name"],null]]],[["@type","@value"],["text",[30,0,["selectedWebhook","name"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.description"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,7],null,[["@value"],[[30,0,["selectedWebhook","description"]]]],null],[1,"    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.username"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,6],[[16,"placeholder",[28,[37,5],["chat.incoming_webhooks.system"],null]]],[["@type","@value"],["text",[30,0,["selectedWebhook","username"]]]],null],[1,"\\n      "],[10,0],[14,0,"control-instructions"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.username_instructions"],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.post_to"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,8],null,[["@content","@value","@onChange"],[[30,0,["model","chat_channels"]],[30,0,["selectedWebhook","chat_channel","id"]],[28,[37,3],[[30,0],"changeChatChannel"],null]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n"],[41,[30,0,["selectedWebhook","emoji"]],[[[1,"          "],[1,[28,[35,5],["chat.incoming_webhooks.current_emoji"],null]],[1,"\\n\\n          "],[10,1],[14,0,"incoming-chat-webhooks-current-emoji"],[12],[1,"\\n            "],[1,[28,[35,9],[[30,0,["selectedWebhook","emoji"]]],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[35,5],["chat.incoming_webhooks.no_emoji"],null]],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n\\n      "],[8,[39,10],null,[["@isActive","@isEditorFocused","@emojiSelected","@onEmojiPickerClose"],[[30,0,["emojiPickerIsActive"]],true,[28,[37,3],[[30,0],"emojiSelected"],null],[28,[37,3],[[30,0],[28,[37,4],[[30,0,["emojiPickerIsActive"]]],null],false],null]]],null],[1,"\\n\\n"],[41,[51,[30,0,["emojiPickerIsActive"]]],[[[1,"        "],[8,[39,2],null,[["@class","@label","@action"],["btn-primary","chat.incoming_webhooks.select_emoji",[28,[37,3],[[30,0],[28,[37,4],[[30,0,["emojiPickerIsActive"]]],null],true],null]]],null],[1,"\\n        "],[8,[39,2],null,[["@label","@action","@disabled"],["chat.incoming_webhooks.reset_emoji",[28,[37,3],[[30,0],[28,[37,4],[[30,0,["selectedWebhook","emoji"]]],null],null],null],[28,[37,12],[[30,0,["selectedWebhook","emoji"]]],null]]],null],[1,"\\n"]],[]],null],[1,"\\n      "],[10,0],[14,0,"control-instructions"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.emoji_instructions"],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,[28,[35,5],["chat.incoming_webhooks.url"],null]],[13],[1,"\\n      "],[10,"label"],[12],[1,[30,0,["selectedWebhook","url"]]],[13],[1,"\\n      "],[10,0],[14,0,"control-instructions"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.url_instructions"],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[39,2],null,[["@class","@label","@title","@action","@disabled"],["btn-primary","chat.incoming_webhooks.save","chat.incoming_webhooks.save",[28,[37,3],[[30,0],"saveEdit"],null],[30,0,["saveEditDisabled"]]]],null],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[1,"  "],[10,"h3"],[12],[1,[28,[35,5],["chat.incoming_webhooks.title"],null]],[13],[1,"\\n\\n"],[41,[30,0,["creatingNew"]],[[[1,"    "],[10,0],[14,0,"new-incoming-webhook-container"],[12],[1,"\\n      "],[8,[39,6],[[16,"placeholder",[28,[37,5],["chat.incoming_webhooks.name_placeholder"],null]]],[["@type","@value"],["text",[30,0,["newWebhookName"]]]],null],[1,"\\n      "],[8,[39,8],null,[["@content","@value","@onChange"],[[30,0,["model","chat_channels"]],[30,0,["newWebhookChannelId"]],[28,[37,3],[[30,0],[28,[37,4],[[30,0,["newWebhookChannelId"]]],null]],null]]],null],[1,"\\n      "],[8,[39,2],null,[["@label","@title","@class","@disabled","@action"],["chat.create","chat.create","btn-primary create-new-incoming-webhook-btn",[28,[37,12],[[30,0,["nameAndChannelValid"]]],null],[28,[37,3],[[30,0],"createNewWebhook"],null]]],null],[1,"\\n      "],[8,[39,2],null,[["@label","@title","@action"],["chat.cancel","chat.cancel",[28,[37,3],[[30,0],"resetNewWebhook"],null]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[1,"    "],[8,[39,2],null,[["@label","@title","@class","@action"],["chat.incoming_webhooks.new","chat.incoming_webhooks.new","btn-primary",[28,[37,3],[[30,0],[28,[37,4],[[30,0,["creatingNew"]]],null],true],null]]],null],[1,"\\n"]],[]]],[1,"\\n  "],[10,2],[12],[1,[28,[35,13],[[28,[37,5],["chat.incoming_webhooks.instructions"],null]],null]],[13],[1,"\\n\\n  "],[10,0],[14,0,"incoming-chat-webhooks"],[12],[1,"\\n"],[41,[30,0,["model","incoming_chat_webhooks"]],[[[42,[28,[37,15],[[28,[37,15],[[30,0,["sortedWebhooks"]]],null]],null],null,[[[1,"        "],[10,0],[14,0,"incoming-chat-webhooks--row"],[12],[1,"\\n          "],[10,0],[14,0,"incoming-chat-webhooks--row--details"],[12],[1,"\\n            "],[10,0],[14,0,"incoming-chat-webhooks--row--details--name"],[12],[1,"\\n              "],[1,[30,1,["name"]]],[1,"\\n            "],[13],[1,"\\n\\n            "],[10,0],[12],[1,"\\n"],[41,[30,1,["emoji"]],[[[1,"                "],[1,[28,[35,9],[[30,1,["emoji"]]],null]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,1,["username"]],[[[1,"                "],[1,[30,1,["username"]]],[1,"\\n"]],[]],[[[1,"                "],[1,[28,[35,5],["chat.incoming_webhooks.system"],null]],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n\\n            "],[10,0],[12],[8,[39,16],null,[["@channel"],[[30,1,["chat_channel"]]]],null],[13],[1,"\\n            "],[10,0],[12],[1,[30,1,["description"]]],[13],[1,"\\n          "],[13],[1,"\\n\\n          "],[10,0],[14,0,"incoming-chat-webhooks--row--controls"],[12],[1,"\\n            "],[10,0],[12],[1,"\\n              "],[8,[39,2],null,[["@class","@icon","@label","@action"],["btn","pencil-alt","chat.incoming_webhooks.edit",[28,[37,3],[[30,0],[28,[37,4],[[30,0,["selectedWebhookId"]]],null],[30,1,["id"]]],null]]],null],[1,"\\n              "],[8,[39,2],null,[["@class","@icon","@title","@action"],["btn btn-danger","trash-alt","chat.incoming_webhooks.delete",[28,[37,3],[[30,0],"destroyWebhook",[30,1]],null]]],null],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[1]],null]],[]],[[[1,"      "],[1,[28,[35,5],["chat.incoming_webhooks.none"],null]],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n"]],[]]]],["webhook"],false,["chat/admin/export-messages","if","d-button","action","mut","i18n","input","textarea","chat-channel-chooser","replace-emoji","emoji-picker","unless","not","html-safe","each","-track-array","chat-channel-title"]]',moduleName:"discourse/plugins/chat/discourse/templates/admin-plugins-chat.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-browse-all",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"n+hNl9uO",block:'[[[8,[39,0],null,[["@status"],["all"]],null]],[],false,["chat-browse-view"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-all.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-browse-archived",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"EUaP2Z63",block:'[[[8,[39,0],null,[["@status"],["archived"]],null]],[],false,["chat-browse-view"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-archived.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-browse-closed",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"ZWfH9pQM",block:'[[[8,[39,0],null,[["@status"],["closed"]],null]],[],false,["chat-browse-view"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-closed.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-browse-open",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"Oa2syDPa",block:'[[[8,[39,0],null,[["@status"],["open"]],null]],[],false,["chat-browse-view"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-open.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-browse",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"bDDVU8Cl",block:'[[[46,[28,[37,1],null,null],null,null,null]],[],false,["component","-outlet"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-channel-info-about",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"0mCTfwHi",block:'[[[8,[39,0],null,[["@channel","@onEditChatChannelName","@onEditChatChannelDescription"],[[30,0,["model"]],[28,[37,1],[[30,0],"onEditChatChannelName"],null],[28,[37,1],[[30,0],"onEditChatChannelDescription"],null]]],null]],[],false,["chat-channel-about-view","action"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-info-about.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-channel-info-members",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"HuRpy8uK",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["model"]]]],null]],[],false,["chat-channel-members-view"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-info-members.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-channel-info-settings",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"q8BaIH17",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["model"]]]],null]],[],false,["chat-channel-settings-view"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-info-settings.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-channel-info",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"hj0edKim",block:'[[[10,0],[14,0,"channel-info"],[12],[1,"\\n  "],[10,0],[14,0,"chat-full-page-header"],[12],[1,"\\n    "],[10,0],[14,0,"chat-channel-header-details"],[12],[1,"\\n      "],[10,0],[14,0,"chat-full-page-header__left-actions"],[12],[1,"\\n"],[41,[30,0,["chatChannelInfoRouteOriginManager","isBrowse"]],[[[1,"          "],[8,[39,1],[[24,0,"chat-full-page-header__back-btn no-text btn-flat btn"],[16,"title",[28,[37,2],["chat.channel_info.back_to_all_channel"],null]]],[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n            "],[1,[28,[35,3],["chevron-left"],null]],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],[[[1,"          "],[8,[39,1],[[24,0,"chat-full-page-header__back-btn no-text btn-flat btn"],[16,"title",[28,[37,2],["chat.channel_info.back_to_channel"],null]]],[["@route","@models"],["chat.channel",[30,0,["model","routeModels"]]]],[["default"],[[[[1,"\\n            "],[1,[28,[35,3],["chevron-left"],null]],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n\\n      "],[8,[39,4],null,[["@channel"],[[30,0,["model"]]]],null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,5],null,[["@channel"],[[30,0,["model"]]]],null],[1,"\\n\\n  "],[10,0],[14,0,"chat-tabs chat-info-tabs"],[12],[1,"\\n    "],[10,"ul"],[14,0,"chat-tabs-list nav-pills"],[14,"role","tablist"],[12],[1,"\\n"],[42,[28,[37,7],[[28,[37,7],[[30,0,["tabs"]]],null]],null],null,[[[1,"        "],[10,"li"],[14,0,"chat-tabs-list__item"],[14,"role","tab"],[15,"aria-controls",[28,[37,8],[[30,1],"-tab"],null]],[12],[1,"\\n          "],[8,[39,1],[[24,0,"chat-tabs-list__link"]],[["@route","@models"],[[28,[37,8],["chat.channel.info.",[30,1]],null],[30,0,["model","routeModels"]]]],[["default"],[[[[1,"\\n            "],[10,1],[12],[1,[28,[35,2],[[28,[37,8],["chat.channel_info.tabs.",[30,1]],null]],null]],[13],[1,"\\n"],[41,[28,[37,9],[[30,1],"members"],null],[[[1,"              "],[10,1],[14,0,"chat-tabs__memberships-count"],[12],[1,"\\n                ("],[1,[30,0,["model","membershipsCount"]]],[1,")\\n              "],[13],[1,"\\n"]],[]],null],[1,"          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n"]],[1]],null],[1,"    "],[13],[1,"\\n\\n    "],[10,0],[15,1,[30,0,["tab"]]],[14,0,"chat-tabs__tabpanel"],[15,"aria-hidden",[28,[37,10],[[30,0,["tab"]],[30,0,["activeTab"]]],null]],[14,"role","tabpanel"],[15,"aria-labelledby",[28,[37,8],[[30,0,["tab"]],"-tab"],null]],[12],[1,"\\n      "],[46,[28,[37,12],null,null],null,null,null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13]],["tab"],false,["if","link-to","i18n","d-icon","chat-channel-title","chat-channel-status","each","-track-array","concat","eq","notEq","component","-outlet"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-info.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-channel-thread",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"l5w9/9z5",block:'[[[8,[39,0],null,[["@thread","@targetMessageId","@includeHeader"],[[30,0,["model"]],[30,0,["targetMessageId"]],true]],null]],[],false,["chat-thread"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-thread.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-channel-threads",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"uukOUxdH",block:'[[[8,[39,0],null,[["@channel","@includeHeader"],[[30,0,["model"]],true]],null]],[],false,["chat/thread-list"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-threads.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-channel",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"ohzsMQzC",block:'[[[8,[39,0],null,[["@channel","@targetMessageId"],[[30,0,["model"]],[30,0,["targetMessageId"]]]],null],[1,"\\n\\n"],[8,[39,1],null,null,[["default"],[[[[1,"\\n  "],[46,[28,[37,3],null,null],null,null,null],[1,"\\n"]],[]]]]]],[],false,["full-page-chat","chat-side-panel","component","-outlet"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-draft-channel",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"sufv3uW6",block:'[[[8,[39,0],null,null,null]],[],false,["chat-draft-channel-screen"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-draft-channel.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat-index",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"Okro16df",block:'[[[8,[39,0],null,null,null]],[],false,["channels-list"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-index.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/chat",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"Ypgs0gJG",block:'[[[10,0],[14,1,"chat-progress-bar-container"],[12],[13],[1,"\\n\\n"],[8,[39,0],null,null,null],[1,"\\n\\n"],[41,[30,0,["chat","sidebarActive"]],[[[1,"  "],[10,0],[14,0,"full-page-chat teams-sidebar-on"],[12],[1,"\\n    "],[46,[28,[37,3],null,null],null,null,null],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[1,"  "],[10,0],[15,0,[28,[37,4],["full-page-chat",[52,[30,0,["shouldUseCoreSidebar"]],"full-page-chat-sidebar-enabled"]],null]],[12],[1,"\\n"],[41,[30,0,["shouldUseChatSidebar"]],[[[1,"      "],[8,[39,5],null,null,null],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,1,"main-chat-outlet"],[15,0,[28,[37,4],["main-chat-outlet",[30,0,["mainOutletModifierClasses"]]],null]],[12],[1,"\\n      "],[46,[28,[37,3],null,null],null,null,null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]]]],[],false,["chat-vh","if","component","-outlet","concat-class","channels-list"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-channel-message-emoji-picker-connector",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"yzyIVLUg",block:'[[[8,[39,0],null,null,null]],[],false,["chat-channel-message-emoji-picker"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-channel-message-emoji-picker-connector.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-drawer-outlet",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"dBkEnbeG",block:'[[[10,0],[14,0,"chat-drawer-outlet-container"],[12],[1,"\\n  "],[8,[39,0],null,null,null],[1,"\\n"],[13]],[],false,["chat-drawer"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-drawer-outlet.hbs",isStrictMode:!1})
e.default=i}))
define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-desktop-outlet",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"6ho8SpDw",block:'[[[8,[39,0],null,null,null]],[],false,["chat-message-actions-desktop"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-desktop-outlet.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-mobile-outlet",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"dy8JR7Ux",block:'[[[8,[39,0],null,null,null]],[],false,["chat-message-actions-mobile"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-mobile-outlet.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/connectors/user-card-below-message-button/chat-button",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"6Q54Siix",block:'[[[41,[30,0,["user","can_chat_user"]],[[[1,"  "],[8,[39,1],null,[["@user"],[[30,0,["user"]]]],null],[1,"\\n"]],[]],null]],[],false,["if","chat/user-card-button"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/user-card-below-message-button/chat-button.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/connectors/user-preferences-nav/user-nav__preferences-chat",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"YHMVvhPt",block:'[[[41,[28,[37,1],[[30,0,["model","can_chat"]],[30,0,["currentUser","admin"]]],null],[[[1,"  "],[8,[39,2],null,[["@route"],["preferences.chat"]],[["default"],[[[[1,"\\n    "],[1,[28,[35,3],["d-chat"],null]],[1,"\\n    "],[10,1],[12],[1,[28,[35,4],["chat.title_capitalized"],null]],[13],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]],null]],[],false,["if","or","link-to","d-icon","i18n"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/user-preferences-nav/user-nav__preferences-chat.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/templates/preferences/chat",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i=(0,t.createTemplateFactory)({id:"JIxVBeAc",block:'[[[10,"label"],[14,0,"control-label"],[12],[1,[28,[35,0],["chat.title_capitalized"],null]],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting"],[14,"data-setting-name","user_chat_enabled"],[12],[1,"\\n  "],[10,"label"],[14,0,"controls"],[12],[1,"\\n    "],[8,[39,1],[[24,1,"user_chat_enabled"]],[["@type","@checked"],["checkbox",[30,0,["model","user_option","chat_enabled"]]]],null],[1,"\\n    "],[1,[28,[35,0],["chat.enable"],null]],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting"],[14,"data-setting-name","user_chat_only_push_notifications"],[12],[1,"\\n  "],[10,"label"],[14,0,"controls"],[12],[1,"\\n    "],[8,[39,1],[[24,1,"user_chat_only_push_notifications"]],[["@type","@checked"],["checkbox",[30,0,["model","user_option","only_chat_push_notifications"]]]],null],[1,"\\n    "],[1,[28,[35,0],["chat.only_chat_push_notifications.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[10,1],[14,0,"control-instructions"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.only_chat_push_notifications.description"],null]],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting"],[14,"data-setting-name","user_chat_ignore_channel_wide_mention"],[12],[1,"\\n  "],[10,"label"],[14,0,"controls"],[12],[1,"\\n    "],[8,[39,1],[[24,1,"user_chat_ignore_channel_wide_mention"]],[["@type","@checked"],["checkbox",[30,0,["model","user_option","ignore_channel_wide_mention"]]]],null],[1,"\\n    "],[1,[28,[35,0],["chat.ignore_channel_wide_mention.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[10,1],[14,0,"control-instructions"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.ignore_channel_wide_mention.description"],null]],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_sounds"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_sounds"],[12],[1,[28,[35,0],["chat.sound.title"],null]],[13],[1,"\\n  "],[8,[39,2],null,[["@options","@valueProperty","@content","@value","@id","@onChange"],[[28,[37,3],null,[["none"],["chat.sounds.none"]]],"value",[30,0,["chatSounds"]],[30,0,["model","user_option","chat_sound"]],"user_chat_sounds",[28,[37,4],[[30,0],"onChangeChatSound"],null]]],null],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_email_frequency"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_email_frequency"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.email_frequency.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[8,[39,2],null,[["@valueProperty","@content","@value","@id","@onChange"],["value",[30,0,["emailFrequencyOptions"]],[30,0,["model","user_option","chat_email_frequency"]],"user_chat_email_frequency",[28,[37,4],[[30,0],[28,[37,5],[[30,0,["model","user_option","chat_email_frequency"]]],null]],null]]],null],[1,"\\n"],[41,[28,[37,7],[[30,0,["model","user_option","chat_email_frequency"]],"when_away"],null],[[[1,"    "],[10,0],[14,0,"control-instructions"],[12],[1,"\\n      "],[1,[28,[35,0],["chat.email_frequency.description"],null]],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_header_indicator_preference"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_header_indicator_preference"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.header_indicator_preference.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[8,[39,2],null,[["@valueProperty","@content","@value","@id","@onChange"],["value",[30,0,["headerIndicatorOptions"]],[30,0,["model","user_option","chat_header_indicator_preference"]],"user_chat_header_indicator_preference",[28,[37,4],[[30,0],[28,[37,5],[[30,0,["model","user_option","chat_header_indicator_preference"]]],null]],null]]],null],[1,"\\n"],[13],[1,"\\n\\n"],[8,[39,8],null,[["@id","@model","@action","@saved"],["user_chat_preference_save",[30,0,["model"]],[28,[37,4],[[30,0],"save"],null],[30,0,["saved"]]]],null]],[],false,["i18n","input","combo-box","hash","action","mut","if","eq","save-controls"]]',moduleName:"discourse/plugins/chat/discourse/templates/preferences/chat.hbs",isStrictMode:!1})
e.default=i})),define("discourse/plugins/chat/discourse/widgets/chat-header-icon",["exports","@ember/template-factory","discourse/widgets/widget","discourse/widgets/render-glimmer"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var r=(0,i.createWidget)("chat-header-icon",{tagName:"li.header-dropdown-toggle.chat-header-icon",title:"chat.title_capitalized",services:["chat"],html(){if(this.chat.userCanChat)return[new n.default(this,"div.widget-component-connector",(0,t.createTemplateFactory)({id:"/OOwVHdi",block:'[[[8,[39,0],null,null,null]],[],false,["chat/header/icon"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/widgets/chat-header-icon.js",isStrictMode:!1}))]}})
e.default=r})),define("discourse/plugins/chat/discourse/widgets/chat-invitation-notification-item",["I18n","discourse/widgets/raw-html","discourse/widgets/widget","discourse/widgets/default-notification-item","virtual-dom","discourse/lib/utilities","discourse-common/lib/icon-library","discourse/plugins/chat/discourse/lib/slugify-channel"],(function(e,t,i,n,r,a,s,o){"use strict";(0,i.createWidgetFrom)(n.DefaultNotificationItem,"chat-invitation-notification-item",{services:["chat","router"],text(t){const i=(0,a.formatUsername)(t.invited_by_username)
return e.default.t("notifications.chat_invitation_html",{username:i})},html(e){const i=e.notification_type,n=this.site.get("notificationLookup")[i],{data:a}=e,o=this.text(a),l=this.notificationTitle(n,a),c=new t.default({html:`<div>${o}</div>`}),u=[(0,s.iconNode)("link"),c],d=this.url(a)
return(0,r.h)("a",{attributes:{title:l,href:d,"data-auto-route":!0}},u)},url:e=>`/chat/c/${(0,o.default)({title:e.chat_channel_title,slug:e.chat_channel_slug})||"-"}/${e.chat_channel_id}/${e.chat_message_id}`})})),define("discourse/plugins/chat/discourse/widgets/chat-mention-notification-item",["I18n","discourse/widgets/raw-html","discourse/widgets/widget","discourse/widgets/default-notification-item","virtual-dom","discourse/lib/utilities","discourse-common/lib/icon-library","discourse/plugins/chat/discourse/lib/slugify-channel"],(function(e,t,i,n,r,a,s,o){"use strict"
const l={services:["chat","router"],text(t,i){const n=(0,a.formatUsername)(i.mentioned_by_username),r=i.identifier?`@${i.identifier}`:null,s=i.is_direct_message_channel?"notifications.popup.direct_message_chat_mention":"notifications.popup.chat_mention",o=r?"other_html":"direct_html"
return e.default.t(`${s}.${o}`,{username:n,identifier:r,channel:i.chat_channel_title})},html(e){const i=e.notification_type,n=this.site.get("notificationLookup")[i],{data:a}=e,o=this.notificationTitle(n,a),l=this.text(n,a),c=new t.default({html:`<div>${l}</div>`}),u=[(0,s.iconNode)("d-chat"),c],d=this.url(a)
return(0,r.h)("a",{attributes:{title:o,href:d,"data-auto-route":!0}},u)},url(e){let t=`/chat/c/${(0,o.default)({title:e.chat_channel_title,slug:e.chat_channel_slug})||"-"}/${e.chat_channel_id}`
return e.chat_thread_id?t+=`/t/${e.chat_thread_id}`:t+=`/${e.chat_message_id}`,t}};(0,i.createWidgetFrom)(n.DefaultNotificationItem,"chat-mention-notification-item",l),(0,i.createWidgetFrom)(n.DefaultNotificationItem,"chat-group-mention-notification-item",l)})),define("discourse/plugins/chat/lib/discourse-markdown/chat-transcript",["exports","I18n","pretty-text/emoji"],(function(e,t,i){"use strict"
let n
Object.defineProperty(e,"__esModule",{value:!0}),e.setup=function(e){e.allowList(["div[class=chat-transcript]","div[class=chat-transcript chat-transcript-chained]","div.chat-transcript-meta","div.chat-transcript-user","div.chat-transcript-username","div.chat-transcript-user-avatar","div.chat-transcript-messages","div.chat-transcript-datetime","div.chat-transcript-reactions","div.chat-transcript-reaction","span[title]","div[data-message-id]","div[data-channel-name]","div[data-channel-id]","div[data-username]","div[data-datetime]","a.chat-transcript-channel"]),e.registerOptions(((e,t)=>{e.features["chat-transcript"]=!!t.chat_enabled})),e.registerPlugin((e=>{e.options.discourse.features["chat-transcript"]&&e.block.bbcode.ruler.push("chat-transcript",r)})),e.buildCookFunction(((e,t)=>{if(!e.discourse.additionalOptions?.chat)return
const i=e.discourse.additionalOptions.chat,r=i.limited_pretty_text_markdown_rules.concat("image")
t({featuresOverride:i.limited_pretty_text_features,markdownItRules:r,hashtagLookup:e.discourse.hashtagLookup,hashtagTypesInPriorityOrder:i.hashtag_configurations["chat-composer"],hashtagIcons:e.discourse.hashtagIcons},(e=>{n=e}))}))}
const r={tag:"chat",replace:function(e,r,a){if(!n)return
const s=e.md.options.discourse,[o,l,c]=r.attrs.quote&&r.attrs.quote.split(";")||[],u=r.attrs.reactions,d=!!r.attrs.multiQuote,h=!!r.attrs.noLink,p=r.attrs.channel,m=r.attrs.channelId,b=m?s.getURL(`/chat/c/-/${m}`):null
if(!o||!l||!c)return
let g,f,v=e.push("div_chat_transcript_wrap","div",1),y=["chat-transcript"]
if(r.attrs.chained&&y.push("chat-transcript-chained"),v.attrs=[["class",y.join(" ")]],v.attrs.push(["data-message-id",l]),v.attrs.push(["data-username",o]),v.attrs.push(["data-datetime",c]),u&&v.attrs.push(["data-reactions",u]),p&&(v.attrs.push(["data-channel-name",p]),d)){e.push("div_chat_transcript_meta","div",1).attrs=[["class","chat-transcript-meta"]]
e.push("html_inline","",0).content=t.default.t("chat.quote.original_channel",{channel:p,channelLink:b}),e.push("div_chat_transcript_meta","div",-1)}if(m&&v.attrs.push(["data-channel-id",m]),e.push("div_chat_transcript_user","div",1).attrs=[["class","chat-transcript-user"]],e.push("div_chat_transcript_user_avatar","div",1).attrs=[["class","chat-transcript-user-avatar"]],s.lookupAvatar&&(g=s.lookupAvatar(o)),g){e.push("html_inline","",0).content=g}e.push("div_chat_transcript_user_avatar","div",-1),e.push("div_chat_transcript_username","div",1).attrs=[["class","chat-transcript-username"]],f=s.formatUsername?s.formatUsername(o):o
if(e.push("html_inline","",0).content=f,e.push("div_chat_transcript_username","div",-1),e.push("div_chat_transcript_datetime","div",1).attrs=[["class","chat-transcript-datetime"]],h||!b){let t=e.push("span_open","span",1)
t.attrs=[["title",c]],t.block=!1,t=e.push("span_close","span",-1),t.block=!1}else{let t=e.push("link_open","a",1)
t.attrs=[["href",`${b}/${l}`],["title",c]],t.block=!1,t=e.push("link_close","a",-1),t.block=!1}if(e.push("div_chat_transcript_datetime","div",-1),p&&!d){let t=e.push("link_open","a",1)
t.attrs=[["class","chat-transcript-channel"],["href",b]],e.push("html_inline","",0).content=`#${p}`,t=e.push("link_close","a",-1),t.block=!1}e.push("div_chat_transcript_user","div",-1),e.push("div_chat_transcript_messages","div",1).attrs=[["class","chat-transcript-messages"]]
if(e.push("html_raw","",1).content=n(a),e.push("html_raw","",-1),u){let t={}
e.push("div_chat_transcript_reactions","div",1).attrs=[["class","chat-transcript-reactions"]],u.split(";").forEach((n=>{const r=n.split(":"),a=r[0],o=r[1].split(",")
e.push("div_chat_transcript_reaction","div",1).attrs=[["class","chat-transcript-reaction"]]
const l=e.push("html_inline","",0)
t[a]||(t[a]=(0,i.performEmojiUnescape)(`:${a}:`,{getURL:s.getURL,emojiSet:s.emojiSet,emojiCDNUrl:s.emojiCDNUrl,enableEmojiShortcuts:s.enableEmojiShortcuts,inlineEmoji:s.inlineEmoji,lazy:!0})),l.content=`${t[a]} ${o.length.toString()}`,e.push("div_chat_transcript_reaction","div",-1)})),e.push("div_chat_transcript_reactions","div",-1)}return e.push("div_chat_transcript_messages","div",-1),e.push("div_chat_transcript_wrap","div",-1),!0}}})),define("discourse/plugins/chat/select-kit/addons/components/thread-notifications-button",["exports","select-kit/components/notifications-button","discourse/plugins/chat/discourse/lib/chat-notification-levels"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var n=t.default.extend({pluginApiIdentifiers:["thread-notifications-button"],classNames:["thread-notifications-button"],content:i.threadNotificationButtonLevels,selectKitOptions:{i18nPrefix:"chat.thread.notifications",showFullTitle:!1,btnCustomClasses:"btn-flat"}})
e.default=n}))

//# sourceMappingURL=chat-81e34a3b4536fac50c64d875c29737688c56494311b053972ec82041127a04f6.map
//!

;
